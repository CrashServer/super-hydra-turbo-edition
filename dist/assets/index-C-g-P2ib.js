var $u=(w,i)=>()=>(i||w((i={exports:{}}).exports,i),i.exports);var Yu=$u((exports,module)=>{(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const m of f)if(m.type==="childList")for(const D of m.addedNodes)D.tagName==="LINK"&&D.rel==="modulepreload"&&l(D)}).observe(document,{childList:!0,subtree:!0});function o(f){const m={};return f.integrity&&(m.integrity=f.integrity),f.referrerPolicy&&(m.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?m.credentials="include":f.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(f){if(f.ep)return;f.ep=!0;const m=o(f);fetch(f.href,m)}})();function getDefaultExportFromCjs(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}var codemirror$1={exports:{}},codemirror=codemirror$1.exports,hasRequiredCodemirror;function requireCodemirror(){return hasRequiredCodemirror||(hasRequiredCodemirror=1,function(w,i){(function(o,l){w.exports=l()})(codemirror,function(){var o=navigator.userAgent,l=navigator.platform,f=/gecko\/\d/i.test(o),m=/MSIE \d/.test(o),D=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(o),F=/Edge\/(\d+)/.exec(o),pe=m||D||F,ue=pe&&(m?document.documentMode||6:+(F||D)[1]),j=!F&&/WebKit\//.test(o),xe=j&&/Qt\/\d+\.\d+/.test(o),Z=!F&&/Chrome\/(\d+)/.exec(o),Ee=Z&&+Z[1],we=/Opera\//.test(o),Oe=/Apple Computer/.test(navigator.vendor),Ke=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(o),le=/PhantomJS/.test(o),q=Oe&&(/Mobile\/\w+/.test(o)||navigator.maxTouchPoints>2),ce=/Android/.test(o),Q=q||ce||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(o),N=q||/Mac/.test(l),oe=/\bCrOS\b/.test(o),de=/win/i.test(l),Te=we&&o.match(/Version\/(\d*\.\d*)/);Te&&(Te=Number(Te[1])),Te&&Te>=15&&(we=!1,j=!0);var ze=N&&(xe||we&&(Te==null||Te<12.11)),nt=f||pe&&ue>=9;function Ve(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var st=function(e,t){var A=e.className,r=Ve(t).exec(A);if(r){var n=A.slice(r.index+r[0].length);e.className=A.slice(0,r.index)+(n?r[1]+n:"")}};function G(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function U(e,t){return G(e).appendChild(t)}function T(e,t,A,r){var n=document.createElement(e);if(A&&(n.className=A),r&&(n.style.cssText=r),typeof t=="string")n.appendChild(document.createTextNode(t));else if(t)for(var s=0;s<t.length;++s)n.appendChild(t[s]);return n}function Be(e,t,A,r){var n=T(e,t,A,r);return n.setAttribute("role","presentation"),n}var Ne;document.createRange?Ne=function(e,t,A,r){var n=document.createRange();return n.setEnd(r||e,A),n.setStart(e,t),n}:Ne=function(e,t,A){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch{return r}return r.collapse(!0),r.moveEnd("character",A),r.moveStart("character",t),r};function Ze(e,t){if(t.nodeType==3&&(t=t.parentNode),e.contains)return e.contains(t);do if(t.nodeType==11&&(t=t.host),t==e)return!0;while(t=t.parentNode)}function pt(e){var t=e.ownerDocument||e,A;try{A=e.activeElement}catch{A=t.body||null}for(;A&&A.shadowRoot&&A.shadowRoot.activeElement;)A=A.shadowRoot.activeElement;return A}function gt(e,t){var A=e.className;Ve(t).test(A)||(e.className+=(A?" ":"")+t)}function dt(e,t){for(var A=e.split(" "),r=0;r<A.length;r++)A[r]&&!Ve(A[r]).test(t)&&(t+=" "+A[r]);return t}var yt=function(e){e.select()};q?yt=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:pe&&(yt=function(e){try{e.select()}catch{}});function wt(e){return e.display.wrapper.ownerDocument}function jt(e){return St(e.display.wrapper)}function St(e){return e.getRootNode?e.getRootNode():e.ownerDocument}function Dt(e){return wt(e).defaultView}function bt(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Lt(e,t,A){t||(t={});for(var r in e)e.hasOwnProperty(r)&&(A!==!1||!t.hasOwnProperty(r))&&(t[r]=e[r]);return t}function Wt(e,t,A,r,n){t==null&&(t=e.search(/[^\s\u00a0]/),t==-1&&(t=e.length));for(var s=r||0,u=n||0;;){var c=e.indexOf("	",s);if(c<0||c>=t)return u+(t-s);u+=c-s,u+=A-u%A,s=c+1}}var NA=function(){this.id=null,this.f=null,this.time=0,this.handler=bt(this.onTimeout,this)};NA.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},NA.prototype.set=function(e,t){this.f=t;var A=+new Date+e;(!this.id||A<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=A)};function Tt(e,t){for(var A=0;A<e.length;++A)if(e[A]==t)return A;return-1}var Jt=50,JA={toString:function(){return"CodeMirror.Pass"}},sr={scroll:!1},Cr={origin:"*mouse"},hr={origin:"+move"};function ZA(e,t,A){for(var r=0,n=0;;){var s=e.indexOf("	",r);s==-1&&(s=e.length);var u=s-r;if(s==e.length||n+u>=t)return r+Math.min(u,t-n);if(n+=s-r,n+=A-n%A,r=s+1,n>=t)return r}}var AA=[""];function on(e){for(;AA.length<=e;)AA.push(qt(AA)+" ");return AA[e]}function qt(e){return e[e.length-1]}function ii(e,t){for(var A=[],r=0;r<e.length;r++)A[r]=t(e[r],r);return A}function $o(e,t,A){for(var r=0,n=A(t);r<e.length&&A(e[r])<=n;)r++;e.splice(r,0,t)}function re(){}function to(e,t){var A;return Object.create?A=Object.create(e):(re.prototype=e,A=new re),t&&Lt(t,A),A}var Yo=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function ha(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Yo.test(e))}function sn(e,t){return t?t.source.indexOf("\\w")>-1&&ha(e)?!0:t.test(e):ha(e)}function jr(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var Kr=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function XA(e){return e.charCodeAt(0)>=768&&Kr.test(e)}function ln(e,t,A){for(;(A<0?t>0:t<e.length)&&XA(e.charAt(t));)t+=A;return t}function Jr(e,t,A){for(var r=t>A?-1:1;;){if(t==A)return t;var n=(t+A)/2,s=r<0?Math.ceil(n):Math.floor(n);if(s==t)return e(s)?t:A;e(s)?A=s:t=s+r}}function Fn(e,t,A,r){if(!e)return r(t,A,"ltr",0);for(var n=!1,s=0;s<e.length;++s){var u=e[s];(u.from<A&&u.to>t||t==A&&u.to==t)&&(r(Math.max(u.from,t),Math.min(u.to,A),u.level==1?"rtl":"ltr",s),n=!0)}n||r(t,A,"ltr")}var Rn=null;function ar(e,t,A){var r;Rn=null;for(var n=0;n<e.length;++n){var s=e[n];if(s.from<t&&s.to>t)return n;s.to==t&&(s.from!=s.to&&A=="before"?r=n:Rn=n),s.from==t&&(s.from!=s.to&&A!="before"?r=n:Rn=n)}return r??Rn}var da=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function A(B){return B<=247?e.charAt(B):1424<=B&&B<=1524?"R":1536<=B&&B<=1785?t.charAt(B-1536):1774<=B&&B<=2220?"r":8192<=B&&B<=8203?"w":B==8204?"b":"L"}var r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,n=/[stwN]/,s=/[LRr]/,u=/[Lb1n]/,c=/[1n]/;function d(B,R,te){this.level=B,this.from=R,this.to=te}return function(B,R){var te=R=="ltr"?"L":"R";if(B.length==0||R=="ltr"&&!r.test(B))return!1;for(var se=B.length,Ae=[],fe=0;fe<se;++fe)Ae.push(A(B.charCodeAt(fe)));for(var ke=0,He=te;ke<se;++ke){var Re=Ae[ke];Re=="m"?Ae[ke]=He:He=Re}for(var Je=0,$e=te;Je<se;++Je){var et=Ae[Je];et=="1"&&$e=="r"?Ae[Je]="n":s.test(et)&&($e=et,et=="r"&&(Ae[Je]="R"))}for(var ht=1,mt=Ae[0];ht<se-1;++ht){var Pt=Ae[ht];Pt=="+"&&mt=="1"&&Ae[ht+1]=="1"?Ae[ht]="1":Pt==","&&mt==Ae[ht+1]&&(mt=="1"||mt=="n")&&(Ae[ht]=mt),mt=Pt}for(var xt=0;xt<se;++xt){var Vt=Ae[xt];if(Vt==",")Ae[xt]="N";else if(Vt=="%"){var Ot=void 0;for(Ot=xt+1;Ot<se&&Ae[Ot]=="%";++Ot);for(var Zt=xt&&Ae[xt-1]=="!"||Ot<se&&Ae[Ot]=="1"?"1":"N",eA=xt;eA<Ot;++eA)Ae[eA]=Zt;xt=Ot-1}}for(var $t=0,LA=te;$t<se;++$t){var tA=Ae[$t];LA=="L"&&tA=="1"?Ae[$t]="L":s.test(tA)&&(LA=tA)}for(var zt=0;zt<se;++zt)if(n.test(Ae[zt])){var Bt=void 0;for(Bt=zt+1;Bt<se&&n.test(Ae[Bt]);++Bt);for(var Yt=(zt?Ae[zt-1]:te)=="L",Ut=(Bt<se?Ae[Bt]:te)=="L",_t=Yt==Ut?Yt?"L":"R":te,Rt=zt;Rt<Bt;++Rt)Ae[Rt]=_t;zt=Bt-1}for(var Ft=[],zA,$A=0;$A<se;)if(u.test(Ae[$A])){var kn=$A;for(++$A;$A<se&&u.test(Ae[$A]);++$A);Ft.push(new d(0,kn,$A))}else{var ae=$A,Le=Ft.length,Pe=R=="rtl"?1:0;for(++$A;$A<se&&Ae[$A]!="L";++$A);for(var ct=ae;ct<$A;)if(c.test(Ae[ct])){ae<ct&&(Ft.splice(Le,0,new d(1,ae,ct)),Le+=Pe);var Nt=ct;for(++ct;ct<$A&&c.test(Ae[ct]);++ct);Ft.splice(Le,0,new d(2,Nt,ct)),Le+=Pe,ae=ct}else++ct;ae<$A&&Ft.splice(Le,0,new d(1,ae,$A))}return R=="ltr"&&(Ft[0].level==1&&(zA=B.match(/^\s+/))&&(Ft[0].from=zA[0].length,Ft.unshift(new d(0,0,zA[0].length))),qt(Ft).level==1&&(zA=B.match(/\s+$/))&&(qt(Ft).to-=zA[0].length,Ft.push(new d(0,se-zA[0].length,se)))),R=="rtl"?Ft.reverse():Ft}}();function Xt(e,t){var A=e.order;return A==null&&(A=e.order=da(e.text,t)),A}var Ao=[],kt=function(e,t,A){if(e.addEventListener)e.addEventListener(t,A,!1);else if(e.attachEvent)e.attachEvent("on"+t,A);else{var r=e._handlers||(e._handlers={});r[t]=(r[t]||Ao).concat(A)}};function un(e,t){return e._handlers&&e._handlers[t]||Ao}function dr(e,t,A){if(e.removeEventListener)e.removeEventListener(t,A,!1);else if(e.detachEvent)e.detachEvent("on"+t,A);else{var r=e._handlers,n=r&&r[t];if(n){var s=Tt(n,A);s>-1&&(r[t]=n.slice(0,s).concat(n.slice(s+1)))}}}function er(e,t){var A=un(e,t);if(A.length)for(var r=Array.prototype.slice.call(arguments,2),n=0;n<A.length;++n)A[n].apply(null,r)}function KA(e,t,A){return typeof t=="string"&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),er(e,A||t.type,e,t),Er(t)||t.codemirrorIgnore}function Qr(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var A=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)Tt(A,t[r])==-1&&A.push(t[r])}function wr(e,t){return un(e,t).length>0}function Nr(e){e.prototype.on=function(t,A){kt(this,t,A)},e.prototype.off=function(t,A){dr(this,t,A)}}function WA(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Qi(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Er(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function Mn(e){WA(e),Qi(e)}function pa(e){return e.target||e.srcElement}function Gr(e){var t=e.which;return t==null&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),N&&e.ctrlKey&&t==1&&(t=3),t}var Xo=function(){if(pe&&ue<9)return!1;var e=T("div");return"draggable"in e||"dragDrop"in e}(),Ti;function ro(e){if(Ti==null){var t=T("span","​");U(e,T("span",[t,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(Ti=t.offsetWidth<=1&&t.offsetHeight>2&&!(pe&&ue<8))}var A=Ti?T("span","​"):T("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return A.setAttribute("cm-text",""),A}var Di;function fn(e){if(Di!=null)return Di;var t=U(e,document.createTextNode("AخA")),A=Ne(t,0,1).getBoundingClientRect(),r=Ne(t,1,2).getBoundingClientRect();return G(e),!A||A.left==A.right?!1:Di=r.right-A.right<3}var rA=`

b`.split(/\n/).length!=3?function(e){for(var t=0,A=[],r=e.length;t<=r;){var n=e.indexOf(`
`,t);n==-1&&(n=e.length);var s=e.slice(t,e.charAt(n-1)=="\r"?n-1:n),u=s.indexOf("\r");u!=-1?(A.push(s.slice(0,u)),t+=u+1):(A.push(s),t=n+1)}return A}:function(e){return e.split(/\r\n?|\n/)},On=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch{}return!t||t.parentElement()!=e?!1:t.compareEndPoints("StartToEnd",t)!=0},no=function(){var e=T("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),Ur=null;function Vo(e){if(Ur!=null)return Ur;var t=U(e,T("span","x")),A=t.getBoundingClientRect(),r=Ne(t,0,1).getBoundingClientRect();return Ur=Math.abs(A.left-r.left)>1}var Pi={},Hr={};function zr(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Pi[e]=t}function ai(e,t){Hr[e]=t}function Ii(e){if(typeof e=="string"&&Hr.hasOwnProperty(e))e=Hr[e];else if(e&&typeof e.name=="string"&&Hr.hasOwnProperty(e.name)){var t=Hr[e.name];typeof t=="string"&&(t={name:t}),e=to(t,e),e.name=t.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Ii("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Ii("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function ki(e,t){t=Ii(t);var A=Pi[t.name];if(!A)return ki(e,"text/plain");var r=A(e,t);if(Nn.hasOwnProperty(t.name)){var n=Nn[t.name];for(var s in n)n.hasOwnProperty(s)&&(r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=n[s])}if(r.name=t.name,t.helperType&&(r.helperType=t.helperType),t.modeProps)for(var u in t.modeProps)r[u]=t.modeProps[u];return r}var Nn={};function Li(e,t){var A=Nn.hasOwnProperty(e)?Nn[e]:Nn[e]={};Lt(t,A)}function Zr(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var A={};for(var r in t){var n=t[r];n instanceof Array&&(n=n.concat([])),A[r]=n}return A}function ga(e,t){for(var A;e.innerMode&&(A=e.innerMode(t),!(!A||A.mode==e));)t=A.state,e=A.mode;return A||{mode:e,state:t}}function Fi(e,t,A){return e.startState?e.startState(t,A):!0}var tr=function(e,t,A){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=A};tr.prototype.eol=function(){return this.pos>=this.string.length},tr.prototype.sol=function(){return this.pos==this.lineStart},tr.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},tr.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},tr.prototype.eat=function(e){var t=this.string.charAt(this.pos),A;if(typeof e=="string"?A=t==e:A=t&&(e.test?e.test(t):e(t)),A)return++this.pos,t},tr.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},tr.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},tr.prototype.skipToEnd=function(){this.pos=this.string.length},tr.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},tr.prototype.backUp=function(e){this.pos-=e},tr.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Wt(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Wt(this.string,this.lineStart,this.tabSize):0)},tr.prototype.indentation=function(){return Wt(this.string,null,this.tabSize)-(this.lineStart?Wt(this.string,this.lineStart,this.tabSize):0)},tr.prototype.match=function(e,t,A){if(typeof e=="string"){var r=function(u){return A?u.toLowerCase():u},n=this.string.substr(this.pos,e.length);if(r(n)==r(e))return t!==!1&&(this.pos+=e.length),!0}else{var s=this.string.slice(this.pos).match(e);return s&&s.index>0?null:(s&&t!==!1&&(this.pos+=s[0].length),s)}},tr.prototype.current=function(){return this.string.slice(this.start,this.pos)},tr.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},tr.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},tr.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function Qt(e,t){if(t-=e.first,t<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var A=e;!A.lines;)for(var r=0;;++r){var n=A.children[r],s=n.chunkSize();if(t<s){A=n;break}t-=s}return A.lines[t]}function cn(e,t,A){var r=[],n=t.line;return e.iter(t.line,A.line+1,function(s){var u=s.text;n==A.line&&(u=u.slice(0,A.ch)),n==t.line&&(u=u.slice(t.ch)),r.push(u),++n}),r}function va(e,t,A){var r=[];return e.iter(t,A,function(n){r.push(n.text)}),r}function Tr(e,t){var A=t-e.height;if(A)for(var r=e;r;r=r.parent)r.height+=A}function I(e){if(e.parent==null)return null;for(var t=e.parent,A=Tt(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var n=0;r.children[n]!=t;++n)A+=r.children[n].chunkSize();return A+t.first}function ge(e,t){var A=e.first;e:do{for(var r=0;r<e.children.length;++r){var n=e.children[r],s=n.height;if(t<s){e=n;continue e}t-=s,A+=n.chunkSize()}return A}while(!e.lines);for(var u=0;u<e.lines.length;++u){var c=e.lines[u],d=c.height;if(t<d)break;t-=d}return A+u}function je(e,t){return t>=e.first&&t<e.first+e.size}function ut(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function Ge(e,t,A){if(A===void 0&&(A=null),!(this instanceof Ge))return new Ge(e,t,A);this.line=e,this.ch=t,this.sticky=A}function vt(e,t){return e.line-t.line||e.ch-t.ch}function HA(e,t){return e.sticky==t.sticky&&vt(e,t)==0}function Ar(e){return Ge(e.line,e.ch)}function gr(e,t){return vt(e,t)<0?t:e}function Ri(e,t){return vt(e,t)<0?e:t}function Js(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function Mt(e,t){if(t.line<e.first)return Ge(e.first,0);var A=e.first+e.size-1;return t.line>A?Ge(A,Qt(e,A).text.length):jo(t,Qt(e,t.line).text.length)}function jo(e,t){var A=e.ch;return A==null||A>t?Ge(e.line,t):A<0?Ge(e.line,0):e}function Ko(e,t){for(var A=[],r=0;r<t.length;r++)A[r]=Mt(e,t[r]);return A}var Mi=function(e,t){this.state=e,this.lookAhead=t},en=function(e,t,A,r){this.state=t,this.doc=e,this.line=A,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};en.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return t!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},en.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},en.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},en.fromSaved=function(e,t,A){return t instanceof Mi?new en(e,Zr(e.mode,t.state),A,t.lookAhead):new en(e,Zr(e.mode,t),A)},en.prototype.save=function(e){var t=e!==!1?Zr(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new Mi(t,this.maxLookAhead):t};function Zs(e,t,A,r){var n=[e.state.modeGen],s={};Zo(e,t.text,e.doc.mode,A,function(B,R){return n.push(B,R)},s,r);for(var u=A.state,c=function(B){A.baseTokens=n;var R=e.state.overlays[B],te=1,se=0;A.state=!0,Zo(e,t.text,R.mode,A,function(Ae,fe){for(var ke=te;se<Ae;){var He=n[te];He>Ae&&n.splice(te,1,Ae,n[te+1],He),te+=2,se=Math.min(Ae,He)}if(fe)if(R.opaque)n.splice(ke,te-ke,Ae,"overlay "+fe),te=ke+2;else for(;ke<te;ke+=2){var Re=n[ke+1];n[ke+1]=(Re?Re+" ":"")+"overlay "+fe}},s),A.state=u,A.baseTokens=null,A.baseTokenPos=1},d=0;d<e.state.overlays.length;++d)c(d);return{styles:n,classes:s.bgClass||s.textClass?s:null}}function el(e,t,A){if(!t.styles||t.styles[0]!=e.state.modeGen){var r=ma(e,I(t)),n=t.text.length>e.options.maxHighlightLength&&Zr(e.doc.mode,r.state),s=Zs(e,t,r);n&&(r.state=n),t.stateAfter=r.save(!n),t.styles=s.styles,s.classes?t.styleClasses=s.classes:t.styleClasses&&(t.styleClasses=null),A===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function ma(e,t,A){var r=e.doc,n=e.display;if(!r.mode.startState)return new en(r,!0,t);var s=ru(e,t,A),u=s>r.first&&Qt(r,s-1).stateAfter,c=u?en.fromSaved(r,u,s):new en(r,Fi(r.mode),s);return r.iter(s,t,function(d){Dr(e,d.text,c);var B=c.line;d.stateAfter=B==t-1||B%5==0||B>=n.viewFrom&&B<n.viewTo?c.save():null,c.nextLine()}),A&&(r.modeFrontier=c.line),c}function Dr(e,t,A,r){var n=e.doc.mode,s=new tr(t,e.options.tabSize,A);for(s.start=s.pos=r||0,t==""&&_r(n,A.state);!s.eol();)Oi(n,s,A.state),s.start=s.pos}function _r(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var A=ga(e,t);if(A.mode.blankLine)return A.mode.blankLine(A.state)}}function Oi(e,t,A,r){for(var n=0;n<10;n++){r&&(r[0]=ga(e,A).mode);var s=e.token(t,A);if(t.pos>t.start)return s}throw new Error("Mode "+e.name+" failed to advance stream.")}var tl=function(e,t,A){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=A};function Al(e,t,A,r){var n=e.doc,s=n.mode,u;t=Mt(n,t);var c=Qt(n,t.line),d=ma(e,t.line,A),B=new tr(c.text,e.options.tabSize,d),R;for(r&&(R=[]);(r||B.pos<t.ch)&&!B.eol();)B.start=B.pos,u=Oi(s,B,d.state),r&&R.push(new tl(B,u,Zr(n.mode,d.state)));return r?R:new tl(B,u,d.state)}function Jo(e,t){if(e)for(;;){var A=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!A)break;e=e.slice(0,A.index)+e.slice(A.index+A[0].length);var r=A[1]?"bgClass":"textClass";t[r]==null?t[r]=A[2]:new RegExp("(?:^|\\s)"+A[2]+"(?:$|\\s)").test(t[r])||(t[r]+=" "+A[2])}return e}function Zo(e,t,A,r,n,s,u){var c=A.flattenSpans;c==null&&(c=e.options.flattenSpans);var d=0,B=null,R=new tr(t,e.options.tabSize,r),te,se=e.options.addModeClass&&[null];for(t==""&&Jo(_r(A,r.state),s);!R.eol();){if(R.pos>e.options.maxHighlightLength?(c=!1,u&&Dr(e,t,r,R.pos),R.pos=t.length,te=null):te=Jo(Oi(A,R,r.state,se),s),se){var Ae=se[0].name;Ae&&(te="m-"+(te?Ae+" "+te:Ae))}if(!c||B!=te){for(;d<R.start;)d=Math.min(R.start,d+5e3),n(d,B);B=te}R.start=R.pos}for(;d<R.pos;){var fe=Math.min(R.pos,d+5e3);n(fe,B),d=fe}}function ru(e,t,A){for(var r,n,s=e.doc,u=A?-1:t-(e.doc.mode.innerMode?1e3:100),c=t;c>u;--c){if(c<=s.first)return s.first;var d=Qt(s,c-1),B=d.stateAfter;if(B&&(!A||c+(B instanceof Mi?B.lookAhead:0)<=s.modeFrontier))return c;var R=Wt(d.text,null,e.options.tabSize);(n==null||r>R)&&(n=c-1,r=R)}return n}function nu(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var A=e.first,r=t-1;r>A;r--){var n=Qt(e,r).stateAfter;if(n&&(!(n instanceof Mi)||r+n.lookAhead<t)){A=r+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,A)}}var io=!1,hn=!1;function iu(){io=!0}function au(){hn=!0}function ao(e,t,A){this.marker=e,this.from=t,this.to=A}function ya(e,t){if(e)for(var A=0;A<e.length;++A){var r=e[A];if(r.marker==t)return r}}function ou(e,t){for(var A,r=0;r<e.length;++r)e[r]!=t&&(A||(A=[])).push(e[r]);return A}function su(e,t,A){var r=A&&window.WeakSet&&(A.markedSpans||(A.markedSpans=new WeakSet));r&&e.markedSpans&&r.has(e.markedSpans)?e.markedSpans.push(t):(e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],r&&r.add(e.markedSpans)),t.marker.attachLine(e)}function lu(e,t,A){var r;if(e)for(var n=0;n<e.length;++n){var s=e[n],u=s.marker,c=s.from==null||(u.inclusiveLeft?s.from<=t:s.from<t);if(c||s.from==t&&u.type=="bookmark"&&(!A||!s.marker.insertLeft)){var d=s.to==null||(u.inclusiveRight?s.to>=t:s.to>t);(r||(r=[])).push(new ao(u,s.from,d?null:s.to))}}return r}function oi(e,t,A){var r;if(e)for(var n=0;n<e.length;++n){var s=e[n],u=s.marker,c=s.to==null||(u.inclusiveRight?s.to>=t:s.to>t);if(c||s.from==t&&u.type=="bookmark"&&(!A||s.marker.insertLeft)){var d=s.from==null||(u.inclusiveLeft?s.from<=t:s.from<t);(r||(r=[])).push(new ao(u,d?null:s.from-t,s.to==null?null:s.to-t))}}return r}function es(e,t){if(t.full)return null;var A=je(e,t.from.line)&&Qt(e,t.from.line).markedSpans,r=je(e,t.to.line)&&Qt(e,t.to.line).markedSpans;if(!A&&!r)return null;var n=t.from.ch,s=t.to.ch,u=vt(t.from,t.to)==0,c=lu(A,n,u),d=oi(r,s,u),B=t.text.length==1,R=qt(t.text).length+(B?n:0);if(c)for(var te=0;te<c.length;++te){var se=c[te];if(se.to==null){var Ae=ya(d,se.marker);Ae?B&&(se.to=Ae.to==null?null:Ae.to+R):se.to=n}}if(d)for(var fe=0;fe<d.length;++fe){var ke=d[fe];if(ke.to!=null&&(ke.to+=R),ke.from==null){var He=ya(c,ke.marker);He||(ke.from=R,B&&(c||(c=[])).push(ke))}else ke.from+=R,B&&(c||(c=[])).push(ke)}c&&(c=rl(c)),d&&d!=c&&(d=rl(d));var Re=[c];if(!B){var Je=t.text.length-2,$e;if(Je>0&&c)for(var et=0;et<c.length;++et)c[et].to==null&&($e||($e=[])).push(new ao(c[et].marker,null,null));for(var ht=0;ht<Je;++ht)Re.push($e);Re.push(d)}return Re}function rl(e){for(var t=0;t<e.length;++t){var A=e[t];A.from!=null&&A.from==A.to&&A.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function oo(e,t,A){var r=null;if(e.iter(t.line,A.line+1,function(Ae){if(Ae.markedSpans)for(var fe=0;fe<Ae.markedSpans.length;++fe){var ke=Ae.markedSpans[fe].marker;ke.readOnly&&(!r||Tt(r,ke)==-1)&&(r||(r=[])).push(ke)}}),!r)return null;for(var n=[{from:t,to:A}],s=0;s<r.length;++s)for(var u=r[s],c=u.find(0),d=0;d<n.length;++d){var B=n[d];if(!(vt(B.to,c.from)<0||vt(B.from,c.to)>0)){var R=[d,1],te=vt(B.from,c.from),se=vt(B.to,c.to);(te<0||!u.inclusiveLeft&&!te)&&R.push({from:B.from,to:c.from}),(se>0||!u.inclusiveRight&&!se)&&R.push({from:c.to,to:B.to}),n.splice.apply(n,R),d+=R.length-3}}return n}function so(e){var t=e.markedSpans;if(t){for(var A=0;A<t.length;++A)t[A].marker.detachLine(e);e.markedSpans=null}}function ts(e,t){if(t){for(var A=0;A<t.length;++A)t[A].marker.attachLine(e);e.markedSpans=t}}function Ea(e){return e.inclusiveLeft?-1:0}function lo(e){return e.inclusiveRight?1:0}function ba(e,t){var A=e.lines.length-t.lines.length;if(A!=0)return A;var r=e.find(),n=t.find(),s=vt(r.from,n.from)||Ea(e)-Ea(t);if(s)return-s;var u=vt(r.to,n.to)||lo(e)-lo(t);return u||t.id-e.id}function uo(e,t){var A=hn&&e.markedSpans,r;if(A)for(var n=void 0,s=0;s<A.length;++s)n=A[s],n.marker.collapsed&&(t?n.from:n.to)==null&&(!r||ba(r,n.marker)<0)&&(r=n.marker);return r}function dn(e){return uo(e,!0)}function si(e){return uo(e,!1)}function nl(e,t){var A=hn&&e.markedSpans,r;if(A)for(var n=0;n<A.length;++n){var s=A[n];s.marker.collapsed&&(s.from==null||s.from<t)&&(s.to==null||s.to>t)&&(!r||ba(r,s.marker)<0)&&(r=s.marker)}return r}function As(e,t,A,r,n){var s=Qt(e,t),u=hn&&s.markedSpans;if(u)for(var c=0;c<u.length;++c){var d=u[c];if(d.marker.collapsed){var B=d.marker.find(0),R=vt(B.from,A)||Ea(d.marker)-Ea(n),te=vt(B.to,r)||lo(d.marker)-lo(n);if(!(R>=0&&te<=0||R<=0&&te>=0)&&(R<=0&&(d.marker.inclusiveRight&&n.inclusiveLeft?vt(B.to,A)>=0:vt(B.to,A)>0)||R>=0&&(d.marker.inclusiveRight&&n.inclusiveLeft?vt(B.from,r)<=0:vt(B.from,r)<0)))return!0}}}function Wr(e){for(var t;t=dn(e);)e=t.find(-1,!0).line;return e}function uu(e){for(var t;t=si(e);)e=t.find(1,!0).line;return e}function fu(e){for(var t,A;t=si(e);)e=t.find(1,!0).line,(A||(A=[])).push(e);return A}function rs(e,t){var A=Qt(e,t),r=Wr(A);return A==r?t:I(r)}function il(e,t){if(t>e.lastLine())return t;var A=Qt(e,t),r;if(!Gn(e,A))return t;for(;r=si(A);)A=r.find(1,!0).line;return I(A)+1}function Gn(e,t){var A=hn&&t.markedSpans;if(A){for(var r=void 0,n=0;n<A.length;++n)if(r=A[n],!!r.marker.collapsed){if(r.from==null)return!0;if(!r.marker.widgetNode&&r.from==0&&r.marker.inclusiveLeft&&ns(e,t,r))return!0}}}function ns(e,t,A){if(A.to==null){var r=A.marker.find(1,!0);return ns(e,r.line,ya(r.line.markedSpans,A.marker))}if(A.marker.inclusiveRight&&A.to==t.text.length)return!0;for(var n=void 0,s=0;s<t.markedSpans.length;++s)if(n=t.markedSpans[s],n.marker.collapsed&&!n.marker.widgetNode&&n.from==A.to&&(n.to==null||n.to!=A.from)&&(n.marker.inclusiveLeft||A.marker.inclusiveRight)&&ns(e,t,n))return!0}function Sr(e){e=Wr(e);for(var t=0,A=e.parent,r=0;r<A.lines.length;++r){var n=A.lines[r];if(n==e)break;t+=n.height}for(var s=A.parent;s;A=s,s=A.parent)for(var u=0;u<s.children.length;++u){var c=s.children[u];if(c==A)break;t+=c.height}return t}function fo(e){if(e.height==0)return 0;for(var t=e.text.length,A,r=e;A=dn(r);){var n=A.find(0,!0);r=n.from.line,t+=n.from.ch-n.to.ch}for(r=e;A=si(r);){var s=A.find(0,!0);t-=r.text.length-s.from.ch,r=s.to.line,t+=r.text.length-s.to.ch}return t}function is(e){var t=e.display,A=e.doc;t.maxLine=Qt(A,A.first),t.maxLineLength=fo(t.maxLine),t.maxLineChanged=!0,A.iter(function(r){var n=fo(r);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=r)})}var tn=function(e,t,A){this.text=e,ts(this,t),this.height=A?A(this):1};tn.prototype.lineNo=function(){return I(this)},Nr(tn);function cu(e,t,A,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),so(e),ts(e,A);var n=r?r(e):1;n!=e.height&&Tr(e,n)}function Ni(e){e.parent=null,so(e)}var al={},Gi={};function as(e,t){if(!e||/^\s*$/.test(e))return null;var A=t.addModeClass?Gi:al;return A[e]||(A[e]=e.replace(/\S+/g,"cm-$&"))}function Un(e,t){var A=Be("span",null,null,j?"padding-right: .1px":null),r={pre:Be("pre",[A],"CodeMirror-line"),content:A,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var n=0;n<=(t.rest?t.rest.length:0);n++){var s=n?t.rest[n-1]:t.line,u=void 0;r.pos=0,r.addToken=hu,fn(e.display.measure)&&(u=Xt(s,e.doc.direction))&&(r.addToken=pu(r.addToken,u)),r.map=[];var c=t!=e.display.externalMeasured&&I(s);gu(s,r,el(e,s,c)),s.styleClasses&&(s.styleClasses.bgClass&&(r.bgClass=dt(s.styleClasses.bgClass,r.bgClass||"")),s.styleClasses.textClass&&(r.textClass=dt(s.styleClasses.textClass,r.textClass||""))),r.map.length==0&&r.map.push(0,0,r.content.appendChild(ro(e.display.measure))),n==0?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(j){var d=r.content.lastChild;(/\bcm-tab\b/.test(d.className)||d.querySelector&&d.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")}return er(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=dt(r.pre.className,r.textClass||"")),r}function os(e){var t=T("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function hu(e,t,A,r,n,s,u){if(t){var c=e.splitSpaces?du(t,e.trailingSpace):t,d=e.cm.state.specialChars,B=!1,R;if(!d.test(t))e.col+=t.length,R=document.createTextNode(c),e.map.push(e.pos,e.pos+t.length,R),pe&&ue<9&&(B=!0),e.pos+=t.length;else{R=document.createDocumentFragment();for(var te=0;;){d.lastIndex=te;var se=d.exec(t),Ae=se?se.index-te:t.length-te;if(Ae){var fe=document.createTextNode(c.slice(te,te+Ae));pe&&ue<9?R.appendChild(T("span",[fe])):R.appendChild(fe),e.map.push(e.pos,e.pos+Ae,fe),e.col+=Ae,e.pos+=Ae}if(!se)break;te+=Ae+1;var ke=void 0;if(se[0]=="	"){var He=e.cm.options.tabSize,Re=He-e.col%He;ke=R.appendChild(T("span",on(Re),"cm-tab")),ke.setAttribute("role","presentation"),ke.setAttribute("cm-text","	"),e.col+=Re}else se[0]=="\r"||se[0]==`
`?(ke=R.appendChild(T("span",se[0]=="\r"?"␍":"␤","cm-invalidchar")),ke.setAttribute("cm-text",se[0]),e.col+=1):(ke=e.cm.options.specialCharPlaceholder(se[0]),ke.setAttribute("cm-text",se[0]),pe&&ue<9?R.appendChild(T("span",[ke])):R.appendChild(ke),e.col+=1);e.map.push(e.pos,e.pos+1,ke),e.pos++}}if(e.trailingSpace=c.charCodeAt(t.length-1)==32,A||r||n||B||s||u){var Je=A||"";r&&(Je+=r),n&&(Je+=n);var $e=T("span",[R],Je,s);if(u)for(var et in u)u.hasOwnProperty(et)&&et!="style"&&et!="class"&&$e.setAttribute(et,u[et]);return e.content.appendChild($e)}e.content.appendChild(R)}}function du(e,t){if(e.length>1&&!/  /.test(e))return e;for(var A=t,r="",n=0;n<e.length;n++){var s=e.charAt(n);s==" "&&A&&(n==e.length-1||e.charCodeAt(n+1)==32)&&(s=" "),r+=s,A=s==" "}return r}function pu(e,t){return function(A,r,n,s,u,c,d){n=n?n+" cm-force-border":"cm-force-border";for(var B=A.pos,R=B+r.length;;){for(var te=void 0,se=0;se<t.length&&(te=t[se],!(te.to>B&&te.from<=B));se++);if(te.to>=R)return e(A,r,n,s,u,c,d);e(A,r.slice(0,te.to-B),n,s,null,c,d),s=null,r=r.slice(te.to-B),B=te.to}}}function ss(e,t,A,r){var n=!r&&A.widgetNode;n&&e.map.push(e.pos,e.pos+t,n),!r&&e.cm.display.input.needsContentAttribute&&(n||(n=e.content.appendChild(document.createElement("span"))),n.setAttribute("cm-marker",A.id)),n&&(e.cm.display.input.setUneditable(n),e.content.appendChild(n)),e.pos+=t,e.trailingSpace=!1}function gu(e,t,A){var r=e.markedSpans,n=e.text,s=0;if(!r){for(var u=1;u<A.length;u+=2)t.addToken(t,n.slice(s,s=A[u]),as(A[u+1],t.cm.options));return}for(var c=n.length,d=0,B=1,R="",te,se,Ae=0,fe,ke,He,Re,Je;;){if(Ae==d){fe=ke=He=se="",Je=null,Re=null,Ae=1/0;for(var $e=[],et=void 0,ht=0;ht<r.length;++ht){var mt=r[ht],Pt=mt.marker;if(Pt.type=="bookmark"&&mt.from==d&&Pt.widgetNode)$e.push(Pt);else if(mt.from<=d&&(mt.to==null||mt.to>d||Pt.collapsed&&mt.to==d&&mt.from==d)){if(mt.to!=null&&mt.to!=d&&Ae>mt.to&&(Ae=mt.to,ke=""),Pt.className&&(fe+=" "+Pt.className),Pt.css&&(se=(se?se+";":"")+Pt.css),Pt.startStyle&&mt.from==d&&(He+=" "+Pt.startStyle),Pt.endStyle&&mt.to==Ae&&(et||(et=[])).push(Pt.endStyle,mt.to),Pt.title&&((Je||(Je={})).title=Pt.title),Pt.attributes)for(var xt in Pt.attributes)(Je||(Je={}))[xt]=Pt.attributes[xt];Pt.collapsed&&(!Re||ba(Re.marker,Pt)<0)&&(Re=mt)}else mt.from>d&&Ae>mt.from&&(Ae=mt.from)}if(et)for(var Vt=0;Vt<et.length;Vt+=2)et[Vt+1]==Ae&&(ke+=" "+et[Vt]);if(!Re||Re.from==d)for(var Ot=0;Ot<$e.length;++Ot)ss(t,0,$e[Ot]);if(Re&&(Re.from||0)==d){if(ss(t,(Re.to==null?c+1:Re.to)-d,Re.marker,Re.from==null),Re.to==null)return;Re.to==d&&(Re=!1)}}if(d>=c)break;for(var Zt=Math.min(c,Ae);;){if(R){var eA=d+R.length;if(!Re){var $t=eA>Zt?R.slice(0,Zt-d):R;t.addToken(t,$t,te?te+fe:fe,He,d+$t.length==Ae?ke:"",se,Je)}if(eA>=Zt){R=R.slice(Zt-d),d=Zt;break}d=eA,He=""}R=n.slice(s,s=A[B++]),te=as(A[B++],t.cm.options)}}}function ol(e,t,A){this.line=t,this.rest=fu(t),this.size=this.rest?I(qt(this.rest))-A+1:1,this.node=this.text=null,this.hidden=Gn(e,t)}function xa(e,t,A){for(var r=[],n,s=t;s<A;s=n){var u=new ol(e.doc,Qt(e.doc,s),s);n=s+u.size,r.push(u)}return r}var qA=null;function sl(e){qA?qA.ops.push(e):e.ownsGroup=qA={ops:[e],delayedCallbacks:[]}}function vu(e){var t=e.delayedCallbacks,A=0;do{for(;A<t.length;A++)t[A].call(null);for(var r=0;r<e.ops.length;r++){var n=e.ops[r];if(n.cursorActivityHandlers)for(;n.cursorActivityCalled<n.cursorActivityHandlers.length;)n.cursorActivityHandlers[n.cursorActivityCalled++].call(null,n.cm)}}while(A<t.length)}function An(e,t){var A=e.ownsGroup;if(A)try{vu(A)}finally{qA=null,t(A)}}var li=null;function rr(e,t){var A=un(e,t);if(A.length){var r=Array.prototype.slice.call(arguments,2),n;qA?n=qA.delayedCallbacks:li?n=li:(n=li=[],setTimeout(ui,0));for(var s=function(c){n.push(function(){return A[c].apply(null,r)})},u=0;u<A.length;++u)s(u)}}function ui(){var e=li;li=null;for(var t=0;t<e.length;++t)e[t]()}function co(e,t,A,r){for(var n=0;n<t.changes.length;n++){var s=t.changes[n];s=="text"?ll(e,t):s=="gutter"?ls(e,t,A,r):s=="class"?wa(e,t):s=="widget"&&mu(e,t,r)}t.changes=null}function Hn(e){return e.node==e.text&&(e.node=T("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),pe&&ue<8&&(e.node.style.zIndex=2)),e.node}function Ba(e,t){var A=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(A&&(A+=" CodeMirror-linebackground"),t.background)A?t.background.className=A:(t.background.parentNode.removeChild(t.background),t.background=null);else if(A){var r=Hn(t);t.background=r.insertBefore(T("div",null,A),r.firstChild),e.display.input.setUneditable(t.background)}}function Ca(e,t){var A=e.display.externalMeasured;return A&&A.line==t.line?(e.display.externalMeasured=null,t.measure=A.measure,A.built):Un(e,t)}function ll(e,t){var A=t.text.className,r=Ca(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,wa(e,t)):A&&(t.text.className=A)}function wa(e,t){Ba(e,t),t.line.wrapClass?Hn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var A=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=A||""}function ls(e,t,A,r){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var n=Hn(t);t.gutterBackground=T("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),n.insertBefore(t.gutterBackground,t.text)}var s=t.line.gutterMarkers;if(e.options.lineNumbers||s){var u=Hn(t),c=t.gutter=T("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(c.setAttribute("aria-hidden","true"),e.display.input.setUneditable(c),u.insertBefore(c,t.text),t.line.gutterClass&&(c.className+=" "+t.line.gutterClass),e.options.lineNumbers&&(!s||!s["CodeMirror-linenumbers"])&&(t.lineNumber=c.appendChild(T("div",ut(e.options,A),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),s)for(var d=0;d<e.display.gutterSpecs.length;++d){var B=e.display.gutterSpecs[d].className,R=s.hasOwnProperty(B)&&s[B];R&&c.appendChild(T("div",[R],"CodeMirror-gutter-elt","left: "+r.gutterLeft[B]+"px; width: "+r.gutterWidth[B]+"px"))}}}function mu(e,t,A){t.alignable&&(t.alignable=null);for(var r=Ve("CodeMirror-linewidget"),n=t.node.firstChild,s=void 0;n;n=s)s=n.nextSibling,r.test(n.className)&&t.node.removeChild(n);ul(e,t,A)}function yu(e,t,A,r){var n=Ca(e,t);return t.text=t.node=n.pre,n.bgClass&&(t.bgClass=n.bgClass),n.textClass&&(t.textClass=n.textClass),wa(e,t),ls(e,t,A,r),ul(e,t,r),t.node}function ul(e,t,A){if(fl(e,t.line,t,A,!0),t.rest)for(var r=0;r<t.rest.length;r++)fl(e,t.rest[r],t,A,!1)}function fl(e,t,A,r,n){if(t.widgets)for(var s=Hn(A),u=0,c=t.widgets;u<c.length;++u){var d=c[u],B=T("div",[d.node],"CodeMirror-linewidget"+(d.className?" "+d.className:""));d.handleMouseEvents||B.setAttribute("cm-ignore-events","true"),us(d,B,A,r),e.display.input.setUneditable(B),n&&d.above?s.insertBefore(B,A.gutter||A.text):s.appendChild(B),rr(d,"redraw")}}function us(e,t,A,r){if(e.noHScroll){(A.alignable||(A.alignable=[])).push(t);var n=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(n-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=n+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function zn(e){if(e.height!=null)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Ze(document.body,e.node)){var A="position: relative;";e.coverGutter&&(A+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(A+="width: "+t.display.wrapper.clientWidth+"px;"),U(t.display.measure,T("div",[e.node],null,A))}return e.height=e.node.parentNode.offsetHeight}function qr(e,t){for(var A=pa(t);A!=e.wrapper;A=A.parentNode)if(!A||A.nodeType==1&&A.getAttribute("cm-ignore-events")=="true"||A.parentNode==e.sizer&&A!=e.mover)return!0}function Ui(e){return e.lineSpace.offsetTop}function Wn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function ho(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=U(e.measure,T("pre","x","CodeMirror-line-like")),A=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(A.paddingLeft),right:parseInt(A.paddingRight)};return!isNaN(r.left)&&!isNaN(r.right)&&(e.cachedPaddingH=r),r}function Fr(e){return Jt-e.display.nativeBarWidth}function pn(e){return e.display.scroller.clientWidth-Fr(e)-e.display.barWidth}function _a(e){return e.display.scroller.clientHeight-Fr(e)-e.display.barHeight}function cl(e,t,A){var r=e.options.lineWrapping,n=r&&pn(e);if(!t.measure.heights||r&&t.measure.width!=n){var s=t.measure.heights=[];if(r){t.measure.width=n;for(var u=t.text.firstChild.getClientRects(),c=0;c<u.length-1;c++){var d=u[c],B=u[c+1];Math.abs(d.bottom-B.bottom)>2&&s.push((d.bottom+B.top)/2-A.top)}}s.push(A.bottom-A.top)}}function fs(e,t,A){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var n=0;n<e.rest.length;n++)if(I(e.rest[n])>A)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}}function hl(e,t){t=Wr(t);var A=I(t),r=e.display.externalMeasured=new ol(e.doc,t,A);r.lineN=A;var n=r.built=Un(e,r);return r.text=n.pre,U(e.display.lineMeasure,n.pre),r}function cs(e,t,A,r){return $r(e,fi(e,t),A,r)}function po(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Rr(e,t)];var A=e.display.externalMeasured;if(A&&t>=A.lineN&&t<A.lineN+A.size)return A}function fi(e,t){var A=I(t),r=po(e,A);r&&!r.text?r=null:r&&r.changes&&(co(e,r,A,bo(e)),e.curOp.forceUpdate=!0),r||(r=hl(e,t));var n=fs(r,t,A);return{line:t,view:r,rect:null,map:n.map,cache:n.cache,before:n.before,hasHeights:!1}}function $r(e,t,A,r,n){t.before&&(A=-1);var s=A+(r||""),u;return t.cache.hasOwnProperty(s)?u=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(cl(e,t.view,t.rect),t.hasHeights=!0),u=ps(e,t,A,r),u.bogus||(t.cache[s]=u)),{left:u.left,right:u.right,top:n?u.rtop:u.top,bottom:n?u.rbottom:u.bottom}}var hs={left:0,right:0,top:0,bottom:0};function ci(e,t,A){for(var r,n,s,u,c,d,B=0;B<e.length;B+=3)if(c=e[B],d=e[B+1],t<c?(n=0,s=1,u="left"):t<d?(n=t-c,s=n+1):(B==e.length-3||t==d&&e[B+3]>t)&&(s=d-c,n=s-1,t>=d&&(u="right")),n!=null){if(r=e[B+2],c==d&&A==(r.insertLeft?"left":"right")&&(u=A),A=="left"&&n==0)for(;B&&e[B-2]==e[B-3]&&e[B-1].insertLeft;)r=e[(B-=3)+2],u="left";if(A=="right"&&n==d-c)for(;B<e.length-3&&e[B+3]==e[B+4]&&!e[B+5].insertLeft;)r=e[(B+=3)+2],u="right";break}return{node:r,start:n,end:s,collapse:u,coverStart:c,coverEnd:d}}function ds(e,t){var A=hs;if(t=="left")for(var r=0;r<e.length&&(A=e[r]).left==A.right;r++);else for(var n=e.length-1;n>=0&&(A=e[n]).left==A.right;n--);return A}function ps(e,t,A,r){var n=ci(t.map,A,r),s=n.node,u=n.start,c=n.end,d=n.collapse,B;if(s.nodeType==3){for(var R=0;R<4;R++){for(;u&&XA(t.line.text.charAt(n.coverStart+u));)--u;for(;n.coverStart+c<n.coverEnd&&XA(t.line.text.charAt(n.coverStart+c));)++c;if(pe&&ue<9&&u==0&&c==n.coverEnd-n.coverStart?B=s.parentNode.getBoundingClientRect():B=ds(Ne(s,u,c).getClientRects(),r),B.left||B.right||u==0)break;c=u,u=u-1,d="right"}pe&&ue<11&&(B=Sa(e.display.measure,B))}else{u>0&&(d=r="right");var te;e.options.lineWrapping&&(te=s.getClientRects()).length>1?B=te[r=="right"?te.length-1:0]:B=s.getBoundingClientRect()}if(pe&&ue<9&&!u&&(!B||!B.left&&!B.right)){var se=s.parentNode.getClientRects()[0];se?B={left:se.left,right:se.left+zi(e.display),top:se.top,bottom:se.bottom}:B=hs}for(var Ae=B.top-t.rect.top,fe=B.bottom-t.rect.top,ke=(Ae+fe)/2,He=t.view.measure.heights,Re=0;Re<He.length-1&&!(ke<He[Re]);Re++);var Je=Re?He[Re-1]:0,$e=He[Re],et={left:(d=="right"?B.right:B.left)-t.rect.left,right:(d=="left"?B.left:B.right)-t.rect.left,top:Je,bottom:$e};return!B.left&&!B.right&&(et.bogus=!0),e.options.singleCursorHeightPerLine||(et.rtop=Ae,et.rbottom=fe),et}function Sa(e,t){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Vo(e))return t;var A=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*A,right:t.right*A,top:t.top*r,bottom:t.bottom*r}}function dl(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function pl(e){e.display.externalMeasure=null,G(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)dl(e.display.view[t])}function Qa(e){pl(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function go(e){return Z&&ce?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function gl(e){return Z&&ce?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function gs(e){var t=Wr(e),A=t.widgets,r=0;if(A)for(var n=0;n<A.length;++n)A[n].above&&(r+=zn(A[n]));return r}function vo(e,t,A,r,n){if(!n){var s=gs(t);A.top+=s,A.bottom+=s}if(r=="line")return A;r||(r="local");var u=Sr(t);if(r=="local"?u+=Ui(e.display):u-=e.display.viewOffset,r=="page"||r=="window"){var c=e.display.lineSpace.getBoundingClientRect();u+=c.top+(r=="window"?0:gl(wt(e)));var d=c.left+(r=="window"?0:go(wt(e)));A.left+=d,A.right+=d}return A.top+=u,A.bottom+=u,A}function mo(e,t,A){if(A=="div")return t;var r=t.left,n=t.top;if(A=="page")r-=go(wt(e)),n-=gl(wt(e));else if(A=="local"||!A){var s=e.display.sizer.getBoundingClientRect();r+=s.left,n+=s.top}var u=e.display.lineSpace.getBoundingClientRect();return{left:r-u.left,top:n-u.top}}function yo(e,t,A,r,n){return r||(r=Qt(e.doc,t.line)),vo(e,r,cs(e,r,t.ch,n),A)}function Pr(e,t,A,r,n,s){r=r||Qt(e.doc,t.line),n||(n=fi(e,r));function u(fe,ke){var He=$r(e,n,fe,ke?"right":"left",s);return ke?He.left=He.right:He.right=He.left,vo(e,r,He,A)}var c=Xt(r,e.doc.direction),d=t.ch,B=t.sticky;if(d>=r.text.length?(d=r.text.length,B="before"):d<=0&&(d=0,B="after"),!c)return u(B=="before"?d-1:d,B=="before");function R(fe,ke,He){var Re=c[ke],Je=Re.level==1;return u(He?fe-1:fe,Je!=He)}var te=ar(c,d,B),se=Rn,Ae=R(d,te,B=="before");return se!=null&&(Ae.other=R(d,se,B!="before")),Ae}function vs(e,t){var A=0;t=Mt(e.doc,t),e.options.lineWrapping||(A=zi(e.display)*t.ch);var r=Qt(e.doc,t.line),n=Sr(r)+Ui(e.display);return{left:A,right:A,top:n,bottom:n+r.height}}function Eo(e,t,A,r,n){var s=Ge(e,t,A);return s.xRel=n,r&&(s.outside=r),s}function Ta(e,t,A){var r=e.doc;if(A+=e.display.viewOffset,A<0)return Eo(r.first,0,null,-1,-1);var n=ge(r,A),s=r.first+r.size-1;if(n>s)return Eo(r.first+r.size-1,Qt(r,s).text.length,null,1,1);t<0&&(t=0);for(var u=Qt(r,n);;){var c=Eu(e,u,n,t,A),d=nl(u,c.ch+(c.xRel>0||c.outside>0?1:0));if(!d)return c;var B=d.find(1);if(B.line==n)return B;u=Qt(r,n=B.line)}}function vl(e,t,A,r){r-=gs(t);var n=t.text.length,s=Jr(function(u){return $r(e,A,u-1).bottom<=r},n,0);return n=Jr(function(u){return $r(e,A,u).top>r},s,n),{begin:s,end:n}}function Da(e,t,A,r){A||(A=fi(e,t));var n=vo(e,t,$r(e,A,r),"line").top;return vl(e,t,A,n)}function ms(e,t,A,r){return e.bottom<=A?!1:e.top>A?!0:(r?e.left:e.right)>t}function Eu(e,t,A,r,n){n-=Sr(t);var s=fi(e,t),u=gs(t),c=0,d=t.text.length,B=!0,R=Xt(t,e.doc.direction);if(R){var te=(e.options.lineWrapping?xu:bu)(e,t,A,s,R,r,n);B=te.level!=1,c=B?te.from:te.to-1,d=B?te.to:te.from-1}var se=null,Ae=null,fe=Jr(function(ht){var mt=$r(e,s,ht);return mt.top+=u,mt.bottom+=u,ms(mt,r,n,!1)?(mt.top<=n&&mt.left<=r&&(se=ht,Ae=mt),!0):!1},c,d),ke,He,Re=!1;if(Ae){var Je=r-Ae.left<Ae.right-r,$e=Je==B;fe=se+($e?0:1),He=$e?"after":"before",ke=Je?Ae.left:Ae.right}else{!B&&(fe==d||fe==c)&&fe++,He=fe==0?"after":fe==t.text.length?"before":$r(e,s,fe-(B?1:0)).bottom+u<=n==B?"after":"before";var et=Pr(e,Ge(A,fe,He),"line",t,s);ke=et.left,Re=n<et.top?-1:n>=et.bottom?1:0}return fe=ln(t.text,fe,1),Eo(A,fe,He,Re,r-ke)}function bu(e,t,A,r,n,s,u){var c=Jr(function(te){var se=n[te],Ae=se.level!=1;return ms(Pr(e,Ge(A,Ae?se.to:se.from,Ae?"before":"after"),"line",t,r),s,u,!0)},0,n.length-1),d=n[c];if(c>0){var B=d.level!=1,R=Pr(e,Ge(A,B?d.from:d.to,B?"after":"before"),"line",t,r);ms(R,s,u,!0)&&R.top>u&&(d=n[c-1])}return d}function xu(e,t,A,r,n,s,u){var c=vl(e,t,r,u),d=c.begin,B=c.end;/\s/.test(t.text.charAt(B-1))&&B--;for(var R=null,te=null,se=0;se<n.length;se++){var Ae=n[se];if(!(Ae.from>=B||Ae.to<=d)){var fe=Ae.level!=1,ke=$r(e,r,fe?Math.min(B,Ae.to)-1:Math.max(d,Ae.from)).right,He=ke<s?s-ke+1e9:ke-s;(!R||te>He)&&(R=Ae,te=He)}}return R||(R=n[n.length-1]),R.from<d&&(R={from:d,to:R.to,level:R.level}),R.to>B&&(R={from:R.from,to:B,level:R.level}),R}var hi;function Hi(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(hi==null){hi=T("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)hi.appendChild(document.createTextNode("x")),hi.appendChild(T("br"));hi.appendChild(document.createTextNode("x"))}U(e.measure,hi);var A=hi.offsetHeight/50;return A>3&&(e.cachedTextHeight=A),G(e.measure),A||1}function zi(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var t=T("span","xxxxxxxxxx"),A=T("pre",[t],"CodeMirror-line-like");U(e.measure,A);var r=t.getBoundingClientRect(),n=(r.right-r.left)/10;return n>2&&(e.cachedCharWidth=n),n||10}function bo(e){for(var t=e.display,A={},r={},n=t.gutters.clientLeft,s=t.gutters.firstChild,u=0;s;s=s.nextSibling,++u){var c=e.display.gutterSpecs[u].className;A[c]=s.offsetLeft+s.clientLeft+n,r[c]=s.clientWidth}return{fixedPos:di(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:A,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function di(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function ml(e){var t=Hi(e.display),A=e.options.lineWrapping,r=A&&Math.max(5,e.display.scroller.clientWidth/zi(e.display)-3);return function(n){if(Gn(e.doc,n))return 0;var s=0;if(n.widgets)for(var u=0;u<n.widgets.length;u++)n.widgets[u].height&&(s+=n.widgets[u].height);return A?s+(Math.ceil(n.text.length/r)||1)*t:s+t}}function Wi(e){var t=e.doc,A=ml(e);t.iter(function(r){var n=A(r);n!=r.height&&Tr(r,n)})}function cr(e,t,A,r){var n=e.display;if(!A&&pa(t).getAttribute("cm-not-content")=="true")return null;var s,u,c=n.lineSpace.getBoundingClientRect();try{s=t.clientX-c.left,u=t.clientY-c.top}catch{return null}var d=Ta(e,s,u),B;if(r&&d.xRel>0&&(B=Qt(e.doc,d.line).text).length==d.ch){var R=Wt(B,B.length,e.options.tabSize)-B.length;d=Ge(d.line,Math.max(0,Math.round((s-ho(e.display).left)/zi(e.display))-R))}return d}function Rr(e,t){if(t>=e.display.viewTo||(t-=e.display.viewFrom,t<0))return null;for(var A=e.display.view,r=0;r<A.length;r++)if(t-=A[r].size,t<0)return r}function vr(e,t,A,r){t==null&&(t=e.doc.first),A==null&&(A=e.doc.first+e.doc.size),r||(r=0);var n=e.display;if(r&&A<n.viewTo&&(n.updateLineNumbers==null||n.updateLineNumbers>t)&&(n.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=n.viewTo)hn&&rs(e.doc,t)<n.viewTo&&vn(e);else if(A<=n.viewFrom)hn&&il(e.doc,A+r)>n.viewFrom?vn(e):(n.viewFrom+=r,n.viewTo+=r);else if(t<=n.viewFrom&&A>=n.viewTo)vn(e);else if(t<=n.viewFrom){var s=Pa(e,A,A+r,1);s?(n.view=n.view.slice(s.index),n.viewFrom=s.lineN,n.viewTo+=r):vn(e)}else if(A>=n.viewTo){var u=Pa(e,t,t,-1);u?(n.view=n.view.slice(0,u.index),n.viewTo=u.lineN):vn(e)}else{var c=Pa(e,t,t,-1),d=Pa(e,A,A+r,1);c&&d?(n.view=n.view.slice(0,c.index).concat(xa(e,c.lineN,d.lineN)).concat(n.view.slice(d.index)),n.viewTo+=r):vn(e)}var B=n.externalMeasured;B&&(A<B.lineN?B.lineN+=r:t<B.lineN+B.size&&(n.externalMeasured=null))}function gn(e,t,A){e.curOp.viewChanged=!0;var r=e.display,n=e.display.externalMeasured;if(n&&t>=n.lineN&&t<n.lineN+n.size&&(r.externalMeasured=null),!(t<r.viewFrom||t>=r.viewTo)){var s=r.view[Rr(e,t)];if(s.node!=null){var u=s.changes||(s.changes=[]);Tt(u,A)==-1&&u.push(A)}}}function vn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Pa(e,t,A,r){var n=Rr(e,t),s,u=e.display.view;if(!hn||A==e.doc.first+e.doc.size)return{index:n,lineN:A};for(var c=e.display.viewFrom,d=0;d<n;d++)c+=u[d].size;if(c!=t){if(r>0){if(n==u.length-1)return null;s=c+u[n].size-t,n++}else s=c-t;t+=s,A+=s}for(;rs(e.doc,A)!=A;){if(n==(r<0?0:u.length-1))return null;A+=r*u[n-(r<0?1:0)].size,n+=r}return{index:n,lineN:A}}function yl(e,t,A){var r=e.display,n=r.view;n.length==0||t>=r.viewTo||A<=r.viewFrom?(r.view=xa(e,t,A),r.viewFrom=t):(r.viewFrom>t?r.view=xa(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(Rr(e,t))),r.viewFrom=t,r.viewTo<A?r.view=r.view.concat(xa(e,r.viewTo,A)):r.viewTo>A&&(r.view=r.view.slice(0,Rr(e,A)))),r.viewTo=A}function ys(e){for(var t=e.display.view,A=0,r=0;r<t.length;r++){var n=t[r];!n.hidden&&(!n.node||n.changes)&&++A}return A}function Ia(e){e.display.input.showSelection(e.display.input.prepareSelection())}function pi(e,t){t===void 0&&(t=!0);var A=e.doc,r={},n=r.cursors=document.createDocumentFragment(),s=r.selection=document.createDocumentFragment(),u=e.options.$customCursor;u&&(t=!0);for(var c=0;c<A.sel.ranges.length;c++)if(!(!t&&c==A.sel.primIndex)){var d=A.sel.ranges[c];if(!(d.from().line>=e.display.viewTo||d.to().line<e.display.viewFrom)){var B=d.empty();if(u){var R=u(e,d);R&&or(e,R,n)}else(B||e.options.showCursorWhenSelecting)&&or(e,d.head,n);B||El(e,d,s)}}return r}function or(e,t,A){var r=Pr(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),n=A.appendChild(T("div"," ","CodeMirror-cursor"));if(n.style.left=r.left+"px",n.style.top=r.top+"px",n.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var s=yo(e,t,"div",null,null),u=s.right-s.left;n.style.width=(u>0?u:e.defaultCharWidth())+"px"}if(r.other){var c=A.appendChild(T("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));c.style.display="",c.style.left=r.other.left+"px",c.style.top=r.other.top+"px",c.style.height=(r.other.bottom-r.other.top)*.85+"px"}}function ka(e,t){return e.top-t.top||e.left-t.left}function El(e,t,A){var r=e.display,n=e.doc,s=document.createDocumentFragment(),u=ho(e.display),c=u.left,d=Math.max(r.sizerWidth,pn(e)-r.sizer.offsetLeft)-u.right,B=n.direction=="ltr";function R($e,et,ht,mt){et<0&&(et=0),et=Math.round(et),mt=Math.round(mt),s.appendChild(T("div",null,"CodeMirror-selected","position: absolute; left: "+$e+`px;
                             top: `+et+"px; width: "+(ht??d-$e)+`px;
                             height: `+(mt-et)+"px"))}function te($e,et,ht){var mt=Qt(n,$e),Pt=mt.text.length,xt,Vt;function Ot($t,LA){return yo(e,Ge($e,$t),"div",mt,LA)}function Zt($t,LA,tA){var zt=Da(e,mt,null,$t),Bt=LA=="ltr"==(tA=="after")?"left":"right",Yt=tA=="after"?zt.begin:zt.end-(/\s/.test(mt.text.charAt(zt.end-1))?2:1);return Ot(Yt,Bt)[Bt]}var eA=Xt(mt,n.direction);return Fn(eA,et||0,ht??Pt,function($t,LA,tA,zt){var Bt=tA=="ltr",Yt=Ot($t,Bt?"left":"right"),Ut=Ot(LA-1,Bt?"right":"left"),_t=et==null&&$t==0,Rt=ht==null&&LA==Pt,Ft=zt==0,zA=!eA||zt==eA.length-1;if(Ut.top-Yt.top<=3){var $A=(B?_t:Rt)&&Ft,kn=(B?Rt:_t)&&zA,ae=$A?c:(Bt?Yt:Ut).left,Le=kn?d:(Bt?Ut:Yt).right;R(ae,Yt.top,Le-ae,Yt.bottom)}else{var Pe,ct,Nt,ne;Bt?(Pe=B&&_t&&Ft?c:Yt.left,ct=B?d:Zt($t,tA,"before"),Nt=B?c:Zt(LA,tA,"after"),ne=B&&Rt&&zA?d:Ut.right):(Pe=B?Zt($t,tA,"before"):c,ct=!B&&_t&&Ft?d:Yt.right,Nt=!B&&Rt&&zA?c:Ut.left,ne=B?Zt(LA,tA,"after"):d),R(Pe,Yt.top,ct-Pe,Yt.bottom),Yt.bottom<Ut.top&&R(c,Yt.bottom,null,Ut.top),R(Nt,Ut.top,ne-Nt,Ut.bottom)}(!xt||ka(Yt,xt)<0)&&(xt=Yt),ka(Ut,xt)<0&&(xt=Ut),(!Vt||ka(Yt,Vt)<0)&&(Vt=Yt),ka(Ut,Vt)<0&&(Vt=Ut)}),{start:xt,end:Vt}}var se=t.from(),Ae=t.to();if(se.line==Ae.line)te(se.line,se.ch,Ae.ch);else{var fe=Qt(n,se.line),ke=Qt(n,Ae.line),He=Wr(fe)==Wr(ke),Re=te(se.line,se.ch,He?fe.text.length+1:null).end,Je=te(Ae.line,He?0:null,Ae.ch).start;He&&(Re.top<Je.top-2?(R(Re.right,Re.top,null,Re.bottom),R(c,Je.top,Je.left,Je.bottom)):R(Re.right,Re.top,Je.left-Re.right,Re.bottom)),Re.bottom<Je.top&&R(c,Re.bottom,null,Je.top)}A.appendChild(s)}function mn(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var A=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){e.hasFocus()||qi(e),t.cursorDiv.style.visibility=(A=!A)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Es(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||bs(e))}function xo(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&qi(e))},100)}function bs(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(er(e,"focus",e,t),e.state.focused=!0,gt(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),j&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),mn(e))}function qi(e,t){e.state.delayingBlurEvent||(e.state.focused&&(er(e,"blur",e,t),e.state.focused=!1,st(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Bo(e){for(var t=e.display,A=t.lineDiv.offsetTop,r=Math.max(0,t.scroller.getBoundingClientRect().top),n=t.lineDiv.getBoundingClientRect().top,s=0,u=0;u<t.view.length;u++){var c=t.view[u],d=e.options.lineWrapping,B=void 0,R=0;if(!c.hidden){if(n+=c.line.height,pe&&ue<8){var te=c.node.offsetTop+c.node.offsetHeight;B=te-A,A=te}else{var se=c.node.getBoundingClientRect();B=se.bottom-se.top,!d&&c.text.firstChild&&(R=c.text.firstChild.getBoundingClientRect().right-se.left-1)}var Ae=c.line.height-B;if((Ae>.005||Ae<-.005)&&(n<r&&(s-=Ae),Tr(c.line,B),bl(c.line),c.rest))for(var fe=0;fe<c.rest.length;fe++)bl(c.rest[fe]);if(R>e.display.sizerWidth){var ke=Math.ceil(R/zi(e.display));ke>e.display.maxLineLength&&(e.display.maxLineLength=ke,e.display.maxLine=c.line,e.display.maxLineChanged=!0)}}}Math.abs(s)>2&&(t.scroller.scrollTop+=s)}function bl(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var A=e.widgets[t],r=A.node.parentNode;r&&(A.height=r.offsetHeight)}}function $i(e,t,A){var r=A&&A.top!=null?Math.max(0,A.top):e.scroller.scrollTop;r=Math.floor(r-Ui(e));var n=A&&A.bottom!=null?A.bottom:r+e.wrapper.clientHeight,s=ge(t,r),u=ge(t,n);if(A&&A.ensure){var c=A.ensure.from.line,d=A.ensure.to.line;c<s?(s=c,u=ge(t,Sr(Qt(t,c))+e.wrapper.clientHeight)):Math.min(d,t.lastLine())>=u&&(s=ge(t,Sr(Qt(t,d))-e.wrapper.clientHeight),u=d)}return{from:s,to:Math.max(u,s+1)}}function xl(e,t){if(!KA(e,"scrollCursorIntoView")){var A=e.display,r=A.sizer.getBoundingClientRect(),n=null,s=A.wrapper.ownerDocument;if(t.top+r.top<0?n=!0:t.bottom+r.top>(s.defaultView.innerHeight||s.documentElement.clientHeight)&&(n=!1),n!=null&&!le){var u=T("div","​",null,`position: absolute;
                         top: `+(t.top-A.viewOffset-Ui(e.display))+`px;
                         height: `+(t.bottom-t.top+Fr(e)+A.barHeight)+`px;
                         left: `+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(u),u.scrollIntoView(n),e.display.lineSpace.removeChild(u)}}}function Bu(e,t,A,r){r==null&&(r=0);var n;!e.options.lineWrapping&&t==A&&(A=t.sticky=="before"?Ge(t.line,t.ch+1,"before"):t,t=t.ch?Ge(t.line,t.sticky=="before"?t.ch-1:t.ch,"after"):t);for(var s=0;s<5;s++){var u=!1,c=Pr(e,t),d=!A||A==t?c:Pr(e,A);n={left:Math.min(c.left,d.left),top:Math.min(c.top,d.top)-r,right:Math.max(c.left,d.left),bottom:Math.max(c.bottom,d.bottom)+r};var B=Co(e,n),R=e.doc.scrollTop,te=e.doc.scrollLeft;if(B.scrollTop!=null&&(Yi(e,B.scrollTop),Math.abs(e.doc.scrollTop-R)>1&&(u=!0)),B.scrollLeft!=null&&($n(e,B.scrollLeft),Math.abs(e.doc.scrollLeft-te)>1&&(u=!0)),!u)break}return n}function Bl(e,t){var A=Co(e,t);A.scrollTop!=null&&Yi(e,A.scrollTop),A.scrollLeft!=null&&$n(e,A.scrollLeft)}function Co(e,t){var A=e.display,r=Hi(e.display);t.top<0&&(t.top=0);var n=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:A.scroller.scrollTop,s=_a(e),u={};t.bottom-t.top>s&&(t.bottom=t.top+s);var c=e.doc.height+Wn(A),d=t.top<r,B=t.bottom>c-r;if(t.top<n)u.scrollTop=d?0:t.top;else if(t.bottom>n+s){var R=Math.min(t.top,(B?c:t.bottom)-s);R!=n&&(u.scrollTop=R)}var te=e.options.fixedGutter?0:A.gutters.offsetWidth,se=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:A.scroller.scrollLeft-te,Ae=pn(e)-A.gutters.offsetWidth,fe=t.right-t.left>Ae;return fe&&(t.right=t.left+Ae),t.left<10?u.scrollLeft=0:t.left<se?u.scrollLeft=Math.max(0,t.left+te-(fe?0:10)):t.right>Ae+se-3&&(u.scrollLeft=t.right+(fe?0:10)-Ae),u}function xs(e,t){t!=null&&(gi(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+t)}function yn(e){gi(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function La(e,t,A){(t!=null||A!=null)&&gi(e),t!=null&&(e.curOp.scrollLeft=t),A!=null&&(e.curOp.scrollTop=A)}function qn(e,t){gi(e),e.curOp.scrollToPos=t}function gi(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var A=vs(e,t.from),r=vs(e,t.to);Bs(e,A,r,t.margin)}}function Bs(e,t,A,r){var n=Co(e,{left:Math.min(t.left,A.left),top:Math.min(t.top,A.top)-r,right:Math.max(t.right,A.right),bottom:Math.max(t.bottom,A.bottom)+r});La(e,n.scrollLeft,n.scrollTop)}function Yi(e,t){Math.abs(e.doc.scrollTop-t)<2||(f||Ra(e,{top:t}),Cs(e,t,!0),f&&Ra(e),Fa(e,100))}function Cs(e,t,A){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),!(e.display.scroller.scrollTop==t&&!A)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function $n(e,t,A,r){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((A?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!r)&&(e.doc.scrollLeft=t,Pl(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Xi(e){var t=e.display,A=t.gutters.offsetWidth,r=Math.round(e.doc.height+Wn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?A:0,docHeight:r,scrollHeight:r+Fr(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:A}}var Yn=function(e,t,A){this.cm=A;var r=this.vert=T("div",[T("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n=this.horiz=T("div",[T("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=n.tabIndex=-1,e(r),e(n),kt(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),kt(n,"scroll",function(){n.clientWidth&&t(n.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,pe&&ue<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Yn.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,A=e.scrollHeight>e.clientHeight+1,r=e.nativeBarWidth;if(A){this.vert.style.display="block",this.vert.style.bottom=t?r+"px":"0";var n=e.viewHeight-(t?r:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+n)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=A?r+"px":"0",this.horiz.style.left=e.barLeft+"px";var s=e.viewWidth-e.barLeft-(A?r:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+s)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(r==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:A?r:0,bottom:t?r:0}},Yn.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Yn.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Yn.prototype.zeroWidthHack=function(){var e=N&&!Ke?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new NA,this.disableVert=new NA},Yn.prototype.enableZeroWidthBar=function(e,t,A){e.style.visibility="";function r(){var n=e.getBoundingClientRect(),s=A=="vert"?document.elementFromPoint(n.right-1,(n.top+n.bottom)/2):document.elementFromPoint((n.right+n.left)/2,n.bottom-1);s!=e?e.style.visibility="hidden":t.set(1e3,r)}t.set(1e3,r)},Yn.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var Vi=function(){};Vi.prototype.update=function(){return{bottom:0,right:0}},Vi.prototype.setScrollLeft=function(){},Vi.prototype.setScrollTop=function(){},Vi.prototype.clear=function(){};function vi(e,t){t||(t=Xi(e));var A=e.display.barWidth,r=e.display.barHeight;ws(e,t);for(var n=0;n<4&&A!=e.display.barWidth||r!=e.display.barHeight;n++)A!=e.display.barWidth&&e.options.lineWrapping&&Bo(e),ws(e,Xi(e)),A=e.display.barWidth,r=e.display.barHeight}function ws(e,t){var A=e.display,r=A.scrollbars.update(t);A.sizer.style.paddingRight=(A.barWidth=r.right)+"px",A.sizer.style.paddingBottom=(A.barHeight=r.bottom)+"px",A.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(A.scrollbarFiller.style.display="block",A.scrollbarFiller.style.height=r.bottom+"px",A.scrollbarFiller.style.width=r.right+"px"):A.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(A.gutterFiller.style.display="block",A.gutterFiller.style.height=r.bottom+"px",A.gutterFiller.style.width=t.gutterWidth+"px"):A.gutterFiller.style.display=""}var Mr={native:Yn,null:Vi};function _s(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&st(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new Mr[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),kt(t,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,A){A=="horizontal"?$n(e,t):Yi(e,t)},e),e.display.scrollbars.addClass&&gt(e.display.wrapper,e.display.scrollbars.addClass)}var Cu=0;function br(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Cu,markArrays:null},sl(e.curOp)}function En(e){var t=e.curOp;t&&An(t,function(A){for(var r=0;r<A.ops.length;r++)A.ops[r].cm.curOp=null;mi(A)})}function mi(e){for(var t=e.ops,A=0;A<t.length;A++)wo(t[A]);for(var r=0;r<t.length;r++)Cl(t[r]);for(var n=0;n<t.length;n++)wl(t[n]);for(var s=0;s<t.length;s++)_l(t[s]);for(var u=0;u<t.length;u++)Sl(t[u])}function wo(e){var t=e.cm,A=t.display;_u(t),e.updateMaxLine&&is(t),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<A.viewFrom||e.scrollToPos.to.line>=A.viewTo)||A.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new _o(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Cl(e){e.updatedDisplay=e.mustUpdate&&Ss(e.cm,e.update)}function wl(e){var t=e.cm,A=t.display;e.updatedDisplay&&Bo(t),e.barMeasure=Xi(t),A.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=cs(t,A.maxLine,A.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(A.scroller.clientWidth,A.sizer.offsetLeft+e.adjustWidthTo+Fr(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,A.sizer.offsetLeft+e.adjustWidthTo-pn(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=A.input.prepareSelection())}function _l(e){var t=e.cm;e.adjustWidthTo!=null&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&$n(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var A=e.focus&&e.focus==pt(jt(t));e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,A),(e.updatedDisplay||e.startHeight!=t.doc.height)&&vi(t,e.barMeasure),e.updatedDisplay&&Ts(t,e.barMeasure),e.selectionChanged&&mn(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),A&&Es(e.cm)}function Sl(e){var t=e.cm,A=t.display,r=t.doc;if(e.updatedDisplay&&Dl(t,e.update),A.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(A.wheelStartX=A.wheelStartY=null),e.scrollTop!=null&&Cs(t,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&$n(t,e.scrollLeft,!0,!0),e.scrollToPos){var n=Bu(t,Mt(r,e.scrollToPos.from),Mt(r,e.scrollToPos.to),e.scrollToPos.margin);xl(t,n)}var s=e.maybeHiddenMarkers,u=e.maybeUnhiddenMarkers;if(s)for(var c=0;c<s.length;++c)s[c].lines.length||er(s[c],"hide");if(u)for(var d=0;d<u.length;++d)u[d].lines.length&&er(u[d],"unhide");A.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&er(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function xr(e,t){if(e.curOp)return t();br(e);try{return t()}finally{En(e)}}function lr(e,t){return function(){if(e.curOp)return t.apply(e,arguments);br(e);try{return t.apply(e,arguments)}finally{En(e)}}}function mr(e){return function(){if(this.curOp)return e.apply(this,arguments);br(this);try{return e.apply(this,arguments)}finally{En(this)}}}function ur(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);br(t);try{return e.apply(this,arguments)}finally{En(t)}}}function Fa(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,bt(wu,e))}function wu(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var A=+new Date+e.options.workTime,r=ma(e,t.highlightFrontier),n=[];t.iter(r.line,Math.min(t.first+t.size,e.display.viewTo+500),function(s){if(r.line>=e.display.viewFrom){var u=s.styles,c=s.text.length>e.options.maxHighlightLength?Zr(t.mode,r.state):null,d=Zs(e,s,r,!0);c&&(r.state=c),s.styles=d.styles;var B=s.styleClasses,R=d.classes;R?s.styleClasses=R:B&&(s.styleClasses=null);for(var te=!u||u.length!=s.styles.length||B!=R&&(!B||!R||B.bgClass!=R.bgClass||B.textClass!=R.textClass),se=0;!te&&se<u.length;++se)te=u[se]!=s.styles[se];te&&n.push(r.line),s.stateAfter=r.save(),r.nextLine()}else s.text.length<=e.options.maxHighlightLength&&Dr(e,s.text,r),s.stateAfter=r.line%5==0?r.save():null,r.nextLine();if(+new Date>A)return Fa(e,e.options.workDelay),!0}),t.highlightFrontier=r.line,t.modeFrontier=Math.max(t.modeFrontier,r.line),n.length&&xr(e,function(){for(var s=0;s<n.length;s++)gn(e,n[s],"text")})}}var _o=function(e,t,A){var r=e.display;this.viewport=t,this.visible=$i(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=pn(e),this.force=A,this.dims=bo(e),this.events=[]};_o.prototype.signal=function(e,t){wr(e,t)&&this.events.push(arguments)},_o.prototype.finish=function(){for(var e=0;e<this.events.length;e++)er.apply(null,this.events[e])};function _u(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Fr(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Fr(e)+"px",t.scrollbarsClipped=!0)}function Ql(e){if(e.hasFocus())return null;var t=pt(jt(e));if(!t||!Ze(e.display.lineDiv,t))return null;var A={activeElt:t};if(window.getSelection){var r=Dt(e).getSelection();r.anchorNode&&r.extend&&Ze(e.display.lineDiv,r.anchorNode)&&(A.anchorNode=r.anchorNode,A.anchorOffset=r.anchorOffset,A.focusNode=r.focusNode,A.focusOffset=r.focusOffset)}return A}function Tl(e){if(!(!e||!e.activeElt||e.activeElt==pt(St(e.activeElt)))&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&Ze(document.body,e.anchorNode)&&Ze(document.body,e.focusNode))){var t=e.activeElt.ownerDocument,A=t.defaultView.getSelection(),r=t.createRange();r.setEnd(e.anchorNode,e.anchorOffset),r.collapse(!1),A.removeAllRanges(),A.addRange(r),A.extend(e.focusNode,e.focusOffset)}}function Ss(e,t){var A=e.display,r=e.doc;if(t.editorIsHidden)return vn(e),!1;if(!t.force&&t.visible.from>=A.viewFrom&&t.visible.to<=A.viewTo&&(A.updateLineNumbers==null||A.updateLineNumbers>=A.viewTo)&&A.renderedView==A.view&&ys(e)==0)return!1;Il(e)&&(vn(e),t.dims=bo(e));var n=r.first+r.size,s=Math.max(t.visible.from-e.options.viewportMargin,r.first),u=Math.min(n,t.visible.to+e.options.viewportMargin);A.viewFrom<s&&s-A.viewFrom<20&&(s=Math.max(r.first,A.viewFrom)),A.viewTo>u&&A.viewTo-u<20&&(u=Math.min(n,A.viewTo)),hn&&(s=rs(e.doc,s),u=il(e.doc,u));var c=s!=A.viewFrom||u!=A.viewTo||A.lastWrapHeight!=t.wrapperHeight||A.lastWrapWidth!=t.wrapperWidth;yl(e,s,u),A.viewOffset=Sr(Qt(e.doc,A.viewFrom)),e.display.mover.style.top=A.viewOffset+"px";var d=ys(e);if(!c&&d==0&&!t.force&&A.renderedView==A.view&&(A.updateLineNumbers==null||A.updateLineNumbers>=A.viewTo))return!1;var B=Ql(e);return d>4&&(A.lineDiv.style.display="none"),So(e,A.updateLineNumbers,t.dims),d>4&&(A.lineDiv.style.display=""),A.renderedView=A.view,Tl(B),G(A.cursorDiv),G(A.selectionDiv),A.gutters.style.height=A.sizer.style.minHeight=0,c&&(A.lastWrapHeight=t.wrapperHeight,A.lastWrapWidth=t.wrapperWidth,Fa(e,400)),A.updateLineNumbers=null,!0}function Dl(e,t){for(var A=t.viewport,r=!0;;r=!1){if(!r||!e.options.lineWrapping||t.oldDisplayWidth==pn(e)){if(A&&A.top!=null&&(A={top:Math.min(e.doc.height+Wn(e.display)-_a(e),A.top)}),t.visible=$i(e.display,e.doc,A),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break}else r&&(t.visible=$i(e.display,e.doc,A));if(!Ss(e,t))break;Bo(e);var n=Xi(e);Ia(e),vi(e,n),Ts(e,n),t.force=!1}t.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Ra(e,t){var A=new _o(e,t);if(Ss(e,A)){Bo(e),Dl(e,A);var r=Xi(e);Ia(e),vi(e,r),Ts(e,r),A.finish()}}function So(e,t,A){var r=e.display,n=e.options.lineNumbers,s=r.lineDiv,u=s.firstChild;function c(fe){var ke=fe.nextSibling;return j&&N&&e.display.currentWheelTarget==fe?fe.style.display="none":fe.parentNode.removeChild(fe),ke}for(var d=r.view,B=r.viewFrom,R=0;R<d.length;R++){var te=d[R];if(!te.hidden)if(!te.node||te.node.parentNode!=s){var se=yu(e,te,B,A);s.insertBefore(se,u)}else{for(;u!=te.node;)u=c(u);var Ae=n&&t!=null&&t<=B&&te.lineNumber;te.changes&&(Tt(te.changes,"gutter")>-1&&(Ae=!1),co(e,te,B,A)),Ae&&(G(te.lineNumber),te.lineNumber.appendChild(document.createTextNode(ut(e.options,B)))),u=te.node.nextSibling}B+=te.size}for(;u;)u=c(u)}function Qs(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",rr(e,"gutterChanged",e)}function Ts(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Fr(e)+"px"}function Pl(e){var t=e.display,A=t.view;if(!(!t.alignWidgets&&(!t.gutters.firstChild||!e.options.fixedGutter))){for(var r=di(t)-t.scroller.scrollLeft+e.doc.scrollLeft,n=t.gutters.offsetWidth,s=r+"px",u=0;u<A.length;u++)if(!A[u].hidden){e.options.fixedGutter&&(A[u].gutter&&(A[u].gutter.style.left=s),A[u].gutterBackground&&(A[u].gutterBackground.style.left=s));var c=A[u].alignable;if(c)for(var d=0;d<c.length;d++)c[d].style.left=s}e.options.fixedGutter&&(t.gutters.style.left=r+n+"px")}}function Il(e){if(!e.options.lineNumbers)return!1;var t=e.doc,A=ut(e.options,t.first+t.size-1),r=e.display;if(A.length!=r.lineNumChars){var n=r.measure.appendChild(T("div",[T("div",A)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=n.firstChild.offsetWidth,u=n.offsetWidth-s;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(s,r.lineGutter.offsetWidth-u)+1,r.lineNumWidth=r.lineNumInnerWidth+u,r.lineNumChars=r.lineNumInnerWidth?A.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",Qs(e.display),!0}return!1}function Ds(e,t){for(var A=[],r=!1,n=0;n<e.length;n++){var s=e[n],u=null;if(typeof s!="string"&&(u=s.style,s=s.className),s=="CodeMirror-linenumbers")if(t)r=!0;else continue;A.push({className:s,style:u})}return t&&!r&&A.push({className:"CodeMirror-linenumbers",style:null}),A}function Ps(e){var t=e.gutters,A=e.gutterSpecs;G(t),e.lineGutter=null;for(var r=0;r<A.length;++r){var n=A[r],s=n.className,u=n.style,c=t.appendChild(T("div",null,"CodeMirror-gutter "+s));u&&(c.style.cssText=u),s=="CodeMirror-linenumbers"&&(e.lineGutter=c,c.style.width=(e.lineNumWidth||1)+"px")}t.style.display=A.length?"":"none",Qs(e)}function Ma(e){Ps(e.display),vr(e),Pl(e)}function Su(e,t,A,r){var n=this;this.input=A,n.scrollbarFiller=T("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=T("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=Be("div",null,"CodeMirror-code"),n.selectionDiv=T("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=T("div",null,"CodeMirror-cursors"),n.measure=T("div",null,"CodeMirror-measure"),n.lineMeasure=T("div",null,"CodeMirror-measure"),n.lineSpace=Be("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none");var s=Be("div",[n.lineSpace],"CodeMirror-lines");n.mover=T("div",[s],null,"position: relative"),n.sizer=T("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=T("div",null,null,"position: absolute; height: "+Jt+"px; width: 1px;"),n.gutters=T("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=T("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=T("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),Z&&Ee>=105&&(n.wrapper.style.clipPath="inset(0px)"),n.wrapper.setAttribute("translate","no"),pe&&ue<8&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),!j&&!(f&&Q)&&(n.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,n.gutterSpecs=Ds(r.gutters,r.lineNumbers),Ps(n),A.init(n)}var Qo=0,bn=null;pe?bn=-.53:f?bn=15:Z?bn=-.7:Oe&&(bn=-1/3);function kl(e){var t=e.wheelDeltaX,A=e.wheelDeltaY;return t==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),A==null&&e.detail&&e.axis==e.VERTICAL_AXIS?A=e.detail:A==null&&(A=e.wheelDelta),{x:t,y:A}}function ji(e){var t=kl(e);return t.x*=bn,t.y*=bn,t}function Ll(e,t){Z&&Ee==102&&(e.display.chromeScrollHack==null?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var A=kl(t),r=A.x,n=A.y,s=bn;t.deltaMode===0&&(r=t.deltaX,n=t.deltaY,s=1);var u=e.display,c=u.scroller,d=c.scrollWidth>c.clientWidth,B=c.scrollHeight>c.clientHeight;if(r&&d||n&&B){if(n&&N&&j){e:for(var R=t.target,te=u.view;R!=c;R=R.parentNode)for(var se=0;se<te.length;se++)if(te[se].node==R){e.display.currentWheelTarget=R;break e}}if(r&&!f&&!we&&s!=null){n&&B&&Yi(e,Math.max(0,c.scrollTop+n*s)),$n(e,Math.max(0,c.scrollLeft+r*s)),(!n||n&&B)&&WA(t),u.wheelStartX=null;return}if(n&&s!=null){var Ae=n*s,fe=e.doc.scrollTop,ke=fe+u.wrapper.clientHeight;Ae<0?fe=Math.max(0,fe+Ae-50):ke=Math.min(e.doc.height,ke+Ae+50),Ra(e,{top:fe,bottom:ke})}Qo<20&&t.deltaMode!==0&&(u.wheelStartX==null?(u.wheelStartX=c.scrollLeft,u.wheelStartY=c.scrollTop,u.wheelDX=r,u.wheelDY=n,setTimeout(function(){if(u.wheelStartX!=null){var He=c.scrollLeft-u.wheelStartX,Re=c.scrollTop-u.wheelStartY,Je=Re&&u.wheelDY&&Re/u.wheelDY||He&&u.wheelDX&&He/u.wheelDX;u.wheelStartX=u.wheelStartY=null,Je&&(bn=(bn*Qo+Je)/(Qo+1),++Qo)}},200)):(u.wheelDX+=r,u.wheelDY+=n))}}var Ir=function(e,t){this.ranges=e,this.primIndex=t};Ir.prototype.primary=function(){return this.ranges[this.primIndex]},Ir.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var A=this.ranges[t],r=e.ranges[t];if(!HA(A.anchor,r.anchor)||!HA(A.head,r.head))return!1}return!0},Ir.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new oA(Ar(this.ranges[t].anchor),Ar(this.ranges[t].head));return new Ir(e,this.primIndex)},Ir.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Ir.prototype.contains=function(e,t){t||(t=e);for(var A=0;A<this.ranges.length;A++){var r=this.ranges[A];if(vt(t,r.from())>=0&&vt(e,r.to())<=0)return A}return-1};var oA=function(e,t){this.anchor=e,this.head=t};oA.prototype.from=function(){return Ri(this.anchor,this.head)},oA.prototype.to=function(){return gr(this.anchor,this.head)},oA.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function kr(e,t,A){var r=e&&e.options.selectionsMayTouch,n=t[A];t.sort(function(se,Ae){return vt(se.from(),Ae.from())}),A=Tt(t,n);for(var s=1;s<t.length;s++){var u=t[s],c=t[s-1],d=vt(c.to(),u.from());if(r&&!u.empty()?d>0:d>=0){var B=Ri(c.from(),u.from()),R=gr(c.to(),u.to()),te=c.empty()?u.from()==u.head:c.from()==c.head;s<=A&&--A,t.splice(--s,2,new oA(te?R:B,te?B:R))}}return new Ir(t,A)}function Xn(e,t){return new Ir([new oA(e,t||e)],0)}function xn(e){return e.text?Ge(e.from.line+e.text.length-1,qt(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function Fl(e,t){if(vt(e,t.from)<0)return e;if(vt(e,t.to)<=0)return xn(t);var A=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=xn(t).ch-t.to.ch),Ge(A,r)}function Is(e,t){for(var A=[],r=0;r<e.sel.ranges.length;r++){var n=e.sel.ranges[r];A.push(new oA(Fl(n.anchor,t),Fl(n.head,t)))}return kr(e.cm,A,e.sel.primIndex)}function Rl(e,t,A){return e.line==t.line?Ge(A.line,e.ch-t.ch+A.ch):Ge(A.line+(e.line-t.line),e.ch)}function Qu(e,t,A){for(var r=[],n=Ge(e.first,0),s=n,u=0;u<t.length;u++){var c=t[u],d=Rl(c.from,n,s),B=Rl(xn(c),n,s);if(n=c.to,s=B,A=="around"){var R=e.sel.ranges[u],te=vt(R.head,R.anchor)<0;r[u]=new oA(te?B:d,te?d:B)}else r[u]=new oA(d,d)}return new Ir(r,e.sel.primIndex)}function ks(e){e.doc.mode=ki(e.options,e.doc.modeOption),Bn(e)}function Bn(e){e.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Fa(e,100),e.state.modeGen++,e.curOp&&vr(e)}function Ml(e,t){return t.from.ch==0&&t.to.ch==0&&qt(t.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Ki(e,t,A,r){function n(Je){return A?A[Je]:null}function s(Je,$e,et){cu(Je,$e,et,r),rr(Je,"change",Je,t)}function u(Je,$e){for(var et=[],ht=Je;ht<$e;++ht)et.push(new tn(B[ht],n(ht),r));return et}var c=t.from,d=t.to,B=t.text,R=Qt(e,c.line),te=Qt(e,d.line),se=qt(B),Ae=n(B.length-1),fe=d.line-c.line;if(t.full)e.insert(0,u(0,B.length)),e.remove(B.length,e.size-B.length);else if(Ml(e,t)){var ke=u(0,B.length-1);s(te,te.text,Ae),fe&&e.remove(c.line,fe),ke.length&&e.insert(c.line,ke)}else if(R==te)if(B.length==1)s(R,R.text.slice(0,c.ch)+se+R.text.slice(d.ch),Ae);else{var He=u(1,B.length-1);He.push(new tn(se+R.text.slice(d.ch),Ae,r)),s(R,R.text.slice(0,c.ch)+B[0],n(0)),e.insert(c.line+1,He)}else if(B.length==1)s(R,R.text.slice(0,c.ch)+B[0]+te.text.slice(d.ch),n(0)),e.remove(c.line+1,fe);else{s(R,R.text.slice(0,c.ch)+B[0],n(0)),s(te,se+te.text.slice(d.ch),Ae);var Re=u(1,B.length-1);fe>1&&e.remove(c.line+1,fe-1),e.insert(c.line+1,Re)}rr(e,"change",e,t)}function Vn(e,t,A){function r(n,s,u){if(n.linked)for(var c=0;c<n.linked.length;++c){var d=n.linked[c];if(d.doc!=s){var B=u&&d.sharedHist;A&&!B||(t(d.doc,B),r(d.doc,n,B))}}}r(e,null,!0)}function yi(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,Wi(e),ks(e),Ei(e),e.options.direction=t.direction,e.options.lineWrapping||is(e),e.options.mode=t.modeOption,vr(e)}function Ei(e){(e.doc.direction=="rtl"?gt:st)(e.display.lineDiv,"CodeMirror-rtl")}function Tu(e){xr(e,function(){Ei(e),vr(e)})}function Cn(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function To(e,t){var A={from:Ar(t.from),to:xn(t),text:cn(e,t.from,t.to)};return Oa(e,A,t.from.line,t.to.line+1),Vn(e,function(r){return Oa(r,A,t.from.line,t.to.line+1)},!0),A}function bi(e){for(;e.length;){var t=qt(e);if(t.ranges)e.pop();else break}}function Ls(e,t){if(t)return bi(e.done),qt(e.done);if(e.done.length&&!qt(e.done).ranges)return qt(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),qt(e.done)}function Do(e,t,A,r){var n=e.history;n.undone.length=0;var s=+new Date,u,c;if((n.lastOp==r||n.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&n.lastModTime>s-(e.cm?e.cm.options.historyEventDelay:500)||t.origin.charAt(0)=="*"))&&(u=Ls(n,n.lastOp==r)))c=qt(u.changes),vt(t.from,t.to)==0&&vt(t.from,c.to)==0?c.to=xn(t):u.changes.push(To(e,t));else{var d=qt(n.done);for((!d||!d.ranges)&&Ji(e.sel,n.done),u={changes:[To(e,t)],generation:n.generation},n.done.push(u);n.done.length>n.undoDepth;)n.done.shift(),n.done[0].ranges||n.done.shift()}n.done.push(A),n.generation=++n.maxGeneration,n.lastModTime=n.lastSelTime=s,n.lastOp=n.lastSelOp=r,n.lastOrigin=n.lastSelOrigin=t.origin,c||er(e,"historyAdded")}function Fs(e,t,A,r){var n=t.charAt(0);return n=="*"||n=="+"&&A.ranges.length==r.ranges.length&&A.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Rs(e,t,A,r){var n=e.history,s=r&&r.origin;A==n.lastSelOp||s&&n.lastSelOrigin==s&&(n.lastModTime==n.lastSelTime&&n.lastOrigin==s||Fs(e,s,qt(n.done),t))?n.done[n.done.length-1]=t:Ji(t,n.done),n.lastSelTime=+new Date,n.lastSelOrigin=s,n.lastSelOp=A,r&&r.clearRedo!==!1&&bi(n.undone)}function Ji(e,t){var A=qt(t);A&&A.ranges&&A.equals(e)||t.push(e)}function Oa(e,t,A,r){var n=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,A),Math.min(e.first+e.size,r),function(u){u.markedSpans&&((n||(n=t["spans_"+e.id]={}))[s]=u.markedSpans),++s})}function Ol(e){if(!e)return null;for(var t,A=0;A<e.length;++A)e[A].marker.explicitlyCleared?t||(t=e.slice(0,A)):t&&t.push(e[A]);return t?t.length?t:null:e}function Nl(e,t){var A=t["spans_"+e.id];if(!A)return null;for(var r=[],n=0;n<t.text.length;++n)r.push(Ol(A[n]));return r}function Ms(e,t){var A=Nl(e,t),r=es(e,t);if(!A)return r;if(!r)return A;for(var n=0;n<A.length;++n){var s=A[n],u=r[n];if(s&&u)e:for(var c=0;c<u.length;++c){for(var d=u[c],B=0;B<s.length;++B)if(s[B].marker==d.marker)continue e;s.push(d)}else u&&(A[n]=u)}return A}function xi(e,t,A){for(var r=[],n=0;n<e.length;++n){var s=e[n];if(s.ranges){r.push(A?Ir.prototype.deepCopy.call(s):s);continue}var u=s.changes,c=[];r.push({changes:c});for(var d=0;d<u.length;++d){var B=u[d],R=void 0;if(c.push({from:B.from,to:B.to,text:B.text}),t)for(var te in B)(R=te.match(/^spans_(\d+)$/))&&Tt(t,Number(R[1]))>-1&&(qt(c)[te]=B[te],delete B[te])}}return r}function Po(e,t,A,r){if(r){var n=e.anchor;if(A){var s=vt(t,n)<0;s!=vt(A,n)<0?(n=t,t=A):s!=vt(t,A)<0&&(t=A)}return new oA(n,t)}else return new oA(A||t,t)}function Zi(e,t,A,r,n){n==null&&(n=e.cm&&(e.cm.display.shift||e.extend)),fr(e,new Ir([Po(e.sel.primary(),t,A,n)],0),r)}function Io(e,t,A){for(var r=[],n=e.cm&&(e.cm.display.shift||e.extend),s=0;s<e.sel.ranges.length;s++)r[s]=Po(e.sel.ranges[s],t[s],null,n);var u=kr(e.cm,r,e.sel.primIndex);fr(e,u,A)}function ko(e,t,A,r){var n=e.sel.ranges.slice(0);n[t]=A,fr(e,kr(e.cm,n,e.sel.primIndex),r)}function Os(e,t,A,r){fr(e,Xn(t,A),r)}function Gl(e,t,A){var r={ranges:t.ranges,update:function(n){this.ranges=[];for(var s=0;s<n.length;s++)this.ranges[s]=new oA(Mt(e,n[s].anchor),Mt(e,n[s].head))},origin:A&&A.origin};return er(e,"beforeSelectionChange",e,r),e.cm&&er(e.cm,"beforeSelectionChange",e.cm,r),r.ranges!=t.ranges?kr(e.cm,r.ranges,r.ranges.length-1):t}function Ns(e,t,A){var r=e.history.done,n=qt(r);n&&n.ranges?(r[r.length-1]=t,Na(e,t,A)):fr(e,t,A)}function fr(e,t,A){Na(e,t,A),Rs(e,e.sel,e.cm?e.cm.curOp.id:NaN,A)}function Na(e,t,A){(wr(e,"beforeSelectionChange")||e.cm&&wr(e.cm,"beforeSelectionChange"))&&(t=Gl(e,t,A));var r=A&&A.bias||(vt(t.primary().head,e.sel.primary().head)<0?-1:1);Gs(e,Fo(e,t,r,!0)),!(A&&A.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&yn(e.cm)}function Gs(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Qr(e.cm)),rr(e,"cursorActivity",e))}function Lo(e){Gs(e,Fo(e,e.sel,null,!1))}function Fo(e,t,A,r){for(var n,s=0;s<t.ranges.length;s++){var u=t.ranges[s],c=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[s],d=ea(e,u.anchor,c&&c.anchor,A,r),B=u.head==u.anchor?d:ea(e,u.head,c&&c.head,A,r);(n||d!=u.anchor||B!=u.head)&&(n||(n=t.ranges.slice(0,s)),n[s]=new oA(d,B))}return n?kr(e.cm,n,t.primIndex):t}function Bi(e,t,A,r,n){var s=Qt(e,t.line);if(s.markedSpans)for(var u=0;u<s.markedSpans.length;++u){var c=s.markedSpans[u],d=c.marker,B="selectLeft"in d?!d.selectLeft:d.inclusiveLeft,R="selectRight"in d?!d.selectRight:d.inclusiveRight;if((c.from==null||(B?c.from<=t.ch:c.from<t.ch))&&(c.to==null||(R?c.to>=t.ch:c.to>t.ch))){if(n&&(er(d,"beforeCursorEnter"),d.explicitlyCleared))if(s.markedSpans){--u;continue}else break;if(!d.atomic)continue;if(A){var te=d.find(r<0?1:-1),se=void 0;if((r<0?R:B)&&(te=Us(e,te,-r,te&&te.line==t.line?s:null)),te&&te.line==t.line&&(se=vt(te,A))&&(r<0?se<0:se>0))return Bi(e,te,t,r,n)}var Ae=d.find(r<0?-1:1);return(r<0?B:R)&&(Ae=Us(e,Ae,r,Ae.line==t.line?s:null)),Ae?Bi(e,Ae,t,r,n):null}}return t}function ea(e,t,A,r,n){var s=r||1,u=Bi(e,t,A,s,n)||!n&&Bi(e,t,A,s,!0)||Bi(e,t,A,-s,n)||!n&&Bi(e,t,A,-s,!0);return u||(e.cantEdit=!0,Ge(e.first,0))}function Us(e,t,A,r){return A<0&&t.ch==0?t.line>e.first?Mt(e,Ge(t.line-1)):null:A>0&&t.ch==(r||Qt(e,t.line)).text.length?t.line<e.first+e.size-1?Ge(t.line+1,0):null:new Ge(t.line,t.ch+A)}function Hs(e){e.setSelection(Ge(e.firstLine(),0),Ge(e.lastLine()),sr)}function Ro(e,t,A){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return r.canceled=!0}};return A&&(r.update=function(n,s,u,c){n&&(r.from=Mt(e,n)),s&&(r.to=Mt(e,s)),u&&(r.text=u),c!==void 0&&(r.origin=c)}),er(e,"beforeChange",e,r),e.cm&&er(e.cm,"beforeChange",e.cm,r),r.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Ci(e,t,A){if(e.cm){if(!e.cm.curOp)return lr(e.cm,Ci)(e,t,A);if(e.cm.state.suppressEdits)return}if(!((wr(e,"beforeChange")||e.cm&&wr(e.cm,"beforeChange"))&&(t=Ro(e,t,!0),!t))){var r=io&&!A&&oo(e,t.from,t.to);if(r)for(var n=r.length-1;n>=0;--n)zs(e,{from:r[n].from,to:r[n].to,text:n?[""]:t.text,origin:t.origin});else zs(e,t)}}function zs(e,t){if(!(t.text.length==1&&t.text[0]==""&&vt(t.from,t.to)==0)){var A=Is(e,t);Do(e,t,A,e.cm?e.cm.curOp.id:NaN),wn(e,t,A,es(e,t));var r=[];Vn(e,function(n,s){!s&&Tt(r,n.history)==-1&&(jn(n.history,t),r.push(n.history)),wn(n,t,null,es(n,t))})}}function ta(e,t,A){var r=e.cm&&e.cm.state.suppressEdits;if(!(r&&!A)){for(var n=e.history,s,u=e.sel,c=t=="undo"?n.done:n.undone,d=t=="undo"?n.undone:n.done,B=0;B<c.length&&(s=c[B],!(A?s.ranges&&!s.equals(e.sel):!s.ranges));B++);if(B!=c.length){for(n.lastOrigin=n.lastSelOrigin=null;;)if(s=c.pop(),s.ranges){if(Ji(s,d),A&&!s.equals(e.sel)){fr(e,s,{clearRedo:!1});return}u=s}else if(r){c.push(s);return}else break;var R=[];Ji(u,d),d.push({changes:R,generation:n.generation}),n.generation=s.generation||++n.maxGeneration;for(var te=wr(e,"beforeChange")||e.cm&&wr(e.cm,"beforeChange"),se=function(ke){var He=s.changes[ke];if(He.origin=t,te&&!Ro(e,He,!1))return c.length=0,{};R.push(To(e,He));var Re=ke?Is(e,He):qt(c);wn(e,He,Re,Ms(e,He)),!ke&&e.cm&&e.cm.scrollIntoView({from:He.from,to:xn(He)});var Je=[];Vn(e,function($e,et){!et&&Tt(Je,$e.history)==-1&&(jn($e.history,He),Je.push($e.history)),wn($e,He,null,Ms($e,He))})},Ae=s.changes.length-1;Ae>=0;--Ae){var fe=se(Ae);if(fe)return fe.v}}}}function Mo(e,t){if(t!=0&&(e.first+=t,e.sel=new Ir(ii(e.sel.ranges,function(n){return new oA(Ge(n.anchor.line+t,n.anchor.ch),Ge(n.head.line+t,n.head.ch))}),e.sel.primIndex),e.cm)){vr(e.cm,e.first,e.first-t,t);for(var A=e.cm.display,r=A.viewFrom;r<A.viewTo;r++)gn(e.cm,r,"gutter")}}function wn(e,t,A,r){if(e.cm&&!e.cm.curOp)return lr(e.cm,wn)(e,t,A,r);if(t.to.line<e.first){Mo(e,t.text.length-1-(t.to.line-t.from.line));return}if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var n=t.text.length-1-(e.first-t.from.line);Mo(e,n),t={from:Ge(e.first,0),to:Ge(t.to.line+n,t.to.ch),text:[qt(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:Ge(s,Qt(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=cn(e,t.from,t.to),A||(A=Is(e,t)),e.cm?Ul(e.cm,t,r):Ki(e,t,r),Na(e,A,sr),e.cantEdit&&ea(e,Ge(e.firstLine(),0))&&(e.cantEdit=!1)}}function Ul(e,t,A){var r=e.doc,n=e.display,s=t.from,u=t.to,c=!1,d=s.line;e.options.lineWrapping||(d=I(Wr(Qt(r,s.line))),r.iter(d,u.line+1,function(Ae){if(Ae==n.maxLine)return c=!0,!0})),r.sel.contains(t.from,t.to)>-1&&Qr(e),Ki(r,t,A,ml(e)),e.options.lineWrapping||(r.iter(d,s.line+t.text.length,function(Ae){var fe=fo(Ae);fe>n.maxLineLength&&(n.maxLine=Ae,n.maxLineLength=fe,n.maxLineChanged=!0,c=!1)}),c&&(e.curOp.updateMaxLine=!0)),nu(r,s.line),Fa(e,400);var B=t.text.length-(u.line-s.line)-1;t.full?vr(e):s.line==u.line&&t.text.length==1&&!Ml(e.doc,t)?gn(e,s.line,"text"):vr(e,s.line,u.line+1,B);var R=wr(e,"changes"),te=wr(e,"change");if(te||R){var se={from:s,to:u,text:t.text,removed:t.removed,origin:t.origin};te&&rr(e,"change",e,se),R&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(se)}e.display.selForContextMenu=null}function _n(e,t,A,r,n){var s;r||(r=A),vt(r,A)<0&&(s=[r,A],A=s[0],r=s[1]),typeof t=="string"&&(t=e.splitLines(t)),Ci(e,{from:A,to:r,text:t,origin:n})}function rn(e,t,A,r){A<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Aa(e,t,A,r){for(var n=0;n<e.length;++n){var s=e[n],u=!0;if(s.ranges){s.copied||(s=e[n]=s.deepCopy(),s.copied=!0);for(var c=0;c<s.ranges.length;c++)rn(s.ranges[c].anchor,t,A,r),rn(s.ranges[c].head,t,A,r);continue}for(var d=0;d<s.changes.length;++d){var B=s.changes[d];if(A<B.from.line)B.from=Ge(B.from.line+r,B.from.ch),B.to=Ge(B.to.line+r,B.to.ch);else if(t<=B.to.line){u=!1;break}}u||(e.splice(0,n+1),n=0)}}function jn(e,t){var A=t.from.line,r=t.to.line,n=t.text.length-(r-A)-1;Aa(e.done,A,r,n),Aa(e.undone,A,r,n)}function Sn(e,t,A,r){var n=t,s=t;return typeof t=="number"?s=Qt(e,Js(e,t)):n=I(t),n==null?null:(r(s,n)&&e.cm&&gn(e.cm,n,A),s)}function Qn(e){this.lines=e,this.parent=null;for(var t=0,A=0;A<e.length;++A)e[A].parent=this,t+=e[A].height;this.height=t}Qn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var A=e,r=e+t;A<r;++A){var n=this.lines[A];this.height-=n.height,Ni(n),rr(n,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,A){this.height+=A,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,A){for(var r=e+t;e<r;++e)if(A(this.lines[e]))return!0}};function Yr(e){this.children=e;for(var t=0,A=0,r=0;r<e.length;++r){var n=e[r];t+=n.chunkSize(),A+=n.height,n.parent=this}this.size=t,this.height=A,this.parent=null}Yr.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var A=0;A<this.children.length;++A){var r=this.children[A],n=r.chunkSize();if(e<n){var s=Math.min(t,n-e),u=r.height;if(r.removeInner(e,s),this.height-=u-r.height,n==s&&(this.children.splice(A--,1),r.parent=null),(t-=s)==0)break;e=0}else e-=n}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Qn))){var c=[];this.collapse(c),this.children=[new Qn(c)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,A){this.size+=t.length,this.height+=A;for(var r=0;r<this.children.length;++r){var n=this.children[r],s=n.chunkSize();if(e<=s){if(n.insertInner(e,t,A),n.lines&&n.lines.length>50){for(var u=n.lines.length%25+25,c=u;c<n.lines.length;){var d=new Qn(n.lines.slice(c,c+=25));n.height-=d.height,this.children.splice(++r,0,d),d.parent=this}n.lines=n.lines.slice(0,u),this.maybeSpill()}break}e-=s}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),A=new Yr(t);if(e.parent){e.size-=A.size,e.height-=A.height;var n=Tt(e.parent.children,e);e.parent.children.splice(n+1,0,A)}else{var r=new Yr(e.children);r.parent=e,e.children=[r,A],e=r}A.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,A){for(var r=0;r<this.children.length;++r){var n=this.children[r],s=n.chunkSize();if(e<s){var u=Math.min(t,s-e);if(n.iterN(e,u,A))return!0;if((t-=u)==0)break;e=0}else e-=s}}};var Xr=function(e,t,A){if(A)for(var r in A)A.hasOwnProperty(r)&&(this[r]=A[r]);this.doc=e,this.node=t};Xr.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,A=this.line,r=I(A);if(!(r==null||!t)){for(var n=0;n<t.length;++n)t[n]==this&&t.splice(n--,1);t.length||(A.widgets=null);var s=zn(this);Tr(A,Math.max(0,A.height-s)),e&&(xr(e,function(){Kn(e,A,-s),gn(e,r,"widget")}),rr(e,"lineWidgetCleared",e,this,r))}},Xr.prototype.changed=function(){var e=this,t=this.height,A=this.doc.cm,r=this.line;this.height=null;var n=zn(this)-t;n&&(Gn(this.doc,r)||Tr(r,r.height+n),A&&xr(A,function(){A.curOp.forceUpdate=!0,Kn(A,r,n),rr(A,"lineWidgetChanged",A,e,I(r))}))},Nr(Xr);function Kn(e,t,A){Sr(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&xs(e,A)}function Oo(e,t,A,r){var n=new Xr(e,A,r),s=e.cm;return s&&n.noHScroll&&(s.display.alignWidgets=!0),Sn(e,t,"widget",function(u){var c=u.widgets||(u.widgets=[]);if(n.insertAt==null?c.push(n):c.splice(Math.min(c.length,Math.max(0,n.insertAt)),0,n),n.line=u,s&&!Gn(e,u)){var d=Sr(u)<e.scrollTop;Tr(u,u.height+zn(n)),d&&xs(s,n.height),s.curOp.forceUpdate=!0}return!0}),s&&rr(s,"lineWidgetAdded",s,n,typeof t=="number"?t:I(t)),n}var Ga=0,Or=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++Ga};Or.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&br(e),wr(this,"clear")){var A=this.find();A&&rr(this,"clear",A.from,A.to)}for(var r=null,n=null,s=0;s<this.lines.length;++s){var u=this.lines[s],c=ya(u.markedSpans,this);e&&!this.collapsed?gn(e,I(u),"text"):e&&(c.to!=null&&(n=I(u)),c.from!=null&&(r=I(u))),u.markedSpans=ou(u.markedSpans,c),c.from==null&&this.collapsed&&!Gn(this.doc,u)&&e&&Tr(u,Hi(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var d=0;d<this.lines.length;++d){var B=Wr(this.lines[d]),R=fo(B);R>e.display.maxLineLength&&(e.display.maxLine=B,e.display.maxLineLength=R,e.display.maxLineChanged=!0)}r!=null&&e&&this.collapsed&&vr(e,r,n+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Lo(e.doc)),e&&rr(e,"markerCleared",e,this,r,n),t&&En(e),this.parent&&this.parent.clear()}},Or.prototype.find=function(e,t){e==null&&this.type=="bookmark"&&(e=1);for(var A,r,n=0;n<this.lines.length;++n){var s=this.lines[n],u=ya(s.markedSpans,this);if(u.from!=null&&(A=Ge(t?s:I(s),u.from),e==-1))return A;if(u.to!=null&&(r=Ge(t?s:I(s),u.to),e==1))return r}return A&&{from:A,to:r}},Or.prototype.changed=function(){var e=this,t=this.find(-1,!0),A=this,r=this.doc.cm;!t||!r||xr(r,function(){var n=t.line,s=I(t.line),u=po(r,s);if(u&&(dl(u),r.curOp.selectionChanged=r.curOp.forceUpdate=!0),r.curOp.updateMaxLine=!0,!Gn(A.doc,n)&&A.height!=null){var c=A.height;A.height=null;var d=zn(A)-c;d&&Tr(n,n.height+d)}rr(r,"markerChanged",r,e)})},Or.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(!t.maybeHiddenMarkers||Tt(t.maybeHiddenMarkers,this)==-1)&&(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Or.prototype.detachLine=function(e){if(this.lines.splice(Tt(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},Nr(Or);function Jn(e,t,A,r,n){if(r&&r.shared)return ra(e,t,A,r,n);if(e.cm&&!e.cm.curOp)return lr(e.cm,Jn)(e,t,A,r,n);var s=new Or(e,n),u=vt(t,A);if(r&&Lt(r,s,!1),u>0||u==0&&s.clearWhenEmpty!==!1)return s;if(s.replacedWith&&(s.collapsed=!0,s.widgetNode=Be("span",[s.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||s.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(s.widgetNode.insertLeft=!0)),s.collapsed){if(As(e,t.line,t,A,s)||t.line!=A.line&&As(e,A.line,t,A,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");au()}s.addToHistory&&Do(e,{from:t,to:A,origin:"markText"},e.sel,NaN);var c=t.line,d=e.cm,B;if(e.iter(c,A.line+1,function(te){d&&s.collapsed&&!d.options.lineWrapping&&Wr(te)==d.display.maxLine&&(B=!0),s.collapsed&&c!=t.line&&Tr(te,0),su(te,new ao(s,c==t.line?t.ch:null,c==A.line?A.ch:null),e.cm&&e.cm.curOp),++c}),s.collapsed&&e.iter(t.line,A.line+1,function(te){Gn(e,te)&&Tr(te,0)}),s.clearOnEnter&&kt(s,"beforeCursorEnter",function(){return s.clear()}),s.readOnly&&(iu(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed&&(s.id=++Ga,s.atomic=!0),d){if(B&&(d.curOp.updateMaxLine=!0),s.collapsed)vr(d,t.line,A.line+1);else if(s.className||s.startStyle||s.endStyle||s.css||s.attributes||s.title)for(var R=t.line;R<=A.line;R++)gn(d,R,"text");s.atomic&&Lo(d.doc),rr(d,"markerAdded",d,s)}return s}var wi=function(e,t){this.markers=e,this.primary=t;for(var A=0;A<e.length;++A)e[A].parent=this};wi.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();rr(this,"clear")}},wi.prototype.find=function(e,t){return this.primary.find(e,t)},Nr(wi);function ra(e,t,A,r,n){r=Lt(r),r.shared=!1;var s=[Jn(e,t,A,r,n)],u=s[0],c=r.widgetNode;return Vn(e,function(d){c&&(r.widgetNode=c.cloneNode(!0)),s.push(Jn(d,Mt(d,t),Mt(d,A),r,n));for(var B=0;B<d.linked.length;++B)if(d.linked[B].isParent)return;u=qt(s)}),new wi(s,u)}function _i(e){return e.findMarks(Ge(e.first,0),e.clipPos(Ge(e.lastLine())),function(t){return t.parent})}function Du(e,t){for(var A=0;A<t.length;A++){var r=t[A],n=r.find(),s=e.clipPos(n.from),u=e.clipPos(n.to);if(vt(s,u)){var c=Jn(e,s,u,r.primary,r.primary.type);r.markers.push(c),c.parent=r}}}function Pu(e){for(var t=function(r){var n=e[r],s=[n.primary.doc];Vn(n.primary.doc,function(d){return s.push(d)});for(var u=0;u<n.markers.length;u++){var c=n.markers[u];Tt(s,c.doc)==-1&&(c.parent=null,n.markers.splice(u--,1))}},A=0;A<e.length;A++)t(A)}var Hl=0,yr=function(e,t,A,r,n){if(!(this instanceof yr))return new yr(e,t,A,r,n);A==null&&(A=0),Yr.call(this,[new Qn([new tn("",null)])]),this.first=A,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=A;var s=Ge(A,0);this.sel=Xn(s),this.history=new Cn(null),this.id=++Hl,this.modeOption=t,this.lineSep=r,this.direction=n=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),Ki(this,{from:s,to:s,text:e}),fr(this,Xn(s),sr)};yr.prototype=to(Yr.prototype,{constructor:yr,iter:function(e,t,A){A?this.iterN(e-this.first,t-e,A):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var A=0,r=0;r<t.length;++r)A+=t[r].height;this.insertInner(e-this.first,t,A)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=va(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:ur(function(e){var t=Ge(this.first,0),A=this.first+this.size-1;Ci(this,{from:t,to:Ge(A,Qt(this,A).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&La(this.cm,0,0),fr(this,Xn(t),sr)}),replaceRange:function(e,t,A,r){t=Mt(this,t),A=A?Mt(this,A):t,_n(this,e,t,A,r)},getRange:function(e,t,A){var r=cn(this,Mt(this,e),Mt(this,t));return A===!1?r:A===""?r.join(""):r.join(A||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(je(this,e))return Qt(this,e)},getLineNumber:function(e){return I(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=Qt(this,e)),Wr(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return Mt(this,e)},getCursor:function(e){var t=this.sel.primary(),A;return e==null||e=="head"?A=t.head:e=="anchor"?A=t.anchor:e=="end"||e=="to"||e===!1?A=t.to():A=t.from(),A},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:ur(function(e,t,A){Os(this,Mt(this,typeof e=="number"?Ge(e,t||0):e),null,A)}),setSelection:ur(function(e,t,A){Os(this,Mt(this,e),Mt(this,t||e),A)}),extendSelection:ur(function(e,t,A){Zi(this,Mt(this,e),t&&Mt(this,t),A)}),extendSelections:ur(function(e,t){Io(this,Ko(this,e),t)}),extendSelectionsBy:ur(function(e,t){var A=ii(this.sel.ranges,e);Io(this,Ko(this,A),t)}),setSelections:ur(function(e,t,A){if(e.length){for(var r=[],n=0;n<e.length;n++)r[n]=new oA(Mt(this,e[n].anchor),Mt(this,e[n].head||e[n].anchor));t==null&&(t=Math.min(e.length-1,this.sel.primIndex)),fr(this,kr(this.cm,r,t),A)}}),addSelection:ur(function(e,t,A){var r=this.sel.ranges.slice(0);r.push(new oA(Mt(this,e),Mt(this,t||e))),fr(this,kr(this.cm,r,r.length-1),A)}),getSelection:function(e){for(var t=this.sel.ranges,A,r=0;r<t.length;r++){var n=cn(this,t[r].from(),t[r].to());A=A?A.concat(n):n}return e===!1?A:A.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],A=this.sel.ranges,r=0;r<A.length;r++){var n=cn(this,A[r].from(),A[r].to());e!==!1&&(n=n.join(e||this.lineSeparator())),t[r]=n}return t},replaceSelection:function(e,t,A){for(var r=[],n=0;n<this.sel.ranges.length;n++)r[n]=e;this.replaceSelections(r,t,A||"+input")},replaceSelections:ur(function(e,t,A){for(var r=[],n=this.sel,s=0;s<n.ranges.length;s++){var u=n.ranges[s];r[s]={from:u.from(),to:u.to(),text:this.splitLines(e[s]),origin:A}}for(var c=t&&t!="end"&&Qu(this,r,t),d=r.length-1;d>=0;d--)Ci(this,r[d]);c?Ns(this,c):this.cm&&yn(this.cm)}),undo:ur(function(){ta(this,"undo")}),redo:ur(function(){ta(this,"redo")}),undoSelection:ur(function(){ta(this,"undo",!0)}),redoSelection:ur(function(){ta(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,A=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var n=0;n<e.undone.length;n++)e.undone[n].ranges||++A;return{undo:t,redo:A}},clearHistory:function(){var e=this;this.history=new Cn(this.history),Vn(this,function(t){return t.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:xi(this.history.done),undone:xi(this.history.undone)}},setHistory:function(e){var t=this.history=new Cn(this.history);t.done=xi(e.done.slice(0),null,!0),t.undone=xi(e.undone.slice(0),null,!0)},setGutterMarker:ur(function(e,t,A){return Sn(this,e,"gutter",function(r){var n=r.gutterMarkers||(r.gutterMarkers={});return n[t]=A,!A&&jr(n)&&(r.gutterMarkers=null),!0})}),clearGutter:ur(function(e){var t=this;this.iter(function(A){A.gutterMarkers&&A.gutterMarkers[e]&&Sn(t,A,"gutter",function(){return A.gutterMarkers[e]=null,jr(A.gutterMarkers)&&(A.gutterMarkers=null),!0})})}),lineInfo:function(e){var t;if(typeof e=="number"){if(!je(this,e)||(t=e,e=Qt(this,e),!e))return null}else if(t=I(e),t==null)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:ur(function(e,t,A){return Sn(this,e,t=="gutter"?"gutter":"class",function(r){var n=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass";if(!r[n])r[n]=A;else{if(Ve(A).test(r[n]))return!1;r[n]+=" "+A}return!0})}),removeLineClass:ur(function(e,t,A){return Sn(this,e,t=="gutter"?"gutter":"class",function(r){var n=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass",s=r[n];if(s)if(A==null)r[n]=null;else{var u=s.match(Ve(A));if(!u)return!1;var c=u.index+u[0].length;r[n]=s.slice(0,u.index)+(!u.index||c==s.length?"":" ")+s.slice(c)||null}else return!1;return!0})}),addLineWidget:ur(function(e,t,A){return Oo(this,e,t,A)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,A){return Jn(this,Mt(this,e),Mt(this,t),A,A&&A.type||"range")},setBookmark:function(e,t){var A={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=Mt(this,e),Jn(this,e,e,A,"bookmark")},findMarksAt:function(e){e=Mt(this,e);var t=[],A=Qt(this,e.line).markedSpans;if(A)for(var r=0;r<A.length;++r){var n=A[r];(n.from==null||n.from<=e.ch)&&(n.to==null||n.to>=e.ch)&&t.push(n.marker.parent||n.marker)}return t},findMarks:function(e,t,A){e=Mt(this,e),t=Mt(this,t);var r=[],n=e.line;return this.iter(e.line,t.line+1,function(s){var u=s.markedSpans;if(u)for(var c=0;c<u.length;c++){var d=u[c];!(d.to!=null&&n==e.line&&e.ch>=d.to||d.from==null&&n!=e.line||d.from!=null&&n==t.line&&d.from>=t.ch)&&(!A||A(d.marker))&&r.push(d.marker.parent||d.marker)}++n}),r},getAllMarks:function(){var e=[];return this.iter(function(t){var A=t.markedSpans;if(A)for(var r=0;r<A.length;++r)A[r].from!=null&&e.push(A[r].marker)}),e},posFromIndex:function(e){var t,A=this.first,r=this.lineSeparator().length;return this.iter(function(n){var s=n.text.length+r;if(s>e)return t=e,!0;e-=s,++A}),Mt(this,Ge(A,t))},indexFromPos:function(e){e=Mt(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var A=this.lineSeparator().length;return this.iter(this.first,e.line,function(r){t+=r.text.length+A}),t},copy:function(e){var t=new yr(va(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,A=this.first+this.size;e.from!=null&&e.from>t&&(t=e.from),e.to!=null&&e.to<A&&(A=e.to);var r=new yr(va(this,t,A),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Du(r,_i(this)),r},unlinkDoc:function(e){if(e instanceof jA&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var A=this.linked[t];if(A.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),Pu(_i(this));break}}if(e.history==this.history){var r=[e.id];Vn(e,function(n){return r.push(n.id)},!0),e.history=new Cn(null),e.history.done=xi(this.history.done,r),e.history.undone=xi(this.history.undone,r)}},iterLinkedDocs:function(e){Vn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):rA(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:ur(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(t){return t.order=null}),this.cm&&Tu(this.cm))})}),yr.prototype.eachLine=yr.prototype.iter;var Ws=0;function Iu(e){var t=this;if(zl(t),!(KA(t,e)||qr(t.display,e))){WA(e),pe&&(Ws=+new Date);var A=cr(t,e,!0),r=e.dataTransfer.files;if(!(!A||t.isReadOnly()))if(r&&r.length&&window.FileReader&&window.File)for(var n=r.length,s=Array(n),u=0,c=function(){++u==n&&lr(t,function(){A=Mt(t.doc,A);var Ae={from:A,to:A,text:t.doc.splitLines(s.filter(function(fe){return fe!=null}).join(t.doc.lineSeparator())),origin:"paste"};Ci(t.doc,Ae),Ns(t.doc,Xn(Mt(t.doc,A),Mt(t.doc,xn(Ae))))})()},d=function(Ae,fe){if(t.options.allowDropFileTypes&&Tt(t.options.allowDropFileTypes,Ae.type)==-1){c();return}var ke=new FileReader;ke.onerror=function(){return c()},ke.onload=function(){var He=ke.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(He)){c();return}s[fe]=He,c()},ke.readAsText(Ae)},B=0;B<r.length;B++)d(r[B],B);else{if(t.state.draggingText&&t.doc.sel.contains(A)>-1){t.state.draggingText(e),setTimeout(function(){return t.display.input.focus()},20);return}try{var R=e.dataTransfer.getData("Text");if(R){var te;if(t.state.draggingText&&!t.state.draggingText.copy&&(te=t.listSelections()),Na(t.doc,Xn(A,A)),te)for(var se=0;se<te.length;++se)_n(t.doc,"",te[se].anchor,te[se].head,"drag");t.replaceSelection(R,"around","paste"),t.display.input.focus()}}catch{}}}}function na(e,t){if(pe&&(!e.state.draggingText||+new Date-Ws<100)){Mn(t);return}if(!(KA(e,t)||qr(e.display,t))&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!Oe)){var A=T("img",null,null,"position: fixed; left: 0; top: 0;");A.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",we&&(A.width=A.height=1,e.display.wrapper.appendChild(A),A._top=A.offsetTop),t.dataTransfer.setDragImage(A,0,0),we&&A.parentNode.removeChild(A)}}function ku(e,t){var A=cr(e,t);if(A){var r=document.createDocumentFragment();or(e,A,r),e.display.dragCursor||(e.display.dragCursor=T("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),U(e.display.dragCursor,r)}}function zl(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Wl(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),A=[],r=0;r<t.length;r++){var n=t[r].CodeMirror;n&&A.push(n)}A.length&&A[0].operation(function(){for(var s=0;s<A.length;s++)e(A[s])})}}var qs=!1;function Lu(){qs||(Fu(),qs=!0)}function Fu(){var e;kt(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,Wl(Ru)},100))}),kt(window,"blur",function(){return Wl(qi)})}function Ru(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Zn={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Ua=0;Ua<10;Ua++)Zn[Ua+48]=Zn[Ua+96]=String(Ua);for(var No=65;No<=90;No++)Zn[No]=String.fromCharCode(No);for(var Ha=1;Ha<=12;Ha++)Zn[Ha+111]=Zn[Ha+63235]="F"+Ha;var Tn={};Tn.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Tn.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Tn.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Tn.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Tn.default=N?Tn.macDefault:Tn.pcDefault;function Mu(e){var t=e.split(/-(?!$)/);e=t[t.length-1];for(var A,r,n,s,u=0;u<t.length-1;u++){var c=t[u];if(/^(cmd|meta|m)$/i.test(c))s=!0;else if(/^a(lt)?$/i.test(c))A=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))n=!0;else throw new Error("Unrecognized modifier name: "+c)}return A&&(e="Alt-"+e),r&&(e="Ctrl-"+e),s&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function Ou(e){var t={};for(var A in e)if(e.hasOwnProperty(A)){var r=e[A];if(/^(name|fallthrough|(de|at)tach)$/.test(A))continue;if(r=="..."){delete e[A];continue}for(var n=ii(A.split(" "),Mu),s=0;s<n.length;s++){var u=void 0,c=void 0;s==n.length-1?(c=n.join(" "),u=r):(c=n.slice(0,s+1).join(" "),u="...");var d=t[c];if(!d)t[c]=u;else if(d!=u)throw new Error("Inconsistent bindings for "+c)}delete e[A]}for(var B in t)e[B]=t[B];return e}function ei(e,t,A,r){t=ia(t);var n=t.call?t.call(e,r):t[e];if(n===!1)return"nothing";if(n==="...")return"multi";if(n!=null&&A(n))return"handled";if(t.fallthrough){if(Object.prototype.toString.call(t.fallthrough)!="[object Array]")return ei(e,t.fallthrough,A,r);for(var s=0;s<t.fallthrough.length;s++){var u=ei(e,t.fallthrough[s],A,r);if(u)return u}}}function za(e){var t=typeof e=="string"?e:Zn[e.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"}function Wa(e,t,A){var r=e;return t.altKey&&r!="Alt"&&(e="Alt-"+e),(ze?t.metaKey:t.ctrlKey)&&r!="Ctrl"&&(e="Ctrl-"+e),(ze?t.ctrlKey:t.metaKey)&&r!="Mod"&&(e="Cmd-"+e),!A&&t.shiftKey&&r!="Shift"&&(e="Shift-"+e),e}function qa(e,t){if(we&&e.keyCode==34&&e.char)return!1;var A=Zn[e.keyCode];return A==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(A=e.code),Wa(A,e,t))}function ia(e){return typeof e=="string"?Tn[e]:e}function Dn(e,t){for(var A=e.doc.sel.ranges,r=[],n=0;n<A.length;n++){for(var s=t(A[n]);r.length&&vt(s.from,qt(r).to)<=0;){var u=r.pop();if(vt(u.from,s.from)<0){s.from=u.from;break}}r.push(s)}xr(e,function(){for(var c=r.length-1;c>=0;c--)_n(e.doc,"",r[c].from,r[c].to,"+delete");yn(e)})}function aa(e,t,A){var r=ln(e.text,t+A,A);return r<0||r>e.text.length?null:r}function oa(e,t,A){var r=aa(e,t.ch,A);return r==null?null:new Ge(t.line,r,A<0?"after":"before")}function $a(e,t,A,r,n){if(e){t.doc.direction=="rtl"&&(n=-n);var s=Xt(A,t.doc.direction);if(s){var u=n<0?qt(s):s[0],c=n<0==(u.level==1),d=c?"after":"before",B;if(u.level>0||t.doc.direction=="rtl"){var R=fi(t,A);B=n<0?A.text.length-1:0;var te=$r(t,R,B).top;B=Jr(function(se){return $r(t,R,se).top==te},n<0==(u.level==1)?u.from:u.to-1,B),d=="before"&&(B=aa(A,B,1))}else B=n<0?u.to:u.from;return new Ge(r,B,d)}}return new Ge(r,n<0?A.text.length:0,n<0?"before":"after")}function Go(e,t,A,r){var n=Xt(t,e.doc.direction);if(!n)return oa(t,A,r);A.ch>=t.text.length?(A.ch=t.text.length,A.sticky="before"):A.ch<=0&&(A.ch=0,A.sticky="after");var s=ar(n,A.ch,A.sticky),u=n[s];if(e.doc.direction=="ltr"&&u.level%2==0&&(r>0?u.to>A.ch:u.from<A.ch))return oa(t,A,r);var c=function(Re,Je){return aa(t,Re instanceof Ge?Re.ch:Re,Je)},d,B=function(Re){return e.options.lineWrapping?(d=d||fi(e,t),Da(e,t,d,Re)):{begin:0,end:t.text.length}},R=B(A.sticky=="before"?c(A,-1):A.ch);if(e.doc.direction=="rtl"||u.level==1){var te=u.level==1==r<0,se=c(A,te?1:-1);if(se!=null&&(te?se<=u.to&&se<=R.end:se>=u.from&&se>=R.begin)){var Ae=te?"before":"after";return new Ge(A.line,se,Ae)}}var fe=function(Re,Je,$e){for(var et=function(xt,Vt){return Vt?new Ge(A.line,c(xt,1),"before"):new Ge(A.line,xt,"after")};Re>=0&&Re<n.length;Re+=Je){var ht=n[Re],mt=Je>0==(ht.level!=1),Pt=mt?$e.begin:c($e.end,-1);if(ht.from<=Pt&&Pt<ht.to||(Pt=mt?ht.from:c(ht.to,-1),$e.begin<=Pt&&Pt<$e.end))return et(Pt,mt)}},ke=fe(s+r,r,R);if(ke)return ke;var He=r>0?R.end:c(R.begin,-1);return He!=null&&!(r>0&&He==t.text.length)&&(ke=fe(r>0?0:n.length-1,r,B(He)),ke)?ke:null}var ti={selectAll:Hs,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),sr)},killLine:function(e){return Dn(e,function(t){if(t.empty()){var A=Qt(e.doc,t.head.line).text.length;return t.head.ch==A&&t.head.line<e.lastLine()?{from:t.head,to:Ge(t.head.line+1,0)}:{from:t.head,to:Ge(t.head.line,A)}}else return{from:t.from(),to:t.to()}})},deleteLine:function(e){return Dn(e,function(t){return{from:Ge(t.from().line,0),to:Mt(e.doc,Ge(t.to().line+1,0))}})},delLineLeft:function(e){return Dn(e,function(t){return{from:Ge(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(e){return Dn(e,function(t){var A=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:A},"div");return{from:r,to:t.from()}})},delWrappedLineRight:function(e){return Dn(e,function(t){var A=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:A},"div");return{from:t.from(),to:r}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(Ge(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(Ge(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(t){return Ya(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(t){return sa(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(t){return Xa(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(t){var A=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:A},"div")},hr)},goLineLeft:function(e){return e.extendSelectionsBy(function(t){var A=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:A},"div")},hr)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(t){var A=e.cursorCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:A},"div");return r.ch<e.getLine(r.line).search(/\S/)?sa(e,t.head):r},hr)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],A=e.listSelections(),r=e.options.tabSize,n=0;n<A.length;n++){var s=A[n].from(),u=Wt(e.getLine(s.line),s.ch,r);t.push(on(r-u%r))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return xr(e,function(){for(var t=e.listSelections(),A=[],r=0;r<t.length;r++)if(t[r].empty()){var n=t[r].head,s=Qt(e.doc,n.line).text;if(s){if(n.ch==s.length&&(n=new Ge(n.line,n.ch-1)),n.ch>0)n=new Ge(n.line,n.ch+1),e.replaceRange(s.charAt(n.ch-1)+s.charAt(n.ch-2),Ge(n.line,n.ch-2),n,"+transpose");else if(n.line>e.doc.first){var u=Qt(e.doc,n.line-1).text;u&&(n=new Ge(n.line,1),e.replaceRange(s.charAt(0)+e.doc.lineSeparator()+u.charAt(u.length-1),Ge(n.line-1,u.length-1),n,"+transpose"))}}A.push(new oA(n,n))}e.setSelections(A)})},newlineAndIndent:function(e){return xr(e,function(){for(var t=e.listSelections(),A=t.length-1;A>=0;A--)e.replaceRange(e.doc.lineSeparator(),t[A].anchor,t[A].head,"+input");t=e.listSelections();for(var r=0;r<t.length;r++)e.indentLine(t[r].from().line,null,!0);yn(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Ya(e,t){var A=Qt(e.doc,t),r=Wr(A);return r!=A&&(t=I(r)),$a(!0,e,r,t,1)}function Xa(e,t){var A=Qt(e.doc,t),r=uu(A);return r!=A&&(t=I(r)),$a(!0,e,A,t,-1)}function sa(e,t){var A=Ya(e,t.line),r=Qt(e.doc,A.line),n=Xt(r,e.doc.direction);if(!n||n[0].level==0){var s=Math.max(A.ch,r.text.search(/\S/)),u=t.line==A.line&&t.ch<=s&&t.ch;return Ge(A.line,u?0:s,A.sticky)}return A}function Ai(e,t,A){if(typeof t=="string"&&(t=ti[t],!t))return!1;e.display.input.ensurePolled();var r=e.display.shift,n=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),A&&(e.display.shift=!1),n=t(e)!=JA}finally{e.display.shift=r,e.state.suppressEdits=!1}return n}function Va(e,t,A){for(var r=0;r<e.state.keyMaps.length;r++){var n=ei(t,e.state.keyMaps[r],A,e);if(n)return n}return e.options.extraKeys&&ei(t,e.options.extraKeys,A,e)||ei(t,e.options.keyMap,A,e)}var ja=new NA;function la(e,t,A,r){var n=e.state.keySeq;if(n){if(za(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:ja.set(50,function(){e.state.keySeq==n&&(e.state.keySeq=null,e.display.input.reset())}),ua(e,n+" "+t,A,r))return!0}return ua(e,t,A,r)}function ua(e,t,A,r){var n=Va(e,t,r);return n=="multi"&&(e.state.keySeq=t),n=="handled"&&rr(e,"keyHandled",e,t,A),(n=="handled"||n=="multi")&&(WA(A),mn(e)),!!n}function ri(e,t){var A=qa(t,!0);return A?t.shiftKey&&!e.state.keySeq?la(e,"Shift-"+A,t,function(r){return Ai(e,r,!0)})||la(e,A,t,function(r){if(typeof r=="string"?/^go[A-Z]/.test(r):r.motion)return Ai(e,r)}):la(e,A,t,function(r){return Ai(e,r)}):!1}function ql(e,t,A){return la(e,"'"+A+"'",t,function(r){return Ai(e,r,!0)})}var Ka=null;function $l(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField())&&(t.curOp.focus=pt(jt(t)),!KA(t,e))){pe&&ue<11&&e.keyCode==27&&(e.returnValue=!1);var A=e.keyCode;t.display.shift=A==16||e.shiftKey;var r=ri(t,e);we&&(Ka=r?A:null,!r&&A==88&&!no&&(N?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),f&&!N&&!r&&A==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),A==18&&!/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)&&Nu(t)}}function Nu(e){var t=e.display.lineDiv;gt(t,"CodeMirror-crosshair");function A(r){(r.keyCode==18||!r.altKey)&&(st(t,"CodeMirror-crosshair"),dr(document,"keyup",A),dr(document,"mouseover",A))}kt(document,"keyup",A),kt(document,"mouseover",A)}function Yl(e){e.keyCode==16&&(this.doc.sel.shift=!1),KA(this,e)}function Pn(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField())&&!(qr(t.display,e)||KA(t,e)||e.ctrlKey&&!e.altKey||N&&e.metaKey)){var A=e.keyCode,r=e.charCode;if(we&&A==Ka){Ka=null,WA(e);return}if(!(we&&(!e.which||e.which<10)&&ri(t,e))){var n=String.fromCharCode(r??A);n!="\b"&&(ql(t,e,n)||t.display.input.onKeyPress(e))}}}var Xl=400,Uo=function(e,t,A){this.time=e,this.pos=t,this.button=A};Uo.prototype.compare=function(e,t,A){return this.time+Xl>e&&vt(t,this.pos)==0&&A==this.button};var fa,Ja;function Vl(e,t){var A=+new Date;return Ja&&Ja.compare(A,e,t)?(fa=Ja=null,"triple"):fa&&fa.compare(A,e,t)?(Ja=new Uo(A,e,t),fa=null,"double"):(fa=new Uo(A,e,t),Ja=null,"single")}function jl(e){var t=this,A=t.display;if(!(KA(t,e)||A.activeTouch&&A.input.supportsTouch())){if(A.input.ensurePolled(),A.shift=e.shiftKey,qr(A,e)){j||(A.scroller.draggable=!1,setTimeout(function(){return A.scroller.draggable=!0},100));return}if(!pr(t,e)){var r=cr(t,e),n=Gr(e),s=r?Vl(r,n):"single";Dt(t).focus(),n==1&&t.state.selectingText&&t.state.selectingText(e),!(r&&nn(t,n,r,s,e))&&(n==1?r?ca(t,r,s,e):pa(e)==A.scroller&&WA(e):n==2?(r&&Zi(t.doc,r),setTimeout(function(){return A.input.focus()},20)):n==3&&(nt?t.display.input.onContextMenu(e):xo(t)))}}}function nn(e,t,A,r,n){var s="Click";return r=="double"?s="Double"+s:r=="triple"&&(s="Triple"+s),s=(t==1?"Left":t==2?"Middle":"Right")+s,la(e,Wa(s,n),n,function(u){if(typeof u=="string"&&(u=ti[u]),!u)return!1;var c=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),c=u(e,A)!=JA}finally{e.state.suppressEdits=!1}return c})}function Kl(e,t,A){var r=e.getOption("configureMouse"),n=r?r(e,t,A):{};if(n.unit==null){var s=oe?A.shiftKey&&A.metaKey:A.altKey;n.unit=s?"rectangle":t=="single"?"char":t=="double"?"word":"line"}return(n.extend==null||e.doc.extend)&&(n.extend=e.doc.extend||A.shiftKey),n.addNew==null&&(n.addNew=N?A.metaKey:A.ctrlKey),n.moveOnDrag==null&&(n.moveOnDrag=!(N?A.altKey:A.ctrlKey)),n}function ca(e,t,A,r){pe?setTimeout(bt(Es,e),0):e.curOp.focus=pt(jt(e));var n=Kl(e,A,r),s=e.doc.sel,u;e.options.dragDrop&&Xo&&!e.isReadOnly()&&A=="single"&&(u=s.contains(t))>-1&&(vt((u=s.ranges[u]).from(),t)<0||t.xRel>0)&&(vt(u.to(),t)>0||t.xRel<0)?ni(e,r,t,n):Ys(e,r,t,n)}function ni(e,t,A,r){var n=e.display,s=!1,u=lr(e,function(B){j&&(n.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:xo(e)),dr(n.wrapper.ownerDocument,"mouseup",u),dr(n.wrapper.ownerDocument,"mousemove",c),dr(n.scroller,"dragstart",d),dr(n.scroller,"drop",u),s||(WA(B),r.addNew||Zi(e.doc,A,null,null,r.extend),j&&!Oe||pe&&ue==9?setTimeout(function(){n.wrapper.ownerDocument.body.focus({preventScroll:!0}),n.input.focus()},20):n.input.focus())}),c=function(B){s=s||Math.abs(t.clientX-B.clientX)+Math.abs(t.clientY-B.clientY)>=10},d=function(){return s=!0};j&&(n.scroller.draggable=!0),e.state.draggingText=u,u.copy=!r.moveOnDrag,kt(n.wrapper.ownerDocument,"mouseup",u),kt(n.wrapper.ownerDocument,"mousemove",c),kt(n.scroller,"dragstart",d),kt(n.scroller,"drop",u),e.state.delayingBlurEvent=!0,setTimeout(function(){return n.input.focus()},20),n.scroller.dragDrop&&n.scroller.dragDrop()}function $s(e,t,A){if(A=="char")return new oA(t,t);if(A=="word")return e.findWordAt(t);if(A=="line")return new oA(Ge(t.line,0),Mt(e.doc,Ge(t.line+1,0)));var r=A(e,t);return new oA(r.from,r.to)}function Ys(e,t,A,r){pe&&xo(e);var n=e.display,s=e.doc;WA(t);var u,c,d=s.sel,B=d.ranges;if(r.addNew&&!r.extend?(c=s.sel.contains(A),c>-1?u=B[c]:u=new oA(A,A)):(u=s.sel.primary(),c=s.sel.primIndex),r.unit=="rectangle")r.addNew||(u=new oA(A,A)),A=cr(e,t,!0,!0),c=-1;else{var R=$s(e,A,r.unit);r.extend?u=Po(u,R.anchor,R.head,r.extend):u=R}r.addNew?c==-1?(c=B.length,fr(s,kr(e,B.concat([u]),c),{scroll:!1,origin:"*mouse"})):B.length>1&&B[c].empty()&&r.unit=="char"&&!r.extend?(fr(s,kr(e,B.slice(0,c).concat(B.slice(c+1)),0),{scroll:!1,origin:"*mouse"}),d=s.sel):ko(s,c,u,Cr):(c=0,fr(s,new Ir([u],0),Cr),d=s.sel);var te=A;function se($e){if(vt(te,$e)!=0)if(te=$e,r.unit=="rectangle"){for(var et=[],ht=e.options.tabSize,mt=Wt(Qt(s,A.line).text,A.ch,ht),Pt=Wt(Qt(s,$e.line).text,$e.ch,ht),xt=Math.min(mt,Pt),Vt=Math.max(mt,Pt),Ot=Math.min(A.line,$e.line),Zt=Math.min(e.lastLine(),Math.max(A.line,$e.line));Ot<=Zt;Ot++){var eA=Qt(s,Ot).text,$t=ZA(eA,xt,ht);xt==Vt?et.push(new oA(Ge(Ot,$t),Ge(Ot,$t))):eA.length>$t&&et.push(new oA(Ge(Ot,$t),Ge(Ot,ZA(eA,Vt,ht))))}et.length||et.push(new oA(A,A)),fr(s,kr(e,d.ranges.slice(0,c).concat(et),c),{origin:"*mouse",scroll:!1}),e.scrollIntoView($e)}else{var LA=u,tA=$s(e,$e,r.unit),zt=LA.anchor,Bt;vt(tA.anchor,zt)>0?(Bt=tA.head,zt=Ri(LA.from(),tA.anchor)):(Bt=tA.anchor,zt=gr(LA.to(),tA.head));var Yt=d.ranges.slice(0);Yt[c]=Ho(e,new oA(Mt(s,zt),Bt)),fr(s,kr(e,Yt,c),Cr)}}var Ae=n.wrapper.getBoundingClientRect(),fe=0;function ke($e){var et=++fe,ht=cr(e,$e,!0,r.unit=="rectangle");if(ht)if(vt(ht,te)!=0){e.curOp.focus=pt(jt(e)),se(ht);var mt=$i(n,s);(ht.line>=mt.to||ht.line<mt.from)&&setTimeout(lr(e,function(){fe==et&&ke($e)}),150)}else{var Pt=$e.clientY<Ae.top?-20:$e.clientY>Ae.bottom?20:0;Pt&&setTimeout(lr(e,function(){fe==et&&(n.scroller.scrollTop+=Pt,ke($e))}),50)}}function He($e){e.state.selectingText=!1,fe=1/0,$e&&(WA($e),n.input.focus()),dr(n.wrapper.ownerDocument,"mousemove",Re),dr(n.wrapper.ownerDocument,"mouseup",Je),s.history.lastSelOrigin=null}var Re=lr(e,function($e){$e.buttons===0||!Gr($e)?He($e):ke($e)}),Je=lr(e,He);e.state.selectingText=Je,kt(n.wrapper.ownerDocument,"mousemove",Re),kt(n.wrapper.ownerDocument,"mouseup",Je)}function Ho(e,t){var A=t.anchor,r=t.head,n=Qt(e.doc,A.line);if(vt(A,r)==0&&A.sticky==r.sticky)return t;var s=Xt(n);if(!s)return t;var u=ar(s,A.ch,A.sticky),c=s[u];if(c.from!=A.ch&&c.to!=A.ch)return t;var d=u+(c.from==A.ch==(c.level!=1)?0:1);if(d==0||d==s.length)return t;var B;if(r.line!=A.line)B=(r.line-A.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var R=ar(s,r.ch,r.sticky),te=R-u||(r.ch-A.ch)*(c.level==1?-1:1);R==d-1||R==d?B=te<0:B=te>0}var se=s[d+(B?-1:0)],Ae=B==(se.level==1),fe=Ae?se.from:se.to,ke=Ae?"after":"before";return A.ch==fe&&A.sticky==ke?t:new oA(new Ge(A.line,fe,ke),r)}function Xs(e,t,A,r){var n,s;if(t.touches)n=t.touches[0].clientX,s=t.touches[0].clientY;else try{n=t.clientX,s=t.clientY}catch{return!1}if(n>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&WA(t);var u=e.display,c=u.lineDiv.getBoundingClientRect();if(s>c.bottom||!wr(e,A))return Er(t);s-=c.top-u.viewOffset;for(var d=0;d<e.display.gutterSpecs.length;++d){var B=u.gutters.childNodes[d];if(B&&B.getBoundingClientRect().right>=n){var R=ge(e.doc,s),te=e.display.gutterSpecs[d];return er(e,A,e,R,te.className,t),Er(t)}}}function pr(e,t){return Xs(e,t,"gutterClick",!0)}function In(e,t){qr(e.display,t)||nr(e,t)||KA(e,t,"contextmenu")||nt||e.display.input.onContextMenu(t)}function nr(e,t){return wr(e,"gutterContextMenu")?Xs(e,t,"gutterContextMenu",!1):!1}function Br(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Qa(e)}var Si={toString:function(){return"CodeMirror.Init"}},Jl={},zo={};function Gu(e){var t=e.optionHandlers;function A(r,n,s,u){e.defaults[r]=n,s&&(t[r]=u?function(c,d,B){B!=Si&&s(c,d,B)}:s)}e.defineOption=A,e.Init=Si,A("value","",function(r,n){return r.setValue(n)},!0),A("mode",null,function(r,n){r.doc.modeOption=n,ks(r)},!0),A("indentUnit",2,ks,!0),A("indentWithTabs",!1),A("smartIndent",!0),A("tabSize",4,function(r){Bn(r),Qa(r),vr(r)},!0),A("lineSeparator",null,function(r,n){if(r.doc.lineSep=n,!!n){var s=[],u=r.doc.first;r.doc.iter(function(d){for(var B=0;;){var R=d.text.indexOf(n,B);if(R==-1)break;B=R+n.length,s.push(Ge(u,R))}u++});for(var c=s.length-1;c>=0;c--)_n(r.doc,n,s[c],Ge(s[c].line,s[c].ch+n.length))}}),A("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(r,n,s){r.state.specialChars=new RegExp(n.source+(n.test("	")?"":"|	"),"g"),s!=Si&&r.refresh()}),A("specialCharPlaceholder",os,function(r){return r.refresh()},!0),A("electricChars",!0),A("inputStyle",Q?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),A("spellcheck",!1,function(r,n){return r.getInputField().spellcheck=n},!0),A("autocorrect",!1,function(r,n){return r.getInputField().autocorrect=n},!0),A("autocapitalize",!1,function(r,n){return r.getInputField().autocapitalize=n},!0),A("rtlMoveVisually",!de),A("wholeLineUpdateBefore",!0),A("theme","default",function(r){Br(r),Ma(r)},!0),A("keyMap","default",function(r,n,s){var u=ia(n),c=s!=Si&&ia(s);c&&c.detach&&c.detach(r,u),u.attach&&u.attach(r,c||null)}),A("extraKeys",null),A("configureMouse",null),A("lineWrapping",!1,Zl,!0),A("gutters",[],function(r,n){r.display.gutterSpecs=Ds(n,r.options.lineNumbers),Ma(r)},!0),A("fixedGutter",!0,function(r,n){r.display.gutters.style.left=n?di(r.display)+"px":"0",r.refresh()},!0),A("coverGutterNextToScrollbar",!1,function(r){return vi(r)},!0),A("scrollbarStyle","native",function(r){_s(r),vi(r),r.display.scrollbars.setScrollTop(r.doc.scrollTop),r.display.scrollbars.setScrollLeft(r.doc.scrollLeft)},!0),A("lineNumbers",!1,function(r,n){r.display.gutterSpecs=Ds(r.options.gutters,n),Ma(r)},!0),A("firstLineNumber",1,Ma,!0),A("lineNumberFormatter",function(r){return r},Ma,!0),A("showCursorWhenSelecting",!1,Ia,!0),A("resetSelectionOnContextMenu",!0),A("lineWiseCopyCut",!0),A("pasteLinesPerSelection",!0),A("selectionsMayTouch",!1),A("readOnly",!1,function(r,n){n=="nocursor"&&(qi(r),r.display.input.blur()),r.display.input.readOnlyChanged(n)}),A("screenReaderLabel",null,function(r,n){n=n===""?null:n,r.display.input.screenReaderLabelChanged(n)}),A("disableInput",!1,function(r,n){n||r.display.input.reset()},!0),A("dragDrop",!0,Uu),A("allowDropFileTypes",null),A("cursorBlinkRate",530),A("cursorScrollMargin",0),A("cursorHeight",1,Ia,!0),A("singleCursorHeightPerLine",!0,Ia,!0),A("workTime",100),A("workDelay",100),A("flattenSpans",!0,Bn,!0),A("addModeClass",!1,Bn,!0),A("pollInterval",100),A("undoDepth",200,function(r,n){return r.doc.history.undoDepth=n}),A("historyEventDelay",1250),A("viewportMargin",10,function(r){return r.refresh()},!0),A("maxHighlightLength",1e4,Bn,!0),A("moveInputWithCursor",!0,function(r,n){n||r.display.input.resetPosition()}),A("tabindex",null,function(r,n){return r.display.input.getField().tabIndex=n||""}),A("autofocus",null),A("direction","ltr",function(r,n){return r.doc.setDirection(n)},!0),A("phrases",null)}function Uu(e,t,A){var r=A&&A!=Si;if(!t!=!r){var n=e.display.dragFunctions,s=t?kt:dr;s(e.display.scroller,"dragstart",n.start),s(e.display.scroller,"dragenter",n.enter),s(e.display.scroller,"dragover",n.over),s(e.display.scroller,"dragleave",n.leave),s(e.display.scroller,"drop",n.drop)}}function Zl(e){e.options.lineWrapping?(gt(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(st(e.display.wrapper,"CodeMirror-wrap"),is(e)),Wi(e),vr(e),Qa(e),setTimeout(function(){return vi(e)},100)}function jA(e,t){var A=this;if(!(this instanceof jA))return new jA(e,t);this.options=t=t?Lt(t):{},Lt(Jl,t,!1);var r=t.value;typeof r=="string"?r=new yr(r,t.mode,null,t.lineSeparator,t.direction):t.mode&&(r.modeOption=t.mode),this.doc=r;var n=new jA.inputStyles[t.inputStyle](this),s=this.display=new Su(e,r,n,t);s.wrapper.CodeMirror=this,Br(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),_s(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new NA,keySeq:null,specialChars:null},t.autofocus&&!Q&&s.input.focus(),pe&&ue<11&&setTimeout(function(){return A.display.input.reset(!0)},20),Hu(this),Lu(),br(this),this.curOp.forceUpdate=!0,yi(this,r),t.autofocus&&!Q||this.hasFocus()?setTimeout(function(){A.hasFocus()&&!A.state.focused&&bs(A)},20):qi(this);for(var u in zo)zo.hasOwnProperty(u)&&zo[u](this,t[u],Si);Il(this),t.finishInit&&t.finishInit(this);for(var c=0;c<Vs.length;++c)Vs[c](this);En(this),j&&t.lineWrapping&&getComputedStyle(s.lineDiv).textRendering=="optimizelegibility"&&(s.lineDiv.style.textRendering="auto")}jA.defaults=Jl,jA.optionHandlers=zo;function Hu(e){var t=e.display;kt(t.scroller,"mousedown",lr(e,jl)),pe&&ue<11?kt(t.scroller,"dblclick",lr(e,function(d){if(!KA(e,d)){var B=cr(e,d);if(!(!B||pr(e,d)||qr(e.display,d))){WA(d);var R=e.findWordAt(B);Zi(e.doc,R.anchor,R.head)}}})):kt(t.scroller,"dblclick",function(d){return KA(e,d)||WA(d)}),kt(t.scroller,"contextmenu",function(d){return In(e,d)}),kt(t.input.getField(),"contextmenu",function(d){t.scroller.contains(d.target)||In(e,d)});var A,r={end:0};function n(){t.activeTouch&&(A=setTimeout(function(){return t.activeTouch=null},1e3),r=t.activeTouch,r.end=+new Date)}function s(d){if(d.touches.length!=1)return!1;var B=d.touches[0];return B.radiusX<=1&&B.radiusY<=1}function u(d,B){if(B.left==null)return!0;var R=B.left-d.left,te=B.top-d.top;return R*R+te*te>20*20}kt(t.scroller,"touchstart",function(d){if(!KA(e,d)&&!s(d)&&!pr(e,d)){t.input.ensurePolled(),clearTimeout(A);var B=+new Date;t.activeTouch={start:B,moved:!1,prev:B-r.end<=300?r:null},d.touches.length==1&&(t.activeTouch.left=d.touches[0].pageX,t.activeTouch.top=d.touches[0].pageY)}}),kt(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),kt(t.scroller,"touchend",function(d){var B=t.activeTouch;if(B&&!qr(t,d)&&B.left!=null&&!B.moved&&new Date-B.start<300){var R=e.coordsChar(t.activeTouch,"page"),te;!B.prev||u(B,B.prev)?te=new oA(R,R):!B.prev.prev||u(B,B.prev.prev)?te=e.findWordAt(R):te=new oA(Ge(R.line,0),Mt(e.doc,Ge(R.line+1,0))),e.setSelection(te.anchor,te.head),e.focus(),WA(d)}n()}),kt(t.scroller,"touchcancel",n),kt(t.scroller,"scroll",function(){t.scroller.clientHeight&&(Yi(e,t.scroller.scrollTop),$n(e,t.scroller.scrollLeft,!0),er(e,"scroll",e))}),kt(t.scroller,"mousewheel",function(d){return Ll(e,d)}),kt(t.scroller,"DOMMouseScroll",function(d){return Ll(e,d)}),kt(t.wrapper,"scroll",function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={enter:function(d){KA(e,d)||Mn(d)},over:function(d){KA(e,d)||(ku(e,d),Mn(d))},start:function(d){return na(e,d)},drop:lr(e,Iu),leave:function(d){KA(e,d)||zl(e)}};var c=t.input.getField();kt(c,"keyup",function(d){return Yl.call(e,d)}),kt(c,"keydown",lr(e,$l)),kt(c,"keypress",lr(e,Pn)),kt(c,"focus",function(d){return bs(e,d)}),kt(c,"blur",function(d){return qi(e,d)})}var Vs=[];jA.defineInitHook=function(e){return Vs.push(e)};function Za(e,t,A,r){var n=e.doc,s;A==null&&(A="add"),A=="smart"&&(n.mode.indent?s=ma(e,t).state:A="prev");var u=e.options.tabSize,c=Qt(n,t),d=Wt(c.text,null,u);c.stateAfter&&(c.stateAfter=null);var B=c.text.match(/^\s*/)[0],R;if(!r&&!/\S/.test(c.text))R=0,A="not";else if(A=="smart"&&(R=n.mode.indent(s,c.text.slice(B.length),c.text),R==JA||R>150)){if(!r)return;A="prev"}A=="prev"?t>n.first?R=Wt(Qt(n,t-1).text,null,u):R=0:A=="add"?R=d+e.options.indentUnit:A=="subtract"?R=d-e.options.indentUnit:typeof A=="number"&&(R=d+A),R=Math.max(0,R);var te="",se=0;if(e.options.indentWithTabs)for(var Ae=Math.floor(R/u);Ae;--Ae)se+=u,te+="	";if(se<R&&(te+=on(R-se)),te!=B)return _n(n,te,Ge(t,0),Ge(t,B.length),"+input"),c.stateAfter=null,!0;for(var fe=0;fe<n.sel.ranges.length;fe++){var ke=n.sel.ranges[fe];if(ke.head.line==t&&ke.head.ch<B.length){var He=Ge(t,B.length);ko(n,fe,new oA(He,He));break}}}var Vr=null;function eo(e){Vr=e}function Wo(e,t,A,r,n){var s=e.doc;e.display.shift=!1,r||(r=s.sel);var u=+new Date-200,c=n=="paste"||e.state.pasteIncoming>u,d=rA(t),B=null;if(c&&r.ranges.length>1)if(Vr&&Vr.text.join(`
`)==t){if(r.ranges.length%Vr.text.length==0){B=[];for(var R=0;R<Vr.text.length;R++)B.push(s.splitLines(Vr.text[R]))}}else d.length==r.ranges.length&&e.options.pasteLinesPerSelection&&(B=ii(d,function(Re){return[Re]}));for(var te=e.curOp.updateInput,se=r.ranges.length-1;se>=0;se--){var Ae=r.ranges[se],fe=Ae.from(),ke=Ae.to();Ae.empty()&&(A&&A>0?fe=Ge(fe.line,fe.ch-A):e.state.overwrite&&!c?ke=Ge(ke.line,Math.min(Qt(s,ke.line).text.length,ke.ch+qt(d).length)):c&&Vr&&Vr.lineWise&&Vr.text.join(`
`)==d.join(`
`)&&(fe=ke=Ge(fe.line,0)));var He={from:fe,to:ke,text:B?B[se%B.length]:d,origin:n||(c?"paste":e.state.cutIncoming>u?"cut":"+input")};Ci(e.doc,He),rr(e,"inputRead",e,He)}t&&!c&&eu(e,t),yn(e),e.curOp.updateInput<2&&(e.curOp.updateInput=te),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function js(e,t){var A=e.clipboardData&&e.clipboardData.getData("Text");if(A)return e.preventDefault(),!t.isReadOnly()&&!t.options.disableInput&&t.hasFocus()&&xr(t,function(){return Wo(t,A,0,null,"paste")}),!0}function eu(e,t){if(!(!e.options.electricChars||!e.options.smartIndent))for(var A=e.doc.sel,r=A.ranges.length-1;r>=0;r--){var n=A.ranges[r];if(!(n.head.ch>100||r&&A.ranges[r-1].head.line==n.head.line)){var s=e.getModeAt(n.head),u=!1;if(s.electricChars){for(var c=0;c<s.electricChars.length;c++)if(t.indexOf(s.electricChars.charAt(c))>-1){u=Za(e,n.head.line,"smart");break}}else s.electricInput&&s.electricInput.test(Qt(e.doc,n.head.line).text.slice(0,n.head.ch))&&(u=Za(e,n.head.line,"smart"));u&&rr(e,"electricInput",e,n.head.line)}}}function tu(e){for(var t=[],A=[],r=0;r<e.doc.sel.ranges.length;r++){var n=e.doc.sel.ranges[r].head.line,s={anchor:Ge(n,0),head:Ge(n+1,0)};A.push(s),t.push(e.getRange(s.anchor,s.head))}return{text:t,ranges:A}}function qo(e,t,A,r){e.setAttribute("autocorrect",A?"on":"off"),e.setAttribute("autocapitalize",r?"on":"off"),e.setAttribute("spellcheck",!!t)}function Au(){var e=T("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),t=T("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return j?e.style.width="1000px":e.setAttribute("wrap","off"),q&&(e.style.border="1px solid black"),t}function E(e){var t=e.optionHandlers,A=e.helpers={};e.prototype={constructor:e,focus:function(){Dt(this).focus(),this.display.input.focus()},setOption:function(r,n){var s=this.options,u=s[r];s[r]==n&&r!="mode"||(s[r]=n,t.hasOwnProperty(r)&&lr(this,t[r])(this,n,u),er(this,"optionChange",this,r))},getOption:function(r){return this.options[r]},getDoc:function(){return this.doc},addKeyMap:function(r,n){this.state.keyMaps[n?"push":"unshift"](ia(r))},removeKeyMap:function(r){for(var n=this.state.keyMaps,s=0;s<n.length;++s)if(n[s]==r||n[s].name==r)return n.splice(s,1),!0},addOverlay:mr(function(r,n){var s=r.token?r:e.getMode(this.options,r);if(s.startState)throw new Error("Overlays may not be stateful.");$o(this.state.overlays,{mode:s,modeSpec:r,opaque:n&&n.opaque,priority:n&&n.priority||0},function(u){return u.priority}),this.state.modeGen++,vr(this)}),removeOverlay:mr(function(r){for(var n=this.state.overlays,s=0;s<n.length;++s){var u=n[s].modeSpec;if(u==r||typeof r=="string"&&u.name==r){n.splice(s,1),this.state.modeGen++,vr(this);return}}}),indentLine:mr(function(r,n,s){typeof n!="string"&&typeof n!="number"&&(n==null?n=this.options.smartIndent?"smart":"prev":n=n?"add":"subtract"),je(this.doc,r)&&Za(this,r,n,s)}),indentSelection:mr(function(r){for(var n=this.doc.sel.ranges,s=-1,u=0;u<n.length;u++){var c=n[u];if(c.empty())c.head.line>s&&(Za(this,c.head.line,r,!0),s=c.head.line,u==this.doc.sel.primIndex&&yn(this));else{var d=c.from(),B=c.to(),R=Math.max(s,d.line);s=Math.min(this.lastLine(),B.line-(B.ch?0:1))+1;for(var te=R;te<s;++te)Za(this,te,r);var se=this.doc.sel.ranges;d.ch==0&&n.length==se.length&&se[u].from().ch>0&&ko(this.doc,u,new oA(d,se[u].to()),sr)}}}),getTokenAt:function(r,n){return Al(this,r,n)},getLineTokens:function(r,n){return Al(this,Ge(r),n,!0)},getTokenTypeAt:function(r){r=Mt(this.doc,r);var n=el(this,Qt(this.doc,r.line)),s=0,u=(n.length-1)/2,c=r.ch,d;if(c==0)d=n[2];else for(;;){var B=s+u>>1;if((B?n[B*2-1]:0)>=c)u=B;else if(n[B*2+1]<c)s=B+1;else{d=n[B*2+2];break}}var R=d?d.indexOf("overlay "):-1;return R<0?d:R==0?null:d.slice(0,R-1)},getModeAt:function(r){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(r).state).mode:n},getHelper:function(r,n){return this.getHelpers(r,n)[0]},getHelpers:function(r,n){var s=[];if(!A.hasOwnProperty(n))return s;var u=A[n],c=this.getModeAt(r);if(typeof c[n]=="string")u[c[n]]&&s.push(u[c[n]]);else if(c[n])for(var d=0;d<c[n].length;d++){var B=u[c[n][d]];B&&s.push(B)}else c.helperType&&u[c.helperType]?s.push(u[c.helperType]):u[c.name]&&s.push(u[c.name]);for(var R=0;R<u._global.length;R++){var te=u._global[R];te.pred(c,this)&&Tt(s,te.val)==-1&&s.push(te.val)}return s},getStateAfter:function(r,n){var s=this.doc;return r=Js(s,r??s.first+s.size-1),ma(this,r+1,n).state},cursorCoords:function(r,n){var s,u=this.doc.sel.primary();return r==null?s=u.head:typeof r=="object"?s=Mt(this.doc,r):s=r?u.from():u.to(),Pr(this,s,n||"page")},charCoords:function(r,n){return yo(this,Mt(this.doc,r),n||"page")},coordsChar:function(r,n){return r=mo(this,r,n||"page"),Ta(this,r.left,r.top)},lineAtHeight:function(r,n){return r=mo(this,{top:r,left:0},n||"page").top,ge(this.doc,r+this.display.viewOffset)},heightAtLine:function(r,n,s){var u=!1,c;if(typeof r=="number"){var d=this.doc.first+this.doc.size-1;r<this.doc.first?r=this.doc.first:r>d&&(r=d,u=!0),c=Qt(this.doc,r)}else c=r;return vo(this,c,{top:0,left:0},n||"page",s||u).top+(u?this.doc.height-Sr(c):0)},defaultTextHeight:function(){return Hi(this.display)},defaultCharWidth:function(){return zi(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(r,n,s,u,c){var d=this.display;r=Pr(this,Mt(this.doc,r));var B=r.bottom,R=r.left;if(n.style.position="absolute",n.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(n),d.sizer.appendChild(n),u=="over")B=r.top;else if(u=="above"||u=="near"){var te=Math.max(d.wrapper.clientHeight,this.doc.height),se=Math.max(d.sizer.clientWidth,d.lineSpace.clientWidth);(u=="above"||r.bottom+n.offsetHeight>te)&&r.top>n.offsetHeight?B=r.top-n.offsetHeight:r.bottom+n.offsetHeight<=te&&(B=r.bottom),R+n.offsetWidth>se&&(R=se-n.offsetWidth)}n.style.top=B+"px",n.style.left=n.style.right="",c=="right"?(R=d.sizer.clientWidth-n.offsetWidth,n.style.right="0px"):(c=="left"?R=0:c=="middle"&&(R=(d.sizer.clientWidth-n.offsetWidth)/2),n.style.left=R+"px"),s&&Bl(this,{left:R,top:B,right:R+n.offsetWidth,bottom:B+n.offsetHeight})},triggerOnKeyDown:mr($l),triggerOnKeyPress:mr(Pn),triggerOnKeyUp:Yl,triggerOnMouseDown:mr(jl),execCommand:function(r){if(ti.hasOwnProperty(r))return ti[r].call(null,this)},triggerElectric:mr(function(r){eu(this,r)}),findPosH:function(r,n,s,u){var c=1;n<0&&(c=-1,n=-n);for(var d=Mt(this.doc,r),B=0;B<n&&(d=Y(this.doc,d,c,s,u),!d.hitSide);++B);return d},moveH:mr(function(r,n){var s=this;this.extendSelectionsBy(function(u){return s.display.shift||s.doc.extend||u.empty()?Y(s.doc,u.head,r,n,s.options.rtlMoveVisually):r<0?u.from():u.to()},hr)}),deleteH:mr(function(r,n){var s=this.doc.sel,u=this.doc;s.somethingSelected()?u.replaceSelection("",null,"+delete"):Dn(this,function(c){var d=Y(u,c.head,r,n,!1);return r<0?{from:d,to:c.head}:{from:c.head,to:d}})}),findPosV:function(r,n,s,u){var c=1,d=u;n<0&&(c=-1,n=-n);for(var B=Mt(this.doc,r),R=0;R<n;++R){var te=Pr(this,B,"div");if(d==null?d=te.left:te.left=d,B=he(this,te,c,s),B.hitSide)break}return B},moveV:mr(function(r,n){var s=this,u=this.doc,c=[],d=!this.display.shift&&!u.extend&&u.sel.somethingSelected();if(u.extendSelectionsBy(function(R){if(d)return r<0?R.from():R.to();var te=Pr(s,R.head,"div");R.goalColumn!=null&&(te.left=R.goalColumn),c.push(te.left);var se=he(s,te,r,n);return n=="page"&&R==u.sel.primary()&&xs(s,yo(s,se,"div").top-te.top),se},hr),c.length)for(var B=0;B<u.sel.ranges.length;B++)u.sel.ranges[B].goalColumn=c[B]}),findWordAt:function(r){var n=this.doc,s=Qt(n,r.line).text,u=r.ch,c=r.ch;if(s){var d=this.getHelper(r,"wordChars");(r.sticky=="before"||c==s.length)&&u?--u:++c;for(var B=s.charAt(u),R=sn(B,d)?function(te){return sn(te,d)}:/\s/.test(B)?function(te){return/\s/.test(te)}:function(te){return!/\s/.test(te)&&!sn(te)};u>0&&R(s.charAt(u-1));)--u;for(;c<s.length&&R(s.charAt(c));)++c}return new oA(Ge(r.line,u),Ge(r.line,c))},toggleOverwrite:function(r){r!=null&&r==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?gt(this.display.cursorDiv,"CodeMirror-overwrite"):st(this.display.cursorDiv,"CodeMirror-overwrite"),er(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==pt(jt(this))},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:mr(function(r,n){La(this,r,n)}),getScrollInfo:function(){var r=this.display.scroller;return{left:r.scrollLeft,top:r.scrollTop,height:r.scrollHeight-Fr(this)-this.display.barHeight,width:r.scrollWidth-Fr(this)-this.display.barWidth,clientHeight:_a(this),clientWidth:pn(this)}},scrollIntoView:mr(function(r,n){r==null?(r={from:this.doc.sel.primary().head,to:null},n==null&&(n=this.options.cursorScrollMargin)):typeof r=="number"?r={from:Ge(r,0),to:null}:r.from==null&&(r={from:r,to:null}),r.to||(r.to=r.from),r.margin=n||0,r.from.line!=null?qn(this,r):Bs(this,r.from,r.to,r.margin)}),setSize:mr(function(r,n){var s=this,u=function(d){return typeof d=="number"||/^\d+$/.test(String(d))?d+"px":d};r!=null&&(this.display.wrapper.style.width=u(r)),n!=null&&(this.display.wrapper.style.height=u(n)),this.options.lineWrapping&&pl(this);var c=this.display.viewFrom;this.doc.iter(c,this.display.viewTo,function(d){if(d.widgets){for(var B=0;B<d.widgets.length;B++)if(d.widgets[B].noHScroll){gn(s,c,"widget");break}}++c}),this.curOp.forceUpdate=!0,er(this,"refresh",this)}),operation:function(r){return xr(this,r)},startOperation:function(){return br(this)},endOperation:function(){return En(this)},refresh:mr(function(){var r=this.display.cachedTextHeight;vr(this),this.curOp.forceUpdate=!0,Qa(this),La(this,this.doc.scrollLeft,this.doc.scrollTop),Qs(this.display),(r==null||Math.abs(r-Hi(this.display))>.5||this.options.lineWrapping)&&Wi(this),er(this,"refresh",this)}),swapDoc:mr(function(r){var n=this.doc;return n.cm=null,this.state.selectingText&&this.state.selectingText(),yi(this,r),Qa(this),this.display.input.reset(),La(this,r.scrollLeft,r.scrollTop),this.curOp.forceScroll=!0,rr(this,"swapDoc",this,n),n}),phrase:function(r){var n=this.options.phrases;return n&&Object.prototype.hasOwnProperty.call(n,r)?n[r]:r},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Nr(e),e.registerHelper=function(r,n,s){A.hasOwnProperty(r)||(A[r]=e[r]={_global:[]}),A[r][n]=s},e.registerGlobalHelper=function(r,n,s,u){e.registerHelper(r,n,u),A[r]._global.push({pred:s,val:u})}}function Y(e,t,A,r,n){var s=t,u=A,c=Qt(e,t.line),d=n&&e.direction=="rtl"?-A:A;function B(){var Je=t.line+d;return Je<e.first||Je>=e.first+e.size?!1:(t=new Ge(Je,t.ch,t.sticky),c=Qt(e,Je))}function R(Je){var $e;if(r=="codepoint"){var et=c.text.charCodeAt(t.ch+(A>0?0:-1));if(isNaN(et))$e=null;else{var ht=A>0?et>=55296&&et<56320:et>=56320&&et<57343;$e=new Ge(t.line,Math.max(0,Math.min(c.text.length,t.ch+A*(ht?2:1))),-A)}}else n?$e=Go(e.cm,c,t,A):$e=oa(c,t,A);if($e==null)if(!Je&&B())t=$a(n,e.cm,c,t.line,d);else return!1;else t=$e;return!0}if(r=="char"||r=="codepoint")R();else if(r=="column")R(!0);else if(r=="word"||r=="group")for(var te=null,se=r=="group",Ae=e.cm&&e.cm.getHelper(t,"wordChars"),fe=!0;!(A<0&&!R(!fe));fe=!1){var ke=c.text.charAt(t.ch)||`
`,He=sn(ke,Ae)?"w":se&&ke==`
`?"n":!se||/\s/.test(ke)?null:"p";if(se&&!fe&&!He&&(He="s"),te&&te!=He){A<0&&(A=1,R(),t.sticky="after");break}if(He&&(te=He),A>0&&!R(!fe))break}var Re=ea(e,t,s,u,!0);return HA(s,Re)&&(Re.hitSide=!0),Re}function he(e,t,A,r){var n=e.doc,s=t.left,u;if(r=="page"){var c=Math.min(e.display.wrapper.clientHeight,Dt(e).innerHeight||n(e).documentElement.clientHeight),d=Math.max(c-.5*Hi(e.display),3);u=(A>0?t.bottom:t.top)+A*d}else r=="line"&&(u=A>0?t.bottom+3:t.top-3);for(var B;B=Ta(e,s,u),!!B.outside;){if(A<0?u<=0:u>=n.height){B.hitSide=!0;break}u+=A*5}return B}var Se=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new NA,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};Se.prototype.init=function(e){var t=this,A=this,r=A.cm,n=A.div=e.lineDiv;n.contentEditable=!0,qo(n,r.options.spellcheck,r.options.autocorrect,r.options.autocapitalize);function s(c){for(var d=c.target;d;d=d.parentNode){if(d==n)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(d.className))break}return!1}kt(n,"paste",function(c){!s(c)||KA(r,c)||js(c,r)||ue<=11&&setTimeout(lr(r,function(){return t.updateFromDOM()}),20)}),kt(n,"compositionstart",function(c){t.composing={data:c.data,done:!1}}),kt(n,"compositionupdate",function(c){t.composing||(t.composing={data:c.data,done:!1})}),kt(n,"compositionend",function(c){t.composing&&(c.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),kt(n,"touchstart",function(){return A.forceCompositionEnd()}),kt(n,"input",function(){t.composing||t.readFromDOMSoon()});function u(c){if(!(!s(c)||KA(r,c))){if(r.somethingSelected())eo({lineWise:!1,text:r.getSelections()}),c.type=="cut"&&r.replaceSelection("",null,"cut");else if(r.options.lineWiseCopyCut){var d=tu(r);eo({lineWise:!0,text:d.text}),c.type=="cut"&&r.operation(function(){r.setSelections(d.ranges,0,sr),r.replaceSelection("",null,"cut")})}else return;if(c.clipboardData){c.clipboardData.clearData();var B=Vr.text.join(`
`);if(c.clipboardData.setData("Text",B),c.clipboardData.getData("Text")==B){c.preventDefault();return}}var R=Au(),te=R.firstChild;qo(te),r.display.lineSpace.insertBefore(R,r.display.lineSpace.firstChild),te.value=Vr.text.join(`
`);var se=pt(St(n));yt(te),setTimeout(function(){r.display.lineSpace.removeChild(R),se.focus(),se==n&&A.showPrimarySelection()},50)}}kt(n,"copy",u),kt(n,"cut",u)},Se.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},Se.prototype.prepareSelection=function(){var e=pi(this.cm,!1);return e.focus=pt(St(this.div))==this.div,e},Se.prototype.showSelection=function(e,t){!e||!this.cm.display.view.length||((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},Se.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Se.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,A=t.doc.sel.primary(),r=A.from(),n=A.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||n.line<t.display.viewFrom){e.removeAllRanges();return}var s=At(t,e.anchorNode,e.anchorOffset),u=At(t,e.focusNode,e.focusOffset);if(!(s&&!s.bad&&u&&!u.bad&&vt(Ri(s,u),r)==0&&vt(gr(s,u),n)==0)){var c=t.display.view,d=r.line>=t.display.viewFrom&&qe(t,r)||{node:c[0].measure.map[2],offset:0},B=n.line<t.display.viewTo&&qe(t,n);if(!B){var R=c[c.length-1].measure,te=R.maps?R.maps[R.maps.length-1]:R.map;B={node:te[te.length-1],offset:te[te.length-2]-te[te.length-3]}}if(!d||!B){e.removeAllRanges();return}var se=e.rangeCount&&e.getRangeAt(0),Ae;try{Ae=Ne(d.node,d.offset,B.offset,B.node)}catch{}Ae&&(!f&&t.state.focused?(e.collapse(d.node,d.offset),Ae.collapsed||(e.removeAllRanges(),e.addRange(Ae))):(e.removeAllRanges(),e.addRange(Ae)),se&&e.anchorNode==null?e.addRange(se):f&&this.startGracePeriod()),this.rememberSelection()}},Se.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},Se.prototype.showMultipleSelections=function(e){U(this.cm.display.cursorDiv,e.cursors),U(this.cm.display.selectionDiv,e.selection)},Se.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},Se.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Ze(this.div,t)},Se.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||pt(St(this.div))!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},Se.prototype.blur=function(){this.div.blur()},Se.prototype.getField=function(){return this.div},Se.prototype.supportsTouch=function(){return!0},Se.prototype.receivedFocus=function(){var e=this,t=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):xr(this.cm,function(){return t.cm.curOp.selectionChanged=!0});function A(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,A))}this.polling.set(this.cm.options.pollInterval,A)},Se.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},Se.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),t=this.cm;if(ce&&Z&&this.cm.display.gutterSpecs.length&&Fe(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var A=At(t,e.anchorNode,e.anchorOffset),r=At(t,e.focusNode,e.focusOffset);A&&r&&xr(t,function(){fr(t.doc,Xn(A,r),sr),(A.bad||r.bad)&&(t.curOp.selectionChanged=!0)})}}},Se.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,t=e.display,A=e.doc.sel.primary(),r=A.from(),n=A.to();if(r.ch==0&&r.line>e.firstLine()&&(r=Ge(r.line-1,Qt(e.doc,r.line-1).length)),n.ch==Qt(e.doc,n.line).text.length&&n.line<e.lastLine()&&(n=Ge(n.line+1,0)),r.line<t.viewFrom||n.line>t.viewTo-1)return!1;var s,u,c;r.line==t.viewFrom||(s=Rr(e,r.line))==0?(u=I(t.view[0].line),c=t.view[0].node):(u=I(t.view[s].line),c=t.view[s-1].node.nextSibling);var d=Rr(e,n.line),B,R;if(d==t.view.length-1?(B=t.viewTo-1,R=t.lineDiv.lastChild):(B=I(t.view[d+1].line)-1,R=t.view[d+1].node.previousSibling),!c)return!1;for(var te=e.doc.splitLines(tt(e,c,R,u,B)),se=cn(e.doc,Ge(u,0),Ge(B,Qt(e.doc,B).text.length));te.length>1&&se.length>1;)if(qt(te)==qt(se))te.pop(),se.pop(),B--;else if(te[0]==se[0])te.shift(),se.shift(),u++;else break;for(var Ae=0,fe=0,ke=te[0],He=se[0],Re=Math.min(ke.length,He.length);Ae<Re&&ke.charCodeAt(Ae)==He.charCodeAt(Ae);)++Ae;for(var Je=qt(te),$e=qt(se),et=Math.min(Je.length-(te.length==1?Ae:0),$e.length-(se.length==1?Ae:0));fe<et&&Je.charCodeAt(Je.length-fe-1)==$e.charCodeAt($e.length-fe-1);)++fe;if(te.length==1&&se.length==1&&u==r.line)for(;Ae&&Ae>r.ch&&Je.charCodeAt(Je.length-fe-1)==$e.charCodeAt($e.length-fe-1);)Ae--,fe++;te[te.length-1]=Je.slice(0,Je.length-fe).replace(/^\u200b+/,""),te[0]=te[0].slice(Ae).replace(/\u200b+$/,"");var ht=Ge(u,Ae),mt=Ge(B,se.length?qt(se).length-fe:0);if(te.length>1||te[0]||vt(ht,mt))return _n(e.doc,te,ht,mt,"+input"),!0},Se.prototype.ensurePolled=function(){this.forceCompositionEnd()},Se.prototype.reset=function(){this.forceCompositionEnd()},Se.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Se.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},Se.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&xr(this.cm,function(){return vr(e.cm)})},Se.prototype.setUneditable=function(e){e.contentEditable="false"},Se.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||lr(this.cm,Wo)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},Se.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},Se.prototype.onContextMenu=function(){},Se.prototype.resetPosition=function(){},Se.prototype.needsContentAttribute=!0;function qe(e,t){var A=po(e,t.line);if(!A||A.hidden)return null;var r=Qt(e.doc,t.line),n=fs(A,r,t.line),s=Xt(r,e.doc.direction),u="left";if(s){var c=ar(s,t.ch);u=c%2?"right":"left"}var d=ci(n.map,t.ch,u);return d.offset=d.collapse=="right"?d.end:d.start,d}function Fe(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function Me(e,t){return t&&(e.bad=!0),e}function tt(e,t,A,r,n){var s="",u=!1,c=e.doc.lineSeparator(),d=!1;function B(Ae){return function(fe){return fe.id==Ae}}function R(){u&&(s+=c,d&&(s+=c),u=d=!1)}function te(Ae){Ae&&(R(),s+=Ae)}function se(Ae){if(Ae.nodeType==1){var fe=Ae.getAttribute("cm-text");if(fe){te(fe);return}var ke=Ae.getAttribute("cm-marker"),He;if(ke){var Re=e.findMarks(Ge(r,0),Ge(n+1,0),B(+ke));Re.length&&(He=Re[0].find(0))&&te(cn(e.doc,He.from,He.to).join(c));return}if(Ae.getAttribute("contenteditable")=="false")return;var Je=/^(pre|div|p|li|table|br)$/i.test(Ae.nodeName);if(!/^br$/i.test(Ae.nodeName)&&Ae.textContent.length==0)return;Je&&R();for(var $e=0;$e<Ae.childNodes.length;$e++)se(Ae.childNodes[$e]);/^(pre|p)$/i.test(Ae.nodeName)&&(d=!0),Je&&(u=!0)}else Ae.nodeType==3&&te(Ae.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;se(t),t!=A;)t=t.nextSibling,d=!1;return s}function At(e,t,A){var r;if(t==e.display.lineDiv){if(r=e.display.lineDiv.childNodes[A],!r)return Me(e.clipPos(Ge(e.display.viewTo-1)),!0);t=null,A=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var n=0;n<e.display.view.length;n++){var s=e.display.view[n];if(s.node==r)return it(s,t,A)}}function it(e,t,A){var r=e.text.firstChild,n=!1;if(!t||!Ze(r,t))return Me(Ge(I(e.line),0),!0);if(t==r&&(n=!0,t=r.childNodes[A],A=0,!t)){var s=e.rest?qt(e.rest):e.line;return Me(Ge(I(s),s.text.length),n)}var u=t.nodeType==3?t:null,c=t;for(!u&&t.childNodes.length==1&&t.firstChild.nodeType==3&&(u=t.firstChild,A&&(A=u.nodeValue.length));c.parentNode!=r;)c=c.parentNode;var d=e.measure,B=d.maps;function R(He,Re,Je){for(var $e=-1;$e<(B?B.length:0);$e++)for(var et=$e<0?d.map:B[$e],ht=0;ht<et.length;ht+=3){var mt=et[ht+2];if(mt==He||mt==Re){var Pt=I($e<0?e.line:e.rest[$e]),xt=et[ht]+Je;return(Je<0||mt!=He)&&(xt=et[ht+(Je?1:0)]),Ge(Pt,xt)}}}var te=R(u,c,A);if(te)return Me(te,n);for(var se=c.nextSibling,Ae=u?u.nodeValue.length-A:0;se;se=se.nextSibling){if(te=R(se,se.firstChild,0),te)return Me(Ge(te.line,te.ch-Ae),n);Ae+=se.textContent.length}for(var fe=c.previousSibling,ke=A;fe;fe=fe.previousSibling){if(te=R(fe,fe.firstChild,-1),te)return Me(Ge(te.line,te.ch+ke),n);ke+=fe.textContent.length}}var Ye=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new NA,this.hasSelection=!1,this.composing=null,this.resetting=!1};Ye.prototype.init=function(e){var t=this,A=this,r=this.cm;this.createField(e);var n=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),q&&(n.style.width="0px"),kt(n,"input",function(){pe&&ue>=9&&t.hasSelection&&(t.hasSelection=null),A.poll()}),kt(n,"paste",function(u){KA(r,u)||js(u,r)||(r.state.pasteIncoming=+new Date,A.fastPoll())});function s(u){if(!KA(r,u)){if(r.somethingSelected())eo({lineWise:!1,text:r.getSelections()});else if(r.options.lineWiseCopyCut){var c=tu(r);eo({lineWise:!0,text:c.text}),u.type=="cut"?r.setSelections(c.ranges,null,sr):(A.prevInput="",n.value=c.text.join(`
`),yt(n))}else return;u.type=="cut"&&(r.state.cutIncoming=+new Date)}}kt(n,"cut",s),kt(n,"copy",s),kt(e.scroller,"paste",function(u){if(!(qr(e,u)||KA(r,u))){if(!n.dispatchEvent){r.state.pasteIncoming=+new Date,A.focus();return}var c=new Event("paste");c.clipboardData=u.clipboardData,n.dispatchEvent(c)}}),kt(e.lineSpace,"selectstart",function(u){qr(e,u)||WA(u)}),kt(n,"compositionstart",function(){var u=r.getCursor("from");A.composing&&A.composing.range.clear(),A.composing={start:u,range:r.markText(u,r.getCursor("to"),{className:"CodeMirror-composing"})}}),kt(n,"compositionend",function(){A.composing&&(A.poll(),A.composing.range.clear(),A.composing=null)})},Ye.prototype.createField=function(e){this.wrapper=Au(),this.textarea=this.wrapper.firstChild;var t=this.cm.options;qo(this.textarea,t.spellcheck,t.autocorrect,t.autocapitalize)},Ye.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Ye.prototype.prepareSelection=function(){var e=this.cm,t=e.display,A=e.doc,r=pi(e);if(e.options.moveInputWithCursor){var n=Pr(e,A.sel.primary().head,"div"),s=t.wrapper.getBoundingClientRect(),u=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,n.top+u.top-s.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,n.left+u.left-s.left))}return r},Ye.prototype.showSelection=function(e){var t=this.cm,A=t.display;U(A.cursorDiv,e.cursors),U(A.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Ye.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing&&e)){var t=this.cm;if(this.resetting=!0,t.somethingSelected()){this.prevInput="";var A=t.getSelection();this.textarea.value=A,t.state.focused&&yt(this.textarea),pe&&ue>=9&&(this.hasSelection=A)}else e||(this.prevInput=this.textarea.value="",pe&&ue>=9&&(this.hasSelection=null));this.resetting=!1}},Ye.prototype.getField=function(){return this.textarea},Ye.prototype.supportsTouch=function(){return!1},Ye.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!Q||pt(St(this.textarea))!=this.textarea))try{this.textarea.focus()}catch{}},Ye.prototype.blur=function(){this.textarea.blur()},Ye.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Ye.prototype.receivedFocus=function(){this.slowPoll()},Ye.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Ye.prototype.fastPoll=function(){var e=!1,t=this;t.pollingFast=!0;function A(){var r=t.poll();!r&&!e?(e=!0,t.polling.set(60,A)):(t.pollingFast=!1,t.slowPoll())}t.polling.set(20,A)},Ye.prototype.poll=function(){var e=this,t=this.cm,A=this.textarea,r=this.prevInput;if(this.contextMenuPending||this.resetting||!t.state.focused||On(A)&&!r&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var n=A.value;if(n==r&&!t.somethingSelected())return!1;if(pe&&ue>=9&&this.hasSelection===n||N&&/[\uf700-\uf7ff]/.test(n))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var s=n.charCodeAt(0);if(s==8203&&!r&&(r="​"),s==8666)return this.reset(),this.cm.execCommand("undo")}for(var u=0,c=Math.min(r.length,n.length);u<c&&r.charCodeAt(u)==n.charCodeAt(u);)++u;return xr(t,function(){Wo(t,n.slice(u),r.length-u,null,e.composing?"*compose":null),n.length>1e3||n.indexOf(`
`)>-1?A.value=e.prevInput="":e.prevInput=n,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Ye.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Ye.prototype.onKeyPress=function(){pe&&ue>=9&&(this.hasSelection=null),this.fastPoll()},Ye.prototype.onContextMenu=function(e){var t=this,A=t.cm,r=A.display,n=t.textarea;t.contextMenuPending&&t.contextMenuPending();var s=cr(A,e),u=r.scroller.scrollTop;if(!s||we)return;var c=A.options.resetSelectionOnContextMenu;c&&A.doc.sel.contains(s)==-1&&lr(A,fr)(A.doc,Xn(s),sr);var d=n.style.cssText,B=t.wrapper.style.cssText,R=t.wrapper.offsetParent.getBoundingClientRect();t.wrapper.style.cssText="position: static",n.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-R.top-5)+"px; left: "+(e.clientX-R.left-5)+`px;
      z-index: 1000; background: `+(pe?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var te;j&&(te=n.ownerDocument.defaultView.scrollY),r.input.focus(),j&&n.ownerDocument.defaultView.scrollTo(null,te),r.input.reset(),A.somethingSelected()||(n.value=t.prevInput=" "),t.contextMenuPending=Ae,r.selForContextMenu=A.doc.sel,clearTimeout(r.detectingSelectAll);function se(){if(n.selectionStart!=null){var ke=A.somethingSelected(),He="​"+(ke?n.value:"");n.value="⇚",n.value=He,t.prevInput=ke?"":"​",n.selectionStart=1,n.selectionEnd=He.length,r.selForContextMenu=A.doc.sel}}function Ae(){if(t.contextMenuPending==Ae&&(t.contextMenuPending=!1,t.wrapper.style.cssText=B,n.style.cssText=d,pe&&ue<9&&r.scrollbars.setScrollTop(r.scroller.scrollTop=u),n.selectionStart!=null)){(!pe||pe&&ue<9)&&se();var ke=0,He=function(){r.selForContextMenu==A.doc.sel&&n.selectionStart==0&&n.selectionEnd>0&&t.prevInput=="​"?lr(A,Hs)(A):ke++<10?r.detectingSelectAll=setTimeout(He,500):(r.selForContextMenu=null,r.input.reset())};r.detectingSelectAll=setTimeout(He,200)}}if(pe&&ue>=9&&se(),nt){Mn(e);var fe=function(){dr(window,"mouseup",fe),setTimeout(Ae,20)};kt(window,"mouseup",fe)}else setTimeout(Ae,50)},Ye.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},Ye.prototype.setUneditable=function(){},Ye.prototype.needsContentAttribute=!1;function lt(e,t){if(t=t?Lt(t):{},t.value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),t.autofocus==null){var A=pt(St(e));t.autofocus=A==e||e.getAttribute("autofocus")!=null&&A==document.body}function r(){e.value=c.getValue()}var n;if(e.form&&(kt(e.form,"submit",r),!t.leaveSubmitMethodAlone)){var s=e.form;n=s.submit;try{var u=s.submit=function(){r(),s.submit=n,s.submit(),s.submit=u}}catch{}}t.finishInit=function(d){d.save=r,d.getTextArea=function(){return e},d.toTextArea=function(){d.toTextArea=isNaN,r(),e.parentNode.removeChild(d.getWrapperElement()),e.style.display="",e.form&&(dr(e.form,"submit",r),!t.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=n))}},e.style.display="none";var c=jA(function(d){return e.parentNode.insertBefore(d,e.nextSibling)},t);return c}function ft(e){e.off=dr,e.on=kt,e.wheelEventPixels=ji,e.Doc=yr,e.splitLines=rA,e.countColumn=Wt,e.findColumn=ZA,e.isWordChar=ha,e.Pass=JA,e.signal=er,e.Line=tn,e.changeEnd=xn,e.scrollbarModel=Mr,e.Pos=Ge,e.cmpPos=vt,e.modes=Pi,e.mimeModes=Hr,e.resolveMode=Ii,e.getMode=ki,e.modeExtensions=Nn,e.extendMode=Li,e.copyState=Zr,e.startState=Fi,e.innerMode=ga,e.commands=ti,e.keyMap=Tn,e.keyName=qa,e.isModifierKey=za,e.lookupKey=ei,e.normalizeKeyMap=Ou,e.StringStream=tr,e.SharedTextMarker=wi,e.TextMarker=Or,e.LineWidget=Xr,e.e_preventDefault=WA,e.e_stopPropagation=Qi,e.e_stop=Mn,e.addClass=gt,e.contains=Ze,e.rmClass=st,e.keyNames=Zn}Gu(jA),E(jA);var rt="iter insert remove copy getEditor constructor".split(" ");for(var ot in yr.prototype)yr.prototype.hasOwnProperty(ot)&&Tt(rt,ot)<0&&(jA.prototype[ot]=function(e){return function(){return e.apply(this.doc,arguments)}}(yr.prototype[ot]));return Nr(yr),jA.inputStyles={textarea:Ye,contenteditable:Se},jA.defineMode=function(e){!jA.defaults.mode&&e!="null"&&(jA.defaults.mode=e),zr.apply(this,arguments)},jA.defineMIME=ai,jA.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),jA.defineMIME("text/plain","null"),jA.defineExtension=function(e,t){jA.prototype[e]=t},jA.defineDocExtension=function(e,t){yr.prototype[e]=t},jA.fromTextArea=lt,ft(jA),jA.version="5.65.19",jA})}(codemirror$1)),codemirror$1.exports}var codemirrorExports=requireCodemirror();const CodeMirror=getDefaultExportFromCjs(codemirrorExports);var javascript={exports:{}},hasRequiredJavascript;function requireJavascript(){return hasRequiredJavascript||(hasRequiredJavascript=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){o.defineMode("javascript",function(l,f){var m=l.indentUnit,D=f.statementIndent,F=f.jsonld,pe=f.json||F,ue=f.trackScope!==!1,j=f.typescript,xe=f.wordCharacters||/[\w$\xa1-\uffff]/,Z=function(){function I(Ar){return{type:Ar,style:"keyword"}}var ge=I("keyword a"),je=I("keyword b"),ut=I("keyword c"),Ge=I("keyword d"),vt=I("operator"),HA={type:"atom",style:"atom"};return{if:I("if"),while:ge,with:ge,else:je,do:je,try:je,finally:je,return:Ge,break:Ge,continue:Ge,new:I("new"),delete:ut,void:ut,throw:ut,debugger:I("debugger"),var:I("var"),const:I("var"),let:I("var"),function:I("function"),catch:I("catch"),for:I("for"),switch:I("switch"),case:I("case"),default:I("default"),in:vt,typeof:vt,instanceof:vt,true:HA,false:HA,null:HA,undefined:HA,NaN:HA,Infinity:HA,this:I("this"),class:I("class"),super:I("atom"),yield:ut,export:I("export"),import:I("import"),extends:ut,await:ut}}(),Ee=/[+\-*&%=<>!?|~^@]/,we=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function Oe(I){for(var ge=!1,je,ut=!1;(je=I.next())!=null;){if(!ge){if(je=="/"&&!ut)return;je=="["?ut=!0:ut&&je=="]"&&(ut=!1)}ge=!ge&&je=="\\"}}var Ke,le;function q(I,ge,je){return Ke=I,le=je,ge}function ce(I,ge){var je=I.next();if(je=='"'||je=="'")return ge.tokenize=Q(je),ge.tokenize(I,ge);if(je=="."&&I.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return q("number","number");if(je=="."&&I.match(".."))return q("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(je))return q(je);if(je=="="&&I.eat(">"))return q("=>","operator");if(je=="0"&&I.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return q("number","number");if(/\d/.test(je))return I.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),q("number","number");if(je=="/")return I.eat("*")?(ge.tokenize=N,N(I,ge)):I.eat("/")?(I.skipToEnd(),q("comment","comment")):Tr(I,ge,1)?(Oe(I),I.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),q("regexp","string-2")):(I.eat("="),q("operator","operator",I.current()));if(je=="`")return ge.tokenize=oe,oe(I,ge);if(je=="#"&&I.peek()=="!")return I.skipToEnd(),q("meta","meta");if(je=="#"&&I.eatWhile(xe))return q("variable","property");if(je=="<"&&I.match("!--")||je=="-"&&I.match("->")&&!/\S/.test(I.string.slice(0,I.start)))return I.skipToEnd(),q("comment","comment");if(Ee.test(je))return(je!=">"||!ge.lexical||ge.lexical.type!=">")&&(I.eat("=")?(je=="!"||je=="=")&&I.eat("="):/[<>*+\-|&?]/.test(je)&&(I.eat(je),je==">"&&I.eat(je))),je=="?"&&I.eat(".")?q("."):q("operator","operator",I.current());if(xe.test(je)){I.eatWhile(xe);var ut=I.current();if(ge.lastType!="."){if(Z.propertyIsEnumerable(ut)){var Ge=Z[ut];return q(Ge.type,Ge.style,ut)}if(ut=="async"&&I.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return q("async","keyword",ut)}return q("variable","variable",ut)}}function Q(I){return function(ge,je){var ut=!1,Ge;if(F&&ge.peek()=="@"&&ge.match(we))return je.tokenize=ce,q("jsonld-keyword","meta");for(;(Ge=ge.next())!=null&&!(Ge==I&&!ut);)ut=!ut&&Ge=="\\";return ut||(je.tokenize=ce),q("string","string")}}function N(I,ge){for(var je=!1,ut;ut=I.next();){if(ut=="/"&&je){ge.tokenize=ce;break}je=ut=="*"}return q("comment","comment")}function oe(I,ge){for(var je=!1,ut;(ut=I.next())!=null;){if(!je&&(ut=="`"||ut=="$"&&I.eat("{"))){ge.tokenize=ce;break}je=!je&&ut=="\\"}return q("quasi","string-2",I.current())}var de="([{}])";function Te(I,ge){ge.fatArrowAt&&(ge.fatArrowAt=null);var je=I.string.indexOf("=>",I.start);if(!(je<0)){if(j){var ut=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(I.string.slice(I.start,je));ut&&(je=ut.index)}for(var Ge=0,vt=!1,HA=je-1;HA>=0;--HA){var Ar=I.string.charAt(HA),gr=de.indexOf(Ar);if(gr>=0&&gr<3){if(!Ge){++HA;break}if(--Ge==0){Ar=="("&&(vt=!0);break}}else if(gr>=3&&gr<6)++Ge;else if(xe.test(Ar))vt=!0;else if(/["'\/`]/.test(Ar))for(;;--HA){if(HA==0)return;var Ri=I.string.charAt(HA-1);if(Ri==Ar&&I.string.charAt(HA-2)!="\\"){HA--;break}}else if(vt&&!Ge){++HA;break}}vt&&!Ge&&(ge.fatArrowAt=HA)}}var ze={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function nt(I,ge,je,ut,Ge,vt){this.indented=I,this.column=ge,this.type=je,this.prev=Ge,this.info=vt,ut!=null&&(this.align=ut)}function Ve(I,ge){if(!ue)return!1;for(var je=I.localVars;je;je=je.next)if(je.name==ge)return!0;for(var ut=I.context;ut;ut=ut.prev)for(var je=ut.vars;je;je=je.next)if(je.name==ge)return!0}function st(I,ge,je,ut,Ge){var vt=I.cc;for(G.state=I,G.stream=Ge,G.marked=null,G.cc=vt,G.style=ge,I.lexical.hasOwnProperty("align")||(I.lexical.align=!0);;){var HA=vt.length?vt.pop():pe?Tt:Wt;if(HA(je,ut)){for(;vt.length&&vt[vt.length-1].lex;)vt.pop()();return G.marked?G.marked:je=="variable"&&Ve(I,ut)?"variable-2":ge}}}var G={state:null,marked:null,cc:null};function U(){for(var I=arguments.length-1;I>=0;I--)G.cc.push(arguments[I])}function T(){return U.apply(null,arguments),!0}function Be(I,ge){for(var je=ge;je;je=je.next)if(je.name==I)return!0;return!1}function Ne(I){var ge=G.state;if(G.marked="def",!!ue){if(ge.context){if(ge.lexical.info=="var"&&ge.context&&ge.context.block){var je=Ze(I,ge.context);if(je!=null){ge.context=je;return}}else if(!Be(I,ge.localVars)){ge.localVars=new dt(I,ge.localVars);return}}f.globalVars&&!Be(I,ge.globalVars)&&(ge.globalVars=new dt(I,ge.globalVars))}}function Ze(I,ge){if(ge)if(ge.block){var je=Ze(I,ge.prev);return je?je==ge.prev?ge:new gt(je,ge.vars,!0):null}else return Be(I,ge.vars)?ge:new gt(ge.prev,new dt(I,ge.vars),!1);else return null}function pt(I){return I=="public"||I=="private"||I=="protected"||I=="abstract"||I=="readonly"}function gt(I,ge,je){this.prev=I,this.vars=ge,this.block=je}function dt(I,ge){this.name=I,this.next=ge}var yt=new dt("this",new dt("arguments",null));function wt(){G.state.context=new gt(G.state.context,G.state.localVars,!1),G.state.localVars=yt}function jt(){G.state.context=new gt(G.state.context,G.state.localVars,!0),G.state.localVars=null}wt.lex=jt.lex=!0;function St(){G.state.localVars=G.state.context.vars,G.state.context=G.state.context.prev}St.lex=!0;function Dt(I,ge){var je=function(){var ut=G.state,Ge=ut.indented;if(ut.lexical.type=="stat")Ge=ut.lexical.indented;else for(var vt=ut.lexical;vt&&vt.type==")"&&vt.align;vt=vt.prev)Ge=vt.indented;ut.lexical=new nt(Ge,G.stream.column(),I,null,ut.lexical,ge)};return je.lex=!0,je}function bt(){var I=G.state;I.lexical.prev&&(I.lexical.type==")"&&(I.indented=I.lexical.indented),I.lexical=I.lexical.prev)}bt.lex=!0;function Lt(I){function ge(je){return je==I?T():I==";"||je=="}"||je==")"||je=="]"?U():T(ge)}return ge}function Wt(I,ge){return I=="var"?T(Dt("vardef",ge),Qi,Lt(";"),bt):I=="keyword a"?T(Dt("form"),JA,Wt,bt):I=="keyword b"?T(Dt("form"),Wt,bt):I=="keyword d"?G.stream.match(/^\s*$/,!1)?T():T(Dt("stat"),Cr,Lt(";"),bt):I=="debugger"?T(Lt(";")):I=="{"?T(Dt("}"),jt,Jr,bt,St):I==";"?T():I=="if"?(G.state.lexical.info=="else"&&G.state.cc[G.state.cc.length-1]==bt&&G.state.cc.pop()(),T(Dt("form"),JA,Wt,bt,Ti)):I=="function"?T(rA):I=="for"?T(Dt("form"),jt,ro,Wt,St,bt):I=="class"||j&&ge=="interface"?(G.marked="keyword",T(Dt("form",I=="class"?I:ge),Pi,bt)):I=="variable"?j&&ge=="declare"?(G.marked="keyword",T(Wt)):j&&(ge=="module"||ge=="enum"||ge=="type")&&G.stream.match(/^\s*\w/,!1)?(G.marked="keyword",ge=="enum"?T(Qt):ge=="type"?T(no,Lt("operator"),Xt,Lt(";")):T(Dt("form"),Er,Lt("{"),Dt("}"),Jr,bt,bt)):j&&ge=="namespace"?(G.marked="keyword",T(Dt("form"),Tt,Wt,bt)):j&&ge=="abstract"?(G.marked="keyword",T(Wt)):T(Dt("stat"),Yo):I=="switch"?T(Dt("form"),JA,Lt("{"),Dt("}","switch"),jt,Jr,bt,bt,St):I=="case"?T(Tt,Lt(":")):I=="default"?T(Lt(":")):I=="catch"?T(Dt("form"),wt,NA,Wt,bt,St):I=="export"?T(Dt("stat"),Ii,bt):I=="import"?T(Dt("stat"),Nn,bt):I=="async"?T(Wt):ge=="@"?T(Tt,Wt):U(Dt("stat"),Tt,Lt(";"),bt)}function NA(I){if(I=="(")return T(Ur,Lt(")"))}function Tt(I,ge){return sr(I,ge,!1)}function Jt(I,ge){return sr(I,ge,!0)}function JA(I){return I!="("?U():T(Dt(")"),Cr,Lt(")"),bt)}function sr(I,ge,je){if(G.state.fatArrowAt==G.stream.start){var ut=je?ii:qt;if(I=="(")return T(wt,Dt(")"),XA(Ur,")"),bt,Lt("=>"),ut,St);if(I=="variable")return U(wt,Er,Lt("=>"),ut,St)}var Ge=je?ZA:hr;return ze.hasOwnProperty(I)?T(Ge):I=="function"?T(rA,Ge):I=="class"||j&&ge=="interface"?(G.marked="keyword",T(Dt("form"),Vo,bt)):I=="keyword c"||I=="async"?T(je?Jt:Tt):I=="("?T(Dt(")"),Cr,Lt(")"),bt,Ge):I=="operator"||I=="spread"?T(je?Jt:Tt):I=="["?T(Dt("]"),tr,bt,Ge):I=="{"?ln(sn,"}",null,Ge):I=="quasi"?U(AA,Ge):I=="new"?T($o(je)):T()}function Cr(I){return I.match(/[;\}\)\],]/)?U():U(Tt)}function hr(I,ge){return I==","?T(Cr):ZA(I,ge,!1)}function ZA(I,ge,je){var ut=je==!1?hr:ZA,Ge=je==!1?Tt:Jt;if(I=="=>")return T(wt,je?ii:qt,St);if(I=="operator")return/\+\+|--/.test(ge)||j&&ge=="!"?T(ut):j&&ge=="<"&&G.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?T(Dt(">"),XA(Xt,">"),bt,ut):ge=="?"?T(Tt,Lt(":"),Ge):T(Ge);if(I=="quasi")return U(AA,ut);if(I!=";"){if(I=="(")return ln(Jt,")","call",ut);if(I==".")return T(ha,ut);if(I=="[")return T(Dt("]"),Cr,Lt("]"),bt,ut);if(j&&ge=="as")return G.marked="keyword",T(Xt,ut);if(I=="regexp")return G.state.lastType=G.marked="operator",G.stream.backUp(G.stream.pos-G.stream.start-1),T(Ge)}}function AA(I,ge){return I!="quasi"?U():ge.slice(ge.length-2)!="${"?T(AA):T(Cr,on)}function on(I){if(I=="}")return G.marked="string-2",G.state.tokenize=oe,T(AA)}function qt(I){return Te(G.stream,G.state),U(I=="{"?Wt:Tt)}function ii(I){return Te(G.stream,G.state),U(I=="{"?Wt:Jt)}function $o(I){return function(ge){return ge=="."?T(I?to:re):ge=="variable"&&j?T(wr,I?ZA:hr):U(I?Jt:Tt)}}function re(I,ge){if(ge=="target")return G.marked="keyword",T(hr)}function to(I,ge){if(ge=="target")return G.marked="keyword",T(ZA)}function Yo(I){return I==":"?T(bt,Wt):U(hr,Lt(";"),bt)}function ha(I){if(I=="variable")return G.marked="property",T()}function sn(I,ge){if(I=="async")return G.marked="property",T(sn);if(I=="variable"||G.style=="keyword"){if(G.marked="property",ge=="get"||ge=="set")return T(jr);var je;return j&&G.state.fatArrowAt==G.stream.start&&(je=G.stream.match(/^\s*:\s*/,!1))&&(G.state.fatArrowAt=G.stream.pos+je[0].length),T(Kr)}else{if(I=="number"||I=="string")return G.marked=F?"property":G.style+" property",T(Kr);if(I=="jsonld-keyword")return T(Kr);if(j&&pt(ge))return G.marked="keyword",T(sn);if(I=="[")return T(Tt,Fn,Lt("]"),Kr);if(I=="spread")return T(Jt,Kr);if(ge=="*")return G.marked="keyword",T(sn);if(I==":")return U(Kr)}}function jr(I){return I!="variable"?U(Kr):(G.marked="property",T(rA))}function Kr(I){if(I==":")return T(Jt);if(I=="(")return U(rA)}function XA(I,ge,je){function ut(Ge,vt){if(je?je.indexOf(Ge)>-1:Ge==","){var HA=G.state.lexical;return HA.info=="call"&&(HA.pos=(HA.pos||0)+1),T(function(Ar,gr){return Ar==ge||gr==ge?U():U(I)},ut)}return Ge==ge||vt==ge?T():je&&je.indexOf(";")>-1?U(I):T(Lt(ge))}return function(Ge,vt){return Ge==ge||vt==ge?T():U(I,ut)}}function ln(I,ge,je){for(var ut=3;ut<arguments.length;ut++)G.cc.push(arguments[ut]);return T(Dt(ge,je),XA(I,ge),bt)}function Jr(I){return I=="}"?T():U(Wt,Jr)}function Fn(I,ge){if(j){if(I==":")return T(Xt);if(ge=="?")return T(Fn)}}function Rn(I,ge){if(j&&(I==":"||ge=="in"))return T(Xt)}function ar(I){if(j&&I==":")return G.stream.match(/^\s*\w+\s+is\b/,!1)?T(Tt,da,Xt):T(Xt)}function da(I,ge){if(ge=="is")return G.marked="keyword",T()}function Xt(I,ge){if(ge=="keyof"||ge=="typeof"||ge=="infer"||ge=="readonly")return G.marked="keyword",T(ge=="typeof"?Jt:Xt);if(I=="variable"||ge=="void")return G.marked="type",T(Qr);if(ge=="|"||ge=="&")return T(Xt);if(I=="string"||I=="number"||I=="atom")return T(Qr);if(I=="[")return T(Dt("]"),XA(Xt,"]",","),bt,Qr);if(I=="{")return T(Dt("}"),kt,bt,Qr);if(I=="(")return T(XA(KA,")"),Ao,Qr);if(I=="<")return T(XA(Xt,">"),Xt);if(I=="quasi")return U(dr,Qr)}function Ao(I){if(I=="=>")return T(Xt)}function kt(I){return I.match(/[\}\)\]]/)?T():I==","||I==";"?T(kt):U(un,kt)}function un(I,ge){if(I=="variable"||G.style=="keyword")return G.marked="property",T(un);if(ge=="?"||I=="number"||I=="string")return T(un);if(I==":")return T(Xt);if(I=="[")return T(Lt("variable"),Rn,Lt("]"),un);if(I=="(")return U(On,un);if(!I.match(/[;\}\)\],]/))return T()}function dr(I,ge){return I!="quasi"?U():ge.slice(ge.length-2)!="${"?T(dr):T(Xt,er)}function er(I){if(I=="}")return G.marked="string-2",G.state.tokenize=oe,T(dr)}function KA(I,ge){return I=="variable"&&G.stream.match(/^\s*[?:]/,!1)||ge=="?"?T(KA):I==":"?T(Xt):I=="spread"?T(KA):U(Xt)}function Qr(I,ge){if(ge=="<")return T(Dt(">"),XA(Xt,">"),bt,Qr);if(ge=="|"||I=="."||ge=="&")return T(Xt);if(I=="[")return T(Xt,Lt("]"),Qr);if(ge=="extends"||ge=="implements")return G.marked="keyword",T(Xt);if(ge=="?")return T(Xt,Lt(":"),Xt)}function wr(I,ge){if(ge=="<")return T(Dt(">"),XA(Xt,">"),bt,Qr)}function Nr(){return U(Xt,WA)}function WA(I,ge){if(ge=="=")return T(Xt)}function Qi(I,ge){return ge=="enum"?(G.marked="keyword",T(Qt)):U(Er,Fn,Gr,Xo)}function Er(I,ge){if(j&&pt(ge))return G.marked="keyword",T(Er);if(I=="variable")return Ne(ge),T();if(I=="spread")return T(Er);if(I=="[")return ln(pa,"]");if(I=="{")return ln(Mn,"}")}function Mn(I,ge){return I=="variable"&&!G.stream.match(/^\s*:/,!1)?(Ne(ge),T(Gr)):(I=="variable"&&(G.marked="property"),I=="spread"?T(Er):I=="}"?U():I=="["?T(Tt,Lt("]"),Lt(":"),Mn):T(Lt(":"),Er,Gr))}function pa(){return U(Er,Gr)}function Gr(I,ge){if(ge=="=")return T(Jt)}function Xo(I){if(I==",")return T(Qi)}function Ti(I,ge){if(I=="keyword b"&&ge=="else")return T(Dt("form","else"),Wt,bt)}function ro(I,ge){if(ge=="await")return T(ro);if(I=="(")return T(Dt(")"),Di,bt)}function Di(I){return I=="var"?T(Qi,fn):I=="variable"?T(fn):U(fn)}function fn(I,ge){return I==")"?T():I==";"?T(fn):ge=="in"||ge=="of"?(G.marked="keyword",T(Tt,fn)):U(Tt,fn)}function rA(I,ge){if(ge=="*")return G.marked="keyword",T(rA);if(I=="variable")return Ne(ge),T(rA);if(I=="(")return T(wt,Dt(")"),XA(Ur,")"),bt,ar,Wt,St);if(j&&ge=="<")return T(Dt(">"),XA(Nr,">"),bt,rA)}function On(I,ge){if(ge=="*")return G.marked="keyword",T(On);if(I=="variable")return Ne(ge),T(On);if(I=="(")return T(wt,Dt(")"),XA(Ur,")"),bt,ar,St);if(j&&ge=="<")return T(Dt(">"),XA(Nr,">"),bt,On)}function no(I,ge){if(I=="keyword"||I=="variable")return G.marked="type",T(no);if(ge=="<")return T(Dt(">"),XA(Nr,">"),bt)}function Ur(I,ge){return ge=="@"&&T(Tt,Ur),I=="spread"?T(Ur):j&&pt(ge)?(G.marked="keyword",T(Ur)):j&&I=="this"?T(Fn,Gr):U(Er,Fn,Gr)}function Vo(I,ge){return I=="variable"?Pi(I,ge):Hr(I,ge)}function Pi(I,ge){if(I=="variable")return Ne(ge),T(Hr)}function Hr(I,ge){if(ge=="<")return T(Dt(">"),XA(Nr,">"),bt,Hr);if(ge=="extends"||ge=="implements"||j&&I==",")return ge=="implements"&&(G.marked="keyword"),T(j?Xt:Tt,Hr);if(I=="{")return T(Dt("}"),zr,bt)}function zr(I,ge){if(I=="async"||I=="variable"&&(ge=="static"||ge=="get"||ge=="set"||j&&pt(ge))&&G.stream.match(/^\s+#?[\w$\xa1-\uffff]/,!1))return G.marked="keyword",T(zr);if(I=="variable"||G.style=="keyword")return G.marked="property",T(ai,zr);if(I=="number"||I=="string")return T(ai,zr);if(I=="[")return T(Tt,Fn,Lt("]"),ai,zr);if(ge=="*")return G.marked="keyword",T(zr);if(j&&I=="(")return U(On,zr);if(I==";"||I==",")return T(zr);if(I=="}")return T();if(ge=="@")return T(Tt,zr)}function ai(I,ge){if(ge=="!"||ge=="?")return T(ai);if(I==":")return T(Xt,Gr);if(ge=="=")return T(Jt);var je=G.state.lexical.prev,ut=je&&je.info=="interface";return U(ut?On:rA)}function Ii(I,ge){return ge=="*"?(G.marked="keyword",T(Fi,Lt(";"))):ge=="default"?(G.marked="keyword",T(Tt,Lt(";"))):I=="{"?T(XA(ki,"}"),Fi,Lt(";")):U(Wt)}function ki(I,ge){if(ge=="as")return G.marked="keyword",T(Lt("variable"));if(I=="variable")return U(Jt,ki)}function Nn(I){return I=="string"?T():I=="("?U(Tt):I=="."?U(hr):U(Li,Zr,Fi)}function Li(I,ge){return I=="{"?ln(Li,"}"):(I=="variable"&&Ne(ge),ge=="*"&&(G.marked="keyword"),T(ga))}function Zr(I){if(I==",")return T(Li,Zr)}function ga(I,ge){if(ge=="as")return G.marked="keyword",T(Li)}function Fi(I,ge){if(ge=="from")return G.marked="keyword",T(Tt)}function tr(I){return I=="]"?T():U(XA(Jt,"]"))}function Qt(){return U(Dt("form"),Er,Lt("{"),Dt("}"),XA(cn,"}"),bt,bt)}function cn(){return U(Er,Gr)}function va(I,ge){return I.lastType=="operator"||I.lastType==","||Ee.test(ge.charAt(0))||/[,.]/.test(ge.charAt(0))}function Tr(I,ge,je){return ge.tokenize==ce&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(ge.lastType)||ge.lastType=="quasi"&&/\{\s*$/.test(I.string.slice(0,I.pos-(je||0)))}return{startState:function(I){var ge={tokenize:ce,lastType:"sof",cc:[],lexical:new nt((I||0)-m,0,"block",!1),localVars:f.localVars,context:f.localVars&&new gt(null,null,!1),indented:I||0};return f.globalVars&&typeof f.globalVars=="object"&&(ge.globalVars=f.globalVars),ge},token:function(I,ge){if(I.sol()&&(ge.lexical.hasOwnProperty("align")||(ge.lexical.align=!1),ge.indented=I.indentation(),Te(I,ge)),ge.tokenize!=N&&I.eatSpace())return null;var je=ge.tokenize(I,ge);return Ke=="comment"?je:(ge.lastType=Ke=="operator"&&(le=="++"||le=="--")?"incdec":Ke,st(ge,je,Ke,le,I))},indent:function(I,ge){if(I.tokenize==N||I.tokenize==oe)return o.Pass;if(I.tokenize!=ce)return 0;var je=ge&&ge.charAt(0),ut=I.lexical,Ge;if(!/^\s*else\b/.test(ge))for(var vt=I.cc.length-1;vt>=0;--vt){var HA=I.cc[vt];if(HA==bt)ut=ut.prev;else if(HA!=Ti&&HA!=St)break}for(;(ut.type=="stat"||ut.type=="form")&&(je=="}"||(Ge=I.cc[I.cc.length-1])&&(Ge==hr||Ge==ZA)&&!/^[,\.=+\-*:?[\(]/.test(ge));)ut=ut.prev;D&&ut.type==")"&&ut.prev.type=="stat"&&(ut=ut.prev);var Ar=ut.type,gr=je==Ar;return Ar=="vardef"?ut.indented+(I.lastType=="operator"||I.lastType==","?ut.info.length+1:0):Ar=="form"&&je=="{"?ut.indented:Ar=="form"?ut.indented+m:Ar=="stat"?ut.indented+(va(I,ge)?D||m:0):ut.info=="switch"&&!gr&&f.doubleIndentSwitch!=!1?ut.indented+(/^(?:case|default)\b/.test(ge)?m:2*m):ut.align?ut.column+(gr?0:1):ut.indented+(gr?0:m)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:pe?null:"/*",blockCommentEnd:pe?null:"*/",blockCommentContinue:pe?null:" * ",lineComment:pe?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:pe?"json":"javascript",jsonldMode:F,jsonMode:pe,expressionAllowed:Tr,skipExpression:function(I){st(I,"atom","atom","true",new o.StringStream("",2,null))}}}),o.registerHelper("wordChars","javascript",/[\w$]/),o.defineMIME("text/javascript","javascript"),o.defineMIME("text/ecmascript","javascript"),o.defineMIME("application/javascript","javascript"),o.defineMIME("application/x-javascript","javascript"),o.defineMIME("application/ecmascript","javascript"),o.defineMIME("application/json",{name:"javascript",json:!0}),o.defineMIME("application/x-json",{name:"javascript",json:!0}),o.defineMIME("application/manifest+json",{name:"javascript",json:!0}),o.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),o.defineMIME("text/typescript",{name:"javascript",typescript:!0}),o.defineMIME("application/typescript",{name:"javascript",typescript:!0})})}()),javascript.exports}requireJavascript();var dialog={exports:{}},hasRequiredDialog;function requireDialog(){return hasRequiredDialog||(hasRequiredDialog=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){function l(m,D,F){var pe=m.getWrapperElement(),ue;return ue=pe.appendChild(document.createElement("div")),F?ue.className="CodeMirror-dialog CodeMirror-dialog-bottom":ue.className="CodeMirror-dialog CodeMirror-dialog-top",typeof D=="string"?ue.innerHTML=D:ue.appendChild(D),o.addClass(pe,"dialog-opened"),ue}function f(m,D){m.state.currentNotificationClose&&m.state.currentNotificationClose(),m.state.currentNotificationClose=D}o.defineExtension("openDialog",function(m,D,F){F||(F={}),f(this,null);var pe=l(this,m,F.bottom),ue=!1,j=this;function xe(we){if(typeof we=="string")Z.value=we;else{if(ue)return;ue=!0,o.rmClass(pe.parentNode,"dialog-opened"),pe.parentNode.removeChild(pe),j.focus(),F.onClose&&F.onClose(pe)}}var Z=pe.getElementsByTagName("input")[0],Ee;return Z?(Z.focus(),F.value&&(Z.value=F.value,F.selectValueOnOpen!==!1&&Z.select()),F.onInput&&o.on(Z,"input",function(we){F.onInput(we,Z.value,xe)}),F.onKeyUp&&o.on(Z,"keyup",function(we){F.onKeyUp(we,Z.value,xe)}),o.on(Z,"keydown",function(we){F&&F.onKeyDown&&F.onKeyDown(we,Z.value,xe)||((we.keyCode==27||F.closeOnEnter!==!1&&we.keyCode==13)&&(Z.blur(),o.e_stop(we),xe()),we.keyCode==13&&D(Z.value,we))}),F.closeOnBlur!==!1&&o.on(pe,"focusout",function(we){we.relatedTarget!==null&&xe()})):(Ee=pe.getElementsByTagName("button")[0])&&(o.on(Ee,"click",function(){xe(),j.focus()}),F.closeOnBlur!==!1&&o.on(Ee,"blur",xe),Ee.focus()),xe}),o.defineExtension("openConfirm",function(m,D,F){f(this,null);var pe=l(this,m,F&&F.bottom),ue=pe.getElementsByTagName("button"),j=!1,xe=this,Z=1;function Ee(){j||(j=!0,o.rmClass(pe.parentNode,"dialog-opened"),pe.parentNode.removeChild(pe),xe.focus())}ue[0].focus();for(var we=0;we<ue.length;++we){var Oe=ue[we];(function(Ke){o.on(Oe,"click",function(le){o.e_preventDefault(le),Ee(),Ke&&Ke(xe)})})(D[we]),o.on(Oe,"blur",function(){--Z,setTimeout(function(){Z<=0&&Ee()},200)}),o.on(Oe,"focus",function(){++Z})}}),o.defineExtension("openNotification",function(m,D){f(this,xe);var F=l(this,m,D&&D.bottom),pe=!1,ue,j=D&&typeof D.duration<"u"?D.duration:5e3;function xe(){pe||(pe=!0,clearTimeout(ue),o.rmClass(F.parentNode,"dialog-opened"),F.parentNode.removeChild(F))}return o.on(F,"click",function(Z){o.e_preventDefault(Z),xe()}),j&&(ue=setTimeout(xe,j)),xe})})}()),dialog.exports}requireDialog();var sublime={exports:{}},searchcursor={exports:{}},hasRequiredSearchcursor;function requireSearchcursor(){return hasRequiredSearchcursor||(hasRequiredSearchcursor=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){var l=o.Pos;function f(q){var ce=q.flags;return ce??(q.ignoreCase?"i":"")+(q.global?"g":"")+(q.multiline?"m":"")}function m(q,ce){for(var Q=f(q),N=Q,oe=0;oe<ce.length;oe++)N.indexOf(ce.charAt(oe))==-1&&(N+=ce.charAt(oe));return Q==N?q:new RegExp(q.source,N)}function D(q){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(q.source)}function F(q,ce,Q){ce=m(ce,"g");for(var N=Q.line,oe=Q.ch,de=q.lastLine();N<=de;N++,oe=0){ce.lastIndex=oe;var Te=q.getLine(N),ze=ce.exec(Te);if(ze)return{from:l(N,ze.index),to:l(N,ze.index+ze[0].length),match:ze}}}function pe(q,ce,Q){if(!D(ce))return F(q,ce,Q);ce=m(ce,"gm");for(var N,oe=1,de=Q.line,Te=q.lastLine();de<=Te;){for(var ze=0;ze<oe&&!(de>Te);ze++){var nt=q.getLine(de++);N=N==null?nt:N+`
`+nt}oe=oe*2,ce.lastIndex=Q.ch;var Ve=ce.exec(N);if(Ve){var st=N.slice(0,Ve.index).split(`
`),G=Ve[0].split(`
`),U=Q.line+st.length-1,T=st[st.length-1].length;return{from:l(U,T),to:l(U+G.length-1,G.length==1?T+G[0].length:G[G.length-1].length),match:Ve}}}}function ue(q,ce,Q){for(var N,oe=0;oe<=q.length;){ce.lastIndex=oe;var de=ce.exec(q);if(!de)break;var Te=de.index+de[0].length;if(Te>q.length-Q)break;(!N||Te>N.index+N[0].length)&&(N=de),oe=de.index+1}return N}function j(q,ce,Q){ce=m(ce,"g");for(var N=Q.line,oe=Q.ch,de=q.firstLine();N>=de;N--,oe=-1){var Te=q.getLine(N),ze=ue(Te,ce,oe<0?0:Te.length-oe);if(ze)return{from:l(N,ze.index),to:l(N,ze.index+ze[0].length),match:ze}}}function xe(q,ce,Q){if(!D(ce))return j(q,ce,Q);ce=m(ce,"gm");for(var N,oe=1,de=q.getLine(Q.line).length-Q.ch,Te=Q.line,ze=q.firstLine();Te>=ze;){for(var nt=0;nt<oe&&Te>=ze;nt++){var Ve=q.getLine(Te--);N=N==null?Ve:Ve+`
`+N}oe*=2;var st=ue(N,ce,de);if(st){var G=N.slice(0,st.index).split(`
`),U=st[0].split(`
`),T=Te+G.length,Be=G[G.length-1].length;return{from:l(T,Be),to:l(T+U.length-1,U.length==1?Be+U[0].length:U[U.length-1].length),match:st}}}}var Z,Ee;String.prototype.normalize?(Z=function(q){return q.normalize("NFD").toLowerCase()},Ee=function(q){return q.normalize("NFD")}):(Z=function(q){return q.toLowerCase()},Ee=function(q){return q});function we(q,ce,Q,N){if(q.length==ce.length)return Q;for(var oe=0,de=Q+Math.max(0,q.length-ce.length);;){if(oe==de)return oe;var Te=oe+de>>1,ze=N(q.slice(0,Te)).length;if(ze==Q)return Te;ze>Q?de=Te:oe=Te+1}}function Oe(q,ce,Q,N){if(!ce.length)return null;var oe=N?Z:Ee,de=oe(ce).split(/\r|\n\r?/);e:for(var Te=Q.line,ze=Q.ch,nt=q.lastLine()+1-de.length;Te<=nt;Te++,ze=0){var Ve=q.getLine(Te).slice(ze),st=oe(Ve);if(de.length==1){var G=st.indexOf(de[0]);if(G==-1)continue e;var Q=we(Ve,st,G,oe)+ze;return{from:l(Te,we(Ve,st,G,oe)+ze),to:l(Te,we(Ve,st,G+de[0].length,oe)+ze)}}else{var U=st.length-de[0].length;if(st.slice(U)!=de[0])continue e;for(var T=1;T<de.length-1;T++)if(oe(q.getLine(Te+T))!=de[T])continue e;var Be=q.getLine(Te+de.length-1),Ne=oe(Be),Ze=de[de.length-1];if(Ne.slice(0,Ze.length)!=Ze)continue e;return{from:l(Te,we(Ve,st,U,oe)+ze),to:l(Te+de.length-1,we(Be,Ne,Ze.length,oe))}}}}function Ke(q,ce,Q,N){if(!ce.length)return null;var oe=N?Z:Ee,de=oe(ce).split(/\r|\n\r?/);e:for(var Te=Q.line,ze=Q.ch,nt=q.firstLine()-1+de.length;Te>=nt;Te--,ze=-1){var Ve=q.getLine(Te);ze>-1&&(Ve=Ve.slice(0,ze));var st=oe(Ve);if(de.length==1){var G=st.lastIndexOf(de[0]);if(G==-1)continue e;return{from:l(Te,we(Ve,st,G,oe)),to:l(Te,we(Ve,st,G+de[0].length,oe))}}else{var U=de[de.length-1];if(st.slice(0,U.length)!=U)continue e;for(var T=1,Q=Te-de.length+1;T<de.length-1;T++)if(oe(q.getLine(Q+T))!=de[T])continue e;var Be=q.getLine(Te+1-de.length),Ne=oe(Be);if(Ne.slice(Ne.length-de[0].length)!=de[0])continue e;return{from:l(Te+1-de.length,we(Be,Ne,Be.length-de[0].length,oe)),to:l(Te,we(Ve,st,U.length,oe))}}}}function le(q,ce,Q,N){this.atOccurrence=!1,this.afterEmptyMatch=!1,this.doc=q,Q=Q?q.clipPos(Q):l(0,0),this.pos={from:Q,to:Q};var oe;typeof N=="object"?oe=N.caseFold:(oe=N,N=null),typeof ce=="string"?(oe==null&&(oe=!1),this.matches=function(de,Te){return(de?Ke:Oe)(q,ce,Te,oe)}):(ce=m(ce,"gm"),!N||N.multiline!==!1?this.matches=function(de,Te){return(de?xe:pe)(q,ce,Te)}:this.matches=function(de,Te){return(de?j:F)(q,ce,Te)})}le.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(q){var ce=this.doc.clipPos(q?this.pos.from:this.pos.to);if(this.afterEmptyMatch&&this.atOccurrence&&(ce=l(ce.line,ce.ch),q?(ce.ch--,ce.ch<0&&(ce.line--,ce.ch=(this.doc.getLine(ce.line)||"").length)):(ce.ch++,ce.ch>(this.doc.getLine(ce.line)||"").length&&(ce.ch=0,ce.line++)),o.cmpPos(ce,this.doc.clipPos(ce))!=0))return this.atOccurrence=!1;var Q=this.matches(q,ce);if(this.afterEmptyMatch=Q&&o.cmpPos(Q.from,Q.to)==0,Q)return this.pos=Q,this.atOccurrence=!0,this.pos.match||!0;var N=l(q?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:N,to:N},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(q,ce){if(this.atOccurrence){var Q=o.splitLines(q);this.doc.replaceRange(Q,this.pos.from,this.pos.to,ce),this.pos.to=l(this.pos.from.line+Q.length-1,Q[Q.length-1].length+(Q.length==1?this.pos.from.ch:0))}}},o.defineExtension("getSearchCursor",function(q,ce,Q){return new le(this.doc,q,ce,Q)}),o.defineDocExtension("getSearchCursor",function(q,ce,Q){return new le(this,q,ce,Q)}),o.defineExtension("selectMatches",function(q,ce){for(var Q=[],N=this.getSearchCursor(q,this.getCursor("from"),ce);N.findNext()&&!(o.cmpPos(N.to(),this.getCursor("to"))>0);)Q.push({anchor:N.from(),head:N.to()});Q.length&&this.setSelections(Q,0)})})}()),searchcursor.exports}var matchbrackets={exports:{}},hasRequiredMatchbrackets;function requireMatchbrackets(){return hasRequiredMatchbrackets||(hasRequiredMatchbrackets=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){var l=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8),f=o.Pos,m={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function D(Z){return Z&&Z.bracketRegex||/[(){}[\]]/}function F(Z,Ee,we){var Oe=Z.getLineHandle(Ee.line),Ke=Ee.ch-1,le=we&&we.afterCursor;le==null&&(le=/(^| )cm-fat-cursor($| )/.test(Z.getWrapperElement().className));var q=D(we),ce=!le&&Ke>=0&&q.test(Oe.text.charAt(Ke))&&m[Oe.text.charAt(Ke)]||q.test(Oe.text.charAt(Ke+1))&&m[Oe.text.charAt(++Ke)];if(!ce)return null;var Q=ce.charAt(1)==">"?1:-1;if(we&&we.strict&&Q>0!=(Ke==Ee.ch))return null;var N=Z.getTokenTypeAt(f(Ee.line,Ke+1)),oe=pe(Z,f(Ee.line,Ke+(Q>0?1:0)),Q,N,we);return oe==null?null:{from:f(Ee.line,Ke),to:oe&&oe.pos,match:oe&&oe.ch==ce.charAt(0),forward:Q>0}}function pe(Z,Ee,we,Oe,Ke){for(var le=Ke&&Ke.maxScanLineLength||1e4,q=Ke&&Ke.maxScanLines||1e3,ce=[],Q=D(Ke),N=we>0?Math.min(Ee.line+q,Z.lastLine()+1):Math.max(Z.firstLine()-1,Ee.line-q),oe=Ee.line;oe!=N;oe+=we){var de=Z.getLine(oe);if(de){var Te=we>0?0:de.length-1,ze=we>0?de.length:-1;if(!(de.length>le))for(oe==Ee.line&&(Te=Ee.ch-(we<0?1:0));Te!=ze;Te+=we){var nt=de.charAt(Te);if(Q.test(nt)&&(Oe===void 0||(Z.getTokenTypeAt(f(oe,Te+1))||"")==(Oe||""))){var Ve=m[nt];if(Ve&&Ve.charAt(1)==">"==we>0)ce.push(nt);else if(ce.length)ce.pop();else return{pos:f(oe,Te),ch:nt}}}}}return oe-we==(we>0?Z.lastLine():Z.firstLine())?!1:null}function ue(Z,Ee,we){for(var Oe=Z.state.matchBrackets.maxHighlightLineLength||1e3,Ke=we&&we.highlightNonMatching,le=[],q=Z.listSelections(),ce=0;ce<q.length;ce++){var Q=q[ce].empty()&&F(Z,q[ce].head,we);if(Q&&(Q.match||Ke!==!1)&&Z.getLine(Q.from.line).length<=Oe){var N=Q.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";le.push(Z.markText(Q.from,f(Q.from.line,Q.from.ch+1),{className:N})),Q.to&&Z.getLine(Q.to.line).length<=Oe&&le.push(Z.markText(Q.to,f(Q.to.line,Q.to.ch+1),{className:N}))}}if(le.length){l&&Z.state.focused&&Z.focus();var oe=function(){Z.operation(function(){for(var de=0;de<le.length;de++)le[de].clear()})};if(Ee)setTimeout(oe,800);else return oe}}function j(Z){Z.operation(function(){Z.state.matchBrackets.currentlyHighlighted&&(Z.state.matchBrackets.currentlyHighlighted(),Z.state.matchBrackets.currentlyHighlighted=null),Z.state.matchBrackets.currentlyHighlighted=ue(Z,!1,Z.state.matchBrackets)})}function xe(Z){Z.state.matchBrackets&&Z.state.matchBrackets.currentlyHighlighted&&(Z.state.matchBrackets.currentlyHighlighted(),Z.state.matchBrackets.currentlyHighlighted=null)}o.defineOption("matchBrackets",!1,function(Z,Ee,we){we&&we!=o.Init&&(Z.off("cursorActivity",j),Z.off("focus",j),Z.off("blur",xe),xe(Z)),Ee&&(Z.state.matchBrackets=typeof Ee=="object"?Ee:{},Z.on("cursorActivity",j),Z.on("focus",j),Z.on("blur",xe))}),o.defineExtension("matchBrackets",function(){ue(this,!0)}),o.defineExtension("findMatchingBracket",function(Z,Ee,we){return(we||typeof Ee=="boolean")&&(we?(we.strict=Ee,Ee=we):Ee=Ee?{strict:!0}:null),F(this,Z,Ee)}),o.defineExtension("scanForBracket",function(Z,Ee,we,Oe){return pe(this,Z,Ee,we,Oe)})})}()),matchbrackets.exports}var hasRequiredSublime;function requireSublime(){return hasRequiredSublime||(hasRequiredSublime=1,function(w,i){(function(o){o(requireCodemirror(),requireSearchcursor(),requireMatchbrackets())})(function(o){var l=o.commands,f=o.Pos;function m(Q,N,oe){if(oe<0&&N.ch==0)return Q.clipPos(f(N.line-1));var de=Q.getLine(N.line);if(oe>0&&N.ch>=de.length)return Q.clipPos(f(N.line+1,0));for(var Te="start",ze,nt=N.ch,Ve=nt,st=oe<0?0:de.length,G=0;Ve!=st;Ve+=oe,G++){var U=de.charAt(oe<0?Ve-1:Ve),T=U!="_"&&o.isWordChar(U)?"w":"o";if(T=="w"&&U.toUpperCase()==U&&(T="W"),Te=="start")T!="o"?(Te="in",ze=T):nt=Ve+oe;else if(Te=="in"&&ze!=T){if(ze=="w"&&T=="W"&&oe<0&&Ve--,ze=="W"&&T=="w"&&oe>0)if(Ve==nt+1){ze="w";continue}else Ve--;break}}return f(N.line,Ve)}function D(Q,N){Q.extendSelectionsBy(function(oe){return Q.display.shift||Q.doc.extend||oe.empty()?m(Q.doc,oe.head,N):N<0?oe.from():oe.to()})}l.goSubwordLeft=function(Q){D(Q,-1)},l.goSubwordRight=function(Q){D(Q,1)},l.scrollLineUp=function(Q){var N=Q.getScrollInfo();if(!Q.somethingSelected()){var oe=Q.lineAtHeight(N.top+N.clientHeight,"local");Q.getCursor().line>=oe&&Q.execCommand("goLineUp")}Q.scrollTo(null,N.top-Q.defaultTextHeight())},l.scrollLineDown=function(Q){var N=Q.getScrollInfo();if(!Q.somethingSelected()){var oe=Q.lineAtHeight(N.top,"local")+1;Q.getCursor().line<=oe&&Q.execCommand("goLineDown")}Q.scrollTo(null,N.top+Q.defaultTextHeight())},l.splitSelectionByLine=function(Q){for(var N=Q.listSelections(),oe=[],de=0;de<N.length;de++)for(var Te=N[de].from(),ze=N[de].to(),nt=Te.line;nt<=ze.line;++nt)ze.line>Te.line&&nt==ze.line&&ze.ch==0||oe.push({anchor:nt==Te.line?Te:f(nt,0),head:nt==ze.line?ze:f(nt)});Q.setSelections(oe,0)},l.singleSelectionTop=function(Q){var N=Q.listSelections()[0];Q.setSelection(N.anchor,N.head,{scroll:!1})},l.selectLine=function(Q){for(var N=Q.listSelections(),oe=[],de=0;de<N.length;de++){var Te=N[de];oe.push({anchor:f(Te.from().line,0),head:f(Te.to().line+1,0)})}Q.setSelections(oe)};function F(Q,N){if(Q.isReadOnly())return o.Pass;Q.operation(function(){for(var oe=Q.listSelections().length,de=[],Te=-1,ze=0;ze<oe;ze++){var nt=Q.listSelections()[ze].head;if(!(nt.line<=Te)){var Ve=f(nt.line+(N?0:1),0);Q.replaceRange(`
`,Ve,null,"+insertLine"),Q.indentLine(Ve.line,null,!0),de.push({head:Ve,anchor:Ve}),Te=nt.line+1}}Q.setSelections(de)}),Q.execCommand("indentAuto")}l.insertLineAfter=function(Q){return F(Q,!1)},l.insertLineBefore=function(Q){return F(Q,!0)};function pe(Q,N){for(var oe=N.ch,de=oe,Te=Q.getLine(N.line);oe&&o.isWordChar(Te.charAt(oe-1));)--oe;for(;de<Te.length&&o.isWordChar(Te.charAt(de));)++de;return{from:f(N.line,oe),to:f(N.line,de),word:Te.slice(oe,de)}}l.selectNextOccurrence=function(Q){var N=Q.getCursor("from"),oe=Q.getCursor("to"),de=Q.state.sublimeFindFullWord==Q.doc.sel;if(o.cmpPos(N,oe)==0){var Te=pe(Q,N);if(!Te.word)return;Q.setSelection(Te.from,Te.to),de=!0}else{var ze=Q.getRange(N,oe),nt=de?new RegExp("\\b"+ze+"\\b"):ze,Ve=Q.getSearchCursor(nt,oe),st=Ve.findNext();if(st||(Ve=Q.getSearchCursor(nt,f(Q.firstLine(),0)),st=Ve.findNext()),!st||j(Q.listSelections(),Ve.from(),Ve.to()))return;Q.addSelection(Ve.from(),Ve.to())}de&&(Q.state.sublimeFindFullWord=Q.doc.sel)},l.skipAndSelectNextOccurrence=function(Q){var N=Q.getCursor("anchor"),oe=Q.getCursor("head");l.selectNextOccurrence(Q),o.cmpPos(N,oe)!=0&&Q.doc.setSelections(Q.doc.listSelections().filter(function(de){return de.anchor!=N||de.head!=oe}))};function ue(Q,N){for(var oe=Q.listSelections(),de=[],Te=0;Te<oe.length;Te++){var ze=oe[Te],nt=Q.findPosV(ze.anchor,N,"line",ze.anchor.goalColumn),Ve=Q.findPosV(ze.head,N,"line",ze.head.goalColumn);nt.goalColumn=ze.anchor.goalColumn!=null?ze.anchor.goalColumn:Q.cursorCoords(ze.anchor,"div").left,Ve.goalColumn=ze.head.goalColumn!=null?ze.head.goalColumn:Q.cursorCoords(ze.head,"div").left;var st={anchor:nt,head:Ve};de.push(ze),de.push(st)}Q.setSelections(de)}l.addCursorToPrevLine=function(Q){ue(Q,-1)},l.addCursorToNextLine=function(Q){ue(Q,1)};function j(Q,N,oe){for(var de=0;de<Q.length;de++)if(o.cmpPos(Q[de].from(),N)==0&&o.cmpPos(Q[de].to(),oe)==0)return!0;return!1}var xe="(){}[]";function Z(Q){for(var N=Q.listSelections(),oe=[],de=0;de<N.length;de++){var Te=N[de],ze=Te.head,nt=Q.scanForBracket(ze,-1);if(!nt)return!1;for(;;){var Ve=Q.scanForBracket(ze,1);if(!Ve)return!1;if(Ve.ch==xe.charAt(xe.indexOf(nt.ch)+1)){var st=f(nt.pos.line,nt.pos.ch+1);if(o.cmpPos(st,Te.from())==0&&o.cmpPos(Ve.pos,Te.to())==0){if(nt=Q.scanForBracket(nt.pos,-1),!nt)return!1}else{oe.push({anchor:st,head:Ve.pos});break}}ze=f(Ve.pos.line,Ve.pos.ch+1)}}return Q.setSelections(oe),!0}l.selectScope=function(Q){Z(Q)||Q.execCommand("selectAll")},l.selectBetweenBrackets=function(Q){if(!Z(Q))return o.Pass};function Ee(Q){return Q?/\bpunctuation\b/.test(Q)?Q:void 0:null}l.goToBracket=function(Q){Q.extendSelectionsBy(function(N){var oe=Q.scanForBracket(N.head,1,Ee(Q.getTokenTypeAt(N.head)));if(oe&&o.cmpPos(oe.pos,N.head)!=0)return oe.pos;var de=Q.scanForBracket(N.head,-1,Ee(Q.getTokenTypeAt(f(N.head.line,N.head.ch+1))));return de&&f(de.pos.line,de.pos.ch+1)||N.head})},l.swapLineUp=function(Q){if(Q.isReadOnly())return o.Pass;for(var N=Q.listSelections(),oe=[],de=Q.firstLine()-1,Te=[],ze=0;ze<N.length;ze++){var nt=N[ze],Ve=nt.from().line-1,st=nt.to().line;Te.push({anchor:f(nt.anchor.line-1,nt.anchor.ch),head:f(nt.head.line-1,nt.head.ch)}),nt.to().ch==0&&!nt.empty()&&--st,Ve>de?oe.push(Ve,st):oe.length&&(oe[oe.length-1]=st),de=st}Q.operation(function(){for(var G=0;G<oe.length;G+=2){var U=oe[G],T=oe[G+1],Be=Q.getLine(U);Q.replaceRange("",f(U,0),f(U+1,0),"+swapLine"),T>Q.lastLine()?Q.replaceRange(`
`+Be,f(Q.lastLine()),null,"+swapLine"):Q.replaceRange(Be+`
`,f(T,0),null,"+swapLine")}Q.setSelections(Te),Q.scrollIntoView()})},l.swapLineDown=function(Q){if(Q.isReadOnly())return o.Pass;for(var N=Q.listSelections(),oe=[],de=Q.lastLine()+1,Te=N.length-1;Te>=0;Te--){var ze=N[Te],nt=ze.to().line+1,Ve=ze.from().line;ze.to().ch==0&&!ze.empty()&&nt--,nt<de?oe.push(nt,Ve):oe.length&&(oe[oe.length-1]=Ve),de=Ve}Q.operation(function(){for(var st=oe.length-2;st>=0;st-=2){var G=oe[st],U=oe[st+1],T=Q.getLine(G);G==Q.lastLine()?Q.replaceRange("",f(G-1),f(G),"+swapLine"):Q.replaceRange("",f(G,0),f(G+1,0),"+swapLine"),Q.replaceRange(T+`
`,f(U,0),null,"+swapLine")}Q.scrollIntoView()})},l.toggleCommentIndented=function(Q){Q.toggleComment({indent:!0})},l.joinLines=function(Q){for(var N=Q.listSelections(),oe=[],de=0;de<N.length;de++){for(var Te=N[de],ze=Te.from(),nt=ze.line,Ve=Te.to().line;de<N.length-1&&N[de+1].from().line==Ve;)Ve=N[++de].to().line;oe.push({start:nt,end:Ve,anchor:!Te.empty()&&ze})}Q.operation(function(){for(var st=0,G=[],U=0;U<oe.length;U++){for(var T=oe[U],Be=T.anchor&&f(T.anchor.line-st,T.anchor.ch),Ne,Ze=T.start;Ze<=T.end;Ze++){var pt=Ze-st;Ze==T.end&&(Ne=f(pt,Q.getLine(pt).length+1)),pt<Q.lastLine()&&(Q.replaceRange(" ",f(pt),f(pt+1,/^\s*/.exec(Q.getLine(pt+1))[0].length)),++st)}G.push({anchor:Be||Ne,head:Ne})}Q.setSelections(G,0)})},l.duplicateLine=function(Q){Q.operation(function(){for(var N=Q.listSelections().length,oe=0;oe<N;oe++){var de=Q.listSelections()[oe];de.empty()?Q.replaceRange(Q.getLine(de.head.line)+`
`,f(de.head.line,0)):Q.replaceRange(Q.getRange(de.from(),de.to()),de.from())}Q.scrollIntoView()})};function we(Q,N,oe){if(Q.isReadOnly())return o.Pass;for(var de=Q.listSelections(),Te=[],ze,nt=0;nt<de.length;nt++){var Ve=de[nt];if(!Ve.empty()){for(var st=Ve.from().line,G=Ve.to().line;nt<de.length-1&&de[nt+1].from().line==G;)G=de[++nt].to().line;de[nt].to().ch||G--,Te.push(st,G)}}Te.length?ze=!0:Te.push(Q.firstLine(),Q.lastLine()),Q.operation(function(){for(var U=[],T=0;T<Te.length;T+=2){var Be=Te[T],Ne=Te[T+1],Ze=f(Be,0),pt=f(Ne),gt=Q.getRange(Ze,pt,!1);N?gt.sort(function(dt,yt){return dt<yt?-oe:dt==yt?0:oe}):gt.sort(function(dt,yt){var wt=dt.toUpperCase(),jt=yt.toUpperCase();return wt!=jt&&(dt=wt,yt=jt),dt<yt?-oe:dt==yt?0:oe}),Q.replaceRange(gt,Ze,pt),ze&&U.push({anchor:Ze,head:f(Ne+1,0)})}ze&&Q.setSelections(U,0)})}l.sortLines=function(Q){we(Q,!0,1)},l.reverseSortLines=function(Q){we(Q,!0,-1)},l.sortLinesInsensitive=function(Q){we(Q,!1,1)},l.reverseSortLinesInsensitive=function(Q){we(Q,!1,-1)},l.nextBookmark=function(Q){var N=Q.state.sublimeBookmarks;if(N)for(;N.length;){var oe=N.shift(),de=oe.find();if(de)return N.push(oe),Q.setSelection(de.from,de.to)}},l.prevBookmark=function(Q){var N=Q.state.sublimeBookmarks;if(N)for(;N.length;){N.unshift(N.pop());var oe=N[N.length-1].find();if(!oe)N.pop();else return Q.setSelection(oe.from,oe.to)}},l.toggleBookmark=function(Q){for(var N=Q.listSelections(),oe=Q.state.sublimeBookmarks||(Q.state.sublimeBookmarks=[]),de=0;de<N.length;de++){for(var Te=N[de].from(),ze=N[de].to(),nt=N[de].empty()?Q.findMarksAt(Te):Q.findMarks(Te,ze),Ve=0;Ve<nt.length;Ve++)if(nt[Ve].sublimeBookmark){nt[Ve].clear();for(var st=0;st<oe.length;st++)oe[st]==nt[Ve]&&oe.splice(st--,1);break}Ve==nt.length&&oe.push(Q.markText(Te,ze,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},l.clearBookmarks=function(Q){var N=Q.state.sublimeBookmarks;if(N)for(var oe=0;oe<N.length;oe++)N[oe].clear();N.length=0},l.selectBookmarks=function(Q){var N=Q.state.sublimeBookmarks,oe=[];if(N)for(var de=0;de<N.length;de++){var Te=N[de].find();Te?oe.push({anchor:Te.from,head:Te.to}):N.splice(de--,0)}oe.length&&Q.setSelections(oe,0)};function Oe(Q,N){Q.operation(function(){for(var oe=Q.listSelections(),de=[],Te=[],ze=0;ze<oe.length;ze++){var nt=oe[ze];nt.empty()?(de.push(ze),Te.push("")):Te.push(N(Q.getRange(nt.from(),nt.to())))}Q.replaceSelections(Te,"around","case");for(var ze=de.length-1,Ve;ze>=0;ze--){var nt=oe[de[ze]];if(!(Ve&&o.cmpPos(nt.head,Ve)>0)){var st=pe(Q,nt.head);Ve=st.from,Q.replaceRange(N(st.word),st.from,st.to)}}})}l.smartBackspace=function(Q){if(Q.somethingSelected())return o.Pass;Q.operation(function(){for(var N=Q.listSelections(),oe=Q.getOption("indentUnit"),de=N.length-1;de>=0;de--){var Te=N[de].head,ze=Q.getRange({line:Te.line,ch:0},Te),nt=o.countColumn(ze,null,Q.getOption("tabSize")),Ve=Q.findPosH(Te,-1,"char",!1);if(ze&&!/\S/.test(ze)&&nt%oe==0){var st=new f(Te.line,o.findColumn(ze,nt-oe,oe));st.ch!=Te.ch&&(Ve=st)}Q.replaceRange("",Ve,Te,"+delete")}})},l.delLineRight=function(Q){Q.operation(function(){for(var N=Q.listSelections(),oe=N.length-1;oe>=0;oe--)Q.replaceRange("",N[oe].anchor,f(N[oe].to().line),"+delete");Q.scrollIntoView()})},l.upcaseAtCursor=function(Q){Oe(Q,function(N){return N.toUpperCase()})},l.downcaseAtCursor=function(Q){Oe(Q,function(N){return N.toLowerCase()})},l.setSublimeMark=function(Q){Q.state.sublimeMark&&Q.state.sublimeMark.clear(),Q.state.sublimeMark=Q.setBookmark(Q.getCursor())},l.selectToSublimeMark=function(Q){var N=Q.state.sublimeMark&&Q.state.sublimeMark.find();N&&Q.setSelection(Q.getCursor(),N)},l.deleteToSublimeMark=function(Q){var N=Q.state.sublimeMark&&Q.state.sublimeMark.find();if(N){var oe=Q.getCursor(),de=N;if(o.cmpPos(oe,de)>0){var Te=de;de=oe,oe=Te}Q.state.sublimeKilled=Q.getRange(oe,de),Q.replaceRange("",oe,de)}},l.swapWithSublimeMark=function(Q){var N=Q.state.sublimeMark&&Q.state.sublimeMark.find();N&&(Q.state.sublimeMark.clear(),Q.state.sublimeMark=Q.setBookmark(Q.getCursor()),Q.setCursor(N))},l.sublimeYank=function(Q){Q.state.sublimeKilled!=null&&Q.replaceSelection(Q.state.sublimeKilled,null,"paste")},l.showInCenter=function(Q){var N=Q.cursorCoords(null,"local");Q.scrollTo(null,(N.top+N.bottom)/2-Q.getScrollInfo().clientHeight/2)};function Ke(Q){var N=Q.getCursor("from"),oe=Q.getCursor("to");if(o.cmpPos(N,oe)==0){var de=pe(Q,N);if(!de.word)return;N=de.from,oe=de.to}return{from:N,to:oe,query:Q.getRange(N,oe),word:de}}function le(Q,N){var oe=Ke(Q);if(oe){var de=oe.query,Te=Q.getSearchCursor(de,N?oe.to:oe.from);(N?Te.findNext():Te.findPrevious())?Q.setSelection(Te.from(),Te.to()):(Te=Q.getSearchCursor(de,N?f(Q.firstLine(),0):Q.clipPos(f(Q.lastLine()))),(N?Te.findNext():Te.findPrevious())?Q.setSelection(Te.from(),Te.to()):oe.word&&Q.setSelection(oe.from,oe.to))}}l.findUnder=function(Q){le(Q,!0)},l.findUnderPrevious=function(Q){le(Q,!1)},l.findAllUnder=function(Q){var N=Ke(Q);if(N){for(var oe=Q.getSearchCursor(N.query),de=[],Te=-1;oe.findNext();)de.push({anchor:oe.from(),head:oe.to()}),oe.from().line<=N.from.line&&oe.from().ch<=N.from.ch&&Te++;Q.setSelections(de,Te)}};var q=o.keyMap;q.macSublime={"Cmd-Left":"goLineStartSmart","Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-Left":"goSubwordLeft","Ctrl-Right":"goSubwordRight","Ctrl-Alt-Up":"scrollLineUp","Ctrl-Alt-Down":"scrollLineDown","Cmd-L":"selectLine","Shift-Cmd-L":"splitSelectionByLine",Esc:"singleSelectionTop","Cmd-Enter":"insertLineAfter","Shift-Cmd-Enter":"insertLineBefore","Cmd-D":"selectNextOccurrence","Shift-Cmd-Space":"selectScope","Shift-Cmd-M":"selectBetweenBrackets","Cmd-M":"goToBracket","Cmd-Ctrl-Up":"swapLineUp","Cmd-Ctrl-Down":"swapLineDown","Cmd-/":"toggleCommentIndented","Cmd-J":"joinLines","Shift-Cmd-D":"duplicateLine",F5:"sortLines","Shift-F5":"reverseSortLines","Cmd-F5":"sortLinesInsensitive","Shift-Cmd-F5":"reverseSortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Cmd-F2":"toggleBookmark","Shift-Cmd-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Cmd-K Cmd-D":"skipAndSelectNextOccurrence","Cmd-K Cmd-K":"delLineRight","Cmd-K Cmd-U":"upcaseAtCursor","Cmd-K Cmd-L":"downcaseAtCursor","Cmd-K Cmd-Space":"setSublimeMark","Cmd-K Cmd-A":"selectToSublimeMark","Cmd-K Cmd-W":"deleteToSublimeMark","Cmd-K Cmd-X":"swapWithSublimeMark","Cmd-K Cmd-Y":"sublimeYank","Cmd-K Cmd-C":"showInCenter","Cmd-K Cmd-G":"clearBookmarks","Cmd-K Cmd-Backspace":"delLineLeft","Cmd-K Cmd-1":"foldAll","Cmd-K Cmd-0":"unfoldAll","Cmd-K Cmd-J":"unfoldAll","Ctrl-Shift-Up":"addCursorToPrevLine","Ctrl-Shift-Down":"addCursorToNextLine","Cmd-F3":"findUnder","Shift-Cmd-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Cmd-[":"fold","Shift-Cmd-]":"unfold","Cmd-I":"findIncremental","Shift-Cmd-I":"findIncrementalReverse","Cmd-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"macDefault"},o.normalizeKeyMap(q.macSublime),q.pcSublime={"Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-T":"transposeChars","Alt-Left":"goSubwordLeft","Alt-Right":"goSubwordRight","Ctrl-Up":"scrollLineUp","Ctrl-Down":"scrollLineDown","Ctrl-L":"selectLine","Shift-Ctrl-L":"splitSelectionByLine",Esc:"singleSelectionTop","Ctrl-Enter":"insertLineAfter","Shift-Ctrl-Enter":"insertLineBefore","Ctrl-D":"selectNextOccurrence","Shift-Ctrl-Space":"selectScope","Shift-Ctrl-M":"selectBetweenBrackets","Ctrl-M":"goToBracket","Shift-Ctrl-Up":"swapLineUp","Shift-Ctrl-Down":"swapLineDown","Ctrl-/":"toggleCommentIndented","Ctrl-J":"joinLines","Shift-Ctrl-D":"duplicateLine",F9:"sortLines","Shift-F9":"reverseSortLines","Ctrl-F9":"sortLinesInsensitive","Shift-Ctrl-F9":"reverseSortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Ctrl-F2":"toggleBookmark","Shift-Ctrl-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Ctrl-K Ctrl-D":"skipAndSelectNextOccurrence","Ctrl-K Ctrl-K":"delLineRight","Ctrl-K Ctrl-U":"upcaseAtCursor","Ctrl-K Ctrl-L":"downcaseAtCursor","Ctrl-K Ctrl-Space":"setSublimeMark","Ctrl-K Ctrl-A":"selectToSublimeMark","Ctrl-K Ctrl-W":"deleteToSublimeMark","Ctrl-K Ctrl-X":"swapWithSublimeMark","Ctrl-K Ctrl-Y":"sublimeYank","Ctrl-K Ctrl-C":"showInCenter","Ctrl-K Ctrl-G":"clearBookmarks","Ctrl-K Ctrl-Backspace":"delLineLeft","Ctrl-K Ctrl-1":"foldAll","Ctrl-K Ctrl-0":"unfoldAll","Ctrl-K Ctrl-J":"unfoldAll","Ctrl-Alt-Up":"addCursorToPrevLine","Ctrl-Alt-Down":"addCursorToNextLine","Ctrl-F3":"findUnder","Shift-Ctrl-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Ctrl-[":"fold","Shift-Ctrl-]":"unfold","Ctrl-I":"findIncremental","Shift-Ctrl-I":"findIncrementalReverse","Ctrl-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"pcDefault"},o.normalizeKeyMap(q.pcSublime);var ce=q.default==q.macDefault;q.sublime=ce?q.macSublime:q.pcSublime})}()),sublime.exports}requireSublime();requireMatchbrackets();var closebrackets={exports:{}},hasRequiredClosebrackets;function requireClosebrackets(){return hasRequiredClosebrackets||(hasRequiredClosebrackets=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){var l={pairs:`()[]{}''""`,closeBefore:`)]}'":;>`,triples:"",explode:"[]{}"},f=o.Pos;o.defineOption("autoCloseBrackets",!1,function(le,q,ce){ce&&ce!=o.Init&&(le.removeKeyMap(D),le.state.closeBrackets=null),q&&(F(m(q,"pairs")),le.state.closeBrackets=q,le.addKeyMap(D))});function m(le,q){return q=="pairs"&&typeof le=="string"?le:typeof le=="object"&&le[q]!=null?le[q]:l[q]}var D={Backspace:j,Enter:xe};function F(le){for(var q=0;q<le.length;q++){var ce=le.charAt(q),Q="'"+ce+"'";D[Q]||(D[Q]=pe(ce))}}F(l.pairs+"`");function pe(le){return function(q){return we(q,le)}}function ue(le){var q=le.state.closeBrackets;if(!q||q.override)return q;var ce=le.getModeAt(le.getCursor());return ce.closeBrackets||q}function j(le){var q=ue(le);if(!q||le.getOption("disableInput"))return o.Pass;for(var ce=m(q,"pairs"),Q=le.listSelections(),N=0;N<Q.length;N++){if(!Q[N].empty())return o.Pass;var oe=Oe(le,Q[N].head);if(!oe||ce.indexOf(oe)%2!=0)return o.Pass}for(var N=Q.length-1;N>=0;N--){var de=Q[N].head;le.replaceRange("",f(de.line,de.ch-1),f(de.line,de.ch+1),"+delete")}}function xe(le){var q=ue(le),ce=q&&m(q,"explode");if(!ce||le.getOption("disableInput"))return o.Pass;for(var Q=le.listSelections(),N=0;N<Q.length;N++){if(!Q[N].empty())return o.Pass;var oe=Oe(le,Q[N].head);if(!oe||ce.indexOf(oe)%2!=0)return o.Pass}le.operation(function(){var de=le.lineSeparator()||`
`;le.replaceSelection(de+de,null),Z(le,-1),Q=le.listSelections();for(var Te=0;Te<Q.length;Te++){var ze=Q[Te].head.line;le.indentLine(ze,null,!0),le.indentLine(ze+1,null,!0)}})}function Z(le,q){for(var ce=[],Q=le.listSelections(),N=0,oe=0;oe<Q.length;oe++){var de=Q[oe];de.head==le.getCursor()&&(N=oe);var Te=de.head.ch||q>0?{line:de.head.line,ch:de.head.ch+q}:{line:de.head.line-1};ce.push({anchor:Te,head:Te})}le.setSelections(ce,N)}function Ee(le){var q=o.cmpPos(le.anchor,le.head)>0;return{anchor:new f(le.anchor.line,le.anchor.ch+(q?-1:1)),head:new f(le.head.line,le.head.ch+(q?1:-1))}}function we(le,q){var ce=ue(le);if(!ce||le.getOption("disableInput"))return o.Pass;var Q=m(ce,"pairs"),N=Q.indexOf(q);if(N==-1)return o.Pass;for(var oe=m(ce,"closeBefore"),de=m(ce,"triples"),Te=Q.charAt(N+1)==q,ze=le.listSelections(),nt=N%2==0,Ve,st=0;st<ze.length;st++){var G=ze[st],U=G.head,T,Be=le.getRange(U,f(U.line,U.ch+1));if(nt&&!G.empty())T="surround";else if((Te||!nt)&&Be==q)Te&&Ke(le,U)?T="both":de.indexOf(q)>=0&&le.getRange(U,f(U.line,U.ch+3))==q+q+q?T="skipThree":T="skip";else if(Te&&U.ch>1&&de.indexOf(q)>=0&&le.getRange(f(U.line,U.ch-2),U)==q+q){if(U.ch>2&&/\bstring/.test(le.getTokenTypeAt(f(U.line,U.ch-2))))return o.Pass;T="addFour"}else if(Te){var Ne=U.ch==0?" ":le.getRange(f(U.line,U.ch-1),U);if(!o.isWordChar(Be)&&Ne!=q&&!o.isWordChar(Ne))T="both";else return o.Pass}else if(nt&&(Be.length===0||/\s/.test(Be)||oe.indexOf(Be)>-1))T="both";else return o.Pass;if(!Ve)Ve=T;else if(Ve!=T)return o.Pass}var Ze=N%2?Q.charAt(N-1):q,pt=N%2?q:Q.charAt(N+1);le.operation(function(){if(Ve=="skip")Z(le,1);else if(Ve=="skipThree")Z(le,3);else if(Ve=="surround"){for(var gt=le.getSelections(),dt=0;dt<gt.length;dt++)gt[dt]=Ze+gt[dt]+pt;le.replaceSelections(gt,"around"),gt=le.listSelections().slice();for(var dt=0;dt<gt.length;dt++)gt[dt]=Ee(gt[dt]);le.setSelections(gt)}else Ve=="both"?(le.replaceSelection(Ze+pt,null),le.triggerElectric(Ze+pt),Z(le,-1)):Ve=="addFour"&&(le.replaceSelection(Ze+Ze+Ze+Ze,"before"),Z(le,1))})}function Oe(le,q){var ce=le.getRange(f(q.line,q.ch-1),f(q.line,q.ch+1));return ce.length==2?ce:null}function Ke(le,q){var ce=le.getTokenAt(f(q.line,q.ch+1));return/\bstring/.test(ce.type)&&ce.start==q.ch&&(q.ch==0||!/\bstring/.test(le.getTokenTypeAt(q)))}})}()),closebrackets.exports}requireClosebrackets();var comment={exports:{}},hasRequiredComment;function requireComment(){return hasRequiredComment||(hasRequiredComment=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){var l={},f=/[^\s\u00a0]/,m=o.Pos,D=o.cmpPos;function F(j){var xe=j.search(f);return xe==-1?0:xe}o.commands.toggleComment=function(j){j.toggleComment()},o.defineExtension("toggleComment",function(j){j||(j=l);for(var xe=this,Z=1/0,Ee=this.listSelections(),we=null,Oe=Ee.length-1;Oe>=0;Oe--){var Ke=Ee[Oe].from(),le=Ee[Oe].to();Ke.line>=Z||(le.line>=Z&&(le=m(Z,0)),Z=Ke.line,we==null?xe.uncomment(Ke,le,j)?we="un":(xe.lineComment(Ke,le,j),we="line"):we=="un"?xe.uncomment(Ke,le,j):xe.lineComment(Ke,le,j))}});function pe(j,xe,Z){return/\bstring\b/.test(j.getTokenTypeAt(m(xe.line,0)))&&!/^[\'\"\`]/.test(Z)}function ue(j,xe){var Z=j.getMode();return Z.useInnerComments===!1||!Z.innerMode?Z:j.getModeAt(xe)}o.defineExtension("lineComment",function(j,xe,Z){Z||(Z=l);var Ee=this,we=ue(Ee,j),Oe=Ee.getLine(j.line);if(!(Oe==null||pe(Ee,j,Oe))){var Ke=Z.lineComment||we.lineComment;if(!Ke){(Z.blockCommentStart||we.blockCommentStart)&&(Z.fullLines=!0,Ee.blockComment(j,xe,Z));return}var le=Math.min(xe.ch!=0||xe.line==j.line?xe.line+1:xe.line,Ee.lastLine()+1),q=Z.padding==null?" ":Z.padding,ce=Z.commentBlankLines||j.line==xe.line;Ee.operation(function(){if(Z.indent){for(var Q=null,N=j.line;N<le;++N){var oe=Ee.getLine(N),de=oe.search(f)===-1?oe:oe.slice(0,F(oe));(Q==null||Q.length>de.length)&&(Q=de)}for(var N=j.line;N<le;++N){var oe=Ee.getLine(N),Te=Q.length;!ce&&!f.test(oe)||(oe.slice(0,Te)!=Q&&(Te=F(oe)),Ee.replaceRange(Q+Ke+q,m(N,0),m(N,Te)))}}else for(var N=j.line;N<le;++N)(ce||f.test(Ee.getLine(N)))&&Ee.replaceRange(Ke+q,m(N,0))})}}),o.defineExtension("blockComment",function(j,xe,Z){Z||(Z=l);var Ee=this,we=ue(Ee,j),Oe=Z.blockCommentStart||we.blockCommentStart,Ke=Z.blockCommentEnd||we.blockCommentEnd;if(!Oe||!Ke){(Z.lineComment||we.lineComment)&&Z.fullLines!=!1&&Ee.lineComment(j,xe,Z);return}if(!/\bcomment\b/.test(Ee.getTokenTypeAt(m(j.line,0)))){var le=Math.min(xe.line,Ee.lastLine());le!=j.line&&xe.ch==0&&f.test(Ee.getLine(le))&&--le;var q=Z.padding==null?" ":Z.padding;j.line>le||Ee.operation(function(){if(Z.fullLines!=!1){var ce=f.test(Ee.getLine(le));Ee.replaceRange(q+Ke,m(le)),Ee.replaceRange(Oe+q,m(j.line,0));var Q=Z.blockCommentLead||we.blockCommentLead;if(Q!=null)for(var N=j.line+1;N<=le;++N)(N!=le||ce)&&Ee.replaceRange(Q+q,m(N,0))}else{var oe=D(Ee.getCursor("to"),xe)==0,de=!Ee.somethingSelected();Ee.replaceRange(Ke,xe),oe&&Ee.setSelection(de?xe:Ee.getCursor("from"),xe),Ee.replaceRange(Oe,j)}})}}),o.defineExtension("uncomment",function(j,xe,Z){Z||(Z=l);var Ee=this,we=ue(Ee,j),Oe=Math.min(xe.ch!=0||xe.line==j.line?xe.line:xe.line-1,Ee.lastLine()),Ke=Math.min(j.line,Oe),le=Z.lineComment||we.lineComment,q=[],ce=Z.padding==null?" ":Z.padding,Q;e:{if(!le)break e;for(var N=Ke;N<=Oe;++N){var oe=Ee.getLine(N),de=oe.indexOf(le);if(de>-1&&!/comment/.test(Ee.getTokenTypeAt(m(N,de+1)))&&(de=-1),de==-1&&f.test(oe)||de>-1&&f.test(oe.slice(0,de)))break e;q.push(oe)}if(Ee.operation(function(){for(var gt=Ke;gt<=Oe;++gt){var dt=q[gt-Ke],yt=dt.indexOf(le),wt=yt+le.length;yt<0||(dt.slice(wt,wt+ce.length)==ce&&(wt+=ce.length),Q=!0,Ee.replaceRange("",m(gt,yt),m(gt,wt)))}}),Q)return!0}var Te=Z.blockCommentStart||we.blockCommentStart,ze=Z.blockCommentEnd||we.blockCommentEnd;if(!Te||!ze)return!1;var nt=Z.blockCommentLead||we.blockCommentLead,Ve=Ee.getLine(Ke),st=Ve.indexOf(Te);if(st==-1)return!1;var G=Oe==Ke?Ve:Ee.getLine(Oe),U=G.indexOf(ze,Oe==Ke?st+Te.length:0),T=m(Ke,st+1),Be=m(Oe,U+1);if(U==-1||!/comment/.test(Ee.getTokenTypeAt(T))||!/comment/.test(Ee.getTokenTypeAt(Be))||Ee.getRange(T,Be,`
`).indexOf(ze)>-1)return!1;var Ne=Ve.lastIndexOf(Te,j.ch),Ze=Ne==-1?-1:Ve.slice(0,j.ch).indexOf(ze,Ne+Te.length);if(Ne!=-1&&Ze!=-1&&Ze+ze.length!=j.ch)return!1;Ze=G.indexOf(ze,xe.ch);var pt=G.slice(xe.ch).lastIndexOf(Te,Ze-xe.ch);return Ne=Ze==-1||pt==-1?-1:xe.ch+pt,Ze!=-1&&Ne!=-1&&Ne!=xe.ch?!1:(Ee.operation(function(){Ee.replaceRange("",m(Oe,U-(ce&&G.slice(U-ce.length,U)==ce?ce.length:0)),m(Oe,U+ze.length));var gt=st+Te.length;if(ce&&Ve.slice(gt,gt+ce.length)==ce&&(gt+=ce.length),Ee.replaceRange("",m(Ke,st),m(Ke,gt)),nt)for(var dt=Ke+1;dt<=Oe;++dt){var yt=Ee.getLine(dt),wt=yt.indexOf(nt);if(!(wt==-1||f.test(yt.slice(0,wt)))){var jt=wt+nt.length;ce&&yt.slice(jt,jt+ce.length)==ce&&(jt+=ce.length),Ee.replaceRange("",m(dt,wt),m(dt,jt))}}}),!0)})})}()),comment.exports}requireComment();var showHint={exports:{}},hasRequiredShowHint;function requireShowHint(){return hasRequiredShowHint||(hasRequiredShowHint=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){var l="CodeMirror-hint",f="CodeMirror-hint-active";o.showHint=function(le,q,ce){if(!q)return le.showHint(ce);ce&&ce.async&&(q.async=!0);var Q={hint:q};if(ce)for(var N in ce)Q[N]=ce[N];return le.showHint(Q)},o.defineExtension("showHint",function(le){le=pe(this,this.getCursor("start"),le);var q=this.listSelections();if(!(q.length>1)){if(this.somethingSelected()){if(!le.hint.supportsSelection)return;for(var ce=0;ce<q.length;ce++)if(q[ce].head.line!=q[ce].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var Q=this.state.completionActive=new m(this,le);Q.options.hint&&(o.signal(this,"startCompletion",this),Q.update(!0))}}),o.defineExtension("closeHint",function(){this.state.completionActive&&this.state.completionActive.close()});function m(le,q){if(this.cm=le,this.options=q,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length,this.options.updateOnCursorActivity){var ce=this;le.on("cursorActivity",this.activityFunc=function(){ce.cursorActivity()})}}var D=window.requestAnimationFrame||function(le){return setTimeout(le,1e3/60)},F=window.cancelAnimationFrame||clearTimeout;m.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.options.updateOnCursorActivity&&this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&o.signal(this.data,"close"),this.widget&&this.widget.close(),o.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(le,q){var ce=le.list[q],Q=this;this.cm.operation(function(){ce.hint?ce.hint(Q.cm,le,ce):Q.cm.replaceRange(ue(ce),ce.from||le.from,ce.to||le.to,"complete"),o.signal(le,"pick",ce),Q.cm.scrollIntoView()}),this.options.closeOnPick&&this.close()},cursorActivity:function(){this.debounce&&(F(this.debounce),this.debounce=0);var le=this.startPos;this.data&&(le=this.data.from);var q=this.cm.getCursor(),ce=this.cm.getLine(q.line);if(q.line!=this.startPos.line||ce.length-q.ch!=this.startLen-this.startPos.ch||q.ch<le.ch||this.cm.somethingSelected()||!q.ch||this.options.closeCharacters.test(ce.charAt(q.ch-1)))this.close();else{var Q=this;this.debounce=D(function(){Q.update()}),this.widget&&this.widget.disable()}},update:function(le){if(this.tick!=null){var q=this,ce=++this.tick;we(this.options.hint,this.cm,this.options,function(Q){q.tick==ce&&q.finishUpdate(Q,le)})}},finishUpdate:function(le,q){this.data&&o.signal(this.data,"update");var ce=this.widget&&this.widget.picked||q&&this.options.completeSingle;this.widget&&this.widget.close(),this.data=le,le&&le.list.length&&(ce&&le.list.length==1?this.pick(le,0):(this.widget=new Z(this,le),o.signal(le,"shown")))}};function pe(le,q,ce){var Q=le.options.hintOptions,N={};for(var oe in Ke)N[oe]=Ke[oe];if(Q)for(var oe in Q)Q[oe]!==void 0&&(N[oe]=Q[oe]);if(ce)for(var oe in ce)ce[oe]!==void 0&&(N[oe]=ce[oe]);return N.hint.resolve&&(N.hint=N.hint.resolve(le,q)),N}function ue(le){return typeof le=="string"?le:le.text}function j(le,q){var ce={Up:function(){q.moveFocus(-1)},Down:function(){q.moveFocus(1)},PageUp:function(){q.moveFocus(-q.menuSize()+1,!0)},PageDown:function(){q.moveFocus(q.menuSize()-1,!0)},Home:function(){q.setFocus(0)},End:function(){q.setFocus(q.length-1)},Enter:q.pick,Tab:q.pick,Esc:q.close},Q=/Mac/.test(navigator.platform);Q&&(ce["Ctrl-P"]=function(){q.moveFocus(-1)},ce["Ctrl-N"]=function(){q.moveFocus(1)});var N=le.options.customKeys,oe=N?{}:ce;function de(nt,Ve){var st;typeof Ve!="string"?st=function(G){return Ve(G,q)}:ce.hasOwnProperty(Ve)?st=ce[Ve]:st=Ve,oe[nt]=st}if(N)for(var Te in N)N.hasOwnProperty(Te)&&de(Te,N[Te]);var ze=le.options.extraKeys;if(ze)for(var Te in ze)ze.hasOwnProperty(Te)&&de(Te,ze[Te]);return oe}function xe(le,q){for(;q&&q!=le;){if(q.nodeName.toUpperCase()==="LI"&&q.parentNode==le)return q;q=q.parentNode}}function Z(le,q){this.id="cm-complete-"+Math.floor(Math.random(1e6)),this.completion=le,this.data=q,this.picked=!1;var ce=this,Q=le.cm,N=Q.getInputField().ownerDocument,oe=N.defaultView||N.parentWindow,de=this.hints=N.createElement("ul");de.setAttribute("role","listbox"),de.setAttribute("aria-expanded","true"),de.id=this.id;var Te=le.cm.options.theme;de.className="CodeMirror-hints "+Te,this.selectedHint=q.selectedHint||0;for(var ze=q.list,nt=0;nt<ze.length;++nt){var Ve=de.appendChild(N.createElement("li")),st=ze[nt],G=l+(nt!=this.selectedHint?"":" "+f);st.className!=null&&(G=st.className+" "+G),Ve.className=G,nt==this.selectedHint&&Ve.setAttribute("aria-selected","true"),Ve.id=this.id+"-"+nt,Ve.setAttribute("role","option"),st.render?st.render(Ve,q,st):Ve.appendChild(N.createTextNode(st.displayText||ue(st))),Ve.hintId=nt}var U=le.options.container||N.body,T=Q.cursorCoords(le.options.alignWithWord?q.from:null),Be=T.left,Ne=T.bottom,Ze=!0,pt=0,gt=0;if(U!==N.body){var dt=["absolute","relative","fixed"].indexOf(oe.getComputedStyle(U).position)!==-1,yt=dt?U:U.offsetParent,wt=yt.getBoundingClientRect(),jt=N.body.getBoundingClientRect();pt=wt.left-jt.left-yt.scrollLeft,gt=wt.top-jt.top-yt.scrollTop}de.style.left=Be-pt+"px",de.style.top=Ne-gt+"px";var St=oe.innerWidth||Math.max(N.body.offsetWidth,N.documentElement.offsetWidth),Dt=oe.innerHeight||Math.max(N.body.offsetHeight,N.documentElement.offsetHeight);U.appendChild(de),Q.getInputField().setAttribute("aria-autocomplete","list"),Q.getInputField().setAttribute("aria-owns",this.id),Q.getInputField().setAttribute("aria-activedescendant",this.id+"-"+this.selectedHint);var bt=le.options.moveOnOverlap?de.getBoundingClientRect():new DOMRect,Lt=le.options.paddingForScrollbar?de.scrollHeight>de.clientHeight+1:!1,Wt;setTimeout(function(){Wt=Q.getScrollInfo()});var NA=bt.bottom-Dt;if(NA>0){var Tt=bt.bottom-bt.top,Jt=bt.top-(T.bottom-T.top)-2;Dt-bt.top<Jt?(Tt>Jt&&(de.style.height=(Tt=Jt)+"px"),de.style.top=(Ne=T.top-Tt)+gt+"px",Ze=!1):de.style.height=Dt-bt.top-2+"px"}var JA=bt.right-St;if(Lt&&(JA+=Q.display.nativeBarWidth),JA>0&&(bt.right-bt.left>St&&(de.style.width=St-5+"px",JA-=bt.right-bt.left-St),de.style.left=(Be=Math.max(T.left-JA-pt,0))+"px"),Lt)for(var sr=de.firstChild;sr;sr=sr.nextSibling)sr.style.paddingRight=Q.display.nativeBarWidth+"px";if(Q.addKeyMap(this.keyMap=j(le,{moveFocus:function(ZA,AA){ce.changeActive(ce.selectedHint+ZA,AA)},setFocus:function(ZA){ce.changeActive(ZA)},menuSize:function(){return ce.screenAmount()},length:ze.length,close:function(){le.close()},pick:function(){ce.pick()},data:q})),le.options.closeOnUnfocus){var Cr;Q.on("blur",this.onBlur=function(){Cr=setTimeout(function(){le.close()},100)}),Q.on("focus",this.onFocus=function(){clearTimeout(Cr)})}Q.on("scroll",this.onScroll=function(){var ZA=Q.getScrollInfo(),AA=Q.getWrapperElement().getBoundingClientRect();Wt||(Wt=Q.getScrollInfo());var on=Ne+Wt.top-ZA.top,qt=on-(oe.pageYOffset||(N.documentElement||N.body).scrollTop);if(Ze||(qt+=de.offsetHeight),qt<=AA.top||qt>=AA.bottom)return le.close();de.style.top=on+"px",de.style.left=Be+Wt.left-ZA.left+"px"}),o.on(de,"dblclick",function(ZA){var AA=xe(de,ZA.target||ZA.srcElement);AA&&AA.hintId!=null&&(ce.changeActive(AA.hintId),ce.pick())}),o.on(de,"click",function(ZA){var AA=xe(de,ZA.target||ZA.srcElement);AA&&AA.hintId!=null&&(ce.changeActive(AA.hintId),le.options.completeOnSingleClick&&ce.pick())}),o.on(de,"mousedown",function(){setTimeout(function(){Q.focus()},20)});var hr=this.getSelectedHintRange();return(hr.from!==0||hr.to!==0)&&this.scrollToActive(),o.signal(q,"select",ze[this.selectedHint],de.childNodes[this.selectedHint]),!0}Z.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode&&this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var le=this.completion.cm.getInputField();le.removeAttribute("aria-activedescendant"),le.removeAttribute("aria-owns");var q=this.completion.cm;this.completion.options.closeOnUnfocus&&(q.off("blur",this.onBlur),q.off("focus",this.onFocus)),q.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var le=this;this.keyMap={Enter:function(){le.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(le,q){if(le>=this.data.list.length?le=q?this.data.list.length-1:0:le<0&&(le=q?0:this.data.list.length-1),this.selectedHint!=le){var ce=this.hints.childNodes[this.selectedHint];ce&&(ce.className=ce.className.replace(" "+f,""),ce.removeAttribute("aria-selected")),ce=this.hints.childNodes[this.selectedHint=le],ce.className+=" "+f,ce.setAttribute("aria-selected","true"),this.completion.cm.getInputField().setAttribute("aria-activedescendant",ce.id),this.scrollToActive(),o.signal(this.data,"select",this.data.list[this.selectedHint],ce)}},scrollToActive:function(){var le=this.getSelectedHintRange(),q=this.hints.childNodes[le.from],ce=this.hints.childNodes[le.to],Q=this.hints.firstChild;q.offsetTop<this.hints.scrollTop?this.hints.scrollTop=q.offsetTop-Q.offsetTop:ce.offsetTop+ce.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=ce.offsetTop+ce.offsetHeight-this.hints.clientHeight+Q.offsetTop)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1},getSelectedHintRange:function(){var le=this.completion.options.scrollMargin||0;return{from:Math.max(0,this.selectedHint-le),to:Math.min(this.data.list.length-1,this.selectedHint+le)}}};function Ee(le,q){if(!le.somethingSelected())return q;for(var ce=[],Q=0;Q<q.length;Q++)q[Q].supportsSelection&&ce.push(q[Q]);return ce}function we(le,q,ce,Q){if(le.async)le(q,Q,ce);else{var N=le(q,ce);N&&N.then?N.then(Q):Q(N)}}function Oe(le,q){var ce=le.getHelpers(q,"hint"),Q;if(ce.length){var N=function(oe,de,Te){var ze=Ee(oe,ce);function nt(Ve){if(Ve==ze.length)return de(null);we(ze[Ve],oe,Te,function(st){st&&st.list.length>0?de(st):nt(Ve+1)})}nt(0)};return N.async=!0,N.supportsSelection=!0,N}else return(Q=le.getHelper(le.getCursor(),"hintWords"))?function(oe){return o.hint.fromList(oe,{words:Q})}:o.hint.anyword?function(oe,de){return o.hint.anyword(oe,de)}:function(){}}o.registerHelper("hint","auto",{resolve:Oe}),o.registerHelper("hint","fromList",function(le,q){var ce=le.getCursor(),Q=le.getTokenAt(ce),N,oe=o.Pos(ce.line,Q.start),de=ce;Q.start<ce.ch&&/\w/.test(Q.string.charAt(ce.ch-Q.start-1))?N=Q.string.substr(0,ce.ch-Q.start):(N="",oe=ce);for(var Te=[],ze=0;ze<q.words.length;ze++){var nt=q.words[ze];nt.slice(0,N.length)==N&&Te.push(nt)}if(Te.length)return{list:Te,from:oe,to:de}}),o.commands.autocomplete=o.showHint;var Ke={hint:o.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnPick:!0,closeOnUnfocus:!0,updateOnCursorActivity:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null,paddingForScrollbar:!0,moveOnOverlap:!0};o.defineOption("hintOptions",null)})}()),showHint.exports}requireShowHint();var activeLine={exports:{}},hasRequiredActiveLine;function requireActiveLine(){return hasRequiredActiveLine||(hasRequiredActiveLine=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){var l="CodeMirror-activeline",f="CodeMirror-activeline-background",m="CodeMirror-activeline-gutter";o.defineOption("styleActiveLine",!1,function(j,xe,Z){var Ee=Z==o.Init?!1:Z;xe!=Ee&&(Ee&&(j.off("beforeSelectionChange",ue),D(j),delete j.state.activeLines),xe&&(j.state.activeLines=[],pe(j,j.listSelections()),j.on("beforeSelectionChange",ue)))});function D(j){for(var xe=0;xe<j.state.activeLines.length;xe++)j.removeLineClass(j.state.activeLines[xe],"wrap",l),j.removeLineClass(j.state.activeLines[xe],"background",f),j.removeLineClass(j.state.activeLines[xe],"gutter",m)}function F(j,xe){if(j.length!=xe.length)return!1;for(var Z=0;Z<j.length;Z++)if(j[Z]!=xe[Z])return!1;return!0}function pe(j,xe){for(var Z=[],Ee=0;Ee<xe.length;Ee++){var we=xe[Ee],Oe=j.getOption("styleActiveLine");if(!(typeof Oe=="object"&&Oe.nonEmpty?we.anchor.line!=we.head.line:!we.empty())){var Ke=j.getLineHandleVisualStart(we.head.line);Z[Z.length-1]!=Ke&&Z.push(Ke)}}F(j.state.activeLines,Z)||j.operation(function(){D(j);for(var le=0;le<Z.length;le++)j.addLineClass(Z[le],"wrap",l),j.addLineClass(Z[le],"background",f),j.addLineClass(Z[le],"gutter",m);j.state.activeLines=Z})}function ue(j,xe){pe(j,xe.ranges)}})}()),activeLine.exports}requireActiveLine();var markSelection={exports:{}},hasRequiredMarkSelection;function requireMarkSelection(){return hasRequiredMarkSelection||(hasRequiredMarkSelection=1,function(w,i){(function(o){o(requireCodemirror())})(function(o){o.defineOption("styleSelectedText",!1,function(Z,Ee,we){var Oe=we&&we!=o.Init;Ee&&!Oe?(Z.state.markedSelection=[],Z.state.markedSelectionStyle=typeof Ee=="string"?Ee:"CodeMirror-selectedtext",j(Z),Z.on("cursorActivity",l),Z.on("change",f)):!Ee&&Oe&&(Z.off("cursorActivity",l),Z.off("change",f),ue(Z),Z.state.markedSelection=Z.state.markedSelectionStyle=null)});function l(Z){Z.state.markedSelection&&Z.operation(function(){xe(Z)})}function f(Z){Z.state.markedSelection&&Z.state.markedSelection.length&&Z.operation(function(){ue(Z)})}var m=8,D=o.Pos,F=o.cmpPos;function pe(Z,Ee,we,Oe){if(F(Ee,we)!=0)for(var Ke=Z.state.markedSelection,le=Z.state.markedSelectionStyle,q=Ee.line;;){var ce=q==Ee.line?Ee:D(q,0),Q=q+m,N=Q>=we.line,oe=N?we:D(Q,0),de=Z.markText(ce,oe,{className:le});if(Oe==null?Ke.push(de):Ke.splice(Oe++,0,de),N)break;q=Q}}function ue(Z){for(var Ee=Z.state.markedSelection,we=0;we<Ee.length;++we)Ee[we].clear();Ee.length=0}function j(Z){ue(Z);for(var Ee=Z.listSelections(),we=0;we<Ee.length;we++)pe(Z,Ee[we].from(),Ee[we].to())}function xe(Z){if(!Z.somethingSelected())return ue(Z);if(Z.listSelections().length>1)return j(Z);var Ee=Z.getCursor("start"),we=Z.getCursor("end"),Oe=Z.state.markedSelection;if(!Oe.length)return pe(Z,Ee,we);var Ke=Oe[0].find(),le=Oe[Oe.length-1].find();if(!Ke||!le||we.line-Ee.line<=m||F(Ee,le.to)>=0||F(we,Ke.from)<=0)return j(Z);for(;F(Ee,Ke.from)>0;)Oe.shift().clear(),Ke=Oe[0].find();for(F(Ee,Ke.from)<0&&(Ke.to.line-Ee.line<m?(Oe.shift().clear(),pe(Z,Ee,Ke.to,0)):pe(Z,Ee,Ke.from,0));F(we,le.to)<0;)Oe.pop().clear(),le=Oe[Oe.length-1].find();F(we,le.to)>0&&(we.line-le.from.line<m?(Oe.pop().clear(),pe(Z,le.from,we)):pe(Z,le.to,we))}})}()),markSelection.exports}requireMarkSelection();var iA=Object.defineProperty,sA=(w,i,o)=>i in w?iA(w,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):w[i]=o,a$1=(w,i,o)=>sA(w,typeof i!="symbol"?i+"":i,o);class P extends Error{constructor(i,o,l={}){const f=P.createFormattedMessage(i,l);super(f),a$1(this,"originalError"),a$1(this,"context"),this.name="TextmodeError",this.originalError=o,this.context=l}static createFormattedMessage(i,o){let l=i;if(o&&Object.keys(o).length>0){l+=`

📋 Context:`;for(const[f,m]of Object.entries(o)){const D=P.formatValue(m);l+=`
  - ${f}: ${D}`}}return l+=`

`,l+="↓".repeat(24)+`
`,l}static formatValue(i){if(i===null)return"null";if(i===void 0)return"undefined";if(typeof i=="string")return`"${i}"`;if(typeof i=="number"||typeof i=="boolean")return String(i);if(Array.isArray(i))return i.length===0?"[]":i.length<=5?`[${i.map(o=>P.formatValue(o)).join(", ")}]`:`[${i.slice(0,3).map(o=>P.formatValue(o)).join(", ")}, ... +${i.length-3} more]`;if(typeof i=="object"){const o=Object.keys(i);return o.length===0?"{}":o.length<=3?`{ ${o.map(l=>`${l}: ${P.formatValue(i[l])}`).join(", ")} }`:`{ ${o.slice(0,2).map(l=>`${l}: ${P.formatValue(i[l])}`).join(", ")}, ... +${o.length-2} more }`}return String(i)}}const v=class Ks{constructor(){a$1(this,"_options",{globalLevel:3})}static getInstance(){return Ks._instance||(Ks._instance=new Ks),Ks._instance}_handle(i,o,l){const f="[textmode.js]";switch(this._options.globalLevel){case 0:return!1;case 1:return console.group(`%c${f} Oops! (╯°□°)╯︵ Something went wrong in your code.`,"color: #f44336; font-weight: bold; background: #ffebee; padding: 2px 6px; border-radius: 3px;"),console.warn(P.createFormattedMessage(i,o)),console.groupEnd(),!1;case 2:return console.group(`%c${f} Oops! (╯°□°)╯︵ Something went wrong in your code.`,"color: #f44336; font-weight: bold; background: #ffebee; padding: 2px 6px; border-radius: 3px;"),console.error(P.createFormattedMessage(i,o)),console.groupEnd(),!1;case 3:default:const m=new P(i,l,o);throw console.group(`%c${f} Oops! (╯°□°)╯︵ Something went wrong in your code.`,"color: #d32f2f; font-weight: bold; background: #ffcdd2; padding: 2px 6px; border-radius: 3px;"),m}}validate(i,o,l){return i?!0:(this._handle(o,l),!1)}setGlobalLevel(i){this._options.globalLevel=i}};a$1(v,"_instance",null);let V=v;const C=V.getInstance();class aA{constructor(i,o,l=o,f={}){a$1(this,"gl"),a$1(this,"_framebuffer"),a$1(this,"_texture"),a$1(this,"_width"),a$1(this,"_height"),a$1(this,"options"),a$1(this,"previousState",null),a$1(this,"_pixels",null),this.gl=i,this._width=o,this._height=l,this.options={filter:"nearest",wrap:"clamp",format:"rgba",type:"unsigned_byte",...f},this._texture=this.createTexture(),this._framebuffer=i.createFramebuffer(),this.attachTexture()}createTexture(){const{gl:i}=this,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o);const l=this.options.filter==="linear"?i.LINEAR:i.NEAREST,f=this.options.wrap==="repeat"?i.REPEAT:i.CLAMP_TO_EDGE;return i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,l),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,l),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,f),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,f),this.updateTextureSize(),o}updateTextureSize(){const{gl:i}=this,o=i.RGBA,l=i.RGBA,f=this.options.type==="float"?i.FLOAT:i.UNSIGNED_BYTE;i.texImage2D(i.TEXTURE_2D,0,o,this._width,this._height,0,l,f,null)}attachTexture(){const{gl:i}=this;i.bindFramebuffer(i.FRAMEBUFFER,this._framebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this._texture,0),i.bindFramebuffer(i.FRAMEBUFFER,null)}update(i){const{gl:o}=this;i instanceof HTMLVideoElement&&i.readyState<2||(o.bindTexture(o.TEXTURE_2D,this._texture),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,i),o.bindTexture(o.TEXTURE_2D,null))}updatePixels(i,o,l){const{gl:f}=this;f.bindTexture(f.TEXTURE_2D,this._texture),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,o,l,0,f.RGBA,f.UNSIGNED_BYTE,i),f.bindTexture(f.TEXTURE_2D,null)}resize(i,o){const{gl:l}=this;this._width=i,this._height=o,l.bindTexture(l.TEXTURE_2D,this._texture),this.updateTextureSize(),l.bindTexture(l.TEXTURE_2D,null)}begin(){const{gl:i}=this;this.previousState={framebuffer:i.getParameter(i.FRAMEBUFFER_BINDING),viewport:i.getParameter(i.VIEWPORT)},i.bindFramebuffer(i.FRAMEBUFFER,this._framebuffer),i.viewport(0,0,this._width,this._height)}end(){if(!this.previousState)return;const{gl:i}=this;i.bindFramebuffer(i.FRAMEBUFFER,this.previousState.framebuffer),i.viewport(...this.previousState.viewport),this.previousState=null}loadPixels(){const{gl:i}=this;this._pixels||(this._pixels=new Uint8Array(this._width*this._height*4));const o=i.getParameter(i.FRAMEBUFFER_BINDING);i.bindFramebuffer(i.FRAMEBUFFER,this._framebuffer),i.readPixels(0,0,this._width,this._height,i.RGBA,i.UNSIGNED_BYTE,this._pixels),i.bindFramebuffer(i.FRAMEBUFFER,o)}get(i,o,l,f){const{gl:m}=this;if(i===void 0&&o===void 0){const D=new Uint8Array(this._width*this._height*4),F=m.getParameter(m.FRAMEBUFFER_BINDING);return m.bindFramebuffer(m.FRAMEBUFFER,this._framebuffer),m.readPixels(0,0,this._width,this._height,m.RGBA,m.UNSIGNED_BYTE,D),m.bindFramebuffer(m.FRAMEBUFFER,F),D}else if(l===void 0&&f===void 0){(i<0||o<0||i>=this._width||o>=this._height)&&(console.warn("The x and y values passed to Framebuffer.get are outside of its range and will be clamped."),i=Math.max(0,Math.min(i,this._width-1)),o=Math.max(0,Math.min(o,this._height-1)));const D=new Uint8Array(4),F=m.getParameter(m.FRAMEBUFFER_BINDING);return m.bindFramebuffer(m.FRAMEBUFFER,this._framebuffer),m.readPixels(i,o,1,1,m.RGBA,m.UNSIGNED_BYTE,D),m.bindFramebuffer(m.FRAMEBUFFER,F),[D[0],D[1],D[2],D[3]]}else{i=Math.max(0,Math.min(i,this._width-1)),o=Math.max(0,Math.min(o,this._height-1)),l=Math.max(1,Math.min(l,this._width-i)),f=Math.max(1,Math.min(f,this._height-o));const D=new Uint8Array(l*f*4),F=m.getParameter(m.FRAMEBUFFER_BINDING);return m.bindFramebuffer(m.FRAMEBUFFER,this._framebuffer),m.readPixels(i,o,l,f,m.RGBA,m.UNSIGNED_BYTE,D),m.bindFramebuffer(m.FRAMEBUFFER,F),D}}get framebuffer(){return this._framebuffer}get texture(){return this._texture}get width(){return this._width}get height(){return this._height}get pixels(){return this._pixels}}class K{constructor(i,o,l){a$1(this,"gl"),a$1(this,"x"),a$1(this,"y"),this.gl=i,this.x=o,this.y=l}}class y{constructor(i,o,l,f,m){a$1(this,"gl"),a$1(this,"vertexBuffer"),a$1(this,"vertexCount",6),a$1(this,"bytesPerVertex"),this.gl=i,this.bytesPerVertex=16;const D=i.getParameter(i.VIEWPORT),F=D[2],pe=D[3],ue=i.getParameter(i.FRAMEBUFFER_BINDING)!==null,j=o/F*2-1,xe=(o+f)/F*2-1;let Z,Ee;ue?(Z=l/pe*2-1,Ee=(l+m)/pe*2-1):(Z=1-l/pe*2,Ee=1-(l+m)/pe*2);let we,Oe,Ke,le;we=j,Ke=xe,Oe=Z,le=Ee;const q=this.generateVertices(we,Oe,Ke,le);this.vertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,q,i.STATIC_DRAW)}generateVertices(i,o,l,f){return new Float32Array([i,f,0,1,l,f,1,1,i,o,0,0,i,o,0,0,l,f,1,1,l,o,1,0])}render(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer);const i=this.gl.getParameter(this.gl.CURRENT_PROGRAM);let o=this.gl.getAttribLocation(i,"a_position"),l=this.gl.getAttribLocation(i,"a_texCoord");this.gl.enableVertexAttribArray(o),this.gl.vertexAttribPointer(o,2,this.gl.FLOAT,!1,this.bytesPerVertex,0),this.gl.enableVertexAttribArray(l),this.gl.vertexAttribPointer(l,2,this.gl.FLOAT,!1,this.bytesPerVertex,8),this.gl.drawArrays(this.gl.TRIANGLES,0,this.vertexCount),this.gl.disableVertexAttribArray(o),this.gl.disableVertexAttribArray(l)}}class nA extends K{constructor(i,o,l,f,m){super(i,o,l),a$1(this,"width"),a$1(this,"height"),this.width=f,this.height=m}renderFill(){new y(this.gl,this.x,this.y,this.width,this.height).render()}renderStroke(i){if(i<=0)return;const o=new y(this.gl,this.x,this.y,this.width,i),l=new y(this.gl,this.x+this.width-i,this.y,i,this.height),f=new y(this.gl,this.x,this.y+this.height-i,this.width,i),m=new y(this.gl,this.x,this.y,i,this.height);o.render(),l.render(),f.render(),m.render()}}class gA{constructor(i,o,l,f,m,D){a$1(this,"gl"),a$1(this,"vertexBuffer"),a$1(this,"vertexCount",6),a$1(this,"bytesPerVertex"),this.gl=i,this.bytesPerVertex=16;const F=i.getParameter(i.VIEWPORT),pe=F[2],ue=F[3],j=i.getParameter(i.FRAMEBUFFER_BINDING)!==null,xe=f-o,Z=m-l,Ee=Math.sqrt(xe*xe+Z*Z);if(Ee===0){const pt=this.generateVertices(0,0,0,0);this.vertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,pt,i.STATIC_DRAW);return}const we=xe/Ee,Oe=-(Z/Ee),Ke=we,le=D/2,q=o+Oe*le,ce=l+Ke*le,Q=o-Oe*le,N=l-Ke*le,oe=f+Oe*le,de=m+Ke*le,Te=f-Oe*le,ze=m-Ke*le,nt=q/pe*2-1,Ve=Q/pe*2-1,st=oe/pe*2-1,G=Te/pe*2-1;let U,T,Be,Ne;j?(U=ce/ue*2-1,T=N/ue*2-1,Be=de/ue*2-1,Ne=ze/ue*2-1):(U=1-ce/ue*2,T=1-N/ue*2,Be=1-de/ue*2,Ne=1-ze/ue*2);const Ze=this.generateLineVertices(nt,U,Ve,T,st,Be,G,Ne);this.vertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,Ze,i.STATIC_DRAW)}generateVertices(i,o,l,f){return new Float32Array([i,f,0,1,l,f,1,1,i,o,0,0,i,o,0,0,l,f,1,1,l,o,1,0])}generateLineVertices(i,o,l,f,m,D,F,pe){return new Float32Array([i,o,0,0,l,f,0,1,m,D,1,0,l,f,0,1,F,pe,1,1,m,D,1,0])}render(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer);const i=this.gl.getParameter(this.gl.CURRENT_PROGRAM);let o=this.gl.getAttribLocation(i,"a_position"),l=this.gl.getAttribLocation(i,"a_texCoord");this.gl.enableVertexAttribArray(o),this.gl.vertexAttribPointer(o,2,this.gl.FLOAT,!1,this.bytesPerVertex,0),this.gl.enableVertexAttribArray(l),this.gl.vertexAttribPointer(l,2,this.gl.FLOAT,!1,this.bytesPerVertex,8),this.gl.drawArrays(this.gl.TRIANGLES,0,this.vertexCount),this.gl.disableVertexAttribArray(o),this.gl.disableVertexAttribArray(l)}}class BA extends K{constructor(i,o,l,f,m){super(i,o,l),a$1(this,"x2"),a$1(this,"y2"),this.x2=f,this.y2=m}renderFill(){}renderStroke(i){i<=0||new gA(this.gl,this.x,this.y,this.x2,this.y2,i).render()}}class p{constructor(i,o,l){a$1(this,"gl"),a$1(this,"program"),a$1(this,"uniformLocations",new Map),a$1(this,"attributeLocations",new Map),a$1(this,"textureUnitCounter",0),this.gl=i,this.program=this.createProgram(o,l),this.cacheLocations()}createProgram(i,o){const l=this.createShader(this.gl.VERTEX_SHADER,i),f=this.createShader(this.gl.FRAGMENT_SHADER,o),m=this.gl.createProgram();if(this.gl.attachShader(m,l),this.gl.attachShader(m,f),this.gl.linkProgram(m),!this.gl.getProgramParameter(m,this.gl.LINK_STATUS)){const D=this.gl.getProgramInfoLog(m);throw new Error(`Shader program link error: ${D}`)}return this.gl.deleteShader(l),this.gl.deleteShader(f),m}createShader(i,o){const l=this.gl.createShader(i);if(this.gl.shaderSource(l,o),this.gl.compileShader(l),!this.gl.getShaderParameter(l,this.gl.COMPILE_STATUS)){const f=this.gl.getShaderInfoLog(l);throw this.gl.deleteShader(l),new Error(`Shader compilation error: ${f}`)}return l}cacheLocations(){const i=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let l=0;l<i;l++){const f=this.gl.getActiveUniform(this.program,l);if(f){const m=this.gl.getUniformLocation(this.program,f.name);m&&this.uniformLocations.set(f.name,m)}}const o=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let l=0;l<o;l++){const f=this.gl.getActiveAttrib(this.program,l);if(f){const m=this.gl.getAttribLocation(this.program,f.name);this.attributeLocations.set(f.name,m)}}}use(){this.gl.useProgram(this.program),this.resetTextureUnits()}setUniform(i,o){const l=this.uniformLocations.get(i);if(!l)return;const f=this.getUniformInfo(i);if(typeof o=="number")f&&f.type===this.gl.INT?this.gl.uniform1i(l,Math.floor(o)):this.gl.uniform1f(l,o);else if(typeof o=="boolean")this.gl.uniform1i(l,o?1:0);else if(Array.isArray(o))if(f&&(f.type===this.gl.INT_VEC2||f.type===this.gl.INT_VEC3||f.type===this.gl.INT_VEC4)){const m=o.map(D=>Math.floor(D));switch(m.length){case 2:this.gl.uniform2iv(l,m);break;case 3:this.gl.uniform3iv(l,m);break;case 4:this.gl.uniform4iv(l,m);break;default:console.warn(`Unsupported array length ${m.length} for uniform '${i}'`)}}else switch(o.length){case 2:this.gl.uniform2f(l,o[0],o[1]);break;case 3:this.gl.uniform3f(l,o[0],o[1],o[2]);break;case 4:this.gl.uniform4f(l,o[0],o[1],o[2],o[3]);break;default:console.warn(`Unsupported array length ${o.length} for uniform '${i}'`)}else if(o instanceof WebGLTexture){const m=this.getNextTextureUnit();this.gl.uniform1i(l,m),this.gl.activeTexture(this.gl.TEXTURE0+m),this.gl.bindTexture(this.gl.TEXTURE_2D,o)}else if(o&&typeof o=="object"&&"texture"in o){const m=this.getNextTextureUnit();this.gl.uniform1i(l,m),this.gl.activeTexture(this.gl.TEXTURE0+m),this.gl.bindTexture(this.gl.TEXTURE_2D,o.texture)}else console.warn(`Unsupported uniform type for '${i}':`,typeof o)}getUniformInfo(i){const o=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let l=0;l<o;l++){const f=this.gl.getActiveUniform(this.program,l);if(f&&f.name===i)return f}return null}getNextTextureUnit(){return this.textureUnitCounter++}hasUniform(i){return this.uniformLocations.has(i)}hasAttribute(i){return this.attributeLocations.has(i)}get glProgram(){return this.program}resetTextureUnits(){this.textureUnitCounter=0}}var _="attribute vec2 a_position;attribute vec2 a_texCoord;varying vec2 v_uv;uniform float u_rotation;uniform vec2 u_center;uniform float u_aspectRatio;mat2 rotate2D(float angle){float s=sin(angle);float c=cos(angle);return mat2(c,-s,s,c);}void main(){v_uv=a_texCoord;vec2 pos=a_position;pos-=u_center;pos.x*=u_aspectRatio;pos=rotate2D(-u_rotation)*pos;pos.x/=u_aspectRatio;pos+=u_center;gl_Position=vec4(pos,0.0,1.0);}",EA="precision lowp float;uniform sampler2D u_texture;varying vec2 v_uv;void main(){gl_FragColor=texture2D(u_texture,v_uv);}",QA="precision lowp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}";class lA{constructor(i){a$1(this,"gl"),a$1(this,"imageShader"),a$1(this,"solidColorShader"),a$1(this,"currentShader",null),a$1(this,"currentFillColor",[1,1,1,1]),a$1(this,"fillMode",!0),a$1(this,"currentStrokeColor",[0,0,0,1]),a$1(this,"currentStrokeWeight",1),a$1(this,"strokeMode",!0),a$1(this,"currentRotation",0),a$1(this,"stateStack",[]),this.gl=i,this.imageShader=new p(this.gl,_,EA),this.solidColorShader=new p(this.gl,_,QA),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}shader(i){this.currentShader=i,i.use()}fill(i,o,l,f){if(this.fillMode=!0,o===void 0&&l===void 0&&f===void 0){const m=i/255;this.currentFillColor=[m,m,m,1]}else if(l!==void 0&&f===void 0)this.currentFillColor=[i/255,o/255,l/255,1];else if(l!==void 0&&f!==void 0)this.currentFillColor=[i/255,o/255,l/255,f/255];else throw new Error("Invalid fill parameters. Use fill(gray), fill(r,g,b), or fill(r,g,b,a)")}stroke(i,o,l,f){if(this.strokeMode=!0,o===void 0&&l===void 0&&f===void 0){const m=i/255;this.currentStrokeColor=[m,m,m,1]}else if(l!==void 0&&f===void 0)this.currentStrokeColor=[i/255,o/255,l/255,1];else if(l!==void 0&&f!==void 0)this.currentStrokeColor=[i/255,o/255,l/255,f/255];else throw new Error("Invalid stroke parameters. Use stroke(gray), stroke(r,g,b), or stroke(r,g,b,a)")}strokeWeight(i){if(i<0)throw new Error("Stroke weight must be non-negative");this.currentStrokeWeight=i}noStroke(){this.strokeMode=!1}noFill(){this.fillMode=!1}rotate(i){this.currentRotation=i}push(){this.stateStack.push({fillColor:[...this.currentFillColor],fillMode:this.fillMode,strokeColor:[...this.currentStrokeColor],strokeWeight:this.currentStrokeWeight,strokeMode:this.strokeMode,rotation:this.currentRotation})}pop(){const i=this.stateStack.pop();i?(this.currentFillColor=i.fillColor,this.fillMode=i.fillMode,this.currentStrokeColor=i.strokeColor,this.currentStrokeWeight=i.strokeWeight,this.strokeMode=i.strokeMode,this.currentRotation=i.rotation):console.warn("pop() called without matching push()")}reset(){this.currentShader=null,this.stateStack=[],this.currentRotation=0,this.fillMode=!0,this.strokeMode=!0,this.currentFillColor=[1,1,1,1],this.currentStrokeColor=[0,0,0,1],this.currentStrokeWeight=1}createShader(i,o){return new p(this.gl,i,o)}setUniform(i,o){this.currentShader.setUniform(i,o)}rect(i,o,l,f){const m=new nA(this.gl,i,o,l,f);if(this.currentShader!==null){if(this.currentRotation!==0){const{centerX:xe,centerY:Z,radians:Ee,aspectRatio:we}=this.calculateRotationParams(i,o,l,f);this.setUniform("u_rotation",Ee),this.setUniform("u_center",[xe,Z]),this.setUniform("u_aspectRatio",we)}else this.setUniform("u_rotation",0),this.setUniform("u_center",[0,0]),this.setUniform("u_aspectRatio",1);m.renderFill(),this.currentShader=null;return}const D=this.solidColorShader,{centerX:F,centerY:pe,radians:ue,aspectRatio:j}=this.calculateRotationParams(i,o,l,f);this.fillMode&&(this.shader(D),this.setUniform("u_color",this.currentFillColor),this.setUniform("u_rotation",ue),this.setUniform("u_center",[F,pe]),this.setUniform("u_aspectRatio",j),m.renderFill()),this.strokeMode&&(this.shader(D),this.setUniform("u_color",this.currentStrokeColor),this.setUniform("u_rotation",ue),this.setUniform("u_center",[F,pe]),this.setUniform("u_aspectRatio",j),m.renderStroke(this.currentStrokeWeight)),this.currentShader=null}line(i,o,l,f){if(!this.strokeMode)return;const m=new BA(this.gl,i,o,l,f);if(this.currentShader!==null){if(this.currentRotation!==0){const Oe=(i+l)/2,Ke=(o+f)/2,le=Math.abs(l-i),q=Math.abs(f-o),{centerX:ce,centerY:Q,radians:N,aspectRatio:oe}=this.calculateRotationParams(Oe-le/2,Ke-q/2,le,q);this.setUniform("u_rotation",N),this.setUniform("u_center",[ce,Q]),this.setUniform("u_aspectRatio",oe)}else this.setUniform("u_rotation",0),this.setUniform("u_center",[0,0]),this.setUniform("u_aspectRatio",1);m.renderStroke(this.currentStrokeWeight),this.currentShader=null;return}const D=this.solidColorShader,F=(i+l)/2,pe=(o+f)/2,ue=Math.abs(l-i),j=Math.abs(f-o),{centerX:xe,centerY:Z,radians:Ee,aspectRatio:we}=this.calculateRotationParams(F-ue/2,pe-j/2,ue,j);this.shader(D),this.setUniform("u_color",this.currentStrokeColor),this.setUniform("u_rotation",Ee),this.setUniform("u_center",[xe,Z]),this.setUniform("u_aspectRatio",we),m.renderStroke(this.currentStrokeWeight),this.currentShader=null}calculateRotationParams(i,o,l,f){const m=this.gl.getParameter(this.gl.VIEWPORT),D=m[2],F=m[3],pe=D/F,ue=this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)!==null,j=i+l/2,xe=o+f/2,Z=j/D*2-1;let Ee;ue?Ee=xe/F*2-1:Ee=1-xe/F*2;const we=this.currentRotation*Math.PI/180;return{centerX:Z,centerY:Ee,radians:we,aspectRatio:pe}}createFramebuffer(i,o,l={}){return new aA(this.gl,i,o,l)}background(i,o=i,l=i,f=255){this.clear(i/255,o/255,l/255,f/255)}clear(i=0,o=0,l=0,f=0){this.gl.clearColor(i,o,l,f),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}resetViewport(){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}get context(){return this.gl}image(i,o,l,f,m){this.shader(this.imageShader),this.setUniform("u_texture",i.texture);const{centerX:D,centerY:F,radians:pe,aspectRatio:ue}=this.calculateRotationParams(o,l,f??i.width,m??i.height);this.setUniform("u_rotation",pe),this.setUniform("u_center",[D,F]),this.setUniform("u_aspectRatio",ue),this.rect(o,l,f??i.width,m??i.height)}}var h={};h.parse=function(w){var i=function(m,D,F,pe){var ue=h.T,j={cmap:ue.cmap,head:ue.head,hhea:ue.hhea,maxp:ue.maxp,hmtx:ue.hmtx,loca:ue.loca,glyf:ue.glyf},xe={_data:m,_index:D,_offset:F};for(var Z in j){var Ee=h.findTable(m,Z,F);if(Ee){var we=Ee[0],Oe=pe[we];Oe==null&&(Oe=j[Z].parseTab(m,we,Ee[1],xe)),xe[Z]=pe[we]=Oe}}return xe},o=new Uint8Array(w),l={},f=i(o,0,0,l);return[f]};h.findTable=function(w,i,o){for(var l=h.B,f=l.readUshort(w,o+4),m=o+12,D=0;D<f;D++){var F=l.readASCII(w,m,4);l.readUint(w,m+4);var pe=l.readUint(w,m+8),ue=l.readUint(w,m+12);if(F==i)return[pe,ue];m+=16}return null};h.T={};h.B={readShort:function(w,i){var o=h.B.t.uint16;return o[0]=w[i]<<8|w[i+1],h.B.t.int16[0]},readUshort:function(w,i){return w[i]<<8|w[i+1]},readUshorts:function(w,i,o){for(var l=[],f=0;f<o;f++)l.push(h.B.readUshort(w,i+f*2));return l},readUint:function(w,i){var o=h.B.t.uint8;return o[3]=w[i],o[2]=w[i+1],o[1]=w[i+2],o[0]=w[i+3],h.B.t.uint32[0]},readASCII:function(w,i,o){for(var l="",f=0;f<o;f++)l+=String.fromCharCode(w[i+f]);return l},t:function(){var w=new ArrayBuffer(8);return{uint8:new Uint8Array(w),int16:new Int16Array(w),uint16:new Uint16Array(w),uint32:new Uint32Array(w)}}()};h.T.cmap={parseTab:function(w,i,o){var l={tables:[],ids:{},off:i};w=new Uint8Array(w.buffer,i,o),i=0;var f=h.B,m=f.readUshort,D=h.T.cmap;m(w,i),i+=2;var F=m(w,i);i+=2;for(var pe=[],ue=0;ue<F;ue++){var j=m(w,i);i+=2;var xe=m(w,i);i+=2;var Z=f.readUint(w,i);i+=4;var Ee="p"+j+"e"+xe,we=pe.indexOf(Z);if(we==-1){we=l.tables.length;var Oe={};pe.push(Z);var Ke=Oe.format=m(w,Z);Ke==4?Oe=D.parse4(w,Z,Oe):Ke==12&&(Oe=D.parse12(w,Z,Oe)),l.tables.push(Oe)}l.ids[Ee]!=null&&console.log("multiple tables for one platform+encoding: "+Ee),l.ids[Ee]=we}return l},parse4:function(w,i,o){var l=h.B,f=l.readUshort,m=l.readUshorts,D=i;i+=2;var F=f(w,i);i+=2,f(w,i),i+=2;var pe=f(w,i);i+=2;var ue=pe>>>1;o.searchRange=f(w,i),i+=2,o.entrySelector=f(w,i),i+=2,o.rangeShift=f(w,i),i+=2,o.endCount=m(w,i,ue),i+=ue*2,i+=2,o.startCount=m(w,i,ue),i+=ue*2,o.idDelta=[];for(var j=0;j<ue;j++)o.idDelta.push(l.readShort(w,i)),i+=2;return o.idRangeOffset=m(w,i,ue),i+=ue*2,o.glyphIdArray=m(w,i,D+F-i>>1),o},parse12:function(w,i,o){var l=h.B,f=l.readUint;i+=4,f(w,i),i+=4,f(w,i),i+=4;var m=f(w,i)*3;i+=4;for(var D=o.groups=new Uint32Array(m),F=0;F<m;F+=3)D[F]=f(w,i+(F<<2)),D[F+1]=f(w,i+(F<<2)+4),D[F+2]=f(w,i+(F<<2)+8);return o}};h.T.head={parseTab:function(w,i,o){var l=h.B,f={};return i+=18,f.unitsPerEm=l.readUshort(w,i),i+=2,i+=16,f.xMin=l.readShort(w,i),i+=2,f.yMin=l.readShort(w,i),i+=2,f.xMax=l.readShort(w,i),i+=2,f.yMax=l.readShort(w,i),i+=2,i+=6,f.indexToLocFormat=l.readShort(w,i),f}};h.T.hhea={parseTab:function(w,i,o){var l=h.B,f={};i+=4;for(var m=["ascender","descender","lineGap","advanceWidthMax","minLeftSideBearing","minRightSideBearing","xMaxExtent","caretSlopeRise","caretSlopeRun","caretOffset","res0","res1","res2","res3","metricDataFormat","numberOfHMetrics"],D=0;D<m.length;D++){var F=m[D],pe=F=="advanceWidthMax"||F=="numberOfHMetrics"?l.readUshort:l.readShort;f[F]=pe(w,i+D*2)}return f}};h.T.hmtx={parseTab:function(w,i,o,l){for(var f=h.B,m=[],D=[],F=l.maxp.numGlyphs,pe=l.hhea.numberOfHMetrics,ue=0,j=0,xe=0;xe<pe;)ue=f.readUshort(w,i+(xe<<2)),j=f.readShort(w,i+(xe<<2)+2),m.push(ue),D.push(j),xe++;for(;xe<F;)m.push(ue),D.push(j),xe++;return{aWidth:m,lsBearing:D}}};h.T.maxp={parseTab:function(w,i,o){var l=h.B,f=l.readUshort,m={};return l.readUint(w,i),i+=4,m.numGlyphs=f(w,i),i+=2,m}};h.T.loca={parseTab:function(w,i,o,l){var f=h.B,m=[],D=l.head.indexToLocFormat,F=l.maxp.numGlyphs+1;if(D==0)for(var pe=0;pe<F;pe++)m.push(f.readUshort(w,i+(pe<<1))<<1);if(D==1)for(var pe=0;pe<F;pe++)m.push(f.readUint(w,i+(pe<<2)));return m}};h.T.glyf={parseTab:function(w,i,o,l){for(var f=[],m=l.maxp.numGlyphs,D=0;D<m;D++)f.push(null);return f},_parseGlyf:function(w,i){var o=h.B,l=w._data,f=w.loca;if(f[i]==f[i+1])return null;var m=h.findTable(l,"glyf",w._offset)[0]+f[i],D={};if(D.noc=o.readShort(l,m),m+=2,D.xMin=o.readShort(l,m),m+=2,D.yMin=o.readShort(l,m),m+=2,D.xMax=o.readShort(l,m),m+=2,D.yMax=o.readShort(l,m),m+=2,D.xMin>=D.xMax||D.yMin>=D.yMax)return null;if(D.noc>0){D.endPts=[];for(var F=0;F<D.noc;F++)D.endPts.push(o.readUshort(l,m)),m+=2;var pe=o.readUshort(l,m);if(m+=2,l.length-m<pe)return null;m+=pe;var ue=D.endPts[D.noc-1]+1;D.flags=[];for(var F=0;F<ue;F++){var j=l[m];if(m++,D.flags.push(j),j&8){var xe=l[m];m++;for(var Z=0;Z<xe;Z++)D.flags.push(j),F++}}D.xs=[];for(var F=0;F<ue;F++){var Ee=(D.flags[F]&2)!=0,we=(D.flags[F]&16)!=0;Ee?(D.xs.push(we?l[m]:-l[m]),m++):we?D.xs.push(0):(D.xs.push(o.readShort(l,m)),m+=2)}D.ys=[];for(var F=0;F<ue;F++){var Ee=(D.flags[F]&4)!=0,we=(D.flags[F]&32)!=0;Ee?(D.ys.push(we?l[m]:-l[m]),m++):we?D.ys.push(0):(D.ys.push(o.readShort(l,m)),m+=2)}for(var Oe=0,Ke=0,F=0;F<ue;F++)Oe+=D.xs[F],Ke+=D.ys[F],D.xs[F]=Oe,D.ys[F]=Ke}else D.parts=[];return D}};typeof module<"u"&&module.exports?module.exports=h:typeof window<"u"&&(window.Typr=h);const hA=`data:font/truetype;charset=utf-8;base64,AAEAAAAKAIAAAwAgT1MvMs+QEyQAAAEoAAAAYGNtYXAg7yVJAAAFjAAACSBnbHlmuHLTdAAAErQAAGi0aGVhZFvXdUwAAACsAAAANmhoZWELAQUCAAAA5AAAACRobXR4BACDgAAAAYgAAAQEbG9jYQAy54AAAA6sAAAECG1heHABIgCCAAABCAAAACBuYW1lVs/OSgAAe2gAAAOicG9zdABpADQAAH8MAAAAIAABAAAAAQAAzOWHqV8PPPUAAAQAAAAAAHxiGCcAAAAAfGIYJwAAAAAEAAQAAAAACAACAAEAAAAAAAEAAAQAAAAAAAQAAAAAAAcAAAEAAAAAAAAAAAAAAAAAAAEBAAEAAAEBAIAAIAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAgQAAZAABQAEAgACAAAAAAACAAIAAAACAAAzAMwAAAAABAAAAAAAAACAAACLAABw4wAAAAAAAAAAWUFMLgBAACAmawQAAAAAAAQAAAAAAAFRAAAAAAMABAAAAAAgAAAEAAAABAAAAAQAAAAEAAGABAABAAQAAIAEAACABAAAgAQAAIAEAAGABAABAAQAAQAEAACABAABAAQAAIAEAACABAABAAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAABAAQAAIAEAAEABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAABAAQAAIAEAAEABAAAgAQAAIAEAAEABAAAgAQAAIAEAACABAAAgAQAAIAEAAEABAAAgAQAAIAEAAGABAAAgAQAAIAEAAGABAAAgAQAAIAEAACABAAAgAQAAIAEAAEABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAAAgAQAAIAEAACABAABgAQAAQAEAACABAAAAAQAAgAEAACABAAAgAQAAIAEAACABAACAAQAAAAEAAIABAABgAQAAgAEAACABAAAgAQAAAAEAACABAAAAAQAAAAEAAAABAAAAAQAAAAEAAIABAADAAQAAAAEAAAABAAAgAQAAYAEAAAABAAAAAQAAIAEAAAABAAAgAQAAIAEAACABAAAAAQAAIAEAAAABAAAAAQAAIAEAAGABAAAAAQAAAAEAAAABAAAAAQAAIAEAACABAAAAAQAAIAEAACABAAAAAQAAIAEAACABAAAgAQAAAAEAACABAAAAAQAAAAEAAEABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAACAAQAAIAEAAAABAAAAAQAAAAEAACABAABAAQAAQAEAAEABAABAAQAAIAEAACABAAAAAQAAAAEAAAABAABAAQAAAAEAACABAAAAAQAAAAEAAIABAAAgAQAAAAEAAAABAAAAAQAAAAEAAAABAABgAQAAAAEAAAABAABgAQAAAAEAAGABAABgAQAAYAEAAAABAAAAAQAAAAEAAAABAABgAQAAYAEAAAABAAAAAQAAAAEAAAABAABgAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAABgAQAAAAEAAGABAABgAQAAAAEAAAABAABgAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAYAEAAAABAAAAAQAAQAEAACABAAAAAQAAAAEAAAABAAAgAQAAIAEAACABAAAgAQAAIAEAAAABAABAAQAAIAEAACABAAAgAQAAIAEAAEABAAAgAQAAIAEAACABAAAgAQAAIAEAAEABAAAgAAAAAIAAAADAAAAFAADAAEAAASaAAQEhgAAAJ4AgAAGAB4AfgCjAKUApwCsALIAtwC9AL8AxwDJANEA1gDcAOIA7wD0APcA/AD/AZIDkwOYA6MDpgOpA7EDtQPAA8QDxiAiIDwgfyCnIZUhqCIaIh8iKSJIImEiZSMCIxAjISUAJQIlDCUQJRQlGCUcJSQlLCU0JTwlbCWAJYQliCWMJZMloSWsJbIluiW8JcQlyyXZJjwmQCZCJmAmYyZmJmv//wAAACAAoQClAKcAqgCwALUAugC/AMQAyQDRANYA3ADfAOQA8QD2APkA/wGSA5MDmAOjA6YDqQOxA7QDwAPDA8YgIiA8IH8gpyGQIagiGSIeIikiSCJhImQjAiMQIyAlACUCJQwlECUUJRglHCUkJSwlNCU8JVAlgCWEJYgljCWQJaAlrCWyJbolvCXEJcsl2CY6JkAmQiZgJmMmZSZq////4v/A/7//vv+8/7n/t/+1/7T/sP+v/6j/pP+f/53/nP+b/5r/mf+X/wX9Bf0B/Pf89fzz/Oz86vzg/N783eCC4GngJ+AA3xjfBt6W3pPeit5s3lTeUt223andmtu827vbstuv26zbqdum25/bmNuR24rbd9tk22HbXttb21jbTNtC2z3bNts12y7bKNsc2rzaudq42pvamdqY2pUAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEhgAAAJ4AgAAGAB4AfgCjAKUApwCsALIAtwC9AL8AxwDJANEA1gDcAOIA7wD0APcA/AD/AZIDkwOYA6MDpgOpA7EDtQPAA8QDxiAiIDwgfyCnIZUhqCIaIh8iKSJIImEiZSMCIxAjISUAJQIlDCUQJRQlGCUcJSQlLCU0JTwlbCWAJYQliCWMJZMloSWsJbIluiW8JcQlyyXZJjwmQCZCJmAmYyZmJmv//wAAACAAoQClAKcAqgCwALUAugC/AMQAyQDRANYA3ADfAOQA8QD2APkA/wGSA5MDmAOjA6YDqQOxA7QDwAPDA8YgIiA8IH8gpyGQIagiGSIeIikiSCJhImQjAiMQIyAlACUCJQwlECUUJRglHCUkJSwlNCU8JVAlgCWEJYgljCWQJaAlrCWyJbolvCXEJcsl2CY6JkAmQiZgJmMmZSZq////4v/A/7//vv+8/7n/t/+1/7T/sP+v/6j/pP+f/53/nP+b/5r/mf+X/wX9Bf0B/Pf89fzz/Oz86vzg/N783eCC4GngJ+AA3xjfBt6W3pPeit5s3lTeUt223andmtu827vbstuv26zbqdum25/bmNuR24rbd9tk22HbXttb21jbTNtC2z3bNts12y7bKNsc2rzaudq42pvamdqY2pUAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAABwAAABIAAAAegAAALwAAADuAAAA9wAAARQAAAExAAABWgAAAW0AAAF7AAABhAAAAY0AAAGvAAAB0gAAAecAAAIOAAACNQAAAk8AAAJsAAACjgAAAqYAAALOAAAC5gAAAvQAAAMHAAADLgAAAzwAAANjAAADhQAAA6UAAAPCAAAD4AAAA/0AAAQaAAAEPAAABEwAAARrAAAEfgAABJEAAASpAAAE0AAABNsAAAT4AAAFFQAABS0AAAVDAAAFZQAABYcAAAWuAAAFvAAABc8AAAXnAAAGBAAABisAAAZDAAAGZQAABnMAAAaVAAAGowAABsUAAAbOAAAG3gAABvYAAAcMAAAHKQAABz8AAAdaAAAHbQAAB4oAAAedAAAHqwAAB8MAAAfgAAAH7gAACAsAAAgjAAAIOwAACFEAAAhsAAAIfAAACJkAAAi2AAAIzgAACOYAAAkDAAAJKgAACUIAAAlfAAAJfAAACYUAAAmiAAAJugAACdcAAAngAAAKBwAACi4AAApgAAAKeQAACokAAAq4AAAKwQAACs8AAArYAAAK8QAACw4AAAshAAALSAAAC1gAAAt1AAALjQAAC5sAAAu0AAALzQAAC9YAAAvhAAAL6gAAC/4AAAwRAAAMJAAADDQAAAxHAAAMUgAADGoAAAyCAAAMlwAADKUAAAy/AAAM0gAADN0AAAz8AAANDwAADSkAAA0yAAANTAAADVUAAA1jAAANfAAADYcAAA2VAAANqQAADcIAAA3mAAAN7wAADg4AAA4XAAAOQQAADloAAA5qAAAOcwAADoYAAA6PAAAOogAADrIAAA7FAAAPCwAADxsAAA8uAAAPRwAAD1AAAA+HAAAPoAAAD6kAAA/CAAAP3wAAD/wAABAZAAAQNgAAEE4AABBfAAAQlQAAEJ4AABCxAAAQugAAEOEAABEnAAARUwAAEWYAABF+AAARlgAAEbgAABJrAAASfgAAEpEAABKpAAASwQAAEswAABLcAAATCAAAExMAABMrAAATQwAAE1sAABNzAAATmgAAE8YAABPeAAAT5wAAE/AAABQSAAAUKgAAFEIAABRaAAAUYwAAFGwAABSOAAAUngAAFLsAABTYAAAU/wAAFSEAABVNAAAVZQAAFX0AABWVAAAVngAAFacAABXTAAAWBAAAFg0AABYvAAAWOgAAFkUAABZxAAAWhAAAFpIAABagAAAWrgAAFrwAABbVAAAW7QAAFxkAABd0AAAXzwAAF/wAABgUAAAYJQAAGC4AABhBAAAYXgAAGHEAABiYAAAYvAAAGOAAABkYAAAZPwAAGWYAABmNAAAZtAAAGdYAABn9AAAaEAAAGi0AAIBgACAAoAEAAADAAcAAAEBAQEBAQEBAYABAAAA/wAAAAEAAAD/AAQAAAD+AAAA/4AAAP8AAAAAAgEAAoADgAQAAAMABwAAAQEBAQEBAQEBAAEAAAD/AAGAAQAAAP8ABAAAAP6AAAABgAAA/oAAAAACAIAAgAQAA4AAGwAfAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQAAAACAAAABAAAAAIAAAP+AAAAAgAAA/4AAAP8AAAD/gAAA/wAAAP+AAAAAgAAA/4AAAACAAQAAAACAAAADgAAA/4AAAACAAAD/gAAA/4AAAP8AAAD/gAAA/4AAAACAAAD/gAAAAIAAAACAAAABAAAAAIAAAP+A/wAAAAEAAAMAgACABAAEAAAbAB8AIwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgAAgAAAAQAAAP8AAAABAAAAAIAAAP+AAAD/AAAA/4AAAP8AAAABAAAA/wAAAP+AAAAAgAAAAQD/gAAAAIAAAACAAAAAgAAABAAAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAD/gP+AAAAAgP8A/4AAAACAAAAABQCAAIAEAAOAAAUAHQAjACkALwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAAAA/4AAAP+AAgABAAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAIAAAACA/YAAgAAAAIAAAP8AAoABAAAA/4AAAP+A/4AAgAAAAIAAAP8AA4AAAP8AAAAAgAAAAIAAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAAAP+AAAD/gAAAAAAAAP8AAAAAgAAAAAAAAP+AAAD/gAAAAAAAAwCAAIAEAAQAABcAHQAjAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/4AAAACAAAAAgAAA/4AAAACAAAD9AAAA/4AAAACAAAD/gAAAAIAAgAAAAIAAAACAAAD/AAAAAQAAAP+AAAAEAAAA/4AAAP8AAAD/gAAAAIAAAP8AAAD/gAAA/4AAAACAAAABAAAAAIAAAAEAAAAAAP+AAAD/gAAAAQD+gP8AAAAAgAAAAIAAAAABAYACgAKABAAAAwAAAQEBAQGAAQAAAP8ABAAAAP6AAAAAAAABAQAAgAMABAAAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQECAAEAAAD/gAAA/4AAAACAAAAAgAAA/wAAAP+AAAD/gAAAAIAAAACABAAAAP+AAAD/gAAA/oAAAP+AAAD/gAAAAIAAAACAAAABgAAAAIAAAAAAAAEBAACAAwAEAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQAAAACAAAAAgAAA/4AAAP+AAAD/AAAAAIAAAACAAAD/gAAA/4AEAAAA/4AAAP+AAAD+gAAA/4AAAP+AAAAAgAAAAIAAAAGAAAAAgAAAAAAABQCAAYADgAQAAAMABwATABcAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAIAAAP+AAYAAgAAA/4D/AAEAAAABAAAA/wAAAP8AAAD/AAAAAQD/gACAAAD/gAGAAIAAAP+ABAAAAP+AAAAAgAAA/4AAAAAAAAD/gAAA/4AAAP+AAAAAgAAAAIAAAP8AAAD/gAAAAIAAAP+AAAAAAAABAQAAgAOAAwAACwAAAQEBAQEBAQEBAQEBAgAAgAAAAQAAAP8AAAD/gAAA/wAAAAEAAwAAAP8AAAD/gAAA/wAAAAEAAAAAgAAAAAAAAQCAAAACAAGAAAcAAAEBAQEBAQEBAQABAAAA/4AAAP8AAAAAgAGAAAD/AAAA/4AAAACAAAAAAAABAIABgAOAAgAAAwAAAQEBAQCAAwAAAP0AAgAAAP+AAAAAAAABAQAAgAIAAYAAAwAAAQEBAQEAAQAAAP8AAYAAAP8AAAAAAAABAIAAgAQAA4AAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAwABAAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAIAAAACAA4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAAAwCAAIADgAQAAAsAEQAXAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/4AAAP4AAAD/gAAAAIAAgAAAAIAAAACAAAD/gAAA/4AAAAEAAAAEAAAA/4AAAP2AAAD/gAAAAIAAAAKAAAAAAP8AAAAAgAAAAID/AP+AAAD/AAAAAYAAAAABAIAAgAOABAAADQAAAQEBAQEBAQEBAQEBAQEBgAEAAAABAAAA/QAAAAEAAAD/AAAAAIAAAACABAAAAP0AAAD/gAAAAIAAAAGAAAAAgAAAAIAAAAABAIAAgAOABAAAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAgAAAACAAAD/gAAA/4AAAP+AAAABgAAA/QAAAACAAAAAgAAAAIAAAACAAAD/AAAA/wAAAACABAAAAP+AAAD/AAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAABAAAA/wAAAAEAAAAAAAABAIAAgAOABAAAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAgAAAACAAAD/gAAAAIAAAP+AAAD+AAAA/4AAAAEAAAABAAAA/wAAAAEAAAD/AAAA/wAAAACABAAAAP+AAAD/AAAA/4AAAP8AAAD/gAAAAIAAAACAAAD/gAAAAQAAAACAAAABAAAA/4AAAACAAAAAAAABAIAAgAOABAAAEQAAAQEBAQEBAQEBAQEBAQEBAQEBAYABAAAA/4AAAP+AAAABAAAAAQAAAP8AAAD+AAAAAIAAAACABAAAAP+AAAD/gAAA/wAAAAEAAAD9gAAAAQAAAAGAAAAAgAAAAAEAgACAA4AEAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQCAAwAAAP4AAAABgAAAAIAAAP+AAAD+AAAA/4AAAAEAAAABAAAA/gAEAAAA/4AAAP8AAAD/gAAA/wAAAP+AAAAAgAAAAIAAAP+AAAABAAAAAAAAAgCAAIADgAQAABMAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQACAAAAAIAAAP8AAAD/AAAAAYAAAACAAAD/gAAA/gAAAP+AAAAAgACAAAABAAAABAAAAP+AAAD/gAAAAIAAAP8AAAD/gAAA/wAAAP+AAAAAgAAAAoAAAP6A/wAAAAEAAAEAgACAA4AEAAAPAAABAQEBAQEBAQEBAQEBAQEBAIADAAAA/4AAAP+AAAD/AAAAAIAAAACAAAD+gAAA/4AEAAAA/oAAAP+AAAD+gAAAAYAAAACAAAABAAAA/4AAAAAAAAMAgACAA4AEAAATABcAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAgAAAACAAAD/gAAAAIAAAP+AAAD+AAAA/4AAAACAAAD/gAAAAIAAgAAAAQAAAP8AAAABAAAABAAAAP+AAAD/AAAA/4AAAP8AAAD/gAAAAIAAAAEAAAAAgAAAAQAAAAAA/wAAAAEA/oD/AAAAAQAAAAACAIAAgAOABAAACwAPAAABAQEBAQEBAQEBAQEBAQEBAQACAAAAAIAAAP8AAAD+gAAA/4AAAACAAIAAAAEAAAAEAAAA/4AAAP0AAAABAAAAAIAAAAGAAAAAAP6AAAABgAACAQABAAIAA4AAAwAHAAABAQEBAQEBAQEAAQAAAP8AAAABAAAA/wADgAAA/wAAAP+AAAD/AAAAAAIAgACAAgADgAADAAsAAAEBAQEBAQEBAQEBAQEAAQAAAP8AAAABAAAA/4AAAP8AAAAAgAOAAAD/AAAA/4AAAP8AAAD/gAAAAIAAAAABAQAAgAOABAAAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQKAAQAAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAP8AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACABAAAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAAAACAIABgAOAAwAAAwAHAAABAQEBAQEBAQCAAwAAAP0AAAADAAAA/QADAAAA/4AAAP+AAAD/gAAAAAEAgACAAwAEAAAbAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAIABAAAAAIAAAACAAAAAgAAA/4AAAP+AAAD/gAAA/wAAAACAAAAAgAAAAIAAAP+AAAD/gAAA/4AEAAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAAAAAAIAgACAA4AEAAATABcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAgAAAACAAAD/gAAA/4AAAP8AAAAAgAAAAIAAAP8AAAD/AAAAAIAAgAEAAAD/AAQAAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAAA/4AAAACAAAD+AAAA/wAAAAACAIAAgAOABAAAEQAVAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQACAAAAAIAAAP6AAAAAgAAA/wAAAAGAAAD+AAAA/4AAAACAAgAAgAAA/4AEAAAA/4AAAP6AAAABAAAAAIAAAP2AAAD/gAAAAIAAAAKAAAD+AAAA/4AAAAAAAAIAgACAA4AEAAAPABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAYABAAAAAIAAAACAAAD/AAAA/wAAAP8AAAAAgAAAAIAAAAAAAQAAAAQAAAD/gAAA/4AAAP2AAAABAAAA/wAAAAKAAAAAgAAA/4D/AAAAAQAAAwCAAIADgAQAAAsADwATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQCAAoAAAACAAAD/gAAAAIAAAP+AAAD9gAEAAAABAAAA/wAAAAEAAAAEAAAA/4AAAP8AAAD/gAAA/wAAAP+AAAADAP8AAAABAP6A/wAAAAEAAAAAAQCAAIADgAQAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQACAAAAAIAAAP8AAAD/AAAAAQAAAAEAAAD/gAAA/gAAAP+AAAAAgAQAAAD/gAAA/4AAAACAAAD9gAAAAIAAAP+AAAD/gAAAAIAAAAKAAAAAAAACAIAAgAOABAAACwATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQCAAgAAAACAAAAAgAAA/4AAAP+AAAD+AAEAAAAAgAAAAIAAAP+AAAAEAAAA/4AAAP+AAAD+gAAA/4AAAP+AAAADAP2AAAAAgAAAAYAAAACAAAEAgACAA4AEAAAXAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/wAAAP8AAAABAAAA/wAAAAEAAAABAAAA/4AAAP4AAAD/gAAAAIAEAAAA/4AAAP+AAAAAgAAA/wAAAP+AAAD/AAAAAIAAAP+AAAD/gAAAAIAAAAKAAAAAAAABAIAAgAOABAAACQAAAQEBAQEBAQEBAQCAAwAAAP4AAAABAAAA/wAAAP8ABAAAAP+AAAD/AAAA/4AAAP6AAAAAAQCAAIADgAQAABUAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/wAAAP8AAAABAAAA/4AAAAGAAAD/gAAA/gAAAP+AAAAAgAQAAAD/gAAA/4AAAACAAAD9gAAAAQAAAACAAAD+gAAA/4AAAACAAAACgAAAAAEAgACAA4AEAAALAAABAQEBAQEBAQEBAQEAgAEAAAABAAAAAQAAAP8AAAD/AAAA/wAEAAAA/gAAAAIAAAD8gAAAAQAAAP8AAAAAAAABAIAAgAOABAAACwAAAQEBAQEBAQEBAQEBAIADAAAA/wAAAAEAAAD9AAAAAQAAAP8ABAAAAP+AAAD9gAAA/4AAAACAAAACgAAAAAAAAQCAAIAEAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEBAAMAAAD/gAAA/4AAAP4AAAD/gAAAAQAAAAEAAAD+gAQAAAD/gAAA/YAAAP+AAAAAgAAAAQAAAP8AAAACgAAAAAAAAQCAAIADgAQAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAEAAAAAgAAAAIAAAAEAAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD/AAQAAAD/AAAAAIAAAACAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAD/AAAAAAAAAQCAAIADgAQAAAUAAAEBAQEBAQCAAQAAAAIAAAD9AAQAAAD9AAAA/4AAAAABAIAAgAQABAAAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAEAAAAAgAAAAIAAAACAAAABAAAA/wAAAP+AAAD/gAAA/4AAAP8ABAAAAP+AAAD/gAAAAIAAAACAAAD8gAAAAgAAAP+AAAAAgAAA/gAAAAAAAAEAgACABAAEAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQCAAQAAAACAAAAAgAAAAIAAAAEAAAD/AAAA/4AAAP+AAAD/gAAA/wAEAAAA/4AAAP+AAAD/gAAAAYAAAPyAAAABAAAAAIAAAACAAAD+AAAAAAAAAgCAAIADgAQAAAsADwAAAQEBAQEBAQEBAQEBAQEBAQEAAgAAAACAAAD/gAAA/gAAAP+AAAAAgACAAAABAAAABAAAAP+AAAD9gAAA/4AAAACAAAACgAAAAAD9gAAAAoAAAgCAAIADgAQAAAkADQAAAQEBAQEBAQEBAQEBAQEAgAKAAAAAgAAA/4AAAP6AAAD/AAEAAAABAAAABAAAAP+AAAD+gAAA/4AAAP8AAAADAP6AAAABgAAAAAIAgACABAAEAAAPABcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAgAAAACAAAAAgAAA/4AAAP+AAAD+AAAA/4AAAACAAIAAAAEAAAD/gAAAAIAAAAQAAAD/gAAA/gAAAP8AAAAAgAAA/4AAAACAAAACgAAAAAD9gAAAAIAAAACAAAABgAACAIAAgAOABAAAEwAXAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAKAAAAAgAAA/4AAAP+AAAAAgAAAAIAAAP8AAAD/gAAA/4AAAP8AAQAAAAEAAAAEAAAA/4AAAP8AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAD/AAAAAwD/AAAAAQAAAQCAAIADgAQAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/wAAAP8AAAABgAAAAIAAAP+AAAD+AAAA/4AAAAEAAAABAAAA/oAAAP+AAAAAgAQAAAD/gAAA/4AAAACAAAD/AAAA/4AAAP8AAAD/gAAAAIAAAACAAAD/gAAAAQAAAACAAAABAAAAAAAAAQCAAIADgAQAAAcAAAEBAQEBAQEBAIADAAAA/wAAAP8AAAD/AAQAAAD/gAAA/QAAAAMAAAAAAAABAIAAgAOABAAACwAAAQEBAQEBAQEBAQEBAIABAAAAAQAAAAEAAAD/gAAA/gAAAP+ABAAAAP0AAAADAAAA/QAAAP+AAAAAgAAAAAAAAQCAAIADgAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEAgAEAAAABAAAAAQAAAP+AAAD/gAAA/wAAAP+AAAD/gAQAAAD+AAAAAgAAAP4AAAD/AAAA/4AAAACAAAABAAAAAAAAAQCAAIAEAAQAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAIABAAAAAIAAAACAAAAAgAAAAQAAAP8AAAD/gAAA/4AAAP+AAAD/AAQAAAD+AAAAAIAAAP+AAAACAAAA/IAAAACAAAAAgAAA/4AAAP+AAAAAAAABAIAAgAOABAAAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQCAAQAAAAEAAAABAAAA/4AAAP+AAAAAgAAAAIAAAP8AAAD/AAAA/wAAAACAAAAAgAAA/4AAAP+ABAAAAP8AAAABAAAA/wAAAP+AAAD/gAAA/4AAAP8AAAABAAAA/wAAAAEAAAAAgAAAAIAAAACAAAAAAAABAIAAgAOABAAADwAAAQEBAQEBAQEBAQEBAQEBAQCAAQAAAAEAAAABAAAA/4AAAP+AAAD/AAAA/4AAAP+ABAAAAP6AAAABgAAA/oAAAP+AAAD+gAAAAYAAAACAAAAAAAABAIAAgAOABAAAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAIADAAAA/4AAAP+AAAD/gAAA/4AAAAIAAAD9AAAAAIAAAACAAAAAgAAAAIAAAP4ABAAAAP8AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAAEAAAAAgAAAAIAAAACAAAAAgAAAAAAAAQEAAIADAAQAAAcAAAEBAQEBAQEBAQACAAAA/wAAAAEAAAD+AAQAAAD/gAAA/YAAAP+AAAAAAAABAIAAgAQAA4AAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAIABAAAAAIAAAACAAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD/gAAA/4AAAP+AA4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAAAQEAAIADAAQAAAcAAAEBAQEBAQEBAQACAAAA/gAAAAEAAAD/AAQAAAD8gAAAAIAAAAKAAAAAAAABAIACAAQABAAAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgAAgAAAAIAAAACAAAAAgAAA/wAAAP+AAAD/gAAA/4AAAP8AAAAAgAAAAIAAAACABAAAAP+AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAP+AAAD/gAAAAIAAAACAAAAAgAAAAAAAAQCAAIADgAEAAAMAAAEBAQEAgAMAAAD9AAEAAAD/gAAAAAAAAQEAAoACgAQAAAkAAAEBAQEBAQEBAQEBAAEAAAAAgAAA/4AAAP+AAAD/gAQAAAD/gAAA/wAAAACAAAAAgAAAAAEAgACAA4ADAAAPAAABAQEBAQEBAQEBAQEBAQEBAQACgAAA/4AAAP+AAAD/AAAAAQAAAP6AAAD/gAAAAIADAAAA/YAAAACAAAABgAAA/oAAAP+AAAAAgAAAAYAAAAAAAAIAgACAA4AEAAAJAA0AAAEBAQEBAQEBAQEBAQEBAIABAAAAAYAAAACAAAD/gAAA/YABAAAAAQAAAAQAAAD/AAAA/4AAAP6AAAD/gAAAAgD+gAAAAYAAAAABAIAAgAOAAwAAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/wAAAP8AAAABAAAAAQAAAP+AAAD+AAAA/4AAAACAAwAAAP+AAAD/gAAAAIAAAP6AAAAAgAAA/4AAAP+AAAAAgAAAAYAAAAAAAAIAgACAA4AEAAAJAA0AAAEBAQEBAQEBAQEBAQEBAoABAAAA/YAAAP+AAAAAgAAAAYD/AAAAAQAAAAQAAAD8gAAAAIAAAAGAAAAAgAAA/4D+gAAAAYAAAAACAIAAgAOAAwAADQARAAABAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/gAAAAGAAAD+AAAA/4AAAACAAIAAAAEAAAADAAAA/4AAAP8AAAD/gAAA/4AAAACAAAABgAAAAAD/gAAAAIAAAAABAQAAgAOAA4AACwAAAQEBAQEBAQEBAQEBAYACAAAA/oAAAAEAAAD/AAAA/wAAAACAA4AAAP+AAAD/AAAA/4AAAP8AAAACgAAAAAAAAgCAAIADgAOAAA8AEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/4AAAP4AAAABgAAA/oAAAP+AAAAAgACAAAABAAAAA4AAAP+AAAD+AAAA/4AAAACAAAAAgAAAAIAAAAEAAAAAAP8AAAABAAABAIAAgAOABAAACwAAAQEBAQEBAQEBAQEBAIABAAAAAYAAAACAAAD/AAAA/wAAAP8ABAAAAP8AAAD/gAAA/gAAAAIAAAD+AAAAAAAAAgGAAIACgAQAAAMABwAAAQEBAQEBAQEBgAEAAAD/AAAAAQAAAP8ABAAAAP+AAAD/gAAA/YAAAAACAIAAgAOABAAAAwAPAAABAQEBAQEBAQEBAQEBAQEBAoABAAAA/wAAAAEAAAD/gAAA/gAAAP+AAAABAAAAAQAEAAAA/4AAAP+AAAD+AAAA/4AAAACAAAABAAAA/wAAAAABAIAAgAOAA4AAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAEAAAAAgAAAAQAAAP+AAAAAgAAAAIAAAP8AAAD/gAAA/4AAAP8AA4AAAP8AAAAAgAAA/4AAAP8AAAD/gAAA/4AAAACAAAAAgAAA/wAAAAAAAAEBgACAAwAEAAAHAAABAQEBAQEBAQGAAQAAAACAAAD/AAAA/4AEAAAA/QAAAP+AAAAAgAAAAAAAAQCAAIAEAAMAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAAAAAIAAAAEAAAAAgAAA/wAAAP+AAAD/gAAA/4AAAP8AAAAAgAMAAAD/gAAAAIAAAP+AAAD+AAAAAYAAAP+AAAAAgAAA/oAAAAIAAAAAAAABAIAAgAOAAwAADwAAAQEBAQEBAQEBAQEBAQEBAQCAAQAAAACAAAABAAAAAIAAAP8AAAD/gAAA/4AAAP8AAwAAAP+AAAAAgAAA/4AAAP4AAAABgAAA/4AAAP8AAAAAAAACAIAAgAOAAwAACwAPAAABAQEBAQEBAQEBAQEBAQEBAQACAAAAAIAAAP+AAAD+AAAA/4AAAACAAIAAAAEAAAADAAAA/4AAAP6AAAD/gAAAAIAAAAGAAAAAAP6AAAABgAACAIAAgAOAAwAACQANAAABAQEBAQEBAQEBAQEBAQCAAoAAAACAAAD/gAAA/oAAAP8AAQAAAAEAAAADAAAA/4AAAP+AAAD/gAAA/wAAAAIA/4AAAACAAAAAAgCAAIAEAAMAAA0AEQAAAQEBAQEBAQEBAQEBAQEBAQEBAQACgAAAAIAAAP+AAAD/AAAA/oAAAP+AAAAAgACAAAABAAAAAwAAAP6AAAD/gAAA/4AAAAEAAAAAgAAAAIAAAAAA/4AAAACAAAAAAQEAAIADgAMAAAkAAAEBAQEBAQEBAQEBAAIAAAAAgAAA/wAAAP+AAAD/AAMAAAD/gAAA/wAAAAEAAAD+AAAAAAEAgACABAADAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEAAoAAAP6AAAABgAAAAIAAAP+AAAD9AAAAAgAAAP6AAAD/gAAAAIADAAAA/4AAAP+AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAAAgAAAAAAAAQCAAIADgAOAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAAAAAQAAAP8AAAAAgAAAAQAAAP+AAAD+gAAA/4AAAP+AAAAAgAOAAAD/gAAA/4AAAP6AAAAAgAAA/4AAAP+AAAAAgAAAAYAAAACAAAAAAAABAIAAgAOAAwAADwAAAQEBAQEBAQEBAQEBAQEBAQCAAQAAAACAAAAAgAAAAQAAAP+AAAD/gAAA/oAAAP+AAwAAAP4AAAAAgAAAAYAAAP2AAAAAgAAA/4AAAACAAAAAAAABAIAAgAOAAwAADwAAAQEBAQEBAQEBAQEBAQEBAQCAAQAAAAEAAAABAAAA/4AAAP+AAAD/AAAA/4AAAP+AAwAAAP6AAAABgAAA/oAAAP+AAAD/gAAAAIAAAACAAAAAAAABAIAAgAQAAwAAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAEAAAAAgAAAAIAAAACAAAABAAAA/4AAAP8AAAD/gAAA/wAAAP+AAwAAAP6AAAAAgAAA/4AAAAGAAAD+AAAA/4AAAACAAAD/gAAAAIAAAAAAAAEAgACAA4ADAAAbAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAIABAAAAAQAAAAEAAAD/gAAA/4AAAACAAAAAgAAA/wAAAP8AAAD/AAAAAIAAAACAAAD/gAAA/4ADAAAA/4AAAACAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAD/gAAAAIAAAACAAAAAgAAAAIAAAAAAAAEAgACAA4ADAAAPAAABAQEBAQEBAQEBAQEBAQEBAIABAAAAAQAAAAEAAAD/gAAA/gAAAAGAAAD+gAAA/4ADAAAA/wAAAAEAAAD+AAAA/4AAAACAAAAAgAAAAIAAAAAAAAEAgACAA4ADAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQCAAwAAAP+AAAD/gAAA/4AAAAGAAAD9AAAAAIAAAACAAAAAgAAA/oADAAAA/4AAAP+AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAAAgAAAAAAAAQCAAIADAAQAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAYABgAAA/wAAAP+AAAAAgAAAAQAAAP6AAAD/gAAA/4AAAACAAAAAgAQAAAD/gAAA/wAAAP+AAAD/AAAA/4AAAACAAAABAAAAAIAAAAEAAAAAAAABAYAAgAKABAAAAwAAAQEBAQGAAQAAAP8ABAAAAPyAAAAAAAABAQAAgAOABAAAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAGAAAAAgAAAAIAAAP+AAAD/gAAA/oAAAAEAAAAAgAAA/4AAAP8ABAAAAP+AAAD/AAAA/4AAAP8AAAD/gAAAAIAAAAEAAAAAgAAAAQAAAAAAAAEAgAGAA4ADAAAPAAABAQEBAQEBAQEBAQEBAQEBAQABAAAAAQAAAACAAAD/gAAA/wAAAP8AAAD/gAAAAIADAAAA/4AAAACAAAD/AAAA/4AAAACAAAD/gAAAAQAAAAAAAAEAAAAABAAEAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQAAAYAAAAEAAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD/AAAA/wAEAAAA/4AAAP+AAAD/gAAA/wAAAP6AAAABAAAAAQAAAACAAAAAgAAAAAAAAQIAAAAEAAQAAAMAAAEBAQECAAIAAAD+AAQAAAD8AAAAAAAAAgCAAIADgAQAABcAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQGAAYAAAP8AAAABAAAA/4AAAP+AAAABgAAA/QAAAACAAAAAgAAA/wAAAACAAAAAgAGAAIAAAP+ABAAAAP+AAAD/AAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAABAAAAAAAAAP+AAAAAAQCAAIADgAQAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAEAAAABAAAAAQAAAP+AAAAAgAAA/wAAAAEAAAD/AAAA/wAAAP8AAAABAAAA/wAAAACAAAD/gAQAAAD+gAAAAYAAAP8AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAABACAAIAEAAQAABcAGwAfACMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAoAAAP4AAAABgAAAAIAAAACAAAD/gAAA/YAAAAIAAAD+gAAA/4AAAP+AAAAAgAEAAAAAgAAAAQAAgAAA/4D9AACAAAD/gAQAAAD/gAAA/4AAAP+AAAD/gAAA/wAAAP+AAAAAgAAAAIAAAACAAAAAgAAAAQAAAP8A/4AAAACAAQAAAP+AAAD+gAAA/4AAAAAEAIAAgAQAA4AAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQCAAIAAAP+AAQAAgAAA/4ABAACAAAD/gAEAAIAAAP+AA4AAAP0AAAADAAAA/QAAAAMAAAD9AAAAAwAAAP0AAAAAAQIAAAAEAAQAAAkAAAEBAQEBAQEBAQEDgACAAAD+AAAAAIAAAACAAAAAgAQAAAD8AAAAAQAAAAEAAAABAAAAAAgAAAAABAAEAAADAAcACwAPABMAFwAbAB8AAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAABAAAA/wACAAEAAAD/AP8AAQAAAP8AAgABAAAA/wD9AAEAAAD/AAIAAQAAAP8A/wABAAAA/wACAAEAAAD/AAQAAAD/AAAAAQAAAP8AAAAAAAAA/wAAAAEAAAD/AAAAAAAAAP8AAAABAAAA/wAAAAAAAAD/AAAAAQAAAP8AAAAAAQIAAAADAAQAAAMAAAEBAQECAAEAAAD/AAQAAAD8AAAAAAAAAgGAAIACgAQAAAMABwAAAQEBAQEBAQEBgAEAAAD/AAAAAQAAAP8ABAAAAP6AAAD/gAAA/oAAAAABAgAAAAQAAgAAAwAAAQEBAQIAAgAAAP4AAgAAAP4AAAAAAAAEAIAAAAQABAAAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQCAAIAAAP+AAQAAgAAA/4ABAACAAAD/gAEAAIAAAP+ABAAAAPwAAAAEAAAA/AAAAAQAAAD8AAAABAAAAPwAAAAAAQCAAIADgAOAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAoABAAAA/oAAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAAEAAAD/gAOAAAD+AAAA/wAAAACAAAAAgAAAAIAAAACAAAAAgAAA/wAAAAEAAAAAAAABAAAAAAQABAAACwAAAQEBAQEBAQEBAQEBAAAEAAAA/gAAAP+AAAD/gAAA/4AAAP+ABAAAAPwAAAAAgAAAAIAAAACAAAAAgAAAAAAAAQCAAIAEAAOAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAgACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAOAAAD/gAAAAIAAAP8AAAABAAAA/oAAAAGAAAD9AAAAAIAAAP+AAAABAAAA/wAAAAGAAAD+gAAAAAAAAQAAAAACAAQAAAkAAAEBAQEBAQEBAQEAAACAAAAAgAAAAIAAAACAAAD+AAQAAAD/AAAA/wAAAP8AAAD/AAAAAAEAAAAABAAEAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQKAAYAAAP8AAAD/AAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAQAEAAAA/wAAAP+AAAD/gAAA/wAAAP8AAAABgAAAAQAAAACAAAAAgAAAAAAAAQAAAAAEAAIAAA8AAAEBAQEBAQEBAQEBAQEBAQEBgAEAAAAAgAAAAIAAAACAAAD8AAAAAIAAAACAAAAAgAIAAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAAAAAAAAgAAAAAEAAQAAAMABwAAAQEBAQEBAQEAAAIAAAD+AAIAAgAAAP4ABAAAAP4AAAAAAAAA/gAAAAAEAAACAAQABAAAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQAAAQAAAP8AAgABAAAA/wD/AAEAAAD/AAIAAQAAAP8ABAAAAP8AAAABAAAA/wAAAAAAAAD/AAAAAQAAAP8AAAAABAIAAAAEAAQAAAMABwALAA8AAAEBAQEBAQEBAQEBAQEBAQECAAEAAAD/AAEAAQAAAP8A/wABAAAA/wABAAEAAAD/AAQAAAD/AAAAAAAAAP8AAAAAAAAA/wAAAAAAAAD/AAAAAAEDAAAABAAEAAADAAABAQEBAwABAAAA/wAEAAAA/AAAAAAAAAEAAAAABAAEAAAFAAABAQEBAQEAAAQAAAD9AAAA/wAEAAAA/wAAAP0AAAAAAQAAAAABAAQAAAMAAAEBAQEAAAEAAAD/AAQAAAD8AAAAAAAAAwCAAIADAAOAAAMABwALAAABAQEBAQEBAQEBAQEAgACAAAD/gAEAAIAAAP+AAQAAgAAA/4ADgAAA/QAAAAMAAAD9AAAAAwAAAP0AAAAAAAABAYABgAQABAAACwAAAQEBAQEBAQEBAQEBAYABAAAAAIAAAAEAAAD+gAAA/4AAAP+ABAAAAP8AAAD/gAAA/wAAAACAAAAAgAAAAAAAAQAAAYACgAQAAAsAAAEBAQEBAQEBAQEBAQGAAQAAAP+AAAD/gAAA/oAAAAEAAAAAgAQAAAD+gAAA/4AAAP+AAAABAAAAAIAAAAAAAAEAAAAABAAEAAAJAAABAQEBAQEBAQEBAwABAAAA/AAAAAEAAAABAAAAAQAEAAAA/AAAAAKAAAAAgAAAAIAAAAABAIAAgAMABAAACwAAAQEBAQEBAQEBAQEBAgABAAAA/4AAAP6AAAD/gAAAAIAAAAEABAAAAP0AAAD/gAAAAIAAAAEAAAAAgAAAAAAAAQAAAAAEAAQAAAUAAAEBAQEBAQAAAQAAAAMAAAD8AAQAAAD9AAAA/wAAAAACAIAAgAMAAoAACwAPAAABAQEBAQEBAQEBAQEBAQEBAQABgAAAAIAAAP+AAAD+gAAAAQAAAP8A/4AAgAAA/4ACgAAA/4AAAP8AAAD/gAAAAIAAAAEAAAAAAAAA/wAAAAACAIAAgAMABAAACwAPAAABAQEBAQEBAQEBAQEBAQEBAgABAAAA/4AAAP6AAAABAAAA/wAAAAEA/oAAgAAA/4AEAAAA/QAAAP+AAAAAgAAAAQAAAACAAAD/gAAA/wAAAAABAIAAgAQABAAADQAAAQEBAQEBAQEBAQEBAQECAAIAAAD/AAAA/4AAAP6AAAD/gAAAAIAAAAEABAAAAP+AAAD9gAAA/4AAAACAAAABAAAAAIAAAAACAAAAAAQABAAAAwAHAAABAQEBAQEBAQAABAAAAPwAAQAAAAIAAAAEAAAA/AAAAAMA/gAAAAIAAAEAgACABAAEAAARAAABAQEBAQEBAQEBAQEBAQEBAQECAAIAAAD/AAAAAQAAAP8AAAD/gAAA/oAAAP+AAAAAgAAAAQAEAAAA/4AAAP+AAAD/gAAA/oAAAP+AAAAAgAAAAQAAAACAAAAAAQAAAAACgAKAAAsAAAEBAQEBAQEBAQEBAQAAAYAAAACAAAAAgAAA/wAAAP+AAAD/AAKAAAD/gAAA/4AAAP6AAAABAAAAAIAAAAAAAAEAAAAABAAEAAAFAAABAQEBAQEAAAQAAAD/AAAA/QAEAAAA/AAAAAMAAAAAAQCAAIAEAAQAABUAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAAIAAAD/AAAAAQAAAP8AAAABAAAA/wAAAP+AAAD+gAAA/4AAAACAAAABAAQAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAAEAAAAAgAAAAAEBgAAABAACgAALAAABAQEBAQEBAQEBAQECgAGAAAD/AAAA/4AAAP8AAAAAgAAAAIACgAAA/wAAAP+AAAD/AAAAAYAAAACAAAAAAAABAAAAAAQABAAAEQAAAQEBAQEBAQEBAQEBAQEBAQEBAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAPwABAAAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAAEAAAAABAABAAADAAABAQEBAAAEAAAA/AABAAAA/wAAAAAAAAEAAAAABAAEAAARAAABAQEBAQEBAQEBAQEBAQEBAQEDgACAAAD8AAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAEAAAA/AAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAAQAAAgAEAAQAAAMAAAEBAQEAAAQAAAD8AAQAAAD+AAAAAAAAAgCAAIACAAOAAAMABwAAAQEBAQEBAQEAgACAAAD/gAEAAIAAAP+AA4AAAP0AAAADAAAA/QAAAAAEAIAAgAQABAAAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQCAA4AAAPyAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAABAAAAPyAAAADAP+AAAAAgP8A/4AAAACA/wD/gAAAAIAAAQAAAAAEAAQAAAUAAAEBAQEBAQMAAQAAAPwAAAADAAQAAAD8AAAAAQAAAAACAIAAgAQABAAAAwAHAAABAQEBAQEBAQCAA4AAAPyAAYAAAACAAAAEAAAA/IAAAAIA/4AAAACAAAMAgACABAAEAAADAAcACwAAAQEBAQEBAQEBAQEBAIADgAAA/IAAgAAAAIAAAAGAAAAAgAAABAAAAPyAAAADAP+AAAAAgP4A/4AAAACAAAAABAAAAIAEAAQAAAMABwALAA8AAAEBAQEBAQEBAQEBAQEBAQEAAAQAAAD8AAAABAAAAPwAAAAEAAAA/AAAAAQAAAD8AAQAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAAYAgACABAAEAAADAAcACwAPABMAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAIADgAAA/IAAgAAAAIAAAAGAAAAAgAAA/oAAAACAAAD+gAAAAIAAAAGAAAAAgAAABAAAAPyAAAADAP+AAAAAgAAA/4AAAACA/wD/gAAAAID/AP+AAAAAgAAA/4AAAACAAAEAgACAAQADgAADAAABAQEBAIAAgAAA/4ADgAAA/QAAAAAAAAUAgACABAAEAAADAAcACwAPABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAIADgAAA/IAAgAAAAIAAAAGAAAAAgAAA/YAAAACAAAABgAAAAIAAAAQAAAD8gAAAAwD/gAAAAIAAAP+AAAAAgP4A/4AAAACAAAD/gAAAAIAAAAABAAADAAQABAAAAwAAAQEBAQAABAAAAPwABAAAAP8AAAAAAAAHAIAAgAQABAAAAwAHAAsADwATABcAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQCAA4AAAPyAAIAAAACAAAABgAAAAIAAAP2AAAAAgAAAAYAAAACAAAD9gAAAAIAAAAGAAAAAgAAABAAAAPyAAAADAP+AAAAAgAAA/4AAAACA/wD/gAAAAIAAAP+AAAAAgP8A/4AAAACAAAD/gAAAAIAAAAAEAAAAAAQAAgAAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQAAAQAAAP8AAgABAAAA/wD/AAEAAAD/AAIAAQAAAP8AAgAAAP8AAAABAAAA/wAAAAAAAAD/AAAAAQAAAP8AAAAAAQAAAAAEAAQAAAkAAAEBAQEBAQEBAQEAAAEAAAABAAAAAQAAAAEAAAD8AAQAAAD/gAAA/4AAAP+AAAD9gAAAAAEBAAAAAgAEAAADAAABAQEBAQABAAAA/wAEAAAA/AAAAAAAAAEAAAAABAAEAAALAAABAQEBAQEBAQEBAQECgAGAAAD8AAAAAIAAAACAAAAAgAAAAQAEAAAA/AAAAAGAAAABAAAAAIAAAACAAAAAAAABAAABAAQAAgAAAwAAAQEBAQAABAAAAPwAAgAAAP8AAAAAAAABAAAAAAQABAAACwAAAQEBAQEBAQEBAQEBAgACAAAA/AAAAACAAAAAgAAAAIAAAACABAAAAPwAAAACAAAAAIAAAACAAAAAgAAAAAAAAQAAAAAEAAIAAAkAAAEBAQEBAQEBAQEDAAEAAAD8AAAAAQAAAAEAAAABAAIAAAD+AAAAAIAAAACAAAAAgAAAAAEAAAAABAAEAAALAAABAQEBAQEBAQEBAQEAAAIAAAAAgAAAAIAAAACAAAAAgAAA/AAEAAAA/4AAAP+AAAD/gAAA/4AAAP4AAAAAAAADAAAAAAQABAAAGwAnADMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAEAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAIAAYAAAACAAAD/gAAA/4AAAP+AAAD/gP4AAIAAAACAAAAAgAAAAIAAAP6AAAD/gAQAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAQAAAP+AAAD+gAAAAIAAAACAAAAAgAAA/oAAAP+AAAD/gAAA/4AAAP+AAAAAgAAAAAAAAQAAAAAEAAIAAAkAAAEBAQEBAQEBAQEAAAEAAAABAAAAAQAAAAEAAAD8AAIAAAD/gAAA/4AAAP+AAAD/gAAAAAEAAAAABAAEAAALAAABAQEBAQEBAQEBAQEAAAGAAAABAAAAAIAAAACAAAAAgAAA/AAEAAAA/4AAAP+AAAD/gAAA/wAAAP6AAAAAAAAEAAAAgAQABAAAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQCAAYAAAP6AAgABgAAA/oD9gAGAAAD+gAIAAYAAAP6ABAAAAP6AAAABgAAA/oAAAP+AAAD+gAAAAYAAAP6AAAAAAQIAAgAEAAQAAAMAAAEBAQECAAIAAAD+AAQAAAD+AAAAAAAABACAAIAEAAQAAAMABwAjACcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEAAAD/AAGAAQAAAP8A/gAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4ABgACAAAD/gAQAAAD/gAAAAIAAAP+AAAAAAAAA/wAAAP+AAAD/gAAAAIAAAACAAAABAAAA/oAAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAAGAAAD/gAAAAAQAAAAABAAEAAADAAcACwAPAAABAQEBAQEBAQEBAQEBAQEBAAAAgAAA/4ADgACAAAD/gPyAAIAAAP+AA4AAgAAA/4AEAAAA/4AAAACAAAD/gAAA/QAAAP+AAAAAgAAA/4AAAAABAAAAAAIAAgAAAwAAAQEBAQAAAgAAAP4AAgAAAP4AAAAAAAAEAAAAAAIABAAAAwAHAAsADwAAAQEBAQEBAQEBAQEBAQEBAQAAAQAAAP8AAQABAAAA/wD/AAEAAAD/AAEAAQAAAP8ABAAAAP8AAAAAAAAA/wAAAAAAAAD/AAAAAAAAAP8AAAAAAQCAAQADgAOAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAYABAAAA/4AAAAGAAAD+gAAAAIAAAP8AAAD/gAAA/4AAAACAAAAAgAOAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAACAAAAAAAABAQABAAOABAAAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQECAACAAAAAgAAAAIAAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACABAAAAP+AAAD/gAAA/wAAAACAAAD+gAAAAYAAAP+AAAABAAAAAIAAAAAAAAEBAAEABAADgAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQIAAQAAAACAAAAAgAAA/4AAAP+AAAD/AAAAAIAAAP6AAAABgAAA/4ADgAAA/4AAAP+AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAAAgAAAAAAAAQEAAIADgAOAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAgAAgAAAAIAAAACAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAOAAAD+gAAAAIAAAP8AAAD/gAAA/4AAAACAAAAAgAAAAQAAAP+AAAAAAAABAQAAgAOABAAADwAAAQEBAQEBAQEBAQEBAQEBAQIAAIAAAACAAAAAgAAA/4AAAP6AAAD/gAAAAIAAAACABAAAAP8AAAD/AAAA/wAAAP+AAAAAgAAAAQAAAAEAAAAAAAACAIAAgAOAA4AAAwAJAAABAQEBAQEBAQEBAIADAAAA/QAAgAAAAgAAAP8AAAADgAAA/QAAAAKA/gAAAAEAAAABAAAAAAIAgACABAAEAAAbACcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAACAAAAAgAAAAIAAAACAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAAAAAD/gAAAAIAAAACAAAAAgAAA/4AAAAQAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAA/4D/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAEAAAIABAADAAADAAABAQEBAAAEAAAA/AADAAAA/wAAAAAAAAEAAAAABAAEAAALAAABAQEBAQEBAQEBAQEAAAQAAAD/gAAA/4AAAP+AAAD/gAAA/gAEAAAA/gAAAP+AAAD/gAAA/4AAAP+AAAAAAAABAAACAAIABAAAAwAAAQEBAQAAAgAAAP4ABAAAAP4AAAAAAAACAQAAgAOAA4AAFwAbAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAYABgAAAAIAAAP8AAAAAgAAAAIAAAP8AAAD/gAAA/wAAAACAAAAAgAAA/wAAAACAAIAAAACAAAADgAAA/wAAAP+AAAD/gAAA/4AAAP+AAAAAgAAA/4AAAACAAAAAgAAAAIAAAACAAAAAgP+AAAAAgAADAAAAAAQABAAACwAnADMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAGAAAD/gAAA/4AAAP+AAAD/gAAAAIACgAEAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgACAAIAAAP+AAAD+gAAAAIAAAACAAAAAgAQAAAD/gAAA/4AAAP+AAAD/gAAAAYAAAACAAAD/AAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAIAAAACAAAAAgAAA/oAAAP6AAAD/gAAAAIAAAACAAAAAgAAAAAAAAgCAAIADgAQAAA8AHwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEAAAABAAAAAIAAAP+AAAD/AAAA/wAAAP+AAAAAgAAAAQAAAAEAAAAAgAAA/4AAAP8AAAD/AAAA/4AAAACABAAAAP+AAAAAgAAA/wAAAP+AAAAAgAAA/4AAAAEAAAD+gAAA/4AAAACAAAD/AAAA/4AAAACAAAD/gAAAAQAAAAABAAAAAAQAA4AACwAAAQEBAQEBAQEBAQEBAQACAAAAAIAAAACAAAD8AAAAAIAAAACAA4AAAP+AAAD/gAAA/YAAAAKAAAAAgAAAAAAAAQAAAAACAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEAAACAAAAAgAAAAIAAAACAAAD/gAAA/4AAAP+AAAD/gAQAAAD/gAAA/4AAAP+AAAD/AAAA/4AAAP+AAAD/gAAAAAAAAQIAAAAEAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEDgACAAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAQAAAD8AAAAAIAAAACAAAAAgAAAAQAAAACAAAAAgAAAAAAAAQCAAIAEAAQAABcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQIAAIAAAACAAAAAgAAAAIAAAP+AAAD/AAAA/4AAAP8AAAD/gAAAAIAAAACAAAAAgAQAAAD/gAAA/4AAAP+AAAD/gAAA/oAAAAEAAAD/AAAAAYAAAACAAAAAgAAAAIAAAAAAACAAAAAABAAEAAADAAcACwAPABMAFwAbAB8AIwAnACsALwAzADcAOwA/AEMARwBLAE8AUwBXAFsAXwBjAGcAawBvAHMAdwB7AH8AAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAgAAA/4ABAACAAAD/gAEAAIAAAP+AAQAAgAAA/4D9gACAAAD/gAEAAIAAAP+AAQAAgAAA/4ABAACAAAD/gPyAAIAAAP+AAQAAgAAA/4ABAACAAAD/gAEAAIAAAP+A/YAAgAAA/4ABAACAAAD/gAEAAIAAAP+AAQAAgAAA/4D8gACAAAD/gAEAAIAAAP+AAQAAgAAA/4ABAACAAAD/gP2AAIAAAP+AAQAAgAAA/4ABAACAAAD/gAEAAIAAAP+A/IAAgAAA/4ABAACAAAD/gAEAAIAAAP+AAQAAgAAA/4D9gACAAAD/gAEAAIAAAP+AAQAAgAAA/4ABAACAAAD/gAQAAAD/gAAAAIAAAP+AAAAAgAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAACAAAD/gAAAAIAAAP+AAAAAAAAA/4AAAACAAAD/gAAAAIAAAP+AAAAAgAAA/4AAAAAAAAD/gAAAAIAAAP+AAAAAgAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAACAAAD/gAAAAIAAAP+AAAAAAAAA/4AAAACAAAD/gAAAAIAAAP+AAAAAgAAA/4AAAAAAAAD/gAAAAIAAAP+AAAAAgAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAACAAAD/gAAAAIAAAP+AAAAAAQAAAAAEAAQAAAsAAAEBAQEBAQEBAQEBAQAABAAAAP6AAAD/AAAA/4AAAP+AAAD/gAQAAAD8AAAAAIAAAACAAAAAgAAAAQAAAAAAAAEAAAAABAAEAAALAAABAQEBAQEBAQEBAQEAAAQAAAD/gAAA/4AAAP+AAAD/AAAA/oAEAAAA/oAAAP8AAAD/gAAA/4AAAP+AAAAAAAABAAABgAKABAAADwAAAQEBAQEBAQEBAQEBAQEBAQAAAQAAAACAAAAAgAAAAIAAAP8AAAD/gAAA/4AAAP+ABAAAAP+AAAD/gAAA/4AAAP8AAAAAgAAAAIAAAACAAAAAAAABAAAAAAKABAAADwAAAQEBAQEBAQEBAQEBAQEBAQAAAQAAAACAAAAAgAAAAIAAAP8AAAD/gAAA/4AAAP+ABAAAAP+AAAD/gAAA/4AAAP2AAAACAAAAAIAAAACAAAAAAAABAYAAAAQAAoAABQAAAQEBAQEBAYACgAAA/oAAAP8AAoAAAP8AAAD+gAAAAAEAAAAABAAEAAAJAAABAQEBAQEBAQEBAAACgAAAAIAAAACAAAAAgAAA/AAEAAAA/wAAAP8AAAD/AAAA/wAAAAACAAAAAAQABAAAGwAfAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQGAAQAAAACAAAAAgAAAAIAAAP+AAAD/gAAA/4AAAP8AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAAAAAEAAAAEAAAA/4AAAP+AAAD/gAAA/wAAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAAEAAAAAgAAAAIAAAP8A/wAAAAEAAAEBgAGABAAEAAAFAAABAQEBAQEBgAEAAAABgAAA/YAEAAAA/oAAAP8AAAAAAQAAAAACgAKAAA8AAAEBAQEBAQEBAQEBAQEBAQEBgAEAAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAKAAAD/AAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAAAAAQGAAAAEAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEDAAEAAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAQAAAD/AAAA/4AAAP+AAAD+AAAAAoAAAACAAAAAgAAAAAAAAQGAAAAEAAKAAA8AAAEBAQEBAQEBAQEBAQEBAQEBgAEAAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD/gAKAAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAAAAAQGAAYAEAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEDAAEAAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAQAAAD/AAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAAAAAQAAAAAEAAQAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAEAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAQAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAAAQAAAAAEAAQAAB8AAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAABAAAAAIAAAAEAAAAAgAAAAQAAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP8AAAAAgAAAAIAAAP+AAAD/gAQAAAD/gAAA/4AAAACAAAAAgAAA/wAAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAAEAAAAAgAAAAQAAAACAAAAAAAABAAABgAQABAAADwAAAQEBAQEBAQEBAQEBAQEBAQAAAQAAAACAAAAAgAAAAgAAAP2AAAD/gAAA/4AAAP+ABAAAAP+AAAD/gAAA/4AAAP8AAAAAgAAAAIAAAACAAAAAAAABAAABgAQAAoAAAwAAAQEBAQAABAAAAPwAAoAAAP8AAAAAAAABAYAAAAKABAAAAwAAAQEBAQGAAQAAAP8ABAAAAPwAAAAAAAABAYAAAAQABAAAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAwABAAAA/4AAAP+AAAAAgAAAAIAAAP8AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACABAAAAP8AAAD/gAAA/wAAAP+AAAD/AAAAAIAAAACAAAAAgAAAAQAAAACAAAAAgAAAAAAAAQAAAAAEAAKAAA8AAAEBAQEBAQEBAQEBAQEBAQEAAAKAAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD+AAKAAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAAAAAQAAAYAEAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEDAAEAAAD/gAAA/4AAAP+AAAD9gAAAAgAAAACAAAAAgAQAAAD/AAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAAAAAQAAAgAEAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEAAAQAAAD/gAAA/4AAAP+AAAD/AAAA/4AAAP+AAAD/gAQAAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAAAAAAAAQAAAYACgAKAAAMAAAEBAQEAAAKAAAD9gAKAAAD/AAAAAAAAAQGAAAACgAKAAAMAAAEBAQEBgAEAAAD/AAKAAAD9gAAAAAAAAQAAAYAEAAQAABcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAQAAAACAAAABAAAAAIAAAAEAAAD/gAAA/4AAAP+AAAD/AAAA/4AAAP+AAAD/gAQAAAD/gAAA/4AAAACAAAAAgAAA/wAAAP+AAAD/gAAA/4AAAACAAAAAgAAAAIAAAAAAAAEAAAAABAAEAAAJAAABAQEBAQEBAQEBAYACgAAA/AAAAACAAAAAgAAAAIAEAAAA/AAAAAEAAAABAAAAAQAAAAABAAAAAAQABAAAEwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEDAAEAAAD/gAAA/4AAAP+AAAD/AAAA/oAAAAEAAAABAAAAAIAAAACABAAAAP6AAAD/AAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAQAAAAAAAAEAAAAABAAEAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQAAAQAAAACAAAAAgAAAAQAAAAEAAAD+gAAA/wAAAP+AAAD/gAAA/4AEAAAA/wAAAP8AAAD/gAAA/4AAAP8AAAAAgAAAAIAAAACAAAABAAAAAAAAAQAAAAAEAAQAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEDAAEAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAQAAAD/AAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAAAQAAAAACgAQAABcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAQAAAACAAAAAgAAAAIAAAP+AAAD/gAAA/4AAAP8AAAAAgAAAAIAAAP+AAAD/gAQAAAD/gAAA/4AAAP+AAAD/AAAA/4AAAP+AAAD/gAAAAQAAAACAAAABAAAAAIAAAAAAAAEAAAAABAAEAAAfAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAQAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAP8AAAD/gAAA/wAAAP+AAAD/AAAAAIAAAACAAAD/gAAA/4AEAAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/wAAAACAAAAAgAAA/4AAAP+AAAABAAAAAIAAAAEAAAAAgAAAAAAAAQAAAAACgAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEBgAEAAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAQAAAD9gAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAAAAAQGAAAAEAAQAAA8AAAEBAQEBAQEBAQEBAQEBAQEBgAEAAAAAgAAAAIAAAACAAAD/AAAA/4AAAP+AAAD/gAQAAAD+AAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAAAAAAAAQAAAAAEAAKAAA8AAAEBAQEBAQEBAQEBAQEBAQEBgAKAAAD+AAAA/4AAAP+AAAD/AAAAAIAAAACAAAAAgAKAAAD/AAAA/4AAAP+AAAD/gAAAAQAAAACAAAAAgAAAAAAAAQGAAYACgAQAAAMAAAEBAQEBgAEAAAD/AAQAAAD9gAAAAAAAAQGAAYAEAAKAAAMAAAEBAQEBgAKAAAD9gAKAAAD/AAAAAAAAAQAAAAAEAAQAAB8AAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAwABAAAA/4AAAP+AAAAAgAAAAIAAAP8AAAD/gAAA/wAAAP+AAAD/AAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAQAAAD/AAAA/4AAAP8AAAD/gAAA/wAAAACAAAAAgAAA/4AAAP+AAAABAAAAAIAAAACAAAAAgAAAAIAAAACAAAAAAAABAAAAAAQABAAAIwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAABAAAAAIAAAAEAAAAAgAAAAQAAAP+AAAD/gAAAAIAAAACAAAD/AAAA/4AAAP8AAAD/gAAA/wAAAACAAAAAgAAA/4AAAP+ABAAAAP+AAAD/gAAAAIAAAACAAAD/AAAA/4AAAP8AAAD/gAAA/wAAAACAAAAAgAAA/4AAAP+AAAABAAAAAIAAAAEAAAAAgAAAAAAAAQGAAYACgAKAAAMAAAEBAQEBgAEAAAD/AAKAAAD/AAAAAAAAAQAAAAAEAAKAABcAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQGAAQAAAACAAAAAgAAAAIAAAP8AAAD/gAAA/wAAAP+AAAD/AAAAAIAAAACAAAAAgAKAAAD/gAAA/4AAAP+AAAD/AAAAAIAAAACAAAD/gAAA/4AAAAEAAAAAgAAAAIAAAAAAAAEAAAGAAoAEAAAFAAABAQEBAQEBgAEAAAD9gAAAAYAEAAAA/YAAAAEAAAAAAQAAAAACgAKAAAUAAAEBAQEBAQAAAoAAAP8AAAD+gAKAAAD9gAAAAYAAAAABAAAAAAQABAAAHwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAEAAAAAgAAAAQAAAACAAAABAAAA/4AAAP+AAAAAgAAAAIAAAP8AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+ABAAAAP+AAAD/gAAAAIAAAACAAAD/AAAA/4AAAP8AAAD/gAAA/wAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAAAAAAEAAAAABAAEAAALAAABAQEBAQEBAQEBAQEBgAEAAAABgAAA/oAAAP8AAAD+gAAAAYAEAAAA/oAAAP8AAAD+gAAAAYAAAAEAAAAAAAABAAAAAAQAAoAABwAAAQEBAQEBAQEAAAQAAAD+gAAA/wAAAP6AAoAAAP8AAAD+gAAAAYAAAAAAAAEBgAAABAAEAAAHAAABAQEBAQEBAQGAAQAAAAGAAAD+gAAA/wAEAAAA/oAAAP8AAAD+gAAAAAAAAQAAAAACgAQAAAcAAAEBAQEBAQEBAYABAAAA/wAAAP6AAAABgAQAAAD8AAAAAYAAAAEAAAAAAAABAAABgAQABAAABwAAAQEBAQEBAQEBgAEAAAABgAAA/AAAAAGABAAAAP6AAAD/AAAAAQAAAAAAAAQBAAEAAwADAAADAAcACwAPAAABAQEBAQEBAQEBAQEBAQEBAYABAAAA/wD/gACAAAD/gAGAAIAAAP+A/wABAAAA/wADAAAA/4AAAAAAAAD/AAAAAQAAAP8AAAAAAAAA/4AAAAACAIAAgAOAA4AACwAPAAABAQEBAQEBAQEBAQEBAQEBAQACAAAAAIAAAP+AAAD+AAAA/4AAAACAAIAAAAEAAAADgAAA/4AAAP4AAAD/gAAAAIAAAAIAAAD/gP8AAAABAAACAAAAAAQABAAAEwAfAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAgAAAACAAAAAgAAA/4AAAP+AAAD+AAAA/4AAAP+AAAAAgAAAAIAAgAAA/4AAAACAAAABAAAAAIAAAP+AAAAEAAAA/4AAAP+AAAD+AAAA/4AAAP+AAAAAgAAAAIAAAAIAAAAAgAAA/4D/gAAA/wAAAP+AAAAAgAAAAQAAAACAABAAAAAABAAEAAADAAcACwAPABMAFwAbAB8AIwAnACsALwAzADcAOwA/AAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAYAAgAAA/4ACAACAAAD/gP2AAIAAAP+AAgAAgAAA/4D9gACAAAD/gAIAAIAAAP+A/YAAgAAA/4ACAACAAAD/gP+AAIAAAP+AAgAAgAAA/4D9gACAAAD/gAIAAIAAAP+A/YAAgAAA/4ACAACAAAD/gP2AAIAAAP+AAgAAgAAA/4AEAAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAAAAAAD/gAAAAIAAAP+AAAAAAAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAAAAAAD/gAAAAIAAAP+AAAAAAAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAAAQAAAAAAQABAAAAwAHAAsADwATABcAGwAfACMAJwArAC8AMwA3ADsAPwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAIAAAP+AAgAAgAAA/4D+gACAAAD/gAIAAIAAAP+A/oAAgAAA/4ACAACAAAD/gP6AAIAAAP+AAgAAgAAA/4D8gACAAAD/gAIAAIAAAP+A/oAAgAAA/4ACAACAAAD/gP6AAIAAAP+AAgAAgAAA/4D+gACAAAD/gAIAAIAAAP+ABAAAAP+AAAAAgAAA/4AAAAAAAAD/gAAAAIAAAP+AAAAAAAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAAAAAAD/gAAAAIAAAP+AAAAAAAAA/4AAAACAAAD/gAAAAAAAAP+AAAAAgAAA/4AAAAAAAAD/gAAAAIAAAP+AAAAAAwCAAIADgAQAABcAGwAfAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQIAAIAAAAEAAAD/AAAAAIAAAP+AAAABAAAA/wAAAP+AAAD/AAAA/4AAAACAAAABAP+AAAAAgAAA/4AAAACAAAAEAAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACAAAAAgAAAAYAAAACAAAD/gP+AAAAAgP8A/4AAAACAAAAAAQCAAIADgAOAAA8AAAEBAQEBAQEBAQEBAQEBAQEBAAIAAAAAgAAA/4AAAP+AAAD/AAAA/4AAAP+AAAAAgAOAAAD/gAAA/wAAAP+AAAD/AAAAAQAAAACAAAABAAAAAAAAAgCAAIADgAOAAAMACQAAAQEBAQEBAQEBAQCAAwAAAP0AAYAAAP8AAAACAAAAA4AAAP0AAAACgP8AAAD/AAAAAgAAAAABAIAAgAOAA4AAAwAAAQEBAQCAAwAAAP0AA4AAAP0AAAAAAAACAIAAgAOAA4AAAwALAAABAQEBAQEBAQEBAQEAgAMAAAD9AACAAAACAAAA/4AAAP8AAAADgAAA/QAAAAKA/gAAAAIAAAD/AAAAAQAAAQAAAAAEAAQAABMAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQACAAAAAIAAAACAAAD/gAAA/4AAAP4AAAD/gAAA/4AAAACAAAAAgAQAAAD/gAAA/4AAAP4AAAD/gAAA/4AAAACAAAAAgAAAAgAAAACAAAAAAAABAQABAAMAAwAACwAAAQEBAQEBAQEBAQEBAYABAAAAAIAAAP+AAAD/AAAA/4AAAACAAwAAAP+AAAD/AAAA/4AAAACAAAABAAAAAAAAAQCAAQAEAAQAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAACAAAAAgAAAAQAAAP+AAAD/gAAAAIAAAP8AAAD/gAAA/wAAAACAAAD/gAAA/4AAAAEAAAAAgAQAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAAAgAAA/4AAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAABgCAAIAEAAQAAAMABwALAA8AEwAXAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAOAAAD8gAEAAAAAgAAAAIAAAACAAAD+AAAAAIAAAAGAAAAAgAAA/gAAAAGAAAAEAAAA/IAAAAMA/wAAAAEAAAD/AAAAAQD+gP+AAAAAgAAA/4AAAACA/4D/gAAAAIAABgCAAIAEAAQAAAMABwALAA8AEwAXAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAgAOAAAD8gAEAAAAAgAAAAIAAAACAAAD+gAAAAYAAAP4AAAAAgAAAAYAAAACAAAAEAAAA/IAAAAMA/wAAAAEAAAD/AAAAAQD+gP+AAAAAgP+A/4AAAACAAAD/gAAAAIAABgCAAIAEAAQAABMAFwAbAB8AIwAnAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgAAgAAAAIAAAAEAAAD/AAAA/4AAAP+AAAD/gAAA/wAAAAEAAAAAgAAAAAAAgAAA/oAAgAAA/4ACAACAAAD/gP4AAIAAAP+AAgAAgAAA/4AEAAAA/wAAAP+AAAD/gAAA/4AAAP8AAAABAAAAAIAAAACAAAAAgAAA/4D/gAAAAIABAAAA/4AAAACAAAD/gAAA/oAAAP+AAAAAgAAA/4AAAAACAQAAgAOABAAAFwAbAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAYABgAAAAIAAAP+AAAD/gAAAAIAAAP+AAAD/gAAA/4AAAACAAAD/gAAAAQAAAP8A/4AAgAAA/4AEAAAA/4AAAP8AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAAAAIAAAAEAAAAAAAAA/wAAAAACAIAAgAQABAAAFwAbAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAYACgAAA/4AAAP+AAAD/gAAAAIAAAP+AAAD+gAAAAQAAAP8AAAABAAAAAIAAAP8A/wAAgAAA/4AEAAAA/gAAAAEAAAD/gAAA/4AAAP8AAAD/gAAAAIAAAAEAAAAAgAAAAIAAAACAAAD+gAAA/wAAAAABAIAAgAQABAAAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQIAAIAAAACAAAAAgAAAAIAAAP8AAAD/gAAAAIAAAP6AAAAAgAAA/4AAAP8AAAAAgAAAAIAAAACABAAAAP+AAAD/gAAA/4AAAP8AAAAAgAAA/wAAAP+AAAAAgAAAAQAAAP+AAAABAAAAAIAAAACAAAAAAAABAIAAgAQABAAAGwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQGAAYAAAP+AAAAAgAAAAQAAAP8AAAD/gAAAAIAAAP6AAAAAgAAA/4AAAP8AAAABAAAAAIAAAP+ABAAAAP8AAAD/gAAAAIAAAP6AAAAAgAAA/wAAAP+AAAAAgAAAAQAAAP+AAAABgAAA/4AAAACAAAAAAAABAIAAgAQABAAAFwAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAAAAAIAAAAEAAAAAgAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAA/4AAAACABAAAAP+AAAAAgAAA/4AAAP6AAAD/gAAA/4AAAP+AAAAAgAAAAIAAAACAAAABgAAAAAAAAQCAAIAEAAQAABsAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAACAAAAAgAAAAIAAAACAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAQAAAD/gAAA/4AAAP+AAAD/gAAA/4AAAP+AAAD/gAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAAAAAQEAAIADgAQAAAsAAAEBAQEBAQEBAQEBAQIAAYAAAP8AAAD/gAAA/wAAAACAAAAAgAQAAAD/AAAA/gAAAP+AAAABAAAAAIAAAAAAAAEAgACABAAEAAATAAABAQEBAQEBAQEBAQEBAQEBAQEBAQGAAoAAAP+AAAD/AAAAAIAAAACAAAD+gAAA/4AAAP8AAAAAgAAAAIAEAAAA/QAAAP+AAAABAAAAAIAAAAEAAAD+AAAA/4AAAAEAAAAAgAAAAAAAAAAYASYAAQAAAAAAAAAIAAAAAQAAAAAAAQAIAAgAAQAAAAAAAgAHABAAAQAAAAAAAwAIABcAAQAAAAAABAAQAB8AAQAAAAAABQALAC8AAQAAAAAABgAIADoAAQAAAAAACQAJAEIAAQAAAAAACgA6AEsAAQAAAAAADQARAIUAAQAAAAAADgAyAJYAAQAAAAAAEwAMAMgAAwABBAkAAAAQANQAAwABBAkAAQAQAOQAAwABBAkAAgAOAPQAAwABBAkAAwAQAQIAAwABBAkABAAgARIAAwABBAkABQAWATIAAwABBAkABgAQAUgAAwABBAkACQASAVgAAwABBAkACgB0AWoAAwABBAkADQAiAd4AAwABBAkADgBkAgAAAwABBAkAEwAYAmQoYykgMjAyMlVyc2FGb250UmVndWxhclVyc2FGb250VXJzYUZvbnQgUmVndWxhclZlcnNpb24gMS4wVXJzYUZvbnRVcnNhRnJhbmtBbiBvcGVuIGxpY2VuY2UgZ2VuZXJhbCBwdXJwb3NlIHRleHRtb2RlIGZvbnQgYnkgVXJzYUZyYW5rQ0MwIDEuMCBVbml2ZXJzYWxodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvcHVibGljZG9tYWluL3plcm8vMS4wL0hlbGxvIFdvcmxkIQAoAGMAKQAgADIAMAAyADIAVQByAHMAYQBGAG8AbgB0AFIAZQBnAHUAbABhAHIAVQByAHMAYQBGAG8AbgB0AFUAcgBzAGEARgBvAG4AdAAgAFIAZQBnAHUAbABhAHIAVgBlAHIAcwBpAG8AbgAgADEALgAwAFUAcgBzAGEARgBvAG4AdABVAHIAcwBhAEYAcgBhAG4AawBBAG4AIABvAHAAZQBuACAAbABpAGMAZQBuAGMAZQAgAGcAZQBuAGUAcgBhAGwAIABwAHUAcgBwAG8AcwBlACAAdABlAHgAdABtAG8AZABlACAAZgBvAG4AdAAgAGIAeQAgAFUAcgBzAGEARgByAGEAbgBrAEMAQwAwACAAMQAuADAAIABVAG4AaQB2AGUAcgBzAGEAbABoAHQAdABwAHMAOgAvAC8AYwByAGUAYQB0AGkAdgBlAGMAbwBtAG0AbwBuAHMALgBvAHIAZwAvAHAAdQBiAGwAaQBjAGQAbwBtAGEAaQBuAC8AegBlAHIAbwAvADEALgAwAC8ASABlAGwAbABvACAAVwBvAHIAbABkACEAAAADAAAAAAAAAGYAMwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\r
`;class cA{extractCharacters(i){var o;const l=[];return(o=i==null?void 0:i.cmap)!=null&&o.tables?(i.cmap.tables.forEach(f=>{if(f.format===4){const m=this._extractCharactersFromFormat4Table(f);l.push(...m)}else if(f.format===12){const m=this._extractCharactersFromFormat12Table(f);l.push(...m)}}),[...new Set(l)]):[]}_extractCharactersFromFormat4Table(i){const o=[];if(!i.startCount||!i.endCount||!i.idRangeOffset||!i.idDelta)return o;for(let l=0;l<i.startCount.length;l++){const f=i.startCount[l],m=i.endCount[l];if(!(f===65535&&m===65535)){for(let D=f;D<=m;D++)if(this._calculateGlyphIndexFormat4(i,D,l)>0){const F=String.fromCodePoint(D);o.push(F)}}}return o}_extractCharactersFromFormat12Table(i){const o=[];if(!i.groups)return o;for(let l=0;l<i.groups.length;l+=3){const f=i.groups[l],m=i.groups[l+1],D=i.groups[l+2];for(let F=f;F<=m;F++)if(D+(F-f)>0){const pe=String.fromCodePoint(F);o.push(pe)}}return o}_calculateGlyphIndexFormat4(i,o,l){if(i.idRangeOffset[l]===0)return o+i.idDelta[l]&65535;{const f=i.idRangeOffset[l]/2+(o-i.startCount[l])-(i.startCount.length-l);if(f>=0&&i.glyphIdArray&&f<i.glyphIdArray.length){const m=i.glyphIdArray[f];if(m!==0)return m+i.idDelta[l]&65535}}return 0}filterProblematicCharacters(i){return i.filter(o=>this._isValidCharacter(o))}_isValidCharacter(i){const o=i.codePointAt(0)||0;return!(o>=0&&o<=31&&o!==9&&o!==10&&o!==13||o>=127&&o<=159)}}class uA{constructor(i){a$1(this,"_textureCanvas"),a$1(this,"_textureContext"),a$1(this,"_renderer"),this._renderer=i,this._textureCanvas=document.createElement("canvas"),this._textureContext=this._textureCanvas.getContext("2d",{willReadFrequently:!0,alpha:!1})}createTextureAtlas(i,o,l,f){const m=i.length,D=Math.ceil(Math.sqrt(m)),F=Math.ceil(m/D),pe=o.width*D,ue=o.height*F;this._setupCanvas(pe,ue,l,f),this._renderCharactersToCanvas(i,o,D,l),this._applyBlackWhiteThreshold();const j=this._renderer.createFramebuffer(pe,ue,{filter:"nearest"});return j.update(this._textureCanvas),{framebuffer:j,columns:D,rows:F}}_setupCanvas(i,o,l,f){this._textureCanvas.width=i,this._textureCanvas.height=o,this._textureCanvas.style.width=i+"px",this._textureCanvas.style.height=i+"px",this._textureContext.imageSmoothingEnabled=!1,this._textureCanvas.style.imageRendering="pixelated",this._textureContext.fillStyle="black",this._textureContext.fillRect(0,0,i,o),this._textureContext.font=`${l}px ${f}`,this._textureContext.textBaseline="top",this._textureContext.textAlign="left",this._textureContext.fillStyle="white"}_renderCharactersToCanvas(i,o,l,f){for(let m=0;m<i.length;m++){const D=m%l,F=Math.floor(m/l),pe=D*o.width+o.width*.5,ue=F*o.height+o.height*.5,j=Math.round(pe-o.width*.5),xe=Math.round(ue-f*.5);this._textureContext.fillText(i[m].character,j,xe)}}_applyBlackWhiteThreshold(i=128){const o=this._textureContext.getImageData(0,0,this._textureCanvas.width,this._textureCanvas.height),l=o.data;for(let f=0;f<l.length;f+=4){const m=.299*l[f]+.587*l[f+1]+.114*l[f+2],D=i+32,F=m>D?255:0;l[f]=F,l[f+1]=F,l[f+2]=F}this._textureContext.putImageData(o,0,0)}}class dA{constructor(){a$1(this,"_tempCanvas"),a$1(this,"_tempContext"),this._tempCanvas=document.createElement("canvas"),this._tempContext=this._tempCanvas.getContext("2d")}calculateMaxGlyphDimensions(i,o,l){this._tempContext.font=`${o}px ${l}`;let f=0,m=0;for(const D of i){const F=this._tempContext.measureText(D),pe=F.width,ue=F.actualBoundingBoxAscent+F.actualBoundingBoxDescent;pe>0&&(f=Math.max(f,pe),m=Math.max(m,ue))}return{width:Math.ceil(f),height:Math.ceil(m)}}}class CA{createCharacterObjects(i,o){return i.map((l,f)=>{const m=l.codePointAt(0)||0,D=this._generateCharacterColor(f);let F=0;if(o.hmtx&&o.hmtx.aWidth){const pe=this._getGlyphIndex(o,m);pe>0&&o.hmtx.aWidth[pe]!==void 0&&(F=o.hmtx.aWidth[pe])}return{character:l,unicode:m,color:D,advanceWidth:F}})}_getGlyphIndex(i,o){const l=i.cmap;if(!l||!l.tables)return 0;for(const f of l.tables)if(f.format===4){for(let m=0;m<f.startCount.length;m++)if(o>=f.startCount[m]&&o<=f.endCount[m]){if(f.idRangeOffset[m]===0)return o+f.idDelta[m]&65535;{const D=f.idRangeOffset[m]/2+(o-f.startCount[m])-(f.startCount.length-m);if(D>=0&&D<f.glyphIdArray.length){const F=f.glyphIdArray[D];if(F!==0)return F+f.idDelta[m]&65535}}}}return 0}_generateCharacterColor(i){const o=i%256,l=Math.floor(i/256)%256,f=Math.floor(i/65536)%256;return[o,l,f]}getCharacterColor(i,o){if(!C.validate(typeof i=="string"&&i.length===1,"Character must be a single character string.",{method:"getCharacterColor",providedValue:i}))return[0,0,0];const l=o.find(f=>f.character===i);return l?l.color:[0,0,0]}getCharacterColors(i,o){return C.validate(typeof i=="string"&&i.length>0,"Characters must be a string with at least one character.",{method:"getCharacterColors",providedValue:i})?i.split("").map(l=>this.getCharacterColor(l,o)||[0,0,0]):[[0,0,0]]}}class fA{constructor(i,o=16){a$1(this,"_font"),a$1(this,"_characters",[]),a$1(this,"_fontFramebuffer"),a$1(this,"_fontSize",16),a$1(this,"_textureColumns",0),a$1(this,"_textureRows",0),a$1(this,"_maxGlyphDimensions",{width:0,height:0}),a$1(this,"_fontFace"),a$1(this,"_fontFamilyName","UrsaFont"),a$1(this,"_characterExtractor"),a$1(this,"_textureAtlas"),a$1(this,"_metricsCalculator"),a$1(this,"_characterColorMapper"),this._fontSize=o,this._characterExtractor=new cA,this._textureAtlas=new uA(i),this._metricsCalculator=new dA,this._characterColorMapper=new CA}async initialize(i){let o;if(i){const l=await fetch(i);if(!l.ok)throw new P(`Failed to load font file: ${l.status} ${l.statusText}`);o=await l.arrayBuffer()}else o=await(await fetch(hA)).arrayBuffer();await this._loadFontFace(o),this._font=h.parse(o)[0],await this._initializeFont()}setFontSize(i){if(i===void 0)return this._fontSize;this._fontSize=i,this._maxGlyphDimensions=this._metricsCalculator.calculateMaxGlyphDimensions(this._characters.map(l=>l.character),this._fontSize,this._fontFamilyName);const o=this._textureAtlas.createTextureAtlas(this._characters,this._maxGlyphDimensions,this._fontSize,this._fontFamilyName);this._fontFramebuffer=o.framebuffer,this._textureColumns=o.columns,this._textureRows=o.rows}async loadFont(i){try{const o=await fetch(i);if(!o.ok)throw new P(`Failed to load font file: ${o.status} ${o.statusText}`);const l=await o.arrayBuffer();await this._loadFontFace(l);const f=h.parse(l);if(!f||f.length===0)throw new Error("Failed to parse font file");this._font=f[0],await this._initializeFont()}catch(o){throw new P(`Failed to load font: ${o instanceof Error?o.message:"Unknown error"}`,o)}}async _loadFontFace(i){const o=Date.now();this._fontFamilyName=this._fontFamilyName==="UrsaFont"?"UrsaFont":`CustomFont_${o}`,this._fontFace=new FontFace(this._fontFamilyName,i),await this._fontFace.load(),document.fonts.add(this._fontFace)}async _initializeFont(){const i=this._characterExtractor.extractCharacters(this._font),o=this._characterExtractor.filterProblematicCharacters(i);this._characters=this._characterColorMapper.createCharacterObjects(o,this._font),this._maxGlyphDimensions=this._metricsCalculator.calculateMaxGlyphDimensions(o,this._fontSize,this._fontFamilyName);const l=this._textureAtlas.createTextureAtlas(this._characters,this._maxGlyphDimensions,this._fontSize,this._fontFamilyName);this._fontFramebuffer=l.framebuffer,this._textureColumns=l.columns,this._textureRows=l.rows}getCharacterColor(i){return this._characterColorMapper.getCharacterColor(i,this._characters)}getCharacterColors(i){return this._characterColorMapper.getCharacterColors(i,this._characters)}hasAllCharacters(i){if(typeof i!="string"||i.length===0)return!1;const o=new Set(this._characters.map(l=>l.character));for(const l of i)if(!o.has(l))return!1;return!0}get fontFramebuffer(){return this._fontFramebuffer}get characters(){return this._characters}get textureColumns(){return this._textureColumns}get textureRows(){return this._textureRows}get maxGlyphDimensions(){return this._maxGlyphDimensions}get fontSize(){return this._fontSize}get font(){return this._font}}class DA{constructor(i,o,l){a$1(this,"_cols"),a$1(this,"_rows"),a$1(this,"_width"),a$1(this,"_height"),a$1(this,"_offsetX"),a$1(this,"_offsetY"),a$1(this,"_fixedDimensions",!1),a$1(this,"_canvas"),a$1(this,"_cellWidth"),a$1(this,"_cellHeight"),this._canvas=i,this._cellWidth=o,this._cellHeight=l,this.reset()}reset(){if(!this._fixedDimensions){const i=this._canvas.getBoundingClientRect();let o=Math.round(i.width),l=Math.round(i.height);[this._cols,this._rows]=[Math.floor(o/this._cellWidth),Math.floor(l/this._cellHeight)]}this._resizeGrid()}_resizeGrid(){const i=this._canvas.getBoundingClientRect();let o=Math.round(i.width),l=Math.round(i.height);this._width=this._cols*this._cellWidth,this._height=this._rows*this._cellHeight,this._offsetX=Math.floor((o-this._width)/2),this._offsetY=Math.floor((l-this._height)/2)}resizeCellPixelDimensions(i,o){[this._cellWidth,this._cellHeight]=[i,o],this.reset()}resizeGridDimensions(i,o){this._fixedDimensions=!0,[this._cols,this._rows]=[i,o],this._resizeGrid()}resetGridDimensions(){this._fixedDimensions=!1,this.reset()}resize(){this._fixedDimensions?this._resizeGrid():this.reset()}fixedDimensions(i){if(i===void 0)return this._fixedDimensions;this._fixedDimensions=i}get cellWidth(){return this._cellWidth}get cellHeight(){return this._cellHeight}get cols(){return this._cols}get rows(){return this._rows}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}}class mA{constructor(i,o=!1,l={}){a$1(this,"_canvas"),a$1(this,"captureSource"),a$1(this,"_isStandalone"),this.captureSource=i,this._isStandalone=o,this._canvas=this.createCanvas(l.width,l.height)}createCanvas(i,o){var l;const f=document.createElement("canvas");if(f.className="textmodeCanvas",this._isStandalone)f.width=i||800,f.height=o||600,f.style.width=i+"px",f.style.height=o+"px",document.body.appendChild(f);else{const m=this.captureSource.getBoundingClientRect();let D=Math.round(m.width),F=Math.round(m.height);if(this.captureSource instanceof HTMLVideoElement){const j=this.captureSource;(D===0||F===0)&&j.videoWidth>0&&j.videoHeight>0&&(D=j.videoWidth,F=j.videoHeight)}f.width=D,f.height=F,f.style.width=D+"px",f.style.height=F+"px",f.style.position="absolute",f.style.pointerEvents="none";const pe=window.getComputedStyle(this.captureSource);let ue=parseInt(pe.zIndex||"0",10);isNaN(ue)&&(ue=0),f.style.zIndex=(ue+1).toString(),this.positionOverlayCanvas(f),(l=this.captureSource.parentNode)==null||l.insertBefore(f,this.captureSource.nextSibling)}return f}positionOverlayCanvas(i){const o=this.captureSource.getBoundingClientRect();let l=this.captureSource.offsetParent;if(l&&l!==document.body){const f=l.getBoundingClientRect();i.style.top=o.top-f.top+"px",i.style.left=o.left-f.left+"px"}else i.style.top=o.top+window.scrollY+"px",i.style.left=o.left+window.scrollX+"px"}resize(i,o){if(this._isStandalone)this._canvas.width=i??this._canvas.width,this._canvas.height=o??this._canvas.height,this._canvas.style.width=(i??this._canvas.width)+"px",this._canvas.style.height=(o??this._canvas.height)+"px";else{const l=this.captureSource.getBoundingClientRect();let f=Math.round(l.width),m=Math.round(l.height);if(this.captureSource instanceof HTMLVideoElement){const D=this.captureSource;(f===0||m===0)&&D.videoWidth>0&&D.videoHeight>0&&(f=D.videoWidth,m=D.videoHeight)}this._canvas.width=f,this._canvas.height=m,this._canvas.style.width=f+"px",this._canvas.style.height=m+"px",this.positionOverlayCanvas(this._canvas)}}getWebGLContext(){const i={alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1,stencil:!1,powerPreference:"high-performance"},o=this._canvas.getContext("webgl2",i)||this._canvas.getContext("webgl",i);if(!o)throw new P("WebGL context could not be created. Ensure your browser supports WebGL.");return o}get canvas(){return this._canvas}get width(){return this._canvas.width}get height(){return this._canvas.height}}class b{constructor(i,o,l,f={}){a$1(this,"renderer"),a$1(this,"fontManager"),a$1(this,"grid"),a$1(this,"_characterFramebuffer"),a$1(this,"_primaryColorFramebuffer"),a$1(this,"_secondaryColorFramebuffer"),a$1(this,"_rotationFramebuffer"),a$1(this,"_transformFramebuffer"),a$1(this,"_options"),this.renderer=i,this.fontManager=o,this.grid=l,this._options=f,this._characterFramebuffer=this.renderer.createFramebuffer(this.grid.cols,this.grid.rows),this._primaryColorFramebuffer=this.renderer.createFramebuffer(this.grid.cols,this.grid.rows),this._secondaryColorFramebuffer=this.renderer.createFramebuffer(this.grid.cols,this.grid.rows),this._rotationFramebuffer=this.renderer.createFramebuffer(this.grid.cols,this.grid.rows),this._transformFramebuffer=this.renderer.createFramebuffer(this.grid.cols,this.grid.rows)}resize(){this._characterFramebuffer.resize(this.grid.cols,this.grid.rows),this._primaryColorFramebuffer.resize(this.grid.cols,this.grid.rows),this._secondaryColorFramebuffer.resize(this.grid.cols,this.grid.rows),this._rotationFramebuffer.resize(this.grid.cols,this.grid.rows),this._transformFramebuffer.resize(this.grid.cols,this.grid.rows)}enabled(i){this._options.enabled=i}enable(){this.enabled(!0)}disable(){this.enabled(!1)}get characterFramebuffer(){return this._characterFramebuffer}get primaryColorFramebuffer(){return this._primaryColorFramebuffer}get secondaryColorFramebuffer(){return this._secondaryColorFramebuffer}get rotationFramebuffer(){return this._rotationFramebuffer}get transformFramebuffer(){return this._transformFramebuffer}get options(){return this._options}}class PA{constructor(i,o){a$1(this,"_framebuffer"),a$1(this,"_renderer"),a$1(this,"_colors"),this._renderer=i,this._colors=o;const l=Math.max(this._colors.length,1);this._framebuffer=this._renderer.createFramebuffer(l,1),this._updateFramebuffer()}_updateFramebuffer(){if(!this._framebuffer)return;const i=Math.max(this._colors.length,1),o=1;this._framebuffer.width!==i&&this._framebuffer.resize(i,o);const l=new Uint8Array(i*o*4);for(let f=0;f<i;f++){const m=f<this._colors.length?this._colors[f]:[0,0,0],D=f*4;l[D]=m[0],l[D+1]=m[1],l[D+2]=m[2],l[D+3]=255}this._framebuffer.updatePixels(l,i,o)}setColors(i){this._colors=i,this._updateFramebuffer()}get colors(){return this._colors}get framebuffer(){return this._framebuffer}get texture(){return this._framebuffer.texture}}class z extends b{constructor(i,o,l,f={}){super(i,o,l,f),a$1(this,"palette"),this.palette=new PA(this.renderer,this.fontManager.getCharacterColors(" .:-=+*%@#"))}characters(i){C.validate(this.fontManager.hasAllCharacters(i),"One or more characters do not exist in the current font.",{method:"characters",providedValue:i})&&(this._options.characters=i,this.palette.setColors(this.fontManager.getCharacterColors(i)))}characterColor(i,o=i,l=i,f=255){C.validate([i,o,l,f].every(m=>m>=0&&m<=255),"Character color values must be between 0 and 255",{method:"characterColor",providedValues:{r:i,g:o,b:l,a:f}})&&(this._options.characterColor=[i,o,l,f])}characterColorMode(i){C.validate(["sampled","fixed"].includes(i),"Invalid character color mode. Must be 'sampled' or 'fixed'.",{method:"characterColorMode",providedValue:i})&&(this._options.characterColorMode=i)}cellColor(i,o=i,l=i,f=255){C.validate([i,o,l,f].every(m=>m>=0&&m<=255),"Cell color values must be between 0 and 255",{method:"cellColor",providedValues:{r:i,g:o,b:l,a:f}})&&(this._options.cellColor=[i,o,l,f])}cellColorMode(i){C.validate(["sampled","fixed"].includes(i),"Invalid cell color mode. Must be 'sampled' or 'fixed'.",{method:"cellColorMode",providedValue:i})&&(this._options.cellColorMode=i)}invert(i){C.validate(typeof i=="boolean"||typeof i=="number"&&Number.isInteger(i),"Invert must be a boolean value or an integer (0 for false, any other number for true).",{method:"invert",providedValue:i})&&(this._options.invert=!!i)}rotation(i){if(!C.validate(typeof i=="number","Rotation angle must be a number.",{method:"rotation",providedValue:i}))return;i=i%360,i<0&&(i+=360);const o=i*255/360,l=Math.floor(o)/255,f=Math.round(o-l);this._options.rotation=[l,f,0,1]}flipHorizontally(i){C.validate(typeof i=="boolean"||typeof i=="number"&&Number.isInteger(i),"Flip horizontally must be a boolean value or an integer (0 for false, any other number for true).",{method:"flipHorizontally",providedValue:i})&&(this._options.flipHorizontally=!!i)}flipVertically(i){C.validate(typeof i=="boolean"||typeof i=="number"&&Number.isInteger(i),"Flip vertically must be a boolean value or an integer (0 for false, any other number for true).",{method:"flipVertically",providedValue:i})&&(this._options.flipVertically=!!i)}}var IA="precision lowp float;uniform sampler2D u_sketchTexture;uniform vec2 u_gridCellDimensions;uniform vec2 u_brightnessRange;varying vec2 v_uv;void main(){vec2 cellCenter=(floor(v_uv*u_gridCellDimensions)+vec2(0.5))/u_gridCellDimensions;vec4 color=texture2D(u_sketchTexture,cellCenter);float brightness=dot(color.rgb,vec3(0.299,0.587,0.114));float brightnessValue=brightness*255.0;if(brightnessValue>=u_brightnessRange.x&&brightnessValue<=u_brightnessRange.y){gl_FragColor=color;}else{gl_FragColor=vec4(0.0);}}",wA="precision lowp float;uniform sampler2D u_sampleTexture;uniform vec4 u_fillColor;uniform bool u_useFixedColor;varying vec2 v_uv;void main(){vec4 sampleColor=texture2D(u_sampleTexture,v_uv);if(sampleColor.a>0.0){if(u_useFixedColor){gl_FragColor=u_fillColor;}else{gl_FragColor=sampleColor;}}else{gl_FragColor=vec4(0.0);}}",pA="precision lowp float;uniform sampler2D u_sampleTexture;uniform bool u_invert;uniform bool u_flipHorizontally;uniform bool u_flipVertically;varying vec2 v_uv;void main(){vec4 sampleColor=texture2D(u_sampleTexture,v_uv);if(sampleColor.a>0.0){float invertValue=u_invert ? 1.0 : 0.0;float flipHValue=u_flipHorizontally ? 1.0 : 0.0;float flipVValue=u_flipVertically ? 1.0 : 0.0;gl_FragColor=vec4(invertValue,flipHValue,flipVValue,1.0);}else{gl_FragColor=vec4(0.0);}}",_A="precision lowp float;uniform sampler2D u_sampleTexture;uniform vec4 u_rotationColor;varying vec2 v_uv;void main(){vec4 sampleColor=texture2D(u_sampleTexture,v_uv);if(sampleColor.a>0.0){gl_FragColor=u_rotationColor;}else{gl_FragColor=vec4(0.0);}}",xA="precision lowp float;uniform sampler2D u_colorSampleFramebuffer;uniform sampler2D u_charPaletteTexture;uniform vec2 u_charPaletteSize;uniform vec2 u_brightnessRange;varying vec2 v_uv;void main(){vec4 color=texture2D(u_colorSampleFramebuffer,v_uv);if(color.a==0.0){gl_FragColor=vec4(0.0);return;}float brightness=dot(color.rgb,vec3(0.299,0.587,0.114))*255.0;vec2 range=u_brightnessRange;if(brightness<range.x||brightness>range.y){gl_FragColor=vec4(0.0);return;}float t=(brightness-range.x)/(range.y-range.x);float idx=clamp(floor(t*u_charPaletteSize.x),0.0,u_charPaletteSize.x-1.0);vec3 charColor=texture2D(u_charPaletteTexture,vec2((idx+0.5)/u_charPaletteSize.x,0.0)).rgb;gl_FragColor=vec4(charColor,1.0);}";const vA={enabled:!0,characters:" .:-=+*%@#",characterColor:[255,255,255,255],characterColorMode:"sampled",cellColor:[0,0,0,255],cellColorMode:"fixed",invert:!1,rotation:[0,0,0,255],flipHorizontally:!1,flipVertically:!1,brightnessRange:[0,255]};class O extends z{constructor(i,o,l){super(i,o,l,{...vA}),a$1(this,"sampleShader"),a$1(this,"colorFillShader"),a$1(this,"charMappingShader"),a$1(this,"transformFillShader"),a$1(this,"rotationFillShader"),a$1(this,"sampleFramebuffer"),this.sampleShader=new p(i.context,_,IA),this.colorFillShader=new p(i.context,_,wA),this.transformFillShader=new p(i.context,_,pA),this.rotationFillShader=new p(i.context,_,_A),this.charMappingShader=new p(i.context,_,xA),this.sampleFramebuffer=this.renderer.createFramebuffer(this.grid.cols,this.grid.rows)}convert(i){this.sampleFramebuffer.begin(),this.renderer.clear(),this.renderer.shader(this.sampleShader),this.renderer.setUniform("u_sketchTexture",i),this.renderer.setUniform("u_gridCellDimensions",[this.grid.cols,this.grid.rows]),this.renderer.setUniform("u_brightnessRange",this._options.brightnessRange),this.renderer.rect(0,0,this.grid.cols,this.grid.rows),this.sampleFramebuffer.end(),this._primaryColorFramebuffer.begin(),this.renderer.clear(),this.renderer.shader(this.colorFillShader),this.renderer.setUniform("u_sampleTexture",this.sampleFramebuffer.texture),this.renderer.setUniform("u_fillColor",this._options.characterColor),this.renderer.setUniform("u_useFixedColor",this._options.characterColorMode==="fixed"),this.renderer.rect(0,0,this.grid.cols,this.grid.rows),this._primaryColorFramebuffer.end(),this._secondaryColorFramebuffer.begin(),this.renderer.clear(),this.renderer.shader(this.colorFillShader),this.renderer.setUniform("u_sampleTexture",this.sampleFramebuffer.texture),this.renderer.setUniform("u_fillColor",this._options.cellColor),this.renderer.setUniform("u_useFixedColor",this._options.cellColorMode==="fixed"),this.renderer.rect(0,0,this.grid.cols,this.grid.rows),this._secondaryColorFramebuffer.end(),this._transformFramebuffer.begin(),this.renderer.clear(),this.renderer.shader(this.transformFillShader),this.renderer.setUniform("u_sampleTexture",this.sampleFramebuffer.texture),this.renderer.setUniform("u_invert",this._options.invert),this.renderer.setUniform("u_flipHorizontally",this._options.flipHorizontally),this.renderer.setUniform("u_flipVertically",this._options.flipVertically),this.renderer.rect(0,0,this.grid.cols,this.grid.rows),this._transformFramebuffer.end(),this._rotationFramebuffer.begin(),this.renderer.clear(),this.renderer.shader(this.rotationFillShader),this.renderer.setUniform("u_sampleTexture",this.sampleFramebuffer.texture),this.renderer.setUniform("u_rotationColor",this._options.rotation),this.renderer.rect(0,0,this.grid.cols,this.grid.rows),this._rotationFramebuffer.end(),this._characterFramebuffer.begin(),this.renderer.clear(0,0,0,0),this.renderer.shader(this.charMappingShader),this.renderer.setUniform("u_colorSampleFramebuffer",this.sampleFramebuffer.texture),this.renderer.setUniform("u_charPaletteTexture",this.palette.texture),this.renderer.setUniform("u_charPaletteSize",[this.palette.colors.length,1]),this.renderer.setUniform("u_brightnessRange",this._options.brightnessRange),this.renderer.rect(0,0,this.grid.cols,this.grid.rows),this._characterFramebuffer.end()}resize(){super.resize(),this.sampleFramebuffer.resize(this.grid.cols,this.grid.rows)}brightnessRange(i){C.validate(Array.isArray(i)&&i.length===2&&i.every(o=>typeof o=="number"&&o>=0&&o<=255),"Brightness range must be an array of two numbers between 0 and 255.",{method:"brightnessRange",providedValue:i})&&(this._options.brightnessRange=i)}}var bA="precision mediump float;uniform sampler2D u_characterTexture;uniform vec2 u_charsetDimensions;uniform sampler2D u_primaryColorTexture;uniform sampler2D u_secondaryColorTexture;uniform sampler2D u_transformTexture;uniform sampler2D u_asciiCharacterTexture;uniform sampler2D u_rotationTexture;uniform sampler2D u_captureTexture;uniform vec2 u_captureDimensions;uniform int u_backgroundMode;uniform vec2 u_gridCellDimensions;uniform vec2 u_gridPixelDimensions;mat2 rotate2D(float angle){float s=sin(angle);float c=cos(angle);return mat2(c,-s,s,c);}void main(){vec2 adjustedCoord=gl_FragCoord.xy/u_gridPixelDimensions;vec2 gridCoord=adjustedCoord*u_gridCellDimensions;vec2 cellCoord=floor(gridCoord);vec2 charIndexTexCoord=(cellCoord+0.5)/u_gridCellDimensions;vec4 primaryColor=texture2D(u_primaryColorTexture,charIndexTexCoord);vec4 secondaryColor=texture2D(u_secondaryColorTexture,charIndexTexCoord);vec4 transformColor=texture2D(u_transformTexture,charIndexTexCoord);bool isInverted=transformColor.r>0.5;bool flipHorizontal=transformColor.g>0.5;bool flipVertical=transformColor.b>0.5;vec4 encodedIndexVec=texture2D(u_asciiCharacterTexture,charIndexTexCoord);if(encodedIndexVec.a<0.01){gl_FragColor=(u_backgroundMode==0)? vec4(0.0):texture2D(u_captureTexture,gl_FragCoord.xy/u_captureDimensions);return;}int charIndex=int(encodedIndexVec.r*255.0+0.5)+int(encodedIndexVec.g*255.0+0.5)*256;int charCol=int(mod(float(charIndex),u_charsetDimensions.x));int charRow=charIndex/int(u_charsetDimensions.x);vec2 charCoord=vec2(charCol,charRow)/u_charsetDimensions;vec4 rotationColor=texture2D(u_rotationTexture,charIndexTexCoord);float scaledAngle=rotationColor.r*255.0+rotationColor.g;float rotationAngle=(scaledAngle*360.0/255.0)*0.017453292;vec2 fractionalPart=fract(gridCoord)-0.5;if(flipHorizontal)fractionalPart.x=-fractionalPart.x;if(flipVertical)fractionalPart.y=-fractionalPart.y;fractionalPart=rotate2D(rotationAngle)*fractionalPart+0.5;vec2 cellSize=1.0/u_charsetDimensions;vec2 texCoord=charCoord+fractionalPart*cellSize;vec2 cellMax=charCoord+cellSize;if(any(lessThan(texCoord,charCoord))||any(greaterThan(texCoord,cellMax))){gl_FragColor=isInverted ? primaryColor : secondaryColor;return;}vec4 charTexel=texture2D(u_characterTexture,texCoord);if(isInverted)charTexel.rgb=1.0-charTexel.rgb;gl_FragColor=mix(secondaryColor,primaryColor,charTexel);}";class FA{constructor(i,o,l){a$1(this,"renderer"),a$1(this,"font"),a$1(this,"grid"),a$1(this,"converters"),a$1(this,"_resultFramebuffer"),a$1(this,"_asciiShader"),a$1(this,"_characterFramebuffer"),a$1(this,"_primaryColorFramebuffer"),a$1(this,"_secondaryColorFramebuffer"),a$1(this,"_rotationFramebuffer"),a$1(this,"_transformFramebuffer"),this.renderer=i,this.font=o,this.grid=l,this._asciiShader=this.renderer.createShader(_,bA),this.converters=[{name:"brightness",converter:new O(i,o,l)},{name:"custom",converter:new b(i,o,l)}],this._characterFramebuffer=this.renderer.createFramebuffer(l.cols,l.rows),this._primaryColorFramebuffer=this.renderer.createFramebuffer(l.cols,l.rows),this._secondaryColorFramebuffer=this.renderer.createFramebuffer(l.cols,l.rows),this._rotationFramebuffer=this.renderer.createFramebuffer(l.cols,l.rows),this._transformFramebuffer=this.renderer.createFramebuffer(l.cols,l.rows),this._resultFramebuffer=this.renderer.createFramebuffer(this.grid.width,this.grid.height)}render(i){for(const l of this.converters){const f=l.converter;f.options.enabled&&f instanceof z&&f.convert(i)}const o=(l,f)=>{l.begin(),this.renderer.clear();for(const m of this.converters){const D=m.converter;D.options.enabled&&this.renderer.image(f(D),0,0)}l.end()};o(this._characterFramebuffer,l=>l.characterFramebuffer),o(this._primaryColorFramebuffer,l=>l.primaryColorFramebuffer),o(this._secondaryColorFramebuffer,l=>l.secondaryColorFramebuffer),o(this._rotationFramebuffer,l=>l.rotationFramebuffer),o(this._transformFramebuffer,l=>l.transformFramebuffer),this._resultFramebuffer.begin(),this.renderer.clear(),this.renderer.shader(this._asciiShader),this.renderer.setUniform("u_characterTexture",this.font.fontFramebuffer),this.renderer.setUniform("u_charsetDimensions",[this.font.textureColumns,this.font.textureRows]),this.renderer.setUniform("u_asciiCharacterTexture",this._characterFramebuffer.texture),this.renderer.setUniform("u_primaryColorTexture",this._primaryColorFramebuffer.texture),this.renderer.setUniform("u_secondaryColorTexture",this._secondaryColorFramebuffer.texture),this.renderer.setUniform("u_transformTexture",this._transformFramebuffer.texture),this.renderer.setUniform("u_rotationTexture",this._rotationFramebuffer.texture),this.renderer.setUniform("u_captureTexture",i.texture),this.renderer.setUniform("u_backgroundMode",!1),this.renderer.setUniform("u_captureDimensions",[i.width,i.height]),this.renderer.setUniform("u_gridCellDimensions",[this.grid.cols,this.grid.rows]),this.renderer.setUniform("u_gridPixelDimensions",[this.grid.width,this.grid.height]),this.renderer.rect(0,0,this._resultFramebuffer.width,this._resultFramebuffer.height),this._resultFramebuffer.end()}get(i){if(!C.validate(typeof i=="string"&&i.length>0,"Converter name must be a non-empty string.",{method:"converter",providedValue:i}))return;const o=this.converters.find(f=>f.name===i),l=o==null?void 0:o.converter;if(C.validate(l instanceof b,`Converter "${i}" is not a valid TextmodeConverter.`,{method:"converter",providedValue:i,converterInstance:l}))return l}add(i,o){if(!C.validate(typeof i=="string"&&i.length>0,"Converter name must be a non-empty string.",{method:"add",providedValue:i})||!C.validate(o==="brightness"||o==="custom",`Converter type must be either "brightness" or "custom". Provided: ${o}`,{method:"add",providedValue:o}))return;let l;return o==="brightness"?l=new O(this.renderer,this.font,this.grid):l=new b(this.renderer,this.font,this.grid),this.converters.push({name:i,converter:l}),l}remove(i){if(!C.validate(typeof i=="string"||i instanceof b,"Parameter must be either a string (converter name) or a TextmodeConverter instance.",{method:"remove",providedValue:i}))return;let o=-1;if(typeof i=="string"){if(!C.validate(i.length>0,"Converter name must be a non-empty string.",{method:"remove",providedValue:i}))return;o=this.converters.findIndex(l=>l.name===i)}else o=this.converters.findIndex(l=>l.converter===i);C.validate(o!==-1,typeof i=="string"?`Converter with name "${i}" not found in pipeline.`:"Converter instance not found in pipeline.",{method:"remove",providedValue:i,convertersCount:this.converters.length})&&this.converters.splice(o,1)}get texture(){return this._resultFramebuffer}resize(){this._resultFramebuffer.resize(this.grid.width,this.grid.height),this._characterFramebuffer.resize(this.grid.cols,this.grid.rows),this._primaryColorFramebuffer.resize(this.grid.cols,this.grid.rows),this._secondaryColorFramebuffer.resize(this.grid.cols,this.grid.rows),this._rotationFramebuffer.resize(this.grid.cols,this.grid.rows),this._transformFramebuffer.resize(this.grid.cols,this.grid.rows);for(const i of this.converters)i.converter.resize()}hasEnabledConverters(){return this.converters.some(i=>i.converter.options.enabled)}disable(){for(const i of this.converters)i.converter.disable()}enable(){for(const i of this.converters)i.converter.enable()}get characterFramebuffer(){return this._characterFramebuffer}get primaryColorFramebuffer(){return this._primaryColorFramebuffer}get secondaryColorFramebuffer(){return this._secondaryColorFramebuffer}get rotationFramebuffer(){return this._rotationFramebuffer}get transformFramebuffer(){return this._transformFramebuffer}}class H{extractFramebufferData(i){const o=i.get("brightness"),l=o==null?void 0:o.characterFramebuffer,f=o==null?void 0:o.primaryColorFramebuffer,m=o==null?void 0:o.secondaryColorFramebuffer,D=o==null?void 0:o.transformFramebuffer,F=o==null?void 0:o.rotationFramebuffer;return l==null||l.loadPixels(),f==null||f.loadPixels(),m==null||m.loadPixels(),D==null||D.loadPixels(),F==null||F.loadPixels(),{characterPixels:(l==null?void 0:l.pixels)||new Uint8Array(0),primaryColorPixels:(f==null?void 0:f.pixels)||new Uint8Array(0),secondaryColorPixels:(m==null?void 0:m.pixels)||new Uint8Array(0),transformPixels:(D==null?void 0:D.pixels)||new Uint8Array(0),rotationPixels:(F==null?void 0:F.pixels)||new Uint8Array(0)}}getCharacterIndex(i,o){const l=i[o],f=i[o+1];return l+(f<<8)}pixelsToRGBA(i,o){return{r:i[o],g:i[o+1],b:i[o+2],a:i[o+3]}}}class L{createBlob(i,o){return new Blob([i],{type:o})}downloadFile(i,o,l){try{const f=this.createBlob(i,l),m=URL.createObjectURL(f),D=document.createElement("a");D.href=m,D.download=o,D.style.display="none",D.rel="noopener",document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(m)}catch(f){throw console.error("Failed to download file:",f),new Error(`File download failed: ${f instanceof Error?f.message:"Unknown error"}`)}}generateTimestamp(){return new Date().toISOString().slice(0,19).replace(/:/g,"-")}generateDateTimeString(){const i=new Date,o=i.toISOString().split("T")[0],l=i.toTimeString().split(" ")[0].replace(/:/g,"-");return{date:o,time:l}}sanitizeFilename(i){return i.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"_").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"").substring(0,255)}generateDefaultFilename(){return`'textmode-export'-${this.generateTimestamp()}`}}class yA extends H{extractTransformData(i,o,l){const f=i[l],m=i[l+1],D=i[l+2],F=f===255,pe=m===255,ue=D===255,j=o[l],xe=o[l+1],Z=j+xe/255,Ee=Math.round(Z*360/255*100)/100;return{isInverted:F,flipHorizontal:pe,flipVertical:ue,rotation:Ee}}calculateCellPosition(i,o,l){return{x:i,y:o,cellX:i*l.cellWidth,cellY:o*l.cellHeight}}extractSVGCellData(i,o){const l=[];let f=0;for(let m=0;m<o.rows;m++)for(let D=0;D<o.cols;D++){const F=f*4,pe=this.getCharacterIndex(i.characterPixels,F);let ue=this.pixelsToRGBA(i.primaryColorPixels,F),j=this.pixelsToRGBA(i.secondaryColorPixels,F);const xe=this.extractTransformData(i.transformPixels,i.rotationPixels,F);if(xe.isInverted){const Ee=ue;ue=j,j=Ee}const Z=this.calculateCellPosition(D,m,o);l.push({charIndex:pe,primaryColor:ue,secondaryColor:j,transform:xe,position:Z}),f++}return l}}class TA{getGlyphIndex(i,o){const l=i.cmap;if(!l||!l.tables)return 0;for(const f of l.tables)if(f.format===4){for(let m=0;m<f.startCount.length;m++)if(o>=f.startCount[m]&&o<=f.endCount[m]){if(f.idRangeOffset[m]===0)return o+f.idDelta[m]&65535;{const D=f.idRangeOffset[m]/2+(o-f.startCount[m])-(f.startCount.length-m);if(D>=0&&D<f.glyphIdArray.length){const F=f.glyphIdArray[D];if(F!==0)return F+f.idDelta[m]&65535}}}}return 0}createEmptyPath(){return{getBoundingBox:()=>({x1:0,y1:0,x2:0,y2:0}),toSVG:()=>""}}createGlyphPath(i,o,l,f,m){if(!o||!o.xs||o.xs.length===0)return this.createEmptyPath();const D=m/i.head.unitsPerEm;return{getBoundingBox:()=>({x1:l+o.xMin*D,y1:f+-o.yMax*D,x2:l+o.xMax*D,y2:f+-o.yMin*D}),toSVG:()=>this.glyphToSVGPath(o,l,f,D)}}glyphToSVGPath(i,o,l,f){if(!i||!i.xs)return"";const{xs:m,ys:D,endPts:F,flags:pe}=i;if(!m||!D||!F||!pe)return"";let ue="",j=0;for(let xe=0;xe<F.length;xe++){const Z=F[xe];if(!(Z<j)){if(Z>=j){const Ee=o+m[j]*f,we=l-D[j]*f;ue+=`M${Ee.toFixed(2)},${we.toFixed(2)}`;let Oe=j+1;for(;Oe<=Z;)if((pe[Oe]&1)!==0){const Ke=o+m[Oe]*f,le=l-D[Oe]*f;ue+=`L${Ke.toFixed(2)},${le.toFixed(2)}`,Oe++}else{const Ke=o+m[Oe]*f,le=l-D[Oe]*f;let q=Oe+1>Z?j:Oe+1;if((pe[q]&1)!==0){const ce=o+m[q]*f,Q=l-D[q]*f;ue+=`Q${Ke.toFixed(2)},${le.toFixed(2)} ${ce.toFixed(2)},${Q.toFixed(2)}`,Oe=q+1}else{const ce=o+m[q]*f,Q=l-D[q]*f,N=(Ke+ce)/2,oe=(le+Q)/2;ue+=`Q${Ke.toFixed(2)},${le.toFixed(2)} ${N.toFixed(2)},${oe.toFixed(2)}`,Oe=q}}ue+="Z"}j=Z+1}}return ue}generateCharacterPath(i,o,l,f,m){try{const D=i.codePointAt(0)||0,F=this.getGlyphIndex(o,D);if(F===0)return this.createEmptyPath();let pe=null;try{o.glyf&&o.glyf[F]!==null?pe=o.glyf[F]:h&&h.T&&h.T.glyf&&h.T.glyf._parseGlyf&&(pe=h.T.glyf._parseGlyf(o,F),o.glyf&&pe&&(o.glyf[F]=pe))}catch(ue){console.warn(`Failed to parse glyph ${F}:`,ue)}return pe?this.createGlyphPath(o,pe,l,f,m):this.createEmptyPath()}catch(D){return console.warn(`Failed to generate path for character "${i}":`,D),this.createEmptyPath()}}generatePositionedCharacterPath(i,o,l,f,m,D,F,pe){try{const ue=F/o.head.unitsPerEm,j=pe*ue,xe=l+(m-j)/2,Z=f+(D+F*.7)/2;return this.generateCharacterPath(i,o,xe,Z,F).toSVG()||null}catch(ue){return console.warn(`Failed to generate positioned character path for "${i}":`,ue),null}}}class SA{constructor(){a$1(this,"pathGenerator"),this.pathGenerator=new TA}generateSVGHeader(i){return`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="${i.width}" height="${i.height}" viewBox="0 0 ${i.width} ${i.height}" 
     xmlns="http://www.w3.org/2000/svg" version="1.1">
<title>textmode art generated via textmode.js</title>
<desc>textmode art visualization generated by textmode.js library</desc>`}generateSVGFooter(){return`
</g>
</svg>`}generateBackground(i,o){if(!o.includeBackgroundRectangles)return"";const l=o.backgroundColor,f=`rgba(${l[0]},${l[1]},${l[2]},${l[3]/255})`;return`
<rect width="${i.width}" height="${i.height}" fill="${f}" />`}rgbaToColorString(i){return`rgba(${i.r},${i.g},${i.b},${i.a/255})`}generateTransformAttribute(i,o){const{transform:l,position:f}=i,m=f.cellX+o.cellWidth/2,D=f.cellY+o.cellHeight/2,F=[];if(l.flipHorizontal||l.flipVertical){const pe=l.flipHorizontal?-1:1,ue=l.flipVertical?-1:1;F.push(`translate(${m} ${D})`),F.push(`scale(${pe} ${ue})`),F.push(`translate(${-m} ${-D})`)}return l.rotation&&F.push(`rotate(${l.rotation} ${m} ${D})`),F.length?` transform="${F.join(" ")}"`:""}generateCellBackground(i,o,l){if(!l.includeBackgroundRectangles||i.secondaryColor.a===0)return"";const{position:f}=i,m=this.rgbaToColorString(i.secondaryColor);return l.drawMode==="stroke"?`
  <rect x="${f.cellX}" y="${f.cellY}" width="${o.cellWidth}" height="${o.cellHeight}" stroke="${m}" fill="none" stroke-width="${l.strokeWidth}" />`:`
  <rect x="${f.cellX}" y="${f.cellY}" width="${o.cellWidth}" height="${o.cellHeight}" fill="${m}" />`}generateCharacterPath(i,o,l,f){const m=l.characters[i.charIndex];if(!m)return"";const D=this.pathGenerator.generatePositionedCharacterPath(m.character,l.font,i.position.cellX,i.position.cellY,o.cellWidth,o.cellHeight,l.fontSize,m.advanceWidth);if(!D)return"";const F=this.rgbaToColorString(i.primaryColor);return f.drawMode==="stroke"?`
    <path id="${`path-${i.charIndex}-${i.position.cellX}-${i.position.cellY}`.replace(/\./g,"-")}" d="${D}" stroke="${F}" stroke-width="${f.strokeWidth}" fill="none" />`:`
    <path d="${D}" fill="${F}" />`}generateCellContent(i,o,l,f){let m="";m+=this.generateCellBackground(i,o,f);const D=this.generateTransformAttribute(i,o),F=this.generateCharacterPath(i,o,l,f);return F&&(D?(m+=`
  <g${D}>`,m+=F,m+=`
  </g>`):m+=F),m}generateSVGContent(i,o,l,f){let m=this.generateSVGHeader(o);m+=this.generateBackground(o,f),m+=`
<g id="ascii-cells">`;for(const D of i)m+=this.generateCellContent(D,o,l,f);return m+=this.generateSVGFooter(),m}optimizeSVGContent(i){return i.replace(/<path[^>]*d=""[^>]*\/>/g,"").replace(/\n\s*\n/g,`
`).replace(/[ \t]+$/gm,"")}}class MA extends L{createSVGBlob(i){return this.createBlob(i,"image/svg+xml;charset=utf-8")}downloadSVG(i,o){try{this.downloadFile(i,this.sanitizeFilename(o)+".svg","image/svg+xml;charset=utf-8")}catch(l){throw console.error("Failed to download SVG file:",l),new Error(`SVG download failed: ${l instanceof Error?l.message:"Unknown error"}`)}}saveSVG(i,o){this.downloadSVG(i,o||this.generateDefaultFilename())}}class W{constructor(){a$1(this,"dataExtractor"),a$1(this,"contentGenerator"),a$1(this,"fileHandler"),this.dataExtractor=new yA,this.contentGenerator=new SA,this.fileHandler=new MA}applyDefaultOptions(i){return{includeBackgroundRectangles:i.includeBackgroundRectangles??!0,drawMode:i.drawMode??"fill",strokeWidth:i.strokeWidth??1,backgroundColor:i.backgroundColor??[0,0,0,0]}}generateSVG(i,o={}){const l=this.applyDefaultOptions(o),f=this.dataExtractor.extractFramebufferData(i.pipeline),m=this.dataExtractor.extractSVGCellData(f,i.grid),D=this.contentGenerator.generateSVGContent(m,i.grid,i.font,l);return this.contentGenerator.optimizeSVGContent(D)}saveSVG(i,o={}){try{const l=this.generateSVG(i,o),f=o.filename||this.fileHandler.generateDefaultFilename();this.fileHandler.saveSVG(l,f)}catch(l){throw console.error("Failed to save SVG:",l),new Error(`SVG save failed: ${l instanceof Error?l.message:"Unknown error"}`)}}}class GA extends H{extractCharacterGrid(i,o,l,f=" "){var m;const D=[];let F=0;for(let pe=0;pe<o.rows;pe++){const ue=[];for(let j=0;j<o.cols;j++){const xe=F*4,Z=this.getCharacterIndex(i.characterPixels,xe),Ee=((m=l.characters[Z])==null?void 0:m.character)||f;ue.push(Ee),F++}D.push(ue)}return D}}class RA{generateTXTContent(i,o){const l=[];for(const m of i){let D=m.join("");o.preserveTrailingSpaces||(D=D.replace(/\s+$/,"")),l.push(D)}const f=o.lineEnding==="crlf"?`\r
`:`
`;return l.join(f)}}class UA extends L{saveTXT(i,o){try{const l=this.ensureValidFilename(o);this.downloadFile(i,l,"text/plain;charset=utf-8")}catch(l){throw console.error("Failed to save TXT file:",l),new Error(`TXT file save failed: ${l instanceof Error?l.message:"Unknown error"}`)}}ensureValidFilename(i){let o=this.sanitizeFilename(i);return o===".txt"||o.length<=4?this.generateDefaultFilename():o}}class ${constructor(){a$1(this,"dataExtractor"),a$1(this,"contentGenerator"),a$1(this,"fileHandler"),this.dataExtractor=new GA,this.contentGenerator=new RA,this.fileHandler=new UA}applyDefaultOptions(i){return{preserveTrailingSpaces:i.preserveTrailingSpaces??!1,lineEnding:i.lineEnding??"lf",emptyCharacter:i.emptyCharacter??" "}}generateTXT(i,o={}){const l=this.applyDefaultOptions(o),f=this.dataExtractor.extractFramebufferData(i.pipeline),m=this.dataExtractor.extractCharacterGrid(f,i.grid,i.font,l.emptyCharacter);return this.contentGenerator.generateTXTContent(m,l)}saveTXT(i,o={}){try{const l=this.generateTXT(i,o),f=o.filename||this.fileHandler.generateDefaultFilename();this.fileHandler.saveTXT(l,f)}catch(l){throw console.error("Failed to save TXT:",l),new Error(`TXT save failed: ${l instanceof Error?l.message:"Unknown error"}`)}}}class YA extends H{captureCanvasData(i,o=1,l="transparent"){const f=i.canvas;if(o===1&&l==="transparent")return f;const m=document.createElement("canvas"),D=m.getContext("2d"),F=Math.round(f.width*o),pe=Math.round(f.height*o);return m.width=F,m.height=pe,l!=="transparent"&&(D.fillStyle=l,D.fillRect(0,0,F,pe)),D.imageSmoothingEnabled=!1,D.drawImage(f,0,0,f.width,f.height,0,0,F,pe),m}}class kA{generateImageData(i,o){const l=this.getMimeType(o.format);return o.format==="png"?i.toDataURL(l):i.toDataURL(l,o.quality)}async generateImageBlob(i,o){return new Promise((l,f)=>{const m=this.getMimeType(o.format),D=F=>{F?l(F):f(new Error(`Failed to generate ${o.format.toUpperCase()} blob`))};o.format==="png"?i.toBlob(D,m):i.toBlob(D,m,o.quality)})}getMimeType(i){switch(i){case"png":return"image/png";case"jpg":return"image/jpeg";case"webp":return"image/webp";default:throw new Error(`Unsupported image format: ${i}`)}}}const J={png:"image/png",jpg:"image/jpeg",webp:"image/webp"},k={png:".png",jpg:".jpg",webp:".webp"};class VA extends L{saveImage(i,o,l){try{const f=k[l];typeof i=="string"?this.saveImageFromDataURL(i,this.sanitizeFilename(o)+f):this.saveImageFromBlob(i,this.sanitizeFilename(o)+f)}catch(f){throw console.error(`Failed to save ${l.toUpperCase()} image:`,f),new Error(`Image save failed: ${f instanceof Error?f.message:"Unknown error"}`)}}saveImageFromDataURL(i,o){const l=document.createElement("a");l.href=i,l.download=o,l.style.display="none",l.rel="noopener",document.body.appendChild(l),l.click(),document.body.removeChild(l)}saveImageFromBlob(i,o){const l=URL.createObjectURL(i);try{const f=document.createElement("a");f.href=l,f.download=o,f.style.display="none",f.rel="noopener",document.body.appendChild(f),f.click(),document.body.removeChild(f)}finally{URL.revokeObjectURL(l)}}validateSaveSupport(i){return i in J&&i in k}getMimeType(i){return J[i]}getFileExtension(i){return k[i]}}class OA{constructor(){a$1(this,"dataExtractor"),a$1(this,"contentGenerator"),a$1(this,"fileHandler"),this.dataExtractor=new YA,this.contentGenerator=new kA,this.fileHandler=new VA}applyDefaultOptions(i){return{format:i.format??"png",quality:i.quality??1,scale:i.scale??1,backgroundColor:i.backgroundColor??"transparent"}}validateOptions(i){if(console.log("Validating image export options:",i),!this.fileHandler.validateSaveSupport(i.format))throw new Error(`Saving '${i.format}' files is not supported`);if(i.quality<0||i.quality>1)throw new Error("Image quality must be between 0.0 and 1.0");if(i.scale<=0)throw new Error("Scale factor must be greater than 0");i.scale>10&&console.warn("Large scale factors may result in very large files and slow performance"),i.format==="jpg"&&i.backgroundColor==="transparent"&&(i.backgroundColor="black")}generateImage(i,o={}){const l=this.applyDefaultOptions(o);if(this.validateOptions(l),l.scale===1&&l.backgroundColor==="transparent")return this.contentGenerator.generateImageData(i.canvas,l);const f=this.dataExtractor.captureCanvasData(i,l.scale,l.backgroundColor);return this.contentGenerator.generateImageData(f,l)}async generateImageBlob(i,o={}){const l=this.applyDefaultOptions(o);if(this.validateOptions(l),l.scale===1&&l.backgroundColor==="transparent")return await this.contentGenerator.generateImageBlob(i.canvas,l);const f=this.dataExtractor.captureCanvasData(i,l.scale,l.backgroundColor);return await this.contentGenerator.generateImageBlob(f,l)}async saveImage(i,o={}){try{const l=await this.generateImageBlob(i,o),f=o.format??"png",m=o.filename||this.fileHandler.generateDefaultFilename();this.fileHandler.saveImage(l,m,f)}catch(l){throw console.error("Failed to save image:",l),new Error(`Image save failed: ${l instanceof Error?l.message:"Unknown error"}`)}}}class S{constructor(i=null,o={}){a$1(this,"captureSource"),a$1(this,"textmodeCanvas"),a$1(this,"_renderer"),a$1(this,"_canvasFramebuffer"),a$1(this,"_font"),a$1(this,"_grid"),a$1(this,"resizeObserver"),a$1(this,"_mode"),a$1(this,"_frameRateLimit"),a$1(this,"animationFrameId",null),a$1(this,"lastFrameTime",0),a$1(this,"frameInterval"),a$1(this,"_frameRate",0),a$1(this,"lastRenderTime",0),a$1(this,"_frameCount",0),a$1(this,"frameTimeHistory",[]),a$1(this,"frameTimeHistorySize",10),a$1(this,"_pipeline"),a$1(this,"_standalone",!1),a$1(this,"_drawCallback",()=>{}),a$1(this,"_resizedCallback",()=>{}),this.captureSource=i,this._standalone=i===null,this._mode=o.renderMode??"auto",this._frameRateLimit=o.frameRate??60,this.frameInterval=1e3/this._frameRateLimit}static async create(i=null,o={}){const l=new S(i,o),f=l._standalone?o:void 0;l.textmodeCanvas=new mA(l.captureSource,l._standalone,f),l._renderer=new lA(l.textmodeCanvas.getWebGLContext());let m,D;l._standalone?(m=o.width||800,D=o.height||600):(m=l.textmodeCanvas.width||800,D=l.textmodeCanvas.height||600),l._canvasFramebuffer=l._renderer.createFramebuffer(m,D),l._font=new fA(l._renderer,o.fontSize??16),await l._font.initialize(o.fontSource);const F=l._font.maxGlyphDimensions;return l._grid=new DA(l.textmodeCanvas.canvas,F.width,F.height),l._pipeline=new FA(l._renderer,l._font,l._grid),l.setupEventListeners(),l.startAutoRendering(),l}setupEventListeners(){window.addEventListener("resize",()=>{this._standalone?this._resizedCallback():this.resize()}),window.ResizeObserver&&this.captureSource&&!this._standalone&&(this.resizeObserver=new ResizeObserver(()=>{this.resize()}),this.resizeObserver.observe(this.captureSource))}toString(i={}){return new $().generateTXT(this,i)}saveStrings(i={}){new $().saveTXT(this,i)}toSVG(i={}){return new W().generateSVG(this,i)}saveSVG(i={}){new W().saveSVG(this,i)}async saveCanvas(i,o="png",l={}){await new OA().saveImage(this.textmodeCanvas,{...l,filename:i,format:o})}async loadFont(i){return this._font.loadFont(i).then(()=>{const o=this._font.maxGlyphDimensions;this._grid.resizeCellPixelDimensions(o.width,o.height),this._pipeline.resize()})}render(){this.measureFrameRate(),this._frameCount++,this._standalone||this._canvasFramebuffer.update(this.captureSource),this._canvasFramebuffer.begin(),this._drawCallback(),this._renderer.reset(),this._canvasFramebuffer.end(),this._pipeline.render(this._canvasFramebuffer),this._pipeline.hasEnabledConverters()?(this._renderer.background(0),this._renderer.image(this._pipeline.texture,this._grid.offsetX,this._grid.offsetY,this._pipeline.texture.width,this._pipeline.texture.height)):(this._renderer.clear(),this._renderer.image(this._canvasFramebuffer,this._grid.offsetX,this._grid.offsetY,this._canvasFramebuffer.width,this._canvasFramebuffer.height))}resize(){this.textmodeCanvas.resize(),this._canvasFramebuffer.resize(this.textmodeCanvas.width,this.textmodeCanvas.height),this._grid.resize(),this._pipeline.resize(),this._renderer.resetViewport(),this._mode!=="manual"&&this.render()}startAutoRendering(){if(this._mode!=="auto")return;this.lastFrameTime=performance.now();const i=o=>{const l=o-this.lastFrameTime;l>=this.frameInterval&&(this.render(),this.lastFrameTime=o-l%this.frameInterval),this.animationFrameId=requestAnimationFrame(i)};this.animationFrameId=requestAnimationFrame(i)}measureFrameRate(){const i=performance.now();if(this.lastRenderTime>0){const o=i-this.lastRenderTime;this.frameTimeHistory.push(o),this.frameTimeHistory.length>this.frameTimeHistorySize&&this.frameTimeHistory.shift();const l=this.frameTimeHistory.reduce((f,m)=>f+m,0)/this.frameTimeHistory.length;this._frameRate=1e3/l}this.lastRenderTime=i}stopAutoRendering(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}renderMode(i){this._mode!==i&&(this.stopAutoRendering(),this._mode=i,i==="auto"&&this.startAutoRendering())}frameRate(i){if(i===void 0)return this._frameRate;this._frameRateLimit=i,this.frameInterval=1e3/i,this._mode==="auto"&&(this.stopAutoRendering(),this.startAutoRendering())}fontSize(i){C.validate(typeof i=="number"&&i>0,"Font size must be a positive number greater than 0.",{method:"fontSize",providedValue:i})&&this._font.fontSize!==i&&(this._font.setFontSize(i),this._grid.resizeCellPixelDimensions(this._font.maxGlyphDimensions.width,this._font.maxGlyphDimensions.height),this._pipeline.resize(),this._renderer.resetViewport())}draw(i){this._drawCallback=i}windowResized(i){this._resizedCallback=i}resizeCanvas(i,o){this.textmodeCanvas.resize(i,o),this._canvasFramebuffer.resize(this.textmodeCanvas.width,this.textmodeCanvas.height),this._grid.resize(),this._pipeline.resize(),this._renderer.resetViewport(),this._mode!=="manual"&&this.render()}converter(i){return this._pipeline.get(i)}fill(i,o,l,f){this._renderer.fill(i,o,l,f)}stroke(i,o,l,f){this._renderer.stroke(i,o,l,f)}strokeWeight(i){this._renderer.strokeWeight(i)}noStroke(){this._renderer.noStroke()}noFill(){this._renderer.noFill()}rotate(i){this._renderer.rotate(i)}push(){this._renderer.push()}pop(){this._renderer.pop()}rect(i,o,l=1,f=1){this._renderer.rect(i,o,l,f)}line(i,o,l,f){this._renderer.line(i,o,l,f)}background(i,o=i,l=i,f=255){this._renderer.background(i,o,l,f)}createShader(i,o){return this._renderer.createShader(i,o)}shader(i){this._renderer.shader(i)}setUniform(i,o){this._renderer.setUniform(i,o)}get grid(){return this._grid}get font(){return this._font}get mode(){return this._mode}get pipeline(){return this._pipeline}get frameCount(){return this._frameCount}get width(){return this.textmodeCanvas.width}get height(){return this.textmodeCanvas.height}}class X{static async create(i,o={}){if(i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)return S.create(i,o);{const l=i||{};return S.create(null,l)}}static setErrorLevel(i){C.setGlobalLevel(i)}static get version(){return"0.1.2"}constructor(){throw new Error("Textmode is a static class and cannot be instantiated.")}}const configPanel={panel:null,editor:null,popupWindow:null,asciiCanvas:null,asciiMode:!1,shortcuts:[{key:"Ctrl+Enter",description:"Execute code block"},{key:"Ctrl+Alt+Enter",description:"Execute code block (without add auto out)"},{key:"Ctrl+Space",description:"Autocomplete"},{key:"Ctrl+;",description:"Stop Hydra (hush)"},{key:"Alt+X",description:"Toggle Comment"},{key:"Alt+↑",description:"Increment value"},{key:"Alt+↓",description:"Decrement value"},{key:"Alt+I",description:"Show definition"},{key:"Alt+H",description:"Hide/Show code"},{key:"Ctrl+S",description:"Save Code"},{key:"Escape",description:"Close tooltips/panel"},{key:"Ctrl+K",description:"Color picker in .color()"},{key:"Alt+1/2/3/4/5",description:"Render output 0/1/2/3/all"}],init:function(w){this.editor=w,this.panel=document.getElementById("config-panel"),this.setupEventListeners(),this.loadSettings(),this.updateShortcutsList()},setupEventListeners:function(){const w=document.getElementById("config-toggle"),i=document.getElementById("config-close"),o=document.getElementById("font-select"),l=document.getElementById("font-size"),f=document.getElementById("theme-select"),m=document.getElementById("open-popup"),D=document.getElementById("show-about"),F=document.getElementById("about-modal"),pe=document.getElementById("close-about"),ue=document.getElementById("ascii-mode");w.addEventListener("click",()=>this.togglePanel()),i.addEventListener("click",()=>this.togglePanel()),o.addEventListener("change",j=>{this.setFont(j.target.value),this.saveSettings()}),l.addEventListener("input",j=>{const xe=j.target.value;document.getElementById("font-size-value").textContent=xe+"px",this.setFontSize(xe),this.saveSettings()}),f.addEventListener("change",j=>{this.editor.setOption("theme",j.target.value),this.saveSettings()}),ue.addEventListener("change",j=>{this.asciiMode=j.target.checked,this.asciiMode?this.ascii(!0):this.ascii(!1)}),m.addEventListener("click",()=>{this.openCanvasPopup()}),D.addEventListener("click",()=>{F.classList.add("show")}),pe.addEventListener("click",()=>{F.classList.remove("show")}),F.addEventListener("click",j=>{j.target===F&&F.classList.remove("show")}),document.addEventListener("keydown",j=>{j.key==="Escape"&&(F.classList.contains("show")?F.classList.remove("show"):this.panel.classList.contains("open")&&this.togglePanel())})},openCanvasPopup:function(){this.popupWindow&&!this.popupWindow.closed&&this.popupWindow.close();const w=document.getElementById("canvas"),i=w.width||window.innerWidth,o=w.height||window.innerHeight;this.popupWindow=window.open("","HydraCanvas",`width=${i},height=${o+50},resizable=yes,scrollbars=no,status=no,menubar=no,toolbar=no`),this.popupWindow.document.write(`
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Hydra Canvas</title>
                <style>
                    body {
                        margin: 0;
                        padding: 0;
                        background-color: #000;
                        overflow: hidden;
                    }
                    #popup-canvas {
                        display: block;
                        width: 100vw;
                        height: 100vh;
                    }
                </style>
            </head>
            <body>
                <canvas id="popup-canvas"></canvas>
            </body>
            </html>
        `),this.popupWindow.document.close(),this.startCanvasSync()},startCanvasSync:function(){if(!this.popupWindow||this.popupWindow.closed)return;const w=document.getElementById("canvas"),i=this.popupWindow.document.getElementById("popup-canvas"),o=()=>{if(!this.popupWindow||this.popupWindow.closed){this.popupWindow=null;return}try{console.log("Syncing canvas..."),i.width=w.width,i.height=w.height,i.getContext("2d").drawImage(w,0,0)}catch(l){console.log("Sync error:",l)}requestAnimationFrame(o)};o(),this.popupWindow.addEventListener("beforeunload",()=>{this.popupWindow=null})},togglePanel:function(){this.panel.classList.toggle("open")},setFont:function(w){const i=document.querySelector(".CodeMirror");i.style.fontFamily=`${w}, monospace`},setFontSize:function(w){this.editor.getWrapperElement().style.fontSize=w+"px",this.editor.refresh()},updateShortcutsList:function(){const w=document.getElementById("shortcuts-list");w.innerHTML="",this.shortcuts.forEach(i=>{const o=document.createElement("div");o.className="shortcut-item",o.innerHTML=`
                <span class="shortcut-key">${i.key}</span>
                <span class="shortcut-desc">${i.description}</span>
            `,w.appendChild(o)})},loadSettings:function(){const w=JSON.parse(localStorage.getItem("editor-settings")||"{}");if(w.font&&(document.getElementById("font-select").value=w.font,this.setFont(w.font)),w.fontSize){const i=document.getElementById("font-size");i.value=w.fontSize,document.getElementById("font-size-value").textContent=w.fontSize+"px",this.setFontSize(w.fontSize)}w.theme&&(document.getElementById("theme-select").value=w.theme,this.editor.setOption("theme",w.theme))},saveSettings:function(){const w={font:document.getElementById("font-select").value,fontSize:document.getElementById("font-size").value,theme:document.getElementById("theme-select").value};localStorage.setItem("editor-settings",JSON.stringify(w))},async ascii(active=!0){if(active){const canvas=document.querySelector("canvas#canvas");if(!canvas)throw new Error("Canvas element not found");this.asciiCanvas||(this.asciiCanvas=await X.create(canvas),eval("setResolution(400, 400)"))}else if(this.asciiCanvas){const canvas=document.querySelector("canvas.textmodeCanvas");canvas.remove(),this.asciiCanvas=null,eval("setResolution(1920, 1080)")}}},scriptRel="modulepreload",assetsURL=function(w){return"/apps/super-hydra-turbo-edition/"+w},seen={},__vitePreload=function w(i,o,l){let f=Promise.resolve();if(o&&o.length>0){let D=function(ue){return Promise.all(ue.map(j=>Promise.resolve(j).then(xe=>({status:"fulfilled",value:xe}),xe=>({status:"rejected",reason:xe}))))};document.getElementsByTagName("link");const F=document.querySelector("meta[property=csp-nonce]"),pe=(F==null?void 0:F.nonce)||(F==null?void 0:F.getAttribute("nonce"));f=D(o.map(ue=>{if(ue=assetsURL(ue),ue in seen)return;seen[ue]=!0;const j=ue.endsWith(".css"),xe=j?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${ue}"]${xe}`))return;const Z=document.createElement("link");if(Z.rel=j?"stylesheet":scriptRel,j||(Z.as="script"),Z.crossOrigin="",Z.href=ue,pe&&Z.setAttribute("nonce",pe),document.head.appendChild(Z),j)return new Promise((Ee,we)=>{Z.addEventListener("load",Ee),Z.addEventListener("error",()=>we(new Error(`Unable to preload CSS for ${ue}`)))})}))}function m(D){const F=new Event("vite:preloadError",{cancelable:!0});if(F.payload=D,window.dispatchEvent(F),!F.defaultPrevented)throw D}return f.then(D=>{for(const F of D||[])F.status==="rejected"&&m(F.reason);return i().catch(m)})};var Output=function({regl:w,precision:i,label:o="",width:l,height:f}){this.regl=w,this.precision=i,this.label=o,this.positionBuffer=this.regl.buffer([[-2,0],[0,-2],[2,2]]),this.draw=()=>{},this.init(),this.pingPongIndex=0,this.fbos=Array(2).fill().map(()=>this.regl.framebuffer({color:this.regl.texture({mag:"nearest",width:l,height:f,format:"rgba"}),depthStencil:!1}))};Output.prototype.resize=function(w,i){this.fbos.forEach(o=>{o.resize(w,i)})};Output.prototype.getCurrent=function(){return this.fbos[this.pingPongIndex]};Output.prototype.getTexture=function(){var w=this.pingPongIndex?0:1;return this.fbos[w]};Output.prototype.init=function(){return this.transformIndex=0,this.fragHeader=`
  precision ${this.precision} float;

  uniform float time;
  varying vec2 uv;
  `,this.fragBody="",this.vert=`
  precision ${this.precision} float;
  attribute vec2 position;
  varying vec2 uv;

  void main () {
    uv = position;
    gl_Position = vec4(2.0 * position - 1.0, 0, 1);
  }`,this.attributes={position:this.positionBuffer},this.uniforms={time:this.regl.prop("time"),resolution:this.regl.prop("resolution")},this.frag=`
       ${this.fragHeader}

      void main () {
        vec4 c = vec4(0, 0, 0, 0);
        vec2 st = uv;
        ${this.fragBody}
        gl_FragColor = c;
      }
  `,this};Output.prototype.render=function(w){let i=w[0];var o=this,l=Object.assign(i.uniforms,{prevBuffer:()=>o.fbos[o.pingPongIndex]});o.draw=o.regl({frag:i.frag,vert:o.vert,attributes:o.attributes,uniforms:l,count:3,framebuffer:()=>(o.pingPongIndex=o.pingPongIndex?0:1,o.fbos[o.pingPongIndex])})};Output.prototype.tick=function(w){this.draw(w)};var inherits_browser={exports:{}},hasRequiredInherits_browser;function requireInherits_browser(){return hasRequiredInherits_browser||(hasRequiredInherits_browser=1,typeof Object.create=="function"?inherits_browser.exports=function(i,o){o&&(i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(i,o){if(o){i.super_=o;var l=function(){};l.prototype=o.prototype,i.prototype=new l,i.prototype.constructor=i}}),inherits_browser.exports}var events,hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events;hasRequiredEvents=1;function w(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}events=w,w.EventEmitter=w,w.prototype._events=void 0,w.prototype._maxListeners=void 0,w.defaultMaxListeners=10,w.prototype.setMaxListeners=function(m){if(!o(m)||m<0||isNaN(m))throw TypeError("n must be a positive number");return this._maxListeners=m,this},w.prototype.emit=function(m){var D,F,pe,ue,j,xe;if(this._events||(this._events={}),m==="error"&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if(D=arguments[1],D instanceof Error)throw D;var Z=new Error('Uncaught, unspecified "error" event. ('+D+")");throw Z.context=D,Z}if(F=this._events[m],f(F))return!1;if(i(F))switch(arguments.length){case 1:F.call(this);break;case 2:F.call(this,arguments[1]);break;case 3:F.call(this,arguments[1],arguments[2]);break;default:ue=Array.prototype.slice.call(arguments,1),F.apply(this,ue)}else if(l(F))for(ue=Array.prototype.slice.call(arguments,1),xe=F.slice(),pe=xe.length,j=0;j<pe;j++)xe[j].apply(this,ue);return!0},w.prototype.addListener=function(m,D){var F;if(!i(D))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,i(D.listener)?D.listener:D),this._events[m]?l(this._events[m])?this._events[m].push(D):this._events[m]=[this._events[m],D]:this._events[m]=D,l(this._events[m])&&!this._events[m].warned&&(f(this._maxListeners)?F=w.defaultMaxListeners:F=this._maxListeners,F&&F>0&&this._events[m].length>F&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),typeof console.trace=="function"&&console.trace())),this},w.prototype.on=w.prototype.addListener,w.prototype.once=function(m,D){if(!i(D))throw TypeError("listener must be a function");var F=!1;function pe(){this.removeListener(m,pe),F||(F=!0,D.apply(this,arguments))}return pe.listener=D,this.on(m,pe),this},w.prototype.removeListener=function(m,D){var F,pe,ue,j;if(!i(D))throw TypeError("listener must be a function");if(!this._events||!this._events[m])return this;if(F=this._events[m],ue=F.length,pe=-1,F===D||i(F.listener)&&F.listener===D)delete this._events[m],this._events.removeListener&&this.emit("removeListener",m,D);else if(l(F)){for(j=ue;j-- >0;)if(F[j]===D||F[j].listener&&F[j].listener===D){pe=j;break}if(pe<0)return this;F.length===1?(F.length=0,delete this._events[m]):F.splice(pe,1),this._events.removeListener&&this.emit("removeListener",m,D)}return this},w.prototype.removeAllListeners=function(m){var D,F;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[m]&&delete this._events[m],this;if(arguments.length===0){for(D in this._events)D!=="removeListener"&&this.removeAllListeners(D);return this.removeAllListeners("removeListener"),this._events={},this}if(F=this._events[m],i(F))this.removeListener(m,F);else if(F)for(;F.length;)this.removeListener(m,F[F.length-1]);return delete this._events[m],this},w.prototype.listeners=function(m){var D;return!this._events||!this._events[m]?D=[]:i(this._events[m])?D=[this._events[m]]:D=this._events[m].slice(),D},w.prototype.listenerCount=function(m){if(this._events){var D=this._events[m];if(i(D))return 1;if(D)return D.length}return 0},w.listenerCount=function(m,D){return m.listenerCount(D)};function i(m){return typeof m=="function"}function o(m){return typeof m=="number"}function l(m){return typeof m=="object"&&m!==null}function f(m){return m===void 0}return events}var browser,hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,browser=globalThis.performance&&globalThis.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}),browser}var raf={exports:{}},performanceNow$1={exports:{}},performanceNow=performanceNow$1.exports,hasRequiredPerformanceNow;function requirePerformanceNow(){return hasRequiredPerformanceNow||(hasRequiredPerformanceNow=1,(function(){var w,i,o,l,f,m;typeof performance<"u"&&performance!==null&&performance.now?performanceNow$1.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(performanceNow$1.exports=function(){return(w()-f)/1e6},i=process.hrtime,w=function(){var D;return D=i(),D[0]*1e9+D[1]},l=w(),m=process.uptime()*1e9,f=l-m):Date.now?(performanceNow$1.exports=function(){return Date.now()-o},o=Date.now()):(performanceNow$1.exports=function(){return new Date().getTime()-o},o=new Date().getTime())}).call(performanceNow)),performanceNow$1.exports}var hasRequiredRaf;function requireRaf(){if(hasRequiredRaf)return raf.exports;hasRequiredRaf=1;for(var w=requirePerformanceNow(),i=typeof window>"u"?globalThis:window,o=["moz","webkit"],l="AnimationFrame",f=i["request"+l],m=i["cancel"+l]||i["cancelRequest"+l],D=0;!f&&D<o.length;D++)f=i[o[D]+"Request"+l],m=i[o[D]+"Cancel"+l]||i[o[D]+"CancelRequest"+l];if(!f||!m){var F=0,pe=0,ue=[],j=1e3/60;f=function(xe){if(ue.length===0){var Z=w(),Ee=Math.max(0,j-(Z-F));F=Ee+Z,setTimeout(function(){var we=ue.slice(0);ue.length=0;for(var Oe=0;Oe<we.length;Oe++)if(!we[Oe].cancelled)try{we[Oe].callback(F)}catch(Ke){setTimeout(function(){throw Ke},0)}},Math.round(Ee))}return ue.push({handle:++pe,callback:xe,cancelled:!1}),pe},m=function(xe){for(var Z=0;Z<ue.length;Z++)ue[Z].handle===xe&&(ue[Z].cancelled=!0)}}return raf.exports=function(xe){return f.call(i,xe)},raf.exports.cancel=function(){m.apply(i,arguments)},raf.exports.polyfill=function(xe){xe||(xe=i),xe.requestAnimationFrame=f,xe.cancelAnimationFrame=m},raf.exports}var rafLoop,hasRequiredRafLoop;function requireRafLoop(){if(hasRequiredRafLoop)return rafLoop;hasRequiredRafLoop=1;var w=requireInherits_browser(),i=requireEvents().EventEmitter,o=requireBrowser(),l=requireRaf();rafLoop=f;function f(m){if(!(this instanceof f))return new f(m);this.running=!1,this.last=o(),this._frame=0,this._tick=this.tick.bind(this),m&&this.on("tick",m)}return w(f,i),f.prototype.start=function(){if(!this.running)return this.running=!0,this.last=o(),this._frame=l(this._tick),this},f.prototype.stop=function(){return this.running=!1,this._frame!==0&&l.cancel(this._frame),this._frame=0,this},f.prototype.tick=function(){this._frame=l(this._tick);var m=o(),D=m-this.last;this.emit("tick",D),this.last=m},rafLoop}var rafLoopExports=requireRafLoop();const loop=getDefaultExportFromCjs(rafLoopExports);function Webcam(w){return navigator.mediaDevices.enumerateDevices().then(i=>i.filter(o=>o.kind==="videoinput")).then(i=>{let o={audio:!1,video:!0};return i[w]&&(o.video={deviceId:{exact:i[w].deviceId}}),window.navigator.mediaDevices.getUserMedia(o)}).then(i=>{const o=document.createElement("video");return o.setAttribute("autoplay",""),o.setAttribute("muted",""),o.setAttribute("playsinline",""),o.srcObject=i,new Promise((l,f)=>{o.addEventListener("loadedmetadata",()=>{o.play().then(()=>l({video:o}))})})}).catch(console.log.bind(console))}function Screen(w){return new Promise(function(i,o){navigator.mediaDevices.getDisplayMedia(w).then(l=>{const f=document.createElement("video");f.srcObject=l,f.addEventListener("loadedmetadata",()=>{f.play(),i({video:f})})}).catch(l=>o(l))})}class HydraSource{constructor({regl:i,width:o,height:l,pb:f,label:m=""}){this.label=m,this.regl=i,this.src=null,this.dynamic=!0,this.width=o,this.height=l,this.tex=this.regl.texture({shape:[1,1]}),this.pb=f}init(i,o){"src"in i&&(this.src=i.src,this.tex=this.regl.texture({data:this.src,...o})),"dynamic"in i&&(this.dynamic=i.dynamic)}initCam(i,o){const l=this;Webcam(i).then(f=>{l.src=f.video,l.dynamic=!0,l.tex=l.regl.texture({data:l.src,...o})}).catch(f=>console.log("could not get camera",f))}initVideo(i="",o){const l=document.createElement("video");l.crossOrigin="anonymous",l.autoplay=!0,l.loop=!0,l.muted=!0,l.addEventListener("loadeddata",()=>{this.src=l,l.play(),this.tex=this.regl.texture({data:this.src,...o}),this.dynamic=!0}),l.src=i}initImage(i="",o){const l=document.createElement("img");l.crossOrigin="anonymous",l.src=i,l.onload=()=>{this.src=l,this.dynamic=!1,this.tex=this.regl.texture({data:this.src,...o})}}initStream(i,o){let l=this;i&&this.pb&&(this.pb.initSource(i),this.pb.on("got video",function(f,m){f===i&&(l.src=m,l.dynamic=!0,l.tex=l.regl.texture({data:l.src,...o}))}))}initScreen(i=0,o){const l=this;Screen().then(function(f){l.src=f.video,l.tex=l.regl.texture({data:l.src,...o}),l.dynamic=!0}).catch(f=>console.log("could not get screen",f))}resize(i,o){this.width=i,this.height=o}clear(){this.src&&this.src.srcObject&&this.src.srcObject.getTracks&&this.src.srcObject.getTracks().forEach(i=>i.stop()),this.src=null,this.tex=this.regl.texture({shape:[1,1]})}tick(i){this.src!==null&&this.dynamic===!0&&(this.src.videoWidth&&this.src.videoWidth!==this.tex.width&&(console.log(this.src.videoWidth,this.src.videoHeight,this.tex.width,this.tex.height),this.tex.resize(this.src.videoWidth,this.src.videoHeight)),this.src.width&&this.src.width!==this.tex.width&&this.tex.resize(this.src.width,this.src.height),this.tex.subimage(this.src))}getTexture(){return this.tex}}const mouse={};function mouseButtons(w){if(typeof w=="object"){if("buttons"in w)return w.buttons;if("which"in w){var i=w.which;if(i===2)return 4;if(i===3)return 2;if(i>0)return 1<<i-1}else if("button"in w){var i=w.button;if(i===1)return 4;if(i===2)return 2;if(i>=0)return 1<<i}}return 0}mouse.buttons=mouseButtons;function mouseElement(w){return w.target||w.srcElement||window}mouse.element=mouseElement;function mouseRelativeX(w){return typeof w=="object"&&"pageX"in w?w.pageX:0}mouse.x=mouseRelativeX;function mouseRelativeY(w){return typeof w=="object"&&"pageY"in w?w.pageY:0}mouse.y=mouseRelativeY;function mouseListen(w,i){i||(i=w,w=window);var o=0,l=0,f=0,m={shift:!1,alt:!1,control:!1,meta:!1},D=!1;function F(q){var ce=!1;return"altKey"in q&&(ce=ce||q.altKey!==m.alt,m.alt=!!q.altKey),"shiftKey"in q&&(ce=ce||q.shiftKey!==m.shift,m.shift=!!q.shiftKey),"ctrlKey"in q&&(ce=ce||q.ctrlKey!==m.control,m.control=!!q.ctrlKey),"metaKey"in q&&(ce=ce||q.metaKey!==m.meta,m.meta=!!q.metaKey),ce}function pe(q,ce){var Q=mouse.x(ce),N=mouse.y(ce);"buttons"in ce&&(q=ce.buttons|0),(q!==o||Q!==l||N!==f||F(ce))&&(o=q|0,l=Q||0,f=N||0,i&&i(o,l,f,m))}function ue(q){pe(0,q)}function j(){(o||l||f||m.shift||m.alt||m.meta||m.control)&&(l=f=0,o=0,m.shift=m.alt=m.control=m.meta=!1,i&&i(0,0,0,m))}function xe(q){F(q)&&i&&i(o,l,f,m)}function Z(q){mouse.buttons(q)===0?pe(0,q):pe(o,q)}function Ee(q){pe(o|mouse.buttons(q),q)}function we(q){pe(o&~mouse.buttons(q),q)}function Oe(){D||(D=!0,w.addEventListener("mousemove",Z),w.addEventListener("mousedown",Ee),w.addEventListener("mouseup",we),w.addEventListener("mouseleave",ue),w.addEventListener("mouseenter",ue),w.addEventListener("mouseout",ue),w.addEventListener("mouseover",ue),w.addEventListener("blur",j),w.addEventListener("keyup",xe),w.addEventListener("keydown",xe),w.addEventListener("keypress",xe),w!==window&&(window.addEventListener("blur",j),window.addEventListener("keyup",xe),window.addEventListener("keydown",xe),window.addEventListener("keypress",xe)))}function Ke(){D&&(D=!1,w.removeEventListener("mousemove",Z),w.removeEventListener("mousedown",Ee),w.removeEventListener("mouseup",we),w.removeEventListener("mouseleave",ue),w.removeEventListener("mouseenter",ue),w.removeEventListener("mouseout",ue),w.removeEventListener("mouseover",ue),w.removeEventListener("blur",j),w.removeEventListener("keyup",xe),w.removeEventListener("keydown",xe),w.removeEventListener("keypress",xe),w!==window&&(window.removeEventListener("blur",j),window.removeEventListener("keyup",xe),window.removeEventListener("keydown",xe),window.removeEventListener("keypress",xe)))}Oe();var le={element:w};return Object.defineProperties(le,{enabled:{get:function(){return D},set:function(q){q?Oe():Ke()},enumerable:!0},buttons:{get:function(){return o},enumerable:!0},x:{get:function(){return l},enumerable:!0},y:{get:function(){return f},enumerable:!0},mods:{get:function(){return m},enumerable:!0}}),le}var meyda_min$1={exports:{}},meyda_min=meyda_min$1.exports,hasRequiredMeyda_min;function requireMeyda_min(){return hasRequiredMeyda_min||(hasRequiredMeyda_min=1,function(w,i){(function(o,l){w.exports=l()})(meyda_min,function(){function o(G,U,T){for(var Be,Ne=0,Ze=U.length;Ne<Ze;Ne++)!Be&&Ne in U||(Be||(Be=Array.prototype.slice.call(U,0,Ne)),Be[Ne]=U[Ne]);return G.concat(Be||Array.prototype.slice.call(U))}var l=Object.freeze({__proto__:null,blackman:function(G){for(var U=new Float32Array(G),T=2*Math.PI/(G-1),Be=2*T,Ne=0;Ne<G/2;Ne++)U[Ne]=.42-.5*Math.cos(Ne*T)+.08*Math.cos(Ne*Be);for(Ne=Math.ceil(G/2);Ne>0;Ne--)U[G-Ne]=U[Ne-1];return U},hamming:function(G){for(var U=new Float32Array(G),T=0;T<G;T++)U[T]=.54-.46*Math.cos(2*Math.PI*(T/G-1));return U},hanning:function(G){for(var U=new Float32Array(G),T=0;T<G;T++)U[T]=.5-.5*Math.cos(2*Math.PI*T/(G-1));return U},sine:function(G){for(var U=Math.PI/(G-1),T=new Float32Array(G),Be=0;Be<G;Be++)T[Be]=Math.sin(U*Be);return T}}),f={};function m(G){for(;G%2==0&&G>1;)G/=2;return G===1}function D(G,U){if(U!=="rect"){if(U!==""&&U||(U="hanning"),f[U]||(f[U]={}),!f[U][G.length])try{f[U][G.length]=l[U](G.length)}catch{throw new Error("Invalid windowing function")}G=function(T,Be){for(var Ne=[],Ze=0;Ze<Math.min(T.length,Be.length);Ze++)Ne[Ze]=T[Ze]*Be[Ze];return Ne}(G,f[U][G.length])}return G}function F(G,U,T){for(var Be=new Float32Array(G),Ne=0;Ne<Be.length;Ne++)Be[Ne]=Ne*U/T,Be[Ne]=13*Math.atan(Be[Ne]/1315.8)+3.5*Math.atan(Math.pow(Be[Ne]/7518,2));return Be}function pe(G){return Float32Array.from(G)}function ue(G){return 1125*Math.log(1+G/700)}function j(G,U,T){for(var Be,Ne=new Float32Array(G+2),Ze=new Float32Array(G+2),pt=U/2,gt=ue(0),dt=(ue(pt)-gt)/(G+1),yt=new Array(G+2),wt=0;wt<Ne.length;wt++)Ne[wt]=wt*dt,Ze[wt]=(Be=Ne[wt],700*(Math.exp(Be/1125)-1)),yt[wt]=Math.floor((T+1)*Ze[wt]/U);for(var jt=new Array(G),St=0;St<jt.length;St++){for(jt[St]=new Array(T/2+1).fill(0),wt=yt[St];wt<yt[St+1];wt++)jt[St][wt]=(wt-yt[St])/(yt[St+1]-yt[St]);for(wt=yt[St+1];wt<yt[St+2];wt++)jt[St][wt]=(yt[St+2]-wt)/(yt[St+2]-yt[St+1])}return jt}function xe(G,U,T,Be,Ne,Ze,pt){Be===void 0&&(Be=5),Ne===void 0&&(Ne=2),Ze===void 0&&(Ze=!0),pt===void 0&&(pt=440);var gt=Math.floor(T/2)+1,dt=new Array(T).fill(0).map(function(NA,Tt){return G*function(Jt,JA){return Math.log2(16*Jt/JA)}(U*Tt/T,pt)});dt[0]=dt[1]-1.5*G;var yt,wt,jt,St=dt.slice(1).map(function(NA,Tt){return Math.max(NA-dt[Tt])},1).concat([1]),Dt=Math.round(G/2),bt=new Array(G).fill(0).map(function(NA,Tt){return dt.map(function(Jt){return(10*G+Dt+Jt-Tt)%G-Dt})}),Lt=bt.map(function(NA,Tt){return NA.map(function(Jt,JA){return Math.exp(-.5*Math.pow(2*bt[Tt][JA]/St[JA],2))})});if(wt=(yt=Lt)[0].map(function(){return 0}),jt=yt.reduce(function(NA,Tt){return Tt.forEach(function(Jt,JA){NA[JA]+=Math.pow(Jt,2)}),NA},wt).map(Math.sqrt),Lt=yt.map(function(NA,Tt){return NA.map(function(Jt,JA){return Jt/(jt[JA]||1)})}),Ne){var Wt=dt.map(function(NA){return Math.exp(-.5*Math.pow((NA/G-Be)/Ne,2))});Lt=Lt.map(function(NA){return NA.map(function(Tt,Jt){return Tt*Wt[Jt]})})}return Ze&&(Lt=o(o([],Lt.slice(3),!0),Lt.slice(0,3))),Lt.map(function(NA){return NA.slice(0,gt)})}function Z(G,U){for(var T=0,Be=0,Ne=0;Ne<U.length;Ne++)T+=Math.pow(Ne,G)*Math.abs(U[Ne]),Be+=U[Ne];return T/Be}function Ee(G){var U=G.ampSpectrum,T=G.barkScale,Be=G.numberOfBarkBands,Ne=Be===void 0?24:Be;if(typeof U!="object"||typeof T!="object")throw new TypeError;var Ze=Ne,pt=new Float32Array(Ze),gt=0,dt=U,yt=new Int32Array(Ze+1);yt[0]=0;for(var wt=T[dt.length-1]/Ze,jt=1,St=0;St<dt.length;St++)for(;T[St]>wt;)yt[jt++]=St,wt=jt*T[dt.length-1]/Ze;for(yt[Ze]=dt.length-1,St=0;St<Ze;St++){for(var Dt=0,bt=yt[St];bt<yt[St+1];bt++)Dt+=dt[bt];pt[St]=Math.pow(Dt,.23)}for(St=0;St<pt.length;St++)gt+=pt[St];return{specific:pt,total:gt}}function we(G){var U=G.ampSpectrum;if(typeof U!="object")throw new TypeError;for(var T=new Float32Array(U.length),Be=0;Be<T.length;Be++)T[Be]=Math.pow(U[Be],2);return T}function Oe(G){var U=G.ampSpectrum,T=G.melFilterBank,Be=G.bufferSize;if(typeof U!="object")throw new TypeError("Valid ampSpectrum is required to generate melBands");if(typeof T!="object")throw new TypeError("Valid melFilterBank is required to generate melBands");for(var Ne=we({ampSpectrum:U}),Ze=T.length,pt=Array(Ze),gt=new Float32Array(Ze),dt=0;dt<gt.length;dt++){pt[dt]=new Float32Array(Be/2),gt[dt]=0;for(var yt=0;yt<Be/2;yt++)pt[dt][yt]=T[dt][yt]*Ne[yt],gt[dt]+=pt[dt][yt];gt[dt]=Math.log(gt[dt]+1)}return Array.prototype.slice.call(gt)}function Ke(G){return G&&G.__esModule&&Object.prototype.hasOwnProperty.call(G,"default")?G.default:G}var le=null,q=Ke(function(G,U){var T=G.length;return U=U||2,le&&le[T]||function(Be){(le=le||{})[Be]=new Array(Be*Be);for(var Ne=Math.PI/Be,Ze=0;Ze<Be;Ze++)for(var pt=0;pt<Be;pt++)le[Be][pt+Ze*Be]=Math.cos(Ne*(pt+.5)*Ze)}(T),G.map(function(){return 0}).map(function(Be,Ne){return U*G.reduce(function(Ze,pt,gt,dt){return Ze+pt*le[T][gt+Ne*T]},0)})}),ce=Object.freeze({__proto__:null,amplitudeSpectrum:function(G){return G.ampSpectrum},buffer:function(G){return G.signal},chroma:function(G){var U=G.ampSpectrum,T=G.chromaFilterBank;if(typeof U!="object")throw new TypeError("Valid ampSpectrum is required to generate chroma");if(typeof T!="object")throw new TypeError("Valid chromaFilterBank is required to generate chroma");var Be=T.map(function(Ze,pt){return U.reduce(function(gt,dt,yt){return gt+dt*Ze[yt]},0)}),Ne=Math.max.apply(Math,Be);return Ne?Be.map(function(Ze){return Ze/Ne}):Be},complexSpectrum:function(G){return G.complexSpectrum},energy:function(G){var U=G.signal;if(typeof U!="object")throw new TypeError;for(var T=0,Be=0;Be<U.length;Be++)T+=Math.pow(Math.abs(U[Be]),2);return T},loudness:Ee,melBands:Oe,mfcc:function(G){var U=G.ampSpectrum,T=G.melFilterBank,Be=G.numberOfMFCCCoefficients,Ne=G.bufferSize,Ze=Math.min(40,Math.max(1,Be||13));if(T.length<Ze)throw new Error("Insufficient filter bank for requested number of coefficients");var pt=Oe({ampSpectrum:U,melFilterBank:T,bufferSize:Ne});return q(pt).slice(0,Ze)},perceptualSharpness:function(G){for(var U=Ee({ampSpectrum:G.ampSpectrum,barkScale:G.barkScale}),T=U.specific,Be=0,Ne=0;Ne<T.length;Ne++)Be+=Ne<15?(Ne+1)*T[Ne+1]:.066*Math.exp(.171*(Ne+1));return Be*=.11/U.total},perceptualSpread:function(G){for(var U=Ee({ampSpectrum:G.ampSpectrum,barkScale:G.barkScale}),T=0,Be=0;Be<U.specific.length;Be++)U.specific[Be]>T&&(T=U.specific[Be]);return Math.pow((U.total-T)/U.total,2)},powerSpectrum:we,rms:function(G){var U=G.signal;if(typeof U!="object")throw new TypeError;for(var T=0,Be=0;Be<U.length;Be++)T+=Math.pow(U[Be],2);return T/=U.length,T=Math.sqrt(T)},spectralCentroid:function(G){var U=G.ampSpectrum;if(typeof U!="object")throw new TypeError;return Z(1,U)},spectralCrest:function(G){var U=G.ampSpectrum;if(typeof U!="object")throw new TypeError;var T=0,Be=-1/0;return U.forEach(function(Ne){T+=Math.pow(Ne,2),Be=Ne>Be?Ne:Be}),T/=U.length,T=Math.sqrt(T),Be/T},spectralFlatness:function(G){var U=G.ampSpectrum;if(typeof U!="object")throw new TypeError;for(var T=0,Be=0,Ne=0;Ne<U.length;Ne++)T+=Math.log(U[Ne]),Be+=U[Ne];return Math.exp(T/U.length)*U.length/Be},spectralFlux:function(G){var U=G.signal,T=G.previousSignal,Be=G.bufferSize;if(typeof U!="object"||typeof T!="object")throw new TypeError;for(var Ne=0,Ze=-Be/2;Ze<U.length/2-1;Ze++)x=Math.abs(U[Ze])-Math.abs(T[Ze]),Ne+=(x+Math.abs(x))/2;return Ne},spectralKurtosis:function(G){var U=G.ampSpectrum;if(typeof U!="object")throw new TypeError;var T=U,Be=Z(1,T),Ne=Z(2,T),Ze=Z(3,T),pt=Z(4,T);return(-3*Math.pow(Be,4)+6*Be*Ne-4*Be*Ze+pt)/Math.pow(Math.sqrt(Ne-Math.pow(Be,2)),4)},spectralRolloff:function(G){var U=G.ampSpectrum,T=G.sampleRate;if(typeof U!="object")throw new TypeError;for(var Be=U,Ne=T/(2*(Be.length-1)),Ze=0,pt=0;pt<Be.length;pt++)Ze+=Be[pt];for(var gt=.99*Ze,dt=Be.length-1;Ze>gt&&dt>=0;)Ze-=Be[dt],--dt;return(dt+1)*Ne},spectralSkewness:function(G){var U=G.ampSpectrum;if(typeof U!="object")throw new TypeError;var T=Z(1,U),Be=Z(2,U),Ne=Z(3,U);return(2*Math.pow(T,3)-3*T*Be+Ne)/Math.pow(Math.sqrt(Be-Math.pow(T,2)),3)},spectralSlope:function(G){var U=G.ampSpectrum,T=G.sampleRate,Be=G.bufferSize;if(typeof U!="object")throw new TypeError;for(var Ne=0,Ze=0,pt=new Float32Array(U.length),gt=0,dt=0,yt=0;yt<U.length;yt++){Ne+=U[yt];var wt=yt*T/Be;pt[yt]=wt,gt+=wt*wt,Ze+=wt,dt+=wt*U[yt]}return(U.length*dt-Ze*Ne)/(Ne*(gt-Math.pow(Ze,2)))},spectralSpread:function(G){var U=G.ampSpectrum;if(typeof U!="object")throw new TypeError;return Math.sqrt(Z(2,U)-Math.pow(Z(1,U),2))},zcr:function(G){var U=G.signal;if(typeof U!="object")throw new TypeError;for(var T=0,Be=1;Be<U.length;Be++)(U[Be-1]>=0&&U[Be]<0||U[Be-1]<0&&U[Be]>=0)&&T++;return T}});function Q(G){if(Array.isArray(G)){for(var U=0,T=Array(G.length);U<G.length;U++)T[U]=G[U];return T}return Array.from(G)}var N={},oe={},de={bitReverseArray:function(G){if(N[G]===void 0){for(var U=(G-1).toString(2).length,T="0".repeat(U),Be={},Ne=0;Ne<G;Ne++){var Ze=Ne.toString(2);Ze=T.substr(Ze.length)+Ze,Ze=[].concat(Q(Ze)).reverse().join(""),Be[Ne]=parseInt(Ze,2)}N[G]=Be}return N[G]},multiply:function(G,U){return{real:G.real*U.real-G.imag*U.imag,imag:G.real*U.imag+G.imag*U.real}},add:function(G,U){return{real:G.real+U.real,imag:G.imag+U.imag}},subtract:function(G,U){return{real:G.real-U.real,imag:G.imag-U.imag}},euler:function(G,U){var T=-2*Math.PI*G/U;return{real:Math.cos(T),imag:Math.sin(T)}},conj:function(G){return G.imag*=-1,G},constructComplexArray:function(G){var U={};U.real=G.real===void 0?G.slice():G.real.slice();var T=U.real.length;return oe[T]===void 0&&(oe[T]=Array.apply(null,Array(T)).map(Number.prototype.valueOf,0)),U.imag=oe[T].slice(),U}},Te=function(G){var U={};G.real===void 0||G.imag===void 0?U=de.constructComplexArray(G):(U.real=G.real.slice(),U.imag=G.imag.slice());var T=U.real.length,Be=Math.log2(T);if(Math.round(Be)!=Be)throw new Error("Input size must be a power of 2.");if(U.real.length!=U.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var Ne=de.bitReverseArray(T),Ze={real:[],imag:[]},pt=0;pt<T;pt++)Ze.real[Ne[pt]]=U.real[pt],Ze.imag[Ne[pt]]=U.imag[pt];for(var gt=0;gt<T;gt++)U.real[gt]=Ze.real[gt],U.imag[gt]=Ze.imag[gt];for(var dt=1;dt<=Be;dt++)for(var yt=Math.pow(2,dt),wt=0;wt<yt/2;wt++)for(var jt=de.euler(wt,yt),St=0;St<T/yt;St++){var Dt=yt*St+wt,bt=yt*St+wt+yt/2,Lt={real:U.real[Dt],imag:U.imag[Dt]},Wt={real:U.real[bt],imag:U.imag[bt]},NA=de.multiply(jt,Wt),Tt=de.subtract(Lt,NA);U.real[bt]=Tt.real,U.imag[bt]=Tt.imag;var Jt=de.add(NA,Lt);U.real[Dt]=Jt.real,U.imag[Dt]=Jt.imag}return U},ze=Te,nt=function(){function G(U,T){var Be=this;if(this._m=T,!U.audioContext)throw this._m.errors.noAC;if(U.bufferSize&&!m(U.bufferSize))throw this._m._errors.notPow2;if(!U.source)throw this._m._errors.noSource;this._m.audioContext=U.audioContext,this._m.bufferSize=U.bufferSize||this._m.bufferSize||256,this._m.hopSize=U.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=U.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=U.callback,this._m.windowingFunction=U.windowingFunction||"hanning",this._m.featureExtractors=ce,this._m.EXTRACTION_STARTED=U.startImmediately||!1,this._m.channel=typeof U.channel=="number"?U.channel:0,this._m.inputs=U.inputs||1,this._m.outputs=U.outputs||1,this._m.numberOfMFCCCoefficients=U.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.numberOfBarkBands=U.numberOfBarkBands||this._m.numberOfBarkBands||24,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=U.featureExtractors||[],this._m.barkScale=F(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=j(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(U.source),this._m.spn.onaudioprocess=function(Ne){var Ze;Be._m.inputData!==null&&(Be._m.previousInputData=Be._m.inputData),Be._m.inputData=Ne.inputBuffer.getChannelData(Be._m.channel),Be._m.previousInputData?((Ze=new Float32Array(Be._m.previousInputData.length+Be._m.inputData.length-Be._m.hopSize)).set(Be._m.previousInputData.slice(Be._m.hopSize)),Ze.set(Be._m.inputData,Be._m.previousInputData.length-Be._m.hopSize)):Ze=Be._m.inputData;var pt=function(gt,dt,yt){if(gt.length<dt)throw new Error("Buffer is too short for frame length");if(yt<1)throw new Error("Hop length cannot be less that 1");if(dt<1)throw new Error("Frame length cannot be less that 1");var wt=1+Math.floor((gt.length-dt)/yt);return new Array(wt).fill(0).map(function(jt,St){return gt.slice(St*yt,St*yt+dt)})}(Ze,Be._m.bufferSize,Be._m.hopSize);pt.forEach(function(gt){Be._m.frame=gt;var dt=Be._m.extract(Be._m._featuresToExtract,Be._m.frame,Be._m.previousFrame);typeof Be._m.callback=="function"&&Be._m.EXTRACTION_STARTED&&Be._m.callback(dt),Be._m.previousFrame=Be._m.frame})}}return G.prototype.start=function(U){this._m._featuresToExtract=U||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0},G.prototype.stop=function(){this._m.EXTRACTION_STARTED=!1},G.prototype.setSource=function(U){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=U,this._m.source.connect(this._m.spn)},G.prototype.setChannel=function(U){U<=this._m.inputs?this._m.channel=U:console.error("Channel ".concat(U," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(U," when instantiating the MeydaAnalyzer"))},G.prototype.get=function(U){return this._m.inputData?this._m.extract(U||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null},G}(),Ve={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:ce,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,numberOfBarkBands:24,_featuresToExtract:[],windowing:D,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(G){return new nt(G,Object.assign({},Ve))},listAvailableFeatureExtractors:function(){return Object.keys(this.featureExtractors)},extract:function(G,U,T){var Be=this;if(!U)throw this._errors.invalidInput;if(typeof U!="object")throw this._errors.invalidInput;if(!G)throw this._errors.featureUndef;if(!m(U.length))throw this._errors.notPow2;this.barkScale!==void 0&&this.barkScale.length==this.bufferSize||(this.barkScale=F(this.bufferSize,this.sampleRate,this.bufferSize)),this.melFilterBank!==void 0&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=j(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),this.chromaFilterBank!==void 0&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=xe(this.chromaBands,this.sampleRate,this.bufferSize)),"buffer"in U&&U.buffer===void 0?this.signal=pe(U):this.signal=U;var Ne=st(U,this.windowingFunction,this.bufferSize);if(this.signal=Ne.windowedSignal,this.complexSpectrum=Ne.complexSpectrum,this.ampSpectrum=Ne.ampSpectrum,T){var Ze=st(T,this.windowingFunction,this.bufferSize);this.previousSignal=Ze.windowedSignal,this.previousComplexSpectrum=Ze.complexSpectrum,this.previousAmpSpectrum=Ze.ampSpectrum}var pt=function(gt){return Be.featureExtractors[gt]({ampSpectrum:Be.ampSpectrum,chromaFilterBank:Be.chromaFilterBank,complexSpectrum:Be.complexSpectrum,signal:Be.signal,bufferSize:Be.bufferSize,sampleRate:Be.sampleRate,barkScale:Be.barkScale,melFilterBank:Be.melFilterBank,previousSignal:Be.previousSignal,previousAmpSpectrum:Be.previousAmpSpectrum,previousComplexSpectrum:Be.previousComplexSpectrum,numberOfMFCCCoefficients:Be.numberOfMFCCCoefficients,numberOfBarkBands:Be.numberOfBarkBands})};if(typeof G=="object")return G.reduce(function(gt,dt){var yt;return Object.assign({},gt,((yt={})[dt]=pt(dt),yt))},{});if(typeof G=="string")return pt(G);throw this._errors.invalidFeatureFmt}},st=function(G,U,T){var Be={};G.buffer===void 0?Be.signal=pe(G):Be.signal=G,Be.windowedSignal=D(Be.signal,U),Be.complexSpectrum=ze(Be.windowedSignal),Be.ampSpectrum=new Float32Array(T/2);for(var Ne=0;Ne<T/2;Ne++)Be.ampSpectrum[Ne]=Math.sqrt(Math.pow(Be.complexSpectrum.real[Ne],2)+Math.pow(Be.complexSpectrum.imag[Ne],2));return Be};return typeof window<"u"&&(window.Meyda=Ve),Ve})}(meyda_min$1)),meyda_min$1.exports}var meyda_minExports=requireMeyda_min();const Meyda=getDefaultExportFromCjs(meyda_minExports);class Audio{constructor({numBins:i=4,cutoff:o=2,smooth:l=.4,max:f=15,scale:m=10,isDrawing:D=!1,parentEl:F=document.body}){this.vol=0,this.scale=m,this.max=f,this.cutoff=o,this.smooth=l,this.setBins(i),this.beat={holdFrames:20,threshold:40,_cutoff:0,decay:.98,_framesSinceBeat:0},this.onBeat=()=>{},this.canvas=document.createElement("canvas"),this.canvas.width=100,this.canvas.height=80,this.canvas.style.width="100px",this.canvas.style.height="80px",this.canvas.style.position="absolute",this.canvas.style.right="0px",this.canvas.style.bottom="0px",F.appendChild(this.canvas),this.isDrawing=D,this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="#DFFFFF",this.ctx.strokeStyle="#0ff",this.ctx.lineWidth=.5,window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(pe=>{this.stream=pe,this.context=new AudioContext;let ue=this.context.createMediaStreamSource(pe);this.meyda=Meyda.createMeydaAnalyzer({audioContext:this.context,source:ue,featureExtractors:["loudness"]})}).catch(pe=>console.log("ERROR",pe))}detectBeat(i){i>this.beat._cutoff&&i>this.beat.threshold?(this.onBeat(),this.beat._cutoff=i*1.2,this.beat._framesSinceBeat=0):this.beat._framesSinceBeat<=this.beat.holdFrames?this.beat._framesSinceBeat++:(this.beat._cutoff*=this.beat.decay,this.beat._cutoff=Math.max(this.beat._cutoff,this.beat.threshold))}tick(){if(this.meyda){var i=this.meyda.get();if(i&&i!==null){this.vol=i.loudness.total,this.detectBeat(this.vol);const o=(f,m)=>f+m;let l=Math.floor(i.loudness.specific.length/this.bins.length);this.prevBins=this.bins.slice(0),this.bins=this.bins.map((f,m)=>i.loudness.specific.slice(m*l,(m+1)*l).reduce(o)).map((f,m)=>f*(1-this.settings[m].smooth)+this.prevBins[m]*this.settings[m].smooth),this.fft=this.bins.map((f,m)=>Math.max(0,(f-this.settings[m].cutoff)/this.settings[m].scale)),this.isDrawing&&this.draw()}}}setCutoff(i){this.cutoff=i,this.settings=this.settings.map(o=>(o.cutoff=i,o))}setSmooth(i){this.smooth=i,this.settings=this.settings.map(o=>(o.smooth=i,o))}setBins(i){this.bins=Array(i).fill(0),this.prevBins=Array(i).fill(0),this.fft=Array(i).fill(0),this.settings=Array(i).fill(0).map(()=>({cutoff:this.cutoff,scale:this.scale,smooth:this.smooth})),this.bins.forEach((o,l)=>{window["a"+l]=(f=1,m=0)=>()=>a.fft[l]*f+m})}setScale(i){this.scale=i,this.settings=this.settings.map(o=>(o.scale=i,o))}setMax(i){this.max=i,console.log("set max is deprecated")}hide(){this.isDrawing=!1,this.canvas.style.display="none"}show(){this.isDrawing=!0,this.canvas.style.display="block"}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var i=this.canvas.width/this.bins.length,o=this.canvas.height/(this.max*2);this.bins.forEach((l,f)=>{var m=l*o;this.ctx.fillRect(f*i,this.canvas.height-m,i,m);var D=this.canvas.height-o*this.settings[f].cutoff;this.ctx.beginPath(),this.ctx.moveTo(f*i,D),this.ctx.lineTo((f+1)*i,D),this.ctx.stroke();var F=this.canvas.height-o*(this.settings[f].scale+this.settings[f].cutoff);this.ctx.beginPath(),this.ctx.moveTo(f*i,F),this.ctx.lineTo((f+1)*i,F),this.ctx.stroke()})}}class VideoRecorder{constructor(i){this.mediaSource=new MediaSource,this.stream=i,this.output=document.createElement("video"),this.output.autoplay=!0,this.output.loop=!0;let o=this;this.mediaSource.addEventListener("sourceopen",()=>{console.log("MediaSource opened"),o.sourceBuffer=o.mediaSource.addSourceBuffer('video/webm; codecs="vp8"'),console.log("Source buffer: ",sourceBuffer)})}start(){let i={mimeType:"video/webm;codecs=vp9"};this.recordedBlobs=[];try{this.mediaRecorder=new MediaRecorder(this.stream,i)}catch(o){console.log("Unable to create MediaRecorder with options Object: ",o);try{i={mimeType:"video/webm,codecs=vp9"},this.mediaRecorder=new MediaRecorder(this.stream,i)}catch(l){console.log("Unable to create MediaRecorder with options Object: ",l);try{i="video/vp8",this.mediaRecorder=new MediaRecorder(this.stream,i)}catch(f){alert(`MediaRecorder is not supported by this browser.

Try Firefox 29 or later, or Chrome 47 or later, with Enable experimental Web Platform features enabled from chrome://flags.`),console.error("Exception while creating MediaRecorder:",f);return}}}console.log("Created MediaRecorder",this.mediaRecorder,"with options",i),this.mediaRecorder.onstop=this._handleStop.bind(this),this.mediaRecorder.ondataavailable=this._handleDataAvailable.bind(this),this.mediaRecorder.start(100),console.log("MediaRecorder started",this.mediaRecorder)}stop(){this.mediaRecorder.stop()}_handleStop(){const i=new Blob(this.recordedBlobs,{type:this.mediaRecorder.mimeType}),o=window.URL.createObjectURL(i);this.output.src=o;const l=document.createElement("a");l.style.display="none",l.href=o;let f=new Date;l.download=`hydra-${f.getFullYear()}-${f.getMonth()+1}-${f.getDate()}-${f.getHours()}.${f.getMinutes()}.${f.getSeconds()}.webm`,document.body.appendChild(l),l.click(),setTimeout(()=>{document.body.removeChild(l),window.URL.revokeObjectURL(o)},300)}_handleDataAvailable(i){i.data&&i.data.size>0&&this.recordedBlobs.push(i.data)}}const easing={linear:function(w){return w},easeInQuad:function(w){return w*w},easeOutQuad:function(w){return w*(2-w)},easeInOutQuad:function(w){return w<.5?2*w*w:-1+(4-2*w)*w},easeInCubic:function(w){return w*w*w},easeOutCubic:function(w){return--w*w*w+1},easeInOutCubic:function(w){return w<.5?4*w*w*w:(w-1)*(2*w-2)*(2*w-2)+1},easeInQuart:function(w){return w*w*w*w},easeOutQuart:function(w){return 1- --w*w*w*w},easeInOutQuart:function(w){return w<.5?8*w*w*w*w:1-8*--w*w*w*w},easeInQuint:function(w){return w*w*w*w*w},easeOutQuint:function(w){return 1+--w*w*w*w*w},easeInOutQuint:function(w){return w<.5?16*w*w*w*w*w:1+16*--w*w*w*w*w},sin:function(w){return(1+Math.sin(Math.PI*w-Math.PI/2))/2}};var map=(w,i,o,l,f)=>(w-i)*(f-l)/(o-i)+l;const ArrayUtils={init:()=>{Array.prototype.fast=function(w=1){return this._speed=w,this},Array.prototype.smooth=function(w=1){return this._smooth=w,this},Array.prototype.ease=function(w="linear"){return typeof w=="function"?(this._smooth=1,this._ease=w):easing[w]&&(this._smooth=1,this._ease=easing[w]),this},Array.prototype.offset=function(w=.5){return this._offset=w%1,this},Array.prototype.fit=function(w=0,i=1){let o=Math.min(...this),l=Math.max(...this);var f=this.map(m=>map(m,o,l,w,i));return f._speed=this._speed,f._smooth=this._smooth,f._ease=this._ease,f}},getValue:(w=[])=>({time:i,bpm:o})=>{let l=w._speed?w._speed:1,f=w._smooth?w._smooth:0,m=i*l*(o/60)+(w._offset||0);if(f!==0){let D=w._ease?w._ease:easing.linear,F=m-f/2,pe=w[Math.floor(F%w.length)],ue=w[Math.floor((F+1)%w.length)],j=Math.min(F%1/f,1);return D(j)*(ue-pe)+pe}else return w[Math.floor(m%w.length)],w[Math.floor(m%w.length)]}},Sandbox=w=>{var i="",o=f(i),l=(m,D)=>{i+=`
      var ${m} = ${D}
    `,o=f(i)};return{addToContext:l,eval:m=>o.eval(m)};function f(m){globalThis.eval(m);var D=function(F){globalThis.eval(F)};return{eval:D}}};class EvalSandbox{constructor(i,o,l=[]){this.makeGlobal=o,this.sandbox=Sandbox(),this.parent=i;var f=Object.keys(i);f.forEach(m=>this.add(m)),this.userProps=l}add(i){this.makeGlobal&&(window[i]=this.parent[i])}set(i,o){this.makeGlobal&&(window[i]=o),this.parent[i]=o}tick(){this.makeGlobal&&this.userProps.forEach(i=>{this.parent[i]=window[i]})}eval(i){this.sandbox.eval(i)}}const DEFAULT_CONVERSIONS={float:{vec4:{name:"sum",args:[[1,1,1,1]]},vec2:{name:"sum",args:[[1,1]]}}},ensure_decimal_dot=w=>(w=w.toString(),w.indexOf(".")<0&&(w+="."),w);function formatArguments(w,i,o){const l=w.transform.inputs,f=w.userArgs,{generators:m}=w.synth,{src:D}=m;return l.map((F,pe)=>{const ue={value:F.default,type:F.type,isUniform:!1,name:F.name,vecLen:0};if(ue.type==="float"&&(ue.value=ensure_decimal_dot(F.default)),F.type.startsWith("vec"))try{ue.vecLen=Number.parseInt(F.type.substr(3))}catch{console.log(`Error determining length of vector input type ${F.type} (${F.name})`)}if(f.length>pe&&(ue.value=f[pe],typeof f[pe]=="function"?(ue.value=(Z,Ee,we)=>{try{const Oe=f[pe](Ee);return typeof Oe=="number"?Oe:(console.warn("function does not return a number",f[pe]),F.default)}catch(Oe){return console.warn("ERROR",Oe),F.default}},ue.isUniform=!0):f[pe].constructor===Array&&(ue.value=(Z,Ee,we)=>ArrayUtils.getValue(f[pe])(Ee),ue.isUniform=!0)),!(i<0)){if(ue.value&&ue.value.transforms){const Z=ue.value.transforms[ue.value.transforms.length-1];if(Z.transform.glsl_return_type!==F.type){const Ee=DEFAULT_CONVERSIONS[F.type];if(typeof Ee<"u"){const we=Ee[Z.transform.glsl_return_type];if(typeof we<"u"){const{name:Oe,args:Ke}=we;ue.value=ue.value[Oe](...Ke)}}}ue.isUniform=!1}else if(ue.type==="float"&&typeof ue.value=="number")ue.value=ensure_decimal_dot(ue.value);else if(ue.type.startsWith("vec")&&typeof ue.value=="object"&&Array.isArray(ue.value))ue.isUniform=!1,ue.value=`${ue.type}(${ue.value.map(ensure_decimal_dot).join(", ")})`;else if(F.type==="sampler2D"){var j=ue.value;ue.value=()=>j.getTexture(),ue.isUniform=!0}else if(ue.value.getTexture&&F.type==="vec4"){var xe=ue.value;ue.value=D(xe),ue.isUniform=!1}ue.isUniform&&(ue.name+=i)}return ue})}function generateGlsl(w){var i={uniforms:[],glslFunctions:[],fragColor:""},o=generateGlsl$1(w,i)("st");i.fragColor=o;let l={};return i.uniforms.forEach(f=>l[f.name]=f),i.uniforms=Object.values(l),i}function generateGlsl$1(w,i){var o=()=>"";return w.forEach(l=>{var f=formatArguments(l,i.uniforms.length);f.forEach(F=>{F.isUniform&&i.uniforms.push(F)}),contains(l,i.glslFunctions)||i.glslFunctions.push(l);var m=o;if(l.transform.type==="src")o=F=>`${shaderString(F,l.name,f,i)}`;else if(l.transform.type==="coord")o=F=>`${m(`${shaderString(F,l.name,f,i)}`)}`;else if(l.transform.type==="color")o=F=>`${shaderString(`${m(F)}`,l.name,f,i)}`;else if(l.transform.type==="combine"){var D=f[0].value&&f[0].value.transforms?F=>`${generateGlsl$1(f[0].value.transforms,i)(F)}`:f[0].isUniform?()=>f[0].name:()=>f[0].value;o=F=>`${shaderString(`${m(F)}, ${D(F)}`,l.name,f.slice(1),i)}`}else if(l.transform.type==="combineCoord"){var D=f[0].value&&f[0].value.transforms?pe=>`${generateGlsl$1(f[0].value.transforms,i)(pe)}`:f[0].isUniform?()=>f[0].name:()=>f[0].value;o=pe=>`${m(`${shaderString(`${pe}, ${D(pe)}`,l.name,f.slice(1),i)}`)}`}}),o}function shaderString(w,i,o,l){const f=o.map(m=>m.isUniform?m.name:m.value&&m.value.transforms?`${generateGlsl$1(m.value.transforms,l)("st")}`:m.value).reduce((m,D)=>`${m}, ${D}`,"");return`${i}(${w}${f})`}function contains(w,i){for(var o=0;o<i.length;o++)if(w.name==i[o].name)return!0;return!1}const utilityGlsl={_luminance:{type:"util",glsl:`float _luminance(vec3 rgb){
      const vec3 W = vec3(0.2125, 0.7154, 0.0721);
      return dot(rgb, W);
    }`},_noise:{type:"util",glsl:`
    //	Simplex 3D Noise
    //	by Ian McEwan, Ashima Arts
    vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}
  vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}

  float _noise(vec3 v){
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);

  // First corner
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;

  // Other corners
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );

    //  x0 = x0 - 0. + 0.0 * C
    vec3 x1 = x0 - i1 + 1.0 * C.xxx;
    vec3 x2 = x0 - i2 + 2.0 * C.xxx;
    vec3 x3 = x0 - 1. + 3.0 * C.xxx;

  // Permutations
    i = mod(i, 289.0 );
    vec4 p = permute( permute( permute(
               i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
             + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
             + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));

  // Gradients
  // ( N*N points uniformly over a square, mapped onto an octahedron.)
    float n_ = 1.0/7.0; // N=7
    vec3  ns = n_ * D.wyz - D.xzx;

    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)

    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)

    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);

    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );

    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));

    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;

    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);

  //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;

  // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
  }
    `},_rgbToHsv:{type:"util",glsl:`vec3 _rgbToHsv(vec3 c){
            vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
            vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
            vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

            float d = q.x - min(q.w, q.y);
            float e = 1.0e-10;
            return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
        }`},_hsvToRgb:{type:"util",glsl:`vec3 _hsvToRgb(vec3 c){
        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }`}};var GlslSource=function(w){return this.transforms=[],this.transforms.push(w),this.defaultOutput=w.defaultOutput,this.synth=w.synth,this.type="GlslSource",this.defaultUniforms=w.defaultUniforms,this};GlslSource.prototype.addTransform=function(w){this.transforms.push(w)};GlslSource.prototype.out=function(w){var i=w||this.defaultOutput,o=this.glsl(i);if(this.synth.currentFunctions=[],i)try{i.render(o)}catch(l){console.log("shader could not compile",l)}};GlslSource.prototype.glsl=function(){var w=[],i=[];return this.transforms.forEach(o=>{o.transform.type==="renderpass"?console.warn("no support for renderpass"):i.push(o)}),i.length>0&&w.push(this.compile(i)),w};GlslSource.prototype.compile=function(w){var i=generateGlsl(w,this.synth),o={};i.uniforms.forEach(f=>{o[f.name]=f.value});var l=`
  precision ${this.defaultOutput.precision} float;
  ${Object.values(i.uniforms).map(f=>{let m=f.type;switch(f.type){case"texture":m="sampler2D";break}return`
      uniform ${m} ${f.name};`}).join("")}
  uniform float time;
  uniform vec2 resolution;
  varying vec2 uv;
  uniform sampler2D prevBuffer;

  ${Object.values(utilityGlsl).map(f=>`
            ${f.glsl}
          `).join("")}

  ${i.glslFunctions.map(f=>`
            ${f.transform.glsl}
          `).join("")}

  void main () {
    vec4 c = vec4(1, 0, 0, 1);
    vec2 st = gl_FragCoord.xy/resolution.xy;
    gl_FragColor = ${i.fragColor};
  }
  `;return{frag:l,uniforms:Object.assign({},this.defaultUniforms,o)}};const glslFunctions=()=>[{name:"noise",type:"src",inputs:[{type:"float",name:"scale",default:10},{type:"float",name:"offset",default:.1}],glsl:"   return vec4(vec3(_noise(vec3(_st*scale, offset*time))), 1.0);"},{name:"voronoi",type:"src",inputs:[{type:"float",name:"scale",default:5},{type:"float",name:"speed",default:.3},{type:"float",name:"blending",default:.3}],glsl:`   vec3 color = vec3(.0);
   // Scale
   _st *= scale;
   // Tile the space
   vec2 i_st = floor(_st);
   vec2 f_st = fract(_st);
   float m_dist = 10.;  // minimun distance
   vec2 m_point;        // minimum point
   for (int j=-1; j<=1; j++ ) {
   for (int i=-1; i<=1; i++ ) {
   vec2 neighbor = vec2(float(i),float(j));
   vec2 p = i_st + neighbor;
   vec2 point = fract(sin(vec2(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3))))*43758.5453);
   point = 0.5 + 0.5*sin(time*speed + 6.2831*point);
   vec2 diff = neighbor + point - f_st;
   float dist = length(diff);
   if( dist < m_dist ) {
   m_dist = dist;
   m_point = point;
   }
   }
   }
   // Assign a color using the closest point position
   color += dot(m_point,vec2(.3,.6));
   color *= 1.0 - blending*m_dist;
   return vec4(color, 1.0);`},{name:"osc",type:"src",inputs:[{type:"float",name:"frequency",default:60},{type:"float",name:"sync",default:.1},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st;
   float r = sin((st.x-offset/frequency+time*sync)*frequency)*0.5  + 0.5;
   float g = sin((st.x+time*sync)*frequency)*0.5 + 0.5;
   float b = sin((st.x+offset/frequency+time*sync)*frequency)*0.5  + 0.5;
   return vec4(r, g, b, 1.0);`},{name:"shape",type:"src",inputs:[{type:"float",name:"sides",default:3},{type:"float",name:"radius",default:.3},{type:"float",name:"smoothing",default:.01}],glsl:`   vec2 st = _st * 2. - 1.;
   // Angle and radius from the current pixel
   float a = atan(st.x,st.y)+3.1416;
   float r = (2.*3.1416)/sides;
   float d = cos(floor(.5+a/r)*r-a)*length(st);
   return vec4(vec3(1.0-smoothstep(radius,radius + smoothing + 0.0000001,d)), 1.0);`},{name:"gradient",type:"src",inputs:[{type:"float",name:"speed",default:0}],glsl:"   return vec4(_st, sin(time*speed), 1.0);"},{name:"src",type:"src",inputs:[{type:"sampler2D",name:"tex",default:NaN}],glsl:`   //  vec2 uv = gl_FragCoord.xy/vec2(1280., 720.);
   return texture2D(tex, fract(_st));`},{name:"solid",type:"src",inputs:[{type:"float",name:"r",default:0},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:1}],glsl:"   return vec4(r, g, b, a);"},{name:"rotate",type:"coord",inputs:[{type:"float",name:"angle",default:10},{type:"float",name:"speed",default:0}],glsl:`   vec2 xy = _st - vec2(0.5);
   float ang = angle + speed *time;
   xy = mat2(cos(ang),-sin(ang), sin(ang),cos(ang))*xy;
   xy += 0.5;
   return xy;`},{name:"scale",type:"coord",inputs:[{type:"float",name:"amount",default:1.5},{type:"float",name:"xMult",default:1},{type:"float",name:"yMult",default:1},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:`   vec2 xy = _st - vec2(offsetX, offsetY);
   xy*=(1.0/vec2(amount*xMult, amount*yMult));
   xy+=vec2(offsetX, offsetY);
   return xy;
   `},{name:"pixelate",type:"coord",inputs:[{type:"float",name:"pixelX",default:20},{type:"float",name:"pixelY",default:20}],glsl:`   vec2 xy = vec2(pixelX, pixelY);
   return (floor(_st * xy) + 0.5)/xy;`},{name:"posterize",type:"color",inputs:[{type:"float",name:"bins",default:3},{type:"float",name:"gamma",default:.6}],glsl:`   vec4 c2 = pow(_c0, vec4(gamma));
   c2 *= vec4(bins);
   c2 = floor(c2);
   c2/= vec4(bins);
   c2 = pow(c2, vec4(1.0/gamma));
   return vec4(c2.xyz, _c0.a);`},{name:"shift",type:"color",inputs:[{type:"float",name:"r",default:.5},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:0}],glsl:`   vec4 c2 = vec4(_c0);
   c2.r = fract(c2.r + r);
   c2.g = fract(c2.g + g);
   c2.b = fract(c2.b + b);
   c2.a = fract(c2.a + a);
   return vec4(c2.rgba);`},{name:"repeat",type:"coord",inputs:[{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:0},{type:"float",name:"offsetY",default:0}],glsl:`   vec2 st = _st * vec2(repeatX, repeatY);
   st.x += step(1., mod(st.y,2.0)) * offsetX;
   st.y += step(1., mod(st.x,2.0)) * offsetY;
   return fract(st);`},{name:"modulateRepeat",type:"combineCoord",inputs:[{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:`   vec2 st = _st * vec2(repeatX, repeatY);
   st.x += step(1., mod(st.y,2.0)) + _c0.r * offsetX;
   st.y += step(1., mod(st.x,2.0)) + _c0.g * offsetY;
   return fract(st);`},{name:"repeatX",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.y += step(1., mod(st.x,2.0))* offset;
   return fract(st);`},{name:"modulateRepeatX",type:"combineCoord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.y += step(1., mod(st.x,2.0)) + _c0.r * offset;
   return fract(st);`},{name:"repeatY",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st * vec2(1.0, reps);
   //  float f =  mod(_st.y,2.0);
   st.x += step(1., mod(st.y,2.0))* offset;
   return fract(st);`},{name:"modulateRepeatY",type:"combineCoord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.x += step(1., mod(st.y,2.0)) + _c0.r * offset;
   return fract(st);`},{name:"kaleid",type:"coord",inputs:[{type:"float",name:"nSides",default:4}],glsl:`   vec2 st = _st;
   st -= 0.5;
   float r = length(st);
   float a = atan(st.y, st.x);
   float pi = 2.*3.1416;
   a = mod(a,pi/nSides);
   a = abs(a-pi/nSides/2.);
   return r*vec2(cos(a), sin(a));`},{name:"modulateKaleid",type:"combineCoord",inputs:[{type:"float",name:"nSides",default:4}],glsl:`   vec2 st = _st - 0.5;
   float r = length(st);
   float a = atan(st.y, st.x);
   float pi = 2.*3.1416;
   a = mod(a,pi/nSides);
   a = abs(a-pi/nSides/2.);
   return (_c0.r+r)*vec2(cos(a), sin(a));`},{name:"scroll",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"scrollY",default:.5},{type:"float",name:"speedX",default:0},{type:"float",name:"speedY",default:0}],glsl:`
   _st.x += scrollX + time*speedX;
   _st.y += scrollY + time*speedY;
   return fract(_st);`},{name:"scrollX",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.x += scrollX + time*speed;
   return fract(_st);`},{name:"modulateScrollX",type:"combineCoord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.x += _c0.r*scrollX + time*speed;
   return fract(_st);`},{name:"scrollY",type:"coord",inputs:[{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.y += scrollY + time*speed;
   return fract(_st);`},{name:"modulateScrollY",type:"combineCoord",inputs:[{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.y += _c0.r*scrollY + time*speed;
   return fract(_st);`},{name:"add",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return (_c0+_c1)*amount + _c0*(1.0-amount);"},{name:"sub",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return (_c0-_c1)*amount + _c0*(1.0-amount);"},{name:"layer",type:"combine",inputs:[],glsl:"   return vec4(mix(_c0.rgb, _c1.rgb, _c1.a), clamp(_c0.a + _c1.a, 0.0, 1.0));"},{name:"blend",type:"combine",inputs:[{type:"float",name:"amount",default:.5}],glsl:"   return _c0*(1.0-amount)+_c1*amount;"},{name:"mult",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return _c0*(1.0-amount)+(_c0*_c1)*amount;"},{name:"diff",type:"combine",inputs:[],glsl:"   return vec4(abs(_c0.rgb-_c1.rgb), max(_c0.a, _c1.a));"},{name:"modulate",type:"combineCoord",inputs:[{type:"float",name:"amount",default:.1}],glsl:`   //  return fract(st+(_c0.xy-0.5)*amount);
   return _st + _c0.xy*amount;`},{name:"modulateScale",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:1}],glsl:`   vec2 xy = _st - vec2(0.5);
   xy*=(1.0/vec2(offset + multiple*_c0.r, offset + multiple*_c0.g));
   xy+=vec2(0.5);
   return xy;`},{name:"modulatePixelate",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:10},{type:"float",name:"offset",default:3}],glsl:`   vec2 xy = vec2(offset + _c0.x*multiple, offset + _c0.y*multiple);
   return (floor(_st * xy) + 0.5)/xy;`},{name:"modulateRotate",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:0}],glsl:`   vec2 xy = _st - vec2(0.5);
   float angle = offset + _c0.x * multiple;
   xy = mat2(cos(angle),-sin(angle), sin(angle),cos(angle))*xy;
   xy += 0.5;
   return xy;`},{name:"modulateHue",type:"combineCoord",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return _st + (vec2(_c0.g - _c0.r, _c0.b - _c0.g) * amount * 1.0/resolution);"},{name:"invert",type:"color",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return vec4((1.0-_c0.rgb)*amount + _c0.rgb*(1.0-amount), _c0.a);"},{name:"contrast",type:"color",inputs:[{type:"float",name:"amount",default:1.6}],glsl:`   vec4 c = (_c0-vec4(0.5))*vec4(amount) + vec4(0.5);
   return vec4(c.rgb, _c0.a);`},{name:"brightness",type:"color",inputs:[{type:"float",name:"amount",default:.4}],glsl:"   return vec4(_c0.rgb + vec3(amount), _c0.a);"},{name:"mask",type:"combine",inputs:[],glsl:`   float a = _luminance(_c1.rgb);
  return vec4(_c0.rgb*a, a*_c0.a);`},{name:"luma",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.1}],glsl:`   float a = smoothstep(threshold-(tolerance+0.0000001), threshold+(tolerance+0.0000001), _luminance(_c0.rgb));
   return vec4(_c0.rgb*a, a);`},{name:"thresh",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.04}],glsl:"   return vec4(vec3(smoothstep(threshold-(tolerance+0.0000001), threshold+(tolerance+0.0000001), _luminance(_c0.rgb))), _c0.a);"},{name:"color",type:"color",inputs:[{type:"float",name:"r",default:1},{type:"float",name:"g",default:1},{type:"float",name:"b",default:1},{type:"float",name:"a",default:1}],glsl:`   vec4 c = vec4(r, g, b, a);
   vec4 pos = step(0.0, c); // detect whether negative
   // if > 0, return r * _c0
   // if < 0 return (1.0-r) * _c0
   return vec4(mix((1.0-_c0)*abs(c), c*_c0, pos));`},{name:"saturate",type:"color",inputs:[{type:"float",name:"amount",default:2}],glsl:`   const vec3 W = vec3(0.2125, 0.7154, 0.0721);
   vec3 intensity = vec3(dot(_c0.rgb, W));
   return vec4(mix(intensity, _c0.rgb, amount), _c0.a);`},{name:"hue",type:"color",inputs:[{type:"float",name:"hue",default:.4}],glsl:`   vec3 c = _rgbToHsv(_c0.rgb);
   c.r += hue;
   //  c.r = fract(c.r);
   return vec4(_hsvToRgb(c), _c0.a);`},{name:"colorama",type:"color",inputs:[{type:"float",name:"amount",default:.005}],glsl:`   vec3 c = _rgbToHsv(_c0.rgb);
   c += vec3(amount);
   c = _hsvToRgb(c);
   c = fract(c);
   return vec4(c, _c0.a);`},{name:"prev",type:"src",inputs:[],glsl:"   return texture2D(prevBuffer, fract(_st));"},{name:"sum",type:"color",inputs:[{type:"vec4",name:"scale",default:1}],glsl:`   vec4 v = _c0 * s;
   return v.r + v.g + v.b + v.a;
   }
   float sum(vec2 _st, vec4 s) { // vec4 is not a typo, because argument type is not overloaded
   vec2 v = _st.xy * s.xy;
   return v.x + v.y;`},{name:"r",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.r * scale + offset);"},{name:"g",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.g * scale + offset);"},{name:"b",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.b * scale + offset);"},{name:"a",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.a * scale + offset);"}];class GeneratorFactory{constructor({defaultUniforms:i,defaultOutput:o,extendTransforms:l=[],changeListener:f=()=>{}}={}){this.defaultOutput=o,this.defaultUniforms=i,this.changeListener=f,this.extendTransforms=l,this.generators={},this.init()}init(){const i=glslFunctions();return this.glslTransforms={},this.generators=Object.entries(this.generators).reduce((o,[l,f])=>(this.changeListener({type:"remove",synth:this,method:l}),o),{}),this.sourceClass=class extends GlslSource{},Array.isArray(this.extendTransforms)?i.concat(this.extendTransforms):typeof this.extendTransforms=="object"&&this.extendTransforms.type&&i.push(this.extendTransforms),i.map(o=>this.setFunction(o))}_addMethod(i,o){const l=this;if(this.glslTransforms[i]=o,o.type==="src"){const f=(...m)=>new this.sourceClass({name:i,transform:o,userArgs:m,defaultOutput:this.defaultOutput,defaultUniforms:this.defaultUniforms,synth:l});return this.generators[i]=f,this.changeListener({type:"add",synth:this,method:i}),f}else this.sourceClass.prototype[i]=function(...f){return this.transforms.push({name:i,transform:o,userArgs:f,synth:l}),this}}setFunction(i){var o=processGlsl(i);o&&this._addMethod(i.name,o)}}const typeLookup={src:{returnType:"vec4",args:["vec2 _st"]},coord:{returnType:"vec2",args:["vec2 _st"]},color:{returnType:"vec4",args:["vec4 _c0"]},combine:{returnType:"vec4",args:["vec4 _c0","vec4 _c1"]},combineCoord:{returnType:"vec2",args:["vec2 _st","vec4 _c0"]}};function processGlsl(w){let i=typeLookup[w.type];if(i){let o=i.args.map(D=>D).join(", "),l=w.inputs.map(D=>`${D.type} ${D.name}`).join(", "),f=`${o}${l.length>0?", "+l:""}`,m=`
  ${i.returnType} ${w.name}(${f}) {
      ${w.glsl}
  }
`;return(w.type==="combine"||w.type==="combineCoord")&&w.inputs.unshift({name:"color",type:"vec4"}),Object.assign({},w,{glsl:m})}else console.warn(`type ${w.type} not recognized`,w)}var regl$2={exports:{}},regl$1=regl$2.exports,hasRequiredRegl;function requireRegl(){return hasRequiredRegl||(hasRequiredRegl=1,function(w,i){(function(o,l){w.exports=l()})(regl$1,function(){var o=function(E){return E instanceof Uint8Array||E instanceof Uint16Array||E instanceof Uint32Array||E instanceof Int8Array||E instanceof Int16Array||E instanceof Int32Array||E instanceof Float32Array||E instanceof Float64Array||E instanceof Uint8ClampedArray},l=function(E,Y){for(var he=Object.keys(Y),Se=0;Se<he.length;++Se)E[he[Se]]=Y[he[Se]];return E},f=`
`;function m(E){return typeof atob<"u"?atob(E):"base64:"+E}function D(E){var Y=new Error("(regl) "+E);throw console.error(Y),Y}function F(E,Y){E||D(Y)}function pe(E){return E?": "+E:""}function ue(E,Y,he){E in Y||D("unknown parameter ("+E+")"+pe(he)+". possible values: "+Object.keys(Y).join())}function j(E,Y){o(E)||D("invalid parameter type"+pe(Y)+". must be a typed array")}function xe(E,Y){switch(Y){case"number":return typeof E=="number";case"object":return typeof E=="object";case"string":return typeof E=="string";case"boolean":return typeof E=="boolean";case"function":return typeof E=="function";case"undefined":return typeof E>"u";case"symbol":return typeof E=="symbol"}}function Z(E,Y,he){xe(E,Y)||D("invalid parameter type"+pe(he)+". expected "+Y+", got "+typeof E)}function Ee(E,Y){E>=0&&(E|0)===E||D("invalid parameter type, ("+E+")"+pe(Y)+". must be a nonnegative integer")}function we(E,Y,he){Y.indexOf(E)<0&&D("invalid value"+pe(he)+". must be one of: "+Y)}var Oe=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ke(E){Object.keys(E).forEach(function(Y){Oe.indexOf(Y)<0&&D('invalid regl constructor argument "'+Y+'". must be one of '+Oe)})}function le(E,Y){for(E=E+"";E.length<Y;)E=" "+E;return E}function q(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function ce(E,Y){this.number=E,this.line=Y,this.errors=[]}function Q(E,Y,he){this.file=E,this.line=Y,this.message=he}function N(){var E=new Error,Y=(E.stack||E).toString(),he=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Y);if(he)return he[1];var Se=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Y);return Se?Se[1]:"unknown"}function oe(){var E=new Error,Y=(E.stack||E).toString(),he=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Y);if(he)return he[1];var Se=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Y);return Se?Se[1]:"unknown"}function de(E,Y){var he=E.split(`
`),Se=1,qe=0,Fe={unknown:new q,0:new q};Fe.unknown.name=Fe[0].name=Y||N(),Fe.unknown.lines.push(new ce(0,""));for(var Me=0;Me<he.length;++Me){var tt=he[Me],At=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(tt);if(At)switch(At[1]){case"line":var it=/(\d+)(\s+\d+)?/.exec(At[2]);it&&(Se=it[1]|0,it[2]&&(qe=it[2]|0,qe in Fe||(Fe[qe]=new q)));break;case"define":var Ye=/SHADER_NAME(_B64)?\s+(.*)$/.exec(At[2]);Ye&&(Fe[qe].name=Ye[1]?m(Ye[2]):Ye[2]);break}Fe[qe].lines.push(new ce(Se++,tt))}return Object.keys(Fe).forEach(function(lt){var ft=Fe[lt];ft.lines.forEach(function(rt){ft.index[rt.number]=rt})}),Fe}function Te(E){var Y=[];return E.split(`
`).forEach(function(he){if(!(he.length<5)){var Se=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(he);Se?Y.push(new Q(Se[1]|0,Se[2]|0,Se[3].trim())):he.length>0&&Y.push(new Q("unknown",0,he))}}),Y}function ze(E,Y){Y.forEach(function(he){var Se=E[he.file];if(Se){var qe=Se.index[he.line];if(qe){qe.errors.push(he),Se.hasErrors=!0;return}}E.unknown.hasErrors=!0,E.unknown.lines[0].errors.push(he)})}function nt(E,Y,he,Se,qe){if(!E.getShaderParameter(Y,E.COMPILE_STATUS)){var Fe=E.getShaderInfoLog(Y),Me=Se===E.FRAGMENT_SHADER?"fragment":"vertex";Ne(he,"string",Me+" shader source must be a string",qe);var tt=de(he,qe),At=Te(Fe);ze(tt,At),Object.keys(tt).forEach(function(it){var Ye=tt[it];if(!Ye.hasErrors)return;var lt=[""],ft=[""];function rt(ot,e){lt.push(ot),ft.push(e||"")}rt("file number "+it+": "+Ye.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Ye.lines.forEach(function(ot){if(ot.errors.length>0){rt(le(ot.number,4)+"|  ","background-color:yellow; font-weight:bold"),rt(ot.line+f,"color:red; background-color:yellow; font-weight:bold");var e=0;ot.errors.forEach(function(t){var A=t.message,r=/^\s*'(.*)'\s*:\s*(.*)$/.exec(A);if(r){var n=r[1];switch(A=r[2],n){case"assign":n="=";break}e=Math.max(ot.line.indexOf(n,e),0)}else e=0;rt(le("| ",6)),rt(le("^^^",e+3)+f,"font-weight:bold"),rt(le("| ",6)),rt(A+f,"font-weight:bold")}),rt(le("| ",6)+f)}else rt(le(ot.number,4)+"|  "),rt(ot.line+f,"color:red")}),typeof document<"u"&&!window.chrome?(ft[0]=lt.join("%c"),console.log.apply(console,ft)):console.log(lt.join(""))}),F.raise("Error compiling "+Me+" shader, "+tt[0].name)}}function Ve(E,Y,he,Se,qe){if(!E.getProgramParameter(Y,E.LINK_STATUS)){var Fe=E.getProgramInfoLog(Y),Me=de(he,qe),tt=de(Se,qe),At='Error linking program with vertex shader, "'+tt[0].name+'", and fragment shader "'+Me[0].name+'"';typeof document<"u"?console.log("%c"+At+f+"%c"+Fe,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(At+f+Fe),F.raise(At)}}function st(E){E._commandRef=N()}function G(E,Y,he,Se){st(E);function qe(At){return At?Se.id(At):0}E._fragId=qe(E.static.frag),E._vertId=qe(E.static.vert);function Fe(At,it){Object.keys(it).forEach(function(Ye){At[Se.id(Ye)]=!0})}var Me=E._uniformSet={};Fe(Me,Y.static),Fe(Me,Y.dynamic);var tt=E._attributeSet={};Fe(tt,he.static),Fe(tt,he.dynamic),E._hasCount="count"in E.static||"count"in E.dynamic||"elements"in E.static||"elements"in E.dynamic}function U(E,Y){var he=oe();D(E+" in command "+(Y||N())+(he==="unknown"?"":" called from "+he))}function T(E,Y,he){E||U(Y,he||N())}function Be(E,Y,he,Se){E in Y||U("unknown parameter ("+E+")"+pe(he)+". possible values: "+Object.keys(Y).join(),Se||N())}function Ne(E,Y,he,Se){xe(E,Y)||U("invalid parameter type"+pe(he)+". expected "+Y+", got "+typeof E,Se||N())}function Ze(E){E()}function pt(E,Y,he){E.texture?we(E.texture._texture.internalformat,Y,"unsupported texture format for attachment"):we(E.renderbuffer._renderbuffer.format,he,"unsupported renderbuffer format for attachment")}var gt=33071,dt=9728,yt=9984,wt=9985,jt=9986,St=9987,Dt=5120,bt=5121,Lt=5122,Wt=5123,NA=5124,Tt=5125,Jt=5126,JA=32819,sr=32820,Cr=33635,hr=34042,ZA=36193,AA={};AA[Dt]=AA[bt]=1,AA[Lt]=AA[Wt]=AA[ZA]=AA[Cr]=AA[JA]=AA[sr]=2,AA[NA]=AA[Tt]=AA[Jt]=AA[hr]=4;function on(E,Y){return E===sr||E===JA||E===Cr?2:E===hr?4:AA[E]*Y}function qt(E){return!(E&E-1)&&!!E}function ii(E,Y,he){var Se,qe=Y.width,Fe=Y.height,Me=Y.channels;F(qe>0&&qe<=he.maxTextureSize&&Fe>0&&Fe<=he.maxTextureSize,"invalid texture shape"),(E.wrapS!==gt||E.wrapT!==gt)&&F(qt(qe)&&qt(Fe),"incompatible wrap mode for texture, both width and height must be power of 2"),Y.mipmask===1?qe!==1&&Fe!==1&&F(E.minFilter!==yt&&E.minFilter!==jt&&E.minFilter!==wt&&E.minFilter!==St,"min filter requires mipmap"):(F(qt(qe)&&qt(Fe),"texture must be a square power of 2 to support mipmapping"),F(Y.mipmask===(qe<<1)-1,"missing or incomplete mipmap data")),Y.type===Jt&&(he.extensions.indexOf("oes_texture_float_linear")<0&&F(E.minFilter===dt&&E.magFilter===dt,"filter not supported, must enable oes_texture_float_linear"),F(!E.genMipmaps,"mipmap generation not supported with float textures"));var tt=Y.images;for(Se=0;Se<16;++Se)if(tt[Se]){var At=qe>>Se,it=Fe>>Se;F(Y.mipmask&1<<Se,"missing mipmap data");var Ye=tt[Se];if(F(Ye.width===At&&Ye.height===it,"invalid shape for mip images"),F(Ye.format===Y.format&&Ye.internalformat===Y.internalformat&&Ye.type===Y.type,"incompatible type for mip image"),!Ye.compressed)if(Ye.data){var lt=Math.ceil(on(Ye.type,Me)*At/Ye.unpackAlignment)*Ye.unpackAlignment;F(Ye.data.byteLength===lt*it,"invalid data for image, buffer size is inconsistent with image format")}else Ye.element||Ye.copy}else E.genMipmaps||F((Y.mipmask&1<<Se)===0,"extra mipmap data");Y.compressed&&F(!E.genMipmaps,"mipmap generation for compressed images not supported")}function $o(E,Y,he,Se){var qe=E.width,Fe=E.height,Me=E.channels;F(qe>0&&qe<=Se.maxTextureSize&&Fe>0&&Fe<=Se.maxTextureSize,"invalid texture shape"),F(qe===Fe,"cube map must be square"),F(Y.wrapS===gt&&Y.wrapT===gt,"wrap mode not supported by cube map");for(var tt=0;tt<he.length;++tt){var At=he[tt];F(At.width===qe&&At.height===Fe,"inconsistent cube map face shape"),Y.genMipmaps&&(F(!At.compressed,"can not generate mipmap for compressed textures"),F(At.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var it=At.images,Ye=0;Ye<16;++Ye){var lt=it[Ye];if(lt){var ft=qe>>Ye,rt=Fe>>Ye;F(At.mipmask&1<<Ye,"missing mipmap data"),F(lt.width===ft&&lt.height===rt,"invalid shape for mip images"),F(lt.format===E.format&&lt.internalformat===E.internalformat&&lt.type===E.type,"incompatible type for mip image"),lt.compressed||(lt.data?F(lt.data.byteLength===ft*rt*Math.max(on(lt.type,Me),lt.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):lt.element||lt.copy)}}}}var re=l(F,{optional:Ze,raise:D,commandRaise:U,command:T,parameter:ue,commandParameter:Be,constructor:Ke,type:Z,commandType:Ne,isTypedArray:j,nni:Ee,oneOf:we,shaderError:nt,linkError:Ve,callSite:oe,saveCommandRef:st,saveDrawInfo:G,framebufferFormat:pt,guessCommand:N,texture2D:ii,textureCube:$o}),to=0,Yo=0,ha=5,sn=6;function jr(E,Y){this.id=to++,this.type=E,this.data=Y}function Kr(E){return E.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function XA(E){if(E.length===0)return[];var Y=E.charAt(0),he=E.charAt(E.length-1);if(E.length>1&&Y===he&&(Y==='"'||Y==="'"))return['"'+Kr(E.substr(1,E.length-2))+'"'];var Se=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(E);if(Se)return XA(E.substr(0,Se.index)).concat(XA(Se[1])).concat(XA(E.substr(Se.index+Se[0].length)));var qe=E.split(".");if(qe.length===1)return['"'+Kr(E)+'"'];for(var Fe=[],Me=0;Me<qe.length;++Me)Fe=Fe.concat(XA(qe[Me]));return Fe}function ln(E){return"["+XA(E).join("][")+"]"}function Jr(E,Y){return new jr(E,ln(Y+""))}function Fn(E){return typeof E=="function"&&!E._reglType||E instanceof jr}function Rn(E,Y){if(typeof E=="function")return new jr(Yo,E);if(typeof E=="number"||typeof E=="boolean")return new jr(ha,E);if(Array.isArray(E))return new jr(sn,E.map((he,Se)=>Rn(he,Y+"["+Se+"]")));if(E instanceof jr)return E;re(!1,"invalid option type in uniform "+Y)}var ar={DynamicVariable:jr,define:Jr,isDynamic:Fn,unbox:Rn,accessor:ln},da={next:typeof requestAnimationFrame=="function"?function(E){return requestAnimationFrame(E)}:function(E){return setTimeout(E,16)},cancel:typeof cancelAnimationFrame=="function"?function(E){return cancelAnimationFrame(E)}:clearTimeout},Xt=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Ao(){var E={"":0},Y=[""];return{id:function(he){var Se=E[he];return Se||(Se=E[he]=Y.length,Y.push(he),Se)},str:function(he){return Y[he]}}}function kt(E,Y,he){var Se=document.createElement("canvas");l(Se.style,{border:0,margin:0,padding:0,top:0,left:0}),E.appendChild(Se),E===document.body&&(Se.style.position="absolute",l(E.style,{margin:0,padding:0}));function qe(){var tt=window.innerWidth,At=window.innerHeight;if(E!==document.body){var it=E.getBoundingClientRect();tt=it.right-it.left,At=it.bottom-it.top}Se.width=he*tt,Se.height=he*At,l(Se.style,{width:tt+"px",height:At+"px"})}var Fe;E!==document.body&&typeof ResizeObserver=="function"?(Fe=new ResizeObserver(function(){setTimeout(qe)}),Fe.observe(E)):window.addEventListener("resize",qe,!1);function Me(){Fe?Fe.disconnect():window.removeEventListener("resize",qe),E.removeChild(Se)}return qe(),{canvas:Se,onDestroy:Me}}function un(E,Y){function he(Se){try{return E.getContext(Se,Y)}catch{return null}}return he("webgl")||he("experimental-webgl")||he("webgl-experimental")}function dr(E){return typeof E.nodeName=="string"&&typeof E.appendChild=="function"&&typeof E.getBoundingClientRect=="function"}function er(E){return typeof E.drawArrays=="function"||typeof E.drawElements=="function"}function KA(E){return typeof E=="string"?E.split():(re(Array.isArray(E),"invalid extension array"),E)}function Qr(E){return typeof E=="string"?(re(typeof document<"u","not supported outside of DOM"),document.querySelector(E)):E}function wr(E){var Y=E||{},he,Se,qe,Fe,Me={},tt=[],At=[],it=typeof window>"u"?1:window.devicePixelRatio,Ye=!1,lt=function(ot){ot&&re.raise(ot)},ft=function(){};if(typeof Y=="string"?(re(typeof document<"u","selector queries only supported in DOM enviroments"),he=document.querySelector(Y),re(he,"invalid query string for element")):typeof Y=="object"?dr(Y)?he=Y:er(Y)?(Fe=Y,qe=Fe.canvas):(re.constructor(Y),"gl"in Y?Fe=Y.gl:"canvas"in Y?qe=Qr(Y.canvas):"container"in Y&&(Se=Qr(Y.container)),"attributes"in Y&&(Me=Y.attributes,re.type(Me,"object","invalid context attributes")),"extensions"in Y&&(tt=KA(Y.extensions)),"optionalExtensions"in Y&&(At=KA(Y.optionalExtensions)),"onDone"in Y&&(re.type(Y.onDone,"function","invalid or missing onDone callback"),lt=Y.onDone),"profile"in Y&&(Ye=!!Y.profile),"pixelRatio"in Y&&(it=+Y.pixelRatio,re(it>0,"invalid pixel ratio"))):re.raise("invalid arguments to regl"),he&&(he.nodeName.toLowerCase()==="canvas"?qe=he:Se=he),!Fe){if(!qe){re(typeof document<"u","must manually specify webgl context outside of DOM environments");var rt=kt(Se||document.body,lt,it);if(!rt)return null;qe=rt.canvas,ft=rt.onDestroy}Me.premultipliedAlpha===void 0&&(Me.premultipliedAlpha=!0),Fe=un(qe,Me)}return Fe?{gl:Fe,canvas:qe,container:Se,extensions:tt,optionalExtensions:At,pixelRatio:it,profile:Ye,onDone:lt,onDestroy:ft}:(ft(),lt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Nr(E,Y){var he={};function Se(Me){re.type(Me,"string","extension name must be string");var tt=Me.toLowerCase(),At;try{At=he[tt]=E.getExtension(tt)}catch{}return!!At}for(var qe=0;qe<Y.extensions.length;++qe){var Fe=Y.extensions[qe];if(!Se(Fe))return Y.onDestroy(),Y.onDone('"'+Fe+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Y.optionalExtensions.forEach(Se),{extensions:he,restore:function(){Object.keys(he).forEach(function(Me){if(he[Me]&&!Se(Me))throw new Error("(regl): error restoring extension "+Me)})}}}function WA(E,Y){for(var he=Array(E),Se=0;Se<E;++Se)he[Se]=Y(Se);return he}var Qi=5120,Er=5121,Mn=5122,pa=5123,Gr=5124,Xo=5125,Ti=5126;function ro(E){for(var Y=16;Y<=1<<28;Y*=16)if(E<=Y)return Y;return 0}function Di(E){var Y,he;return Y=(E>65535)<<4,E>>>=Y,he=(E>255)<<3,E>>>=he,Y|=he,he=(E>15)<<2,E>>>=he,Y|=he,he=(E>3)<<1,E>>>=he,Y|=he,Y|E>>1}function fn(){var E=WA(8,function(){return[]});function Y(Fe){var Me=ro(Fe),tt=E[Di(Me)>>2];return tt.length>0?tt.pop():new ArrayBuffer(Me)}function he(Fe){E[Di(Fe.byteLength)>>2].push(Fe)}function Se(Fe,Me){var tt=null;switch(Fe){case Qi:tt=new Int8Array(Y(Me),0,Me);break;case Er:tt=new Uint8Array(Y(Me),0,Me);break;case Mn:tt=new Int16Array(Y(2*Me),0,Me);break;case pa:tt=new Uint16Array(Y(2*Me),0,Me);break;case Gr:tt=new Int32Array(Y(4*Me),0,Me);break;case Xo:tt=new Uint32Array(Y(4*Me),0,Me);break;case Ti:tt=new Float32Array(Y(4*Me),0,Me);break;default:return null}return tt.length!==Me?tt.subarray(0,Me):tt}function qe(Fe){he(Fe.buffer)}return{alloc:Y,free:he,allocType:Se,freeType:qe}}var rA=fn();rA.zero=fn();var On=3408,no=3410,Ur=3411,Vo=3412,Pi=3413,Hr=3414,zr=3415,ai=33901,Ii=33902,ki=3379,Nn=3386,Li=34921,Zr=36347,ga=36348,Fi=35661,tr=35660,Qt=34930,cn=36349,va=34076,Tr=34024,I=7936,ge=7937,je=7938,ut=35724,Ge=34047,vt=36063,HA=34852,Ar=3553,gr=34067,Ri=34069,Js=33984,Mt=6408,jo=5126,Ko=5121,Mi=36160,en=36053,Zs=36064,el=16384,ma=function(E,Y){var he=1;Y.ext_texture_filter_anisotropic&&(he=E.getParameter(Ge));var Se=1,qe=1;Y.webgl_draw_buffers&&(Se=E.getParameter(HA),qe=E.getParameter(vt));var Fe=!!Y.oes_texture_float;if(Fe){var Me=E.createTexture();E.bindTexture(Ar,Me),E.texImage2D(Ar,0,Mt,1,1,0,Mt,jo,null);var tt=E.createFramebuffer();if(E.bindFramebuffer(Mi,tt),E.framebufferTexture2D(Mi,Zs,Ar,Me,0),E.bindTexture(Ar,null),E.checkFramebufferStatus(Mi)!==en)Fe=!1;else{E.viewport(0,0,1,1),E.clearColor(1,0,0,1),E.clear(el);var At=rA.allocType(jo,4);E.readPixels(0,0,1,1,Mt,jo,At),E.getError()?Fe=!1:(E.deleteFramebuffer(tt),E.deleteTexture(Me),Fe=At[0]===1),rA.freeType(At)}}var it=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Ye=!0;if(!it){var lt=E.createTexture(),ft=rA.allocType(Ko,36);E.activeTexture(Js),E.bindTexture(gr,lt),E.texImage2D(Ri,0,Mt,3,3,0,Mt,Ko,ft),rA.freeType(ft),E.bindTexture(gr,null),E.deleteTexture(lt),Ye=!E.getError()}return{colorBits:[E.getParameter(no),E.getParameter(Ur),E.getParameter(Vo),E.getParameter(Pi)],depthBits:E.getParameter(Hr),stencilBits:E.getParameter(zr),subpixelBits:E.getParameter(On),extensions:Object.keys(Y).filter(function(rt){return!!Y[rt]}),maxAnisotropic:he,maxDrawbuffers:Se,maxColorAttachments:qe,pointSizeDims:E.getParameter(ai),lineWidthDims:E.getParameter(Ii),maxViewportDims:E.getParameter(Nn),maxCombinedTextureUnits:E.getParameter(Fi),maxCubeMapSize:E.getParameter(va),maxRenderbufferSize:E.getParameter(Tr),maxTextureUnits:E.getParameter(Qt),maxTextureSize:E.getParameter(ki),maxAttributes:E.getParameter(Li),maxVertexUniforms:E.getParameter(Zr),maxVertexTextureUnits:E.getParameter(tr),maxVaryingVectors:E.getParameter(ga),maxFragmentUniforms:E.getParameter(cn),glsl:E.getParameter(ut),renderer:E.getParameter(ge),vendor:E.getParameter(I),version:E.getParameter(je),readFloat:Fe,npotTextureCube:Ye}};function Dr(E){return!!E&&typeof E=="object"&&Array.isArray(E.shape)&&Array.isArray(E.stride)&&typeof E.offset=="number"&&E.shape.length===E.stride.length&&(Array.isArray(E.data)||o(E.data))}var _r=function(E){return Object.keys(E).map(function(Y){return E[Y]})},Oi={shape:nu,flatten:ru};function tl(E,Y,he){for(var Se=0;Se<Y;++Se)he[Se]=E[Se]}function Al(E,Y,he,Se){for(var qe=0,Fe=0;Fe<Y;++Fe)for(var Me=E[Fe],tt=0;tt<he;++tt)Se[qe++]=Me[tt]}function Jo(E,Y,he,Se,qe,Fe){for(var Me=Fe,tt=0;tt<Y;++tt)for(var At=E[tt],it=0;it<he;++it)for(var Ye=At[it],lt=0;lt<Se;++lt)qe[Me++]=Ye[lt]}function Zo(E,Y,he,Se,qe){for(var Fe=1,Me=he+1;Me<Y.length;++Me)Fe*=Y[Me];var tt=Y[he];if(Y.length-he===4){var At=Y[he+1],it=Y[he+2],Ye=Y[he+3];for(Me=0;Me<tt;++Me)Jo(E[Me],At,it,Ye,Se,qe),qe+=Fe}else for(Me=0;Me<tt;++Me)Zo(E[Me],Y,he+1,Se,qe),qe+=Fe}function ru(E,Y,he,Se){var qe=1;if(Y.length)for(var Fe=0;Fe<Y.length;++Fe)qe*=Y[Fe];else qe=0;var Me=Se||rA.allocType(he,qe);switch(Y.length){case 0:break;case 1:tl(E,Y[0],Me);break;case 2:Al(E,Y[0],Y[1],Me);break;case 3:Jo(E,Y[0],Y[1],Y[2],Me,0);break;default:Zo(E,Y,0,Me,0)}return Me}function nu(E){for(var Y=[],he=E;he.length;he=he[0])Y.push(he.length);return Y}var io={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},hn=5120,iu=5122,au=5124,ao=5121,ya=5123,ou=5125,su=5126,lu=5126,oi={int8:hn,int16:iu,int32:au,uint8:ao,uint16:ya,uint32:ou,float:su,float32:lu},es=35048,rl=35040,oo={dynamic:es,stream:rl,static:35044},so=Oi.flatten,ts=Oi.shape,Ea=35044,lo=35040,ba=5121,uo=5126,dn=[];dn[5120]=1,dn[5122]=2,dn[5124]=4,dn[5121]=1,dn[5123]=2,dn[5125]=4,dn[5126]=4;function si(E){return io[Object.prototype.toString.call(E)]|0}function nl(E,Y){for(var he=0;he<Y.length;++he)E[he]=Y[he]}function As(E,Y,he,Se,qe,Fe,Me){for(var tt=0,At=0;At<he;++At)for(var it=0;it<Se;++it)E[tt++]=Y[qe*At+Fe*it+Me]}function Wr(E,Y,he,Se){var qe=0,Fe={};function Me(e){this.id=qe++,this.buffer=E.createBuffer(),this.type=e,this.usage=Ea,this.byteLength=0,this.dimension=1,this.dtype=ba,this.persistentData=null,he.profile&&(this.stats={size:0})}Me.prototype.bind=function(){E.bindBuffer(this.type,this.buffer)},Me.prototype.destroy=function(){ft(this)};var tt=[];function At(e,t){var A=tt.pop();return A||(A=new Me(e)),A.bind(),lt(A,t,lo,0,1,!1),A}function it(e){tt.push(e)}function Ye(e,t,A){e.byteLength=t.byteLength,E.bufferData(e.type,t,A)}function lt(e,t,A,r,n,s){var u;if(e.usage=A,Array.isArray(t)){if(e.dtype=r||uo,t.length>0){var c;if(Array.isArray(t[0])){u=ts(t);for(var d=1,B=1;B<u.length;++B)d*=u[B];e.dimension=d,c=so(t,u,e.dtype),Ye(e,c,A),s?e.persistentData=c:rA.freeType(c)}else if(typeof t[0]=="number"){e.dimension=n;var R=rA.allocType(e.dtype,t.length);nl(R,t),Ye(e,R,A),s?e.persistentData=R:rA.freeType(R)}else o(t[0])?(e.dimension=t[0].length,e.dtype=r||si(t[0])||uo,c=so(t,[t.length,t[0].length],e.dtype),Ye(e,c,A),s?e.persistentData=c:rA.freeType(c)):re.raise("invalid buffer data")}}else if(o(t))e.dtype=r||si(t),e.dimension=n,Ye(e,t,A),s&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(Dr(t)){u=t.shape;var te=t.stride,se=t.offset,Ae=0,fe=0,ke=0,He=0;u.length===1?(Ae=u[0],fe=1,ke=te[0],He=0):u.length===2?(Ae=u[0],fe=u[1],ke=te[0],He=te[1]):re.raise("invalid shape"),e.dtype=r||si(t.data)||uo,e.dimension=fe;var Re=rA.allocType(e.dtype,Ae*fe);As(Re,t.data,Ae,fe,ke,He,se),Ye(e,Re,A),s?e.persistentData=Re:rA.freeType(Re)}else t instanceof ArrayBuffer?(e.dtype=ba,e.dimension=n,Ye(e,t,A),s&&(e.persistentData=new Uint8Array(new Uint8Array(t)))):re.raise("invalid buffer data")}function ft(e){Y.bufferCount--,Se(e);var t=e.buffer;re(t,"buffer must not be deleted already"),E.deleteBuffer(t),e.buffer=null,delete Fe[e.id]}function rt(e,t,A,r){Y.bufferCount++;var n=new Me(t);Fe[n.id]=n;function s(d){var B=Ea,R=null,te=0,se=0,Ae=1;return Array.isArray(d)||o(d)||Dr(d)||d instanceof ArrayBuffer?R=d:typeof d=="number"?te=d|0:d&&(re.type(d,"object","buffer arguments must be an object, a number or an array"),"data"in d&&(re(R===null||Array.isArray(R)||o(R)||Dr(R),"invalid data for buffer"),R=d.data),"usage"in d&&(re.parameter(d.usage,oo,"invalid buffer usage"),B=oo[d.usage]),"type"in d&&(re.parameter(d.type,oi,"invalid buffer type"),se=oi[d.type]),"dimension"in d&&(re.type(d.dimension,"number","invalid dimension"),Ae=d.dimension|0),"length"in d&&(re.nni(te,"buffer length must be a nonnegative integer"),te=d.length|0)),n.bind(),R?lt(n,R,B,se,Ae,r):(te&&E.bufferData(n.type,te,B),n.dtype=se||ba,n.usage=B,n.dimension=Ae,n.byteLength=te),he.profile&&(n.stats.size=n.byteLength*dn[n.dtype]),s}function u(d,B){re(B+d.byteLength<=n.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+d.byteLength+" starting from offset "+B+" to a buffer of size "+n.byteLength),E.bufferSubData(n.type,B,d)}function c(d,B){var R=(B||0)|0,te;if(n.bind(),o(d)||d instanceof ArrayBuffer)u(d,R);else if(Array.isArray(d)){if(d.length>0)if(typeof d[0]=="number"){var se=rA.allocType(n.dtype,d.length);nl(se,d),u(se,R),rA.freeType(se)}else if(Array.isArray(d[0])||o(d[0])){te=ts(d);var Ae=so(d,te,n.dtype);u(Ae,R),rA.freeType(Ae)}else re.raise("invalid buffer data")}else if(Dr(d)){te=d.shape;var fe=d.stride,ke=0,He=0,Re=0,Je=0;te.length===1?(ke=te[0],He=1,Re=fe[0],Je=0):te.length===2?(ke=te[0],He=te[1],Re=fe[0],Je=fe[1]):re.raise("invalid shape");var $e=Array.isArray(d.data)?n.dtype:si(d.data),et=rA.allocType($e,ke*He);As(et,d.data,ke,He,Re,Je,d.offset),u(et,R),rA.freeType(et)}else re.raise("invalid data for buffer subdata");return s}return A||s(e),s._reglType="buffer",s._buffer=n,s.subdata=c,he.profile&&(s.stats=n.stats),s.destroy=function(){ft(n)},s}function ot(){_r(Fe).forEach(function(e){e.buffer=E.createBuffer(),E.bindBuffer(e.type,e.buffer),E.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})}return he.profile&&(Y.getTotalBufferSize=function(){var e=0;return Object.keys(Fe).forEach(function(t){e+=Fe[t].stats.size}),e}),{create:rt,createStream:At,destroyStream:it,clear:function(){_r(Fe).forEach(ft),tt.forEach(ft)},getBuffer:function(e){return e&&e._buffer instanceof Me?e._buffer:null},restore:ot,_initBuffer:lt}}var uu=0,fu=0,rs=1,il=1,Gn=4,ns=4,Sr={points:uu,point:fu,lines:rs,line:il,triangles:Gn,triangle:ns,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},fo=0,is=1,tn=4,cu=5120,Ni=5121,al=5122,Gi=5123,as=5124,Un=5125,os=34963,hu=35040,du=35044;function pu(E,Y,he,Se){var qe={},Fe=0,Me={uint8:Ni,uint16:Gi};Y.oes_element_index_uint&&(Me.uint32=Un);function tt(ot){this.id=Fe++,qe[this.id]=this,this.buffer=ot,this.primType=tn,this.vertCount=0,this.type=0}tt.prototype.bind=function(){this.buffer.bind()};var At=[];function it(ot){var e=At.pop();return e||(e=new tt(he.create(null,os,!0,!1)._buffer)),lt(e,ot,hu,-1,-1,0,0),e}function Ye(ot){At.push(ot)}function lt(ot,e,t,A,r,n,s){ot.buffer.bind();var u;if(e){var c=s;!s&&(!o(e)||Dr(e)&&!o(e.data))&&(c=Y.oes_element_index_uint?Un:Gi),he._initBuffer(ot.buffer,e,t,c,3)}else E.bufferData(os,n,t),ot.buffer.dtype=u||Ni,ot.buffer.usage=t,ot.buffer.dimension=3,ot.buffer.byteLength=n;if(u=s,!s){switch(ot.buffer.dtype){case Ni:case cu:u=Ni;break;case Gi:case al:u=Gi;break;case Un:case as:u=Un;break;default:re.raise("unsupported type for element array")}ot.buffer.dtype=u}ot.type=u,re(u!==Un||!!Y.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var d=r;d<0&&(d=ot.buffer.byteLength,u===Gi?d>>=1:u===Un&&(d>>=2)),ot.vertCount=d;var B=A;if(A<0){B=tn;var R=ot.buffer.dimension;R===1&&(B=fo),R===2&&(B=is),R===3&&(B=tn)}ot.primType=B}function ft(ot){Se.elementsCount--,re(ot.buffer!==null,"must not double destroy elements"),delete qe[ot.id],ot.buffer.destroy(),ot.buffer=null}function rt(ot,e){var t=he.create(null,os,!0),A=new tt(t._buffer);Se.elementsCount++;function r(n){if(!n)t(),A.primType=tn,A.vertCount=0,A.type=Ni;else if(typeof n=="number")t(n),A.primType=tn,A.vertCount=n|0,A.type=Ni;else{var s=null,u=du,c=-1,d=-1,B=0,R=0;Array.isArray(n)||o(n)||Dr(n)?s=n:(re.type(n,"object","invalid arguments for elements"),"data"in n&&(s=n.data,re(Array.isArray(s)||o(s)||Dr(s),"invalid data for element buffer")),"usage"in n&&(re.parameter(n.usage,oo,"invalid element buffer usage"),u=oo[n.usage]),"primitive"in n&&(re.parameter(n.primitive,Sr,"invalid element buffer primitive"),c=Sr[n.primitive]),"count"in n&&(re(typeof n.count=="number"&&n.count>=0,"invalid vertex count for elements"),d=n.count|0),"type"in n&&(re.parameter(n.type,Me,"invalid buffer type"),R=Me[n.type]),"length"in n?B=n.length|0:(B=d,R===Gi||R===al?B*=2:(R===Un||R===as)&&(B*=4))),lt(A,s,u,c,d,B,R)}return r}return r(ot),r._reglType="elements",r._elements=A,r.subdata=function(n,s){return t.subdata(n,s),r},r.destroy=function(){ft(A)},r}return{create:rt,createStream:it,destroyStream:Ye,getElements:function(ot){return typeof ot=="function"&&ot._elements instanceof tt?ot._elements:null},clear:function(){_r(qe).forEach(ft)}}}var ss=new Float32Array(1),gu=new Uint32Array(ss.buffer),ol=5123;function xa(E){for(var Y=rA.allocType(ol,E.length),he=0;he<E.length;++he)if(isNaN(E[he]))Y[he]=65535;else if(E[he]===1/0)Y[he]=31744;else if(E[he]===-1/0)Y[he]=64512;else{ss[0]=E[he];var Se=gu[0],qe=Se>>>31<<15,Fe=(Se<<1>>>24)-127,Me=Se>>13&1023;if(Fe<-24)Y[he]=qe;else if(Fe<-14){var tt=-14-Fe;Y[he]=qe+(Me+1024>>tt)}else Fe>15?Y[he]=qe+31744:Y[he]=qe+(Fe+15<<10)+Me}return Y}function qA(E){return Array.isArray(E)||o(E)}var sl=function(E){return!(E&E-1)&&!!E},vu=34467,An=3553,li=34067,rr=34069,ui=6408,co=6406,Hn=6407,Ba=6409,Ca=6410,ll=32854,wa=32855,ls=36194,mu=32819,yu=32820,ul=33635,fl=34042,us=6402,zn=34041,qr=35904,Ui=35906,Wn=36193,ho=33776,Fr=33777,pn=33778,_a=33779,cl=35986,fs=35987,hl=34798,cs=35840,po=35841,fi=35842,$r=35843,hs=36196,ci=5121,ds=5123,ps=5125,Sa=5126,dl=10242,pl=10243,Qa=10497,go=33071,gl=33648,gs=10240,vo=10241,mo=9728,yo=9729,Pr=9984,vs=9985,Eo=9986,Ta=9987,vl=33170,Da=4352,ms=4353,Eu=4354,bu=34046,xu=3317,hi=37440,Hi=37441,zi=37443,bo=37444,di=33984,ml=[Pr,Eo,vs,Ta],Wi=[0,Ba,Ca,Hn,ui],cr={};cr[Ba]=cr[co]=cr[us]=1,cr[zn]=cr[Ca]=2,cr[Hn]=cr[qr]=3,cr[ui]=cr[Ui]=4;function Rr(E){return"[object "+E+"]"}var vr=Rr("HTMLCanvasElement"),gn=Rr("OffscreenCanvas"),vn=Rr("CanvasRenderingContext2D"),Pa=Rr("ImageBitmap"),yl=Rr("HTMLImageElement"),ys=Rr("HTMLVideoElement"),Ia=Object.keys(io).concat([vr,gn,vn,Pa,yl,ys]),pi=[];pi[ci]=1,pi[Sa]=4,pi[Wn]=2,pi[ds]=2,pi[ps]=4;var or=[];or[ll]=2,or[wa]=2,or[ls]=2,or[zn]=4,or[ho]=.5,or[Fr]=.5,or[pn]=1,or[_a]=1,or[cl]=.5,or[fs]=1,or[hl]=1,or[cs]=.5,or[po]=.25,or[fi]=.5,or[$r]=.25,or[hs]=.5;function ka(E){return Array.isArray(E)&&(E.length===0||typeof E[0]=="number")}function El(E){if(!Array.isArray(E))return!1;var Y=E.length;return!(Y===0||!qA(E[0]))}function mn(E){return Object.prototype.toString.call(E)}function Es(E){return mn(E)===vr}function xo(E){return mn(E)===gn}function bs(E){return mn(E)===vn}function qi(E){return mn(E)===Pa}function Bo(E){return mn(E)===yl}function bl(E){return mn(E)===ys}function $i(E){if(!E)return!1;var Y=mn(E);return Ia.indexOf(Y)>=0?!0:ka(E)||El(E)||Dr(E)}function xl(E){return io[Object.prototype.toString.call(E)]|0}function Bu(E,Y){var he=Y.length;switch(E.type){case ci:case ds:case ps:case Sa:var Se=rA.allocType(E.type,he);Se.set(Y),E.data=Se;break;case Wn:E.data=xa(Y);break;default:re.raise("unsupported texture type, must specify a typed array")}}function Bl(E,Y){return rA.allocType(E.type===Wn?Sa:E.type,Y)}function Co(E,Y){E.type===Wn?(E.data=xa(Y),rA.freeType(Y)):E.data=Y}function xs(E,Y,he,Se,qe,Fe){for(var Me=E.width,tt=E.height,At=E.channels,it=Me*tt*At,Ye=Bl(E,it),lt=0,ft=0;ft<tt;++ft)for(var rt=0;rt<Me;++rt)for(var ot=0;ot<At;++ot)Ye[lt++]=Y[he*rt+Se*ft+qe*ot+Fe];Co(E,Ye)}function yn(E,Y,he,Se,qe,Fe){var Me;if(typeof or[E]<"u"?Me=or[E]:Me=cr[E]*pi[Y],Fe&&(Me*=6),qe){for(var tt=0,At=he;At>=1;)tt+=Me*At*At,At/=2;return tt}else return Me*he*Se}function La(E,Y,he,Se,qe,Fe,Me){var tt={"don't care":Da,"dont care":Da,nice:Eu,fast:ms},At={repeat:Qa,clamp:go,mirror:gl},it={nearest:mo,linear:yo},Ye=l({mipmap:Ta,"nearest mipmap nearest":Pr,"linear mipmap nearest":vs,"nearest mipmap linear":Eo,"linear mipmap linear":Ta},it),lt={none:0,browser:bo},ft={uint8:ci,rgba4:mu,rgb565:ul,"rgb5 a1":yu},rt={alpha:co,luminance:Ba,"luminance alpha":Ca,rgb:Hn,rgba:ui,rgba4:ll,"rgb5 a1":wa,rgb565:ls},ot={};Y.ext_srgb&&(rt.srgb=qr,rt.srgba=Ui),Y.oes_texture_float&&(ft.float32=ft.float=Sa),Y.oes_texture_half_float&&(ft.float16=ft["half float"]=Wn),Y.webgl_depth_texture&&(l(rt,{depth:us,"depth stencil":zn}),l(ft,{uint16:ds,uint32:ps,"depth stencil":fl})),Y.webgl_compressed_texture_s3tc&&l(ot,{"rgb s3tc dxt1":ho,"rgba s3tc dxt1":Fr,"rgba s3tc dxt3":pn,"rgba s3tc dxt5":_a}),Y.webgl_compressed_texture_atc&&l(ot,{"rgb atc":cl,"rgba atc explicit alpha":fs,"rgba atc interpolated alpha":hl}),Y.webgl_compressed_texture_pvrtc&&l(ot,{"rgb pvrtc 4bppv1":cs,"rgb pvrtc 2bppv1":po,"rgba pvrtc 4bppv1":fi,"rgba pvrtc 2bppv1":$r}),Y.webgl_compressed_texture_etc1&&(ot["rgb etc1"]=hs);var e=Array.prototype.slice.call(E.getParameter(vu));Object.keys(ot).forEach(function(ae){var Le=ot[ae];e.indexOf(Le)>=0&&(rt[ae]=Le)});var t=Object.keys(rt);he.textureFormats=t;var A=[];Object.keys(rt).forEach(function(ae){var Le=rt[ae];A[Le]=ae});var r=[];Object.keys(ft).forEach(function(ae){var Le=ft[ae];r[Le]=ae});var n=[];Object.keys(it).forEach(function(ae){var Le=it[ae];n[Le]=ae});var s=[];Object.keys(Ye).forEach(function(ae){var Le=Ye[ae];s[Le]=ae});var u=[];Object.keys(At).forEach(function(ae){var Le=At[ae];u[Le]=ae});var c=t.reduce(function(ae,Le){var Pe=rt[Le];return Pe===Ba||Pe===co||Pe===Ba||Pe===Ca||Pe===us||Pe===zn||Y.ext_srgb&&(Pe===qr||Pe===Ui)?ae[Pe]=Pe:Pe===wa||Le.indexOf("rgba")>=0?ae[Pe]=ui:ae[Pe]=Hn,ae},{});function d(){this.internalformat=ui,this.format=ui,this.type=ci,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=bo,this.width=0,this.height=0,this.channels=0}function B(ae,Le){ae.internalformat=Le.internalformat,ae.format=Le.format,ae.type=Le.type,ae.compressed=Le.compressed,ae.premultiplyAlpha=Le.premultiplyAlpha,ae.flipY=Le.flipY,ae.unpackAlignment=Le.unpackAlignment,ae.colorSpace=Le.colorSpace,ae.width=Le.width,ae.height=Le.height,ae.channels=Le.channels}function R(ae,Le){if(!(typeof Le!="object"||!Le)){if("premultiplyAlpha"in Le&&(re.type(Le.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),ae.premultiplyAlpha=Le.premultiplyAlpha),"flipY"in Le&&(re.type(Le.flipY,"boolean","invalid texture flip"),ae.flipY=Le.flipY),"alignment"in Le&&(re.oneOf(Le.alignment,[1,2,4,8],"invalid texture unpack alignment"),ae.unpackAlignment=Le.alignment),"colorSpace"in Le&&(re.parameter(Le.colorSpace,lt,"invalid colorSpace"),ae.colorSpace=lt[Le.colorSpace]),"type"in Le){var Pe=Le.type;re(Y.oes_texture_float||!(Pe==="float"||Pe==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),re(Y.oes_texture_half_float||!(Pe==="half float"||Pe==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),re(Y.webgl_depth_texture||!(Pe==="uint16"||Pe==="uint32"||Pe==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),re.parameter(Pe,ft,"invalid texture type"),ae.type=ft[Pe]}var ct=ae.width,Nt=ae.height,ne=ae.channels,M=!1;"shape"in Le?(re(Array.isArray(Le.shape)&&Le.shape.length>=2,"shape must be an array"),ct=Le.shape[0],Nt=Le.shape[1],Le.shape.length===3&&(ne=Le.shape[2],re(ne>0&&ne<=4,"invalid number of channels"),M=!0),re(ct>=0&&ct<=he.maxTextureSize,"invalid width"),re(Nt>=0&&Nt<=he.maxTextureSize,"invalid height")):("radius"in Le&&(ct=Nt=Le.radius,re(ct>=0&&ct<=he.maxTextureSize,"invalid radius")),"width"in Le&&(ct=Le.width,re(ct>=0&&ct<=he.maxTextureSize,"invalid width")),"height"in Le&&(Nt=Le.height,re(Nt>=0&&Nt<=he.maxTextureSize,"invalid height")),"channels"in Le&&(ne=Le.channels,re(ne>0&&ne<=4,"invalid number of channels"),M=!0)),ae.width=ct|0,ae.height=Nt|0,ae.channels=ne|0;var me=!1;if("format"in Le){var Qe=Le.format;re(Y.webgl_depth_texture||!(Qe==="depth"||Qe==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),re.parameter(Qe,rt,"invalid texture format");var De=ae.internalformat=rt[Qe];ae.format=c[De],Qe in ft&&("type"in Le||(ae.type=ft[Qe])),Qe in ot&&(ae.compressed=!0),me=!0}!M&&me?ae.channels=cr[ae.format]:M&&!me?ae.channels!==Wi[ae.format]&&(ae.format=ae.internalformat=Wi[ae.channels]):me&&M&&re(ae.channels===cr[ae.format],"number of channels inconsistent with specified format")}}function te(ae){E.pixelStorei(hi,ae.flipY),E.pixelStorei(Hi,ae.premultiplyAlpha),E.pixelStorei(zi,ae.colorSpace),E.pixelStorei(xu,ae.unpackAlignment)}function se(){d.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Ae(ae,Le){var Pe=null;if($i(Le)?Pe=Le:Le&&(re.type(Le,"object","invalid pixel data type"),R(ae,Le),"x"in Le&&(ae.xOffset=Le.x|0),"y"in Le&&(ae.yOffset=Le.y|0),$i(Le.data)&&(Pe=Le.data)),re(!ae.compressed||Pe instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Le.copy){re(!Pe,"can not specify copy and data field for the same texture");var ct=qe.viewportWidth,Nt=qe.viewportHeight;ae.width=ae.width||ct-ae.xOffset,ae.height=ae.height||Nt-ae.yOffset,ae.needsCopy=!0,re(ae.xOffset>=0&&ae.xOffset<ct&&ae.yOffset>=0&&ae.yOffset<Nt&&ae.width>0&&ae.width<=ct&&ae.height>0&&ae.height<=Nt,"copy texture read out of bounds")}else if(!Pe)ae.width=ae.width||1,ae.height=ae.height||1,ae.channels=ae.channels||4;else if(o(Pe))ae.channels=ae.channels||4,ae.data=Pe,!("type"in Le)&&ae.type===ci&&(ae.type=xl(Pe));else if(ka(Pe))ae.channels=ae.channels||4,Bu(ae,Pe),ae.alignment=1,ae.needsFree=!0;else if(Dr(Pe)){var ne=Pe.data;!Array.isArray(ne)&&ae.type===ci&&(ae.type=xl(ne));var M=Pe.shape,me=Pe.stride,Qe,De,be,ye,Ce,ie;M.length===3?(be=M[2],ie=me[2]):(re(M.length===2,"invalid ndarray pixel data, must be 2 or 3D"),be=1,ie=1),Qe=M[0],De=M[1],ye=me[0],Ce=me[1],ae.alignment=1,ae.width=Qe,ae.height=De,ae.channels=be,ae.format=ae.internalformat=Wi[be],ae.needsFree=!0,xs(ae,ne,ye,Ce,ie,Pe.offset)}else if(Es(Pe)||xo(Pe)||bs(Pe))Es(Pe)||xo(Pe)?ae.element=Pe:ae.element=Pe.canvas,ae.width=ae.element.width,ae.height=ae.element.height,ae.channels=4;else if(qi(Pe))ae.element=Pe,ae.width=Pe.width,ae.height=Pe.height,ae.channels=4;else if(Bo(Pe))ae.element=Pe,ae.width=Pe.naturalWidth,ae.height=Pe.naturalHeight,ae.channels=4;else if(bl(Pe))ae.element=Pe,ae.width=Pe.videoWidth,ae.height=Pe.videoHeight,ae.channels=4;else if(El(Pe)){var ve=ae.width||Pe[0].length,ee=ae.height||Pe.length,_e=ae.channels;qA(Pe[0][0])?_e=_e||Pe[0][0].length:_e=_e||1;for(var Ie=Oi.shape(Pe),We=1,Xe=0;Xe<Ie.length;++Xe)We*=Ie[Xe];var Ue=Bl(ae,We);Oi.flatten(Pe,Ie,"",Ue),Co(ae,Ue),ae.alignment=1,ae.width=ve,ae.height=ee,ae.channels=_e,ae.format=ae.internalformat=Wi[_e],ae.needsFree=!0}ae.type===Sa?re(he.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):ae.type===Wn&&re(he.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function fe(ae,Le,Pe){var ct=ae.element,Nt=ae.data,ne=ae.internalformat,M=ae.format,me=ae.type,Qe=ae.width,De=ae.height;te(ae),ct?E.texImage2D(Le,Pe,M,M,me,ct):ae.compressed?E.compressedTexImage2D(Le,Pe,ne,Qe,De,0,Nt):ae.needsCopy?(Se(),E.copyTexImage2D(Le,Pe,M,ae.xOffset,ae.yOffset,Qe,De,0)):E.texImage2D(Le,Pe,M,Qe,De,0,M,me,Nt||null)}function ke(ae,Le,Pe,ct,Nt){var ne=ae.element,M=ae.data,me=ae.internalformat,Qe=ae.format,De=ae.type,be=ae.width,ye=ae.height;te(ae),ne?E.texSubImage2D(Le,Nt,Pe,ct,Qe,De,ne):ae.compressed?E.compressedTexSubImage2D(Le,Nt,Pe,ct,me,be,ye,M):ae.needsCopy?(Se(),E.copyTexSubImage2D(Le,Nt,Pe,ct,ae.xOffset,ae.yOffset,be,ye)):E.texSubImage2D(Le,Nt,Pe,ct,be,ye,Qe,De,M)}var He=[];function Re(){return He.pop()||new se}function Je(ae){ae.needsFree&&rA.freeType(ae.data),se.call(ae),He.push(ae)}function $e(){d.call(this),this.genMipmaps=!1,this.mipmapHint=Da,this.mipmask=0,this.images=Array(16)}function et(ae,Le,Pe){var ct=ae.images[0]=Re();ae.mipmask=1,ct.width=ae.width=Le,ct.height=ae.height=Pe,ct.channels=ae.channels=4}function ht(ae,Le){var Pe=null;if($i(Le))Pe=ae.images[0]=Re(),B(Pe,ae),Ae(Pe,Le),ae.mipmask=1;else if(R(ae,Le),Array.isArray(Le.mipmap))for(var ct=Le.mipmap,Nt=0;Nt<ct.length;++Nt)Pe=ae.images[Nt]=Re(),B(Pe,ae),Pe.width>>=Nt,Pe.height>>=Nt,Ae(Pe,ct[Nt]),ae.mipmask|=1<<Nt;else Pe=ae.images[0]=Re(),B(Pe,ae),Ae(Pe,Le),ae.mipmask=1;B(ae,ae.images[0]),ae.compressed&&(ae.internalformat===ho||ae.internalformat===Fr||ae.internalformat===pn||ae.internalformat===_a)&&re(ae.width%4===0&&ae.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function mt(ae,Le){for(var Pe=ae.images,ct=0;ct<Pe.length;++ct){if(!Pe[ct])return;fe(Pe[ct],Le,ct)}}var Pt=[];function xt(){var ae=Pt.pop()||new $e;d.call(ae),ae.mipmask=0;for(var Le=0;Le<16;++Le)ae.images[Le]=null;return ae}function Vt(ae){for(var Le=ae.images,Pe=0;Pe<Le.length;++Pe)Le[Pe]&&Je(Le[Pe]),Le[Pe]=null;Pt.push(ae)}function Ot(){this.minFilter=mo,this.magFilter=mo,this.wrapS=go,this.wrapT=go,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Da}function Zt(ae,Le){if("min"in Le){var Pe=Le.min;re.parameter(Pe,Ye),ae.minFilter=Ye[Pe],ml.indexOf(ae.minFilter)>=0&&!("faces"in Le)&&(ae.genMipmaps=!0)}if("mag"in Le){var ct=Le.mag;re.parameter(ct,it),ae.magFilter=it[ct]}var Nt=ae.wrapS,ne=ae.wrapT;if("wrap"in Le){var M=Le.wrap;typeof M=="string"?(re.parameter(M,At),Nt=ne=At[M]):Array.isArray(M)&&(re.parameter(M[0],At),re.parameter(M[1],At),Nt=At[M[0]],ne=At[M[1]])}else{if("wrapS"in Le){var me=Le.wrapS;re.parameter(me,At),Nt=At[me]}if("wrapT"in Le){var Qe=Le.wrapT;re.parameter(Qe,At),ne=At[Qe]}}if(ae.wrapS=Nt,ae.wrapT=ne,"anisotropic"in Le){var De=Le.anisotropic;re(typeof De=="number"&&De>=1&&De<=he.maxAnisotropic,"aniso samples must be between 1 and "),ae.anisotropic=Le.anisotropic}if("mipmap"in Le){var be=!1;switch(typeof Le.mipmap){case"string":re.parameter(Le.mipmap,tt,"invalid mipmap hint"),ae.mipmapHint=tt[Le.mipmap],ae.genMipmaps=!0,be=!0;break;case"boolean":be=ae.genMipmaps=Le.mipmap;break;case"object":re(Array.isArray(Le.mipmap),"invalid mipmap type"),ae.genMipmaps=!1,be=!0;break;default:re.raise("invalid mipmap type")}be&&!("min"in Le)&&(ae.minFilter=Pr)}}function eA(ae,Le){E.texParameteri(Le,vo,ae.minFilter),E.texParameteri(Le,gs,ae.magFilter),E.texParameteri(Le,dl,ae.wrapS),E.texParameteri(Le,pl,ae.wrapT),Y.ext_texture_filter_anisotropic&&E.texParameteri(Le,bu,ae.anisotropic),ae.genMipmaps&&(E.hint(vl,ae.mipmapHint),E.generateMipmap(Le))}var $t=0,LA={},tA=he.maxTextureUnits,zt=Array(tA).map(function(){return null});function Bt(ae){d.call(this),this.mipmask=0,this.internalformat=ui,this.id=$t++,this.refCount=1,this.target=ae,this.texture=E.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ot,Me.profile&&(this.stats={size:0})}function Yt(ae){E.activeTexture(di),E.bindTexture(ae.target,ae.texture)}function Ut(){var ae=zt[0];ae?E.bindTexture(ae.target,ae.texture):E.bindTexture(An,null)}function _t(ae){var Le=ae.texture;re(Le,"must not double destroy texture");var Pe=ae.unit,ct=ae.target;Pe>=0&&(E.activeTexture(di+Pe),E.bindTexture(ct,null),zt[Pe]=null),E.deleteTexture(Le),ae.texture=null,ae.params=null,ae.pixels=null,ae.refCount=0,delete LA[ae.id],Fe.textureCount--}l(Bt.prototype,{bind:function(){var ae=this;ae.bindCount+=1;var Le=ae.unit;if(Le<0){for(var Pe=0;Pe<tA;++Pe){var ct=zt[Pe];if(ct){if(ct.bindCount>0)continue;ct.unit=-1}zt[Pe]=ae,Le=Pe;break}Le>=tA&&re.raise("insufficient number of texture units"),Me.profile&&Fe.maxTextureUnits<Le+1&&(Fe.maxTextureUnits=Le+1),ae.unit=Le,E.activeTexture(di+Le),E.bindTexture(ae.target,ae.texture)}return Le},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&_t(this)}});function Rt(ae,Le){var Pe=new Bt(An);LA[Pe.id]=Pe,Fe.textureCount++;function ct(M,me){var Qe=Pe.texInfo;Ot.call(Qe);var De=xt();return typeof M=="number"?typeof me=="number"?et(De,M|0,me|0):et(De,M|0,M|0):M?(re.type(M,"object","invalid arguments to regl.texture"),Zt(Qe,M),ht(De,M)):et(De,1,1),Qe.genMipmaps&&(De.mipmask=(De.width<<1)-1),Pe.mipmask=De.mipmask,B(Pe,De),re.texture2D(Qe,De,he),Pe.internalformat=De.internalformat,ct.width=De.width,ct.height=De.height,Yt(Pe),mt(De,An),eA(Qe,An),Ut(),Vt(De),Me.profile&&(Pe.stats.size=yn(Pe.internalformat,Pe.type,De.width,De.height,Qe.genMipmaps,!1)),ct.format=A[Pe.internalformat],ct.type=r[Pe.type],ct.mag=n[Qe.magFilter],ct.min=s[Qe.minFilter],ct.wrapS=u[Qe.wrapS],ct.wrapT=u[Qe.wrapT],ct}function Nt(M,me,Qe,De){re(!!M,"must specify image data");var be=me|0,ye=Qe|0,Ce=De|0,ie=Re();return B(ie,Pe),ie.width=0,ie.height=0,Ae(ie,M),ie.width=ie.width||(Pe.width>>Ce)-be,ie.height=ie.height||(Pe.height>>Ce)-ye,re(Pe.type===ie.type&&Pe.format===ie.format&&Pe.internalformat===ie.internalformat,"incompatible format for texture.subimage"),re(be>=0&&ye>=0&&be+ie.width<=Pe.width&&ye+ie.height<=Pe.height,"texture.subimage write out of bounds"),re(Pe.mipmask&1<<Ce,"missing mipmap data"),re(ie.data||ie.element||ie.needsCopy,"missing image data"),Yt(Pe),ke(ie,An,be,ye,Ce),Ut(),Je(ie),ct}function ne(M,me){var Qe=M|0,De=me|0||Qe;if(Qe===Pe.width&&De===Pe.height)return ct;ct.width=Pe.width=Qe,ct.height=Pe.height=De,Yt(Pe);for(var be=0;Pe.mipmask>>be;++be){var ye=Qe>>be,Ce=De>>be;if(!ye||!Ce)break;E.texImage2D(An,be,Pe.format,ye,Ce,0,Pe.format,Pe.type,null)}return Ut(),Me.profile&&(Pe.stats.size=yn(Pe.internalformat,Pe.type,Qe,De,!1,!1)),ct}return ct(ae,Le),ct.subimage=Nt,ct.resize=ne,ct._reglType="texture2d",ct._texture=Pe,Me.profile&&(ct.stats=Pe.stats),ct.destroy=function(){Pe.decRef()},ct}function Ft(ae,Le,Pe,ct,Nt,ne){var M=new Bt(li);LA[M.id]=M,Fe.cubeCount++;var me=new Array(6);function Qe(ye,Ce,ie,ve,ee,_e){var Ie,We=M.texInfo;for(Ot.call(We),Ie=0;Ie<6;++Ie)me[Ie]=xt();if(typeof ye=="number"||!ye){var Xe=ye|0||1;for(Ie=0;Ie<6;++Ie)et(me[Ie],Xe,Xe)}else if(typeof ye=="object")if(Ce)ht(me[0],ye),ht(me[1],Ce),ht(me[2],ie),ht(me[3],ve),ht(me[4],ee),ht(me[5],_e);else if(Zt(We,ye),R(M,ye),"faces"in ye){var Ue=ye.faces;for(re(Array.isArray(Ue)&&Ue.length===6,"cube faces must be a length 6 array"),Ie=0;Ie<6;++Ie)re(typeof Ue[Ie]=="object"&&!!Ue[Ie],"invalid input for cube map face"),B(me[Ie],M),ht(me[Ie],Ue[Ie])}else for(Ie=0;Ie<6;++Ie)ht(me[Ie],ye);else re.raise("invalid arguments to cube map");for(B(M,me[0]),he.npotTextureCube||re(sl(M.width)&&sl(M.height),"your browser does not support non power or two texture dimensions"),We.genMipmaps?M.mipmask=(me[0].width<<1)-1:M.mipmask=me[0].mipmask,re.textureCube(M,We,me,he),M.internalformat=me[0].internalformat,Qe.width=me[0].width,Qe.height=me[0].height,Yt(M),Ie=0;Ie<6;++Ie)mt(me[Ie],rr+Ie);for(eA(We,li),Ut(),Me.profile&&(M.stats.size=yn(M.internalformat,M.type,Qe.width,Qe.height,We.genMipmaps,!0)),Qe.format=A[M.internalformat],Qe.type=r[M.type],Qe.mag=n[We.magFilter],Qe.min=s[We.minFilter],Qe.wrapS=u[We.wrapS],Qe.wrapT=u[We.wrapT],Ie=0;Ie<6;++Ie)Vt(me[Ie]);return Qe}function De(ye,Ce,ie,ve,ee){re(!!Ce,"must specify image data"),re(typeof ye=="number"&&ye===(ye|0)&&ye>=0&&ye<6,"invalid face");var _e=ie|0,Ie=ve|0,We=ee|0,Xe=Re();return B(Xe,M),Xe.width=0,Xe.height=0,Ae(Xe,Ce),Xe.width=Xe.width||(M.width>>We)-_e,Xe.height=Xe.height||(M.height>>We)-Ie,re(M.type===Xe.type&&M.format===Xe.format&&M.internalformat===Xe.internalformat,"incompatible format for texture.subimage"),re(_e>=0&&Ie>=0&&_e+Xe.width<=M.width&&Ie+Xe.height<=M.height,"texture.subimage write out of bounds"),re(M.mipmask&1<<We,"missing mipmap data"),re(Xe.data||Xe.element||Xe.needsCopy,"missing image data"),Yt(M),ke(Xe,rr+ye,_e,Ie,We),Ut(),Je(Xe),Qe}function be(ye){var Ce=ye|0;if(Ce!==M.width){Qe.width=M.width=Ce,Qe.height=M.height=Ce,Yt(M);for(var ie=0;ie<6;++ie)for(var ve=0;M.mipmask>>ve;++ve)E.texImage2D(rr+ie,ve,M.format,Ce>>ve,Ce>>ve,0,M.format,M.type,null);return Ut(),Me.profile&&(M.stats.size=yn(M.internalformat,M.type,Qe.width,Qe.height,!1,!0)),Qe}}return Qe(ae,Le,Pe,ct,Nt,ne),Qe.subimage=De,Qe.resize=be,Qe._reglType="textureCube",Qe._texture=M,Me.profile&&(Qe.stats=M.stats),Qe.destroy=function(){M.decRef()},Qe}function zA(){for(var ae=0;ae<tA;++ae)E.activeTexture(di+ae),E.bindTexture(An,null),zt[ae]=null;_r(LA).forEach(_t),Fe.cubeCount=0,Fe.textureCount=0}Me.profile&&(Fe.getTotalTextureSize=function(){var ae=0;return Object.keys(LA).forEach(function(Le){ae+=LA[Le].stats.size}),ae});function $A(){for(var ae=0;ae<tA;++ae){var Le=zt[ae];Le&&(Le.bindCount=0,Le.unit=-1,zt[ae]=null)}_r(LA).forEach(function(Pe){Pe.texture=E.createTexture(),E.bindTexture(Pe.target,Pe.texture);for(var ct=0;ct<32;++ct)if((Pe.mipmask&1<<ct)!==0)if(Pe.target===An)E.texImage2D(An,ct,Pe.internalformat,Pe.width>>ct,Pe.height>>ct,0,Pe.internalformat,Pe.type,null);else for(var Nt=0;Nt<6;++Nt)E.texImage2D(rr+Nt,ct,Pe.internalformat,Pe.width>>ct,Pe.height>>ct,0,Pe.internalformat,Pe.type,null);eA(Pe.texInfo,Pe.target)})}function kn(){for(var ae=0;ae<tA;++ae){var Le=zt[ae];Le&&(Le.bindCount=0,Le.unit=-1,zt[ae]=null),E.activeTexture(di+ae),E.bindTexture(An,null),E.bindTexture(li,null)}}return{create2D:Rt,createCube:Ft,clear:zA,getTexture:function(ae){return null},restore:$A,refresh:kn}}var qn=36161,gi=32854,Bs=32855,Yi=36194,Cs=33189,$n=36168,Xi=34041,Yn=35907,Vi=34836,vi=34842,ws=34843,Mr=[];Mr[gi]=2,Mr[Bs]=2,Mr[Yi]=2,Mr[Cs]=2,Mr[$n]=1,Mr[Xi]=4,Mr[Yn]=4,Mr[Vi]=16,Mr[vi]=8,Mr[ws]=6;function _s(E,Y,he){return Mr[E]*Y*he}var Cu=function(E,Y,he,Se,qe){var Fe={rgba4:gi,rgb565:Yi,"rgb5 a1":Bs,depth:Cs,stencil:$n,"depth stencil":Xi};Y.ext_srgb&&(Fe.srgba=Yn),Y.ext_color_buffer_half_float&&(Fe.rgba16f=vi,Fe.rgb16f=ws),Y.webgl_color_buffer_float&&(Fe.rgba32f=Vi);var Me=[];Object.keys(Fe).forEach(function(rt){var ot=Fe[rt];Me[ot]=rt});var tt=0,At={};function it(rt){this.id=tt++,this.refCount=1,this.renderbuffer=rt,this.format=gi,this.width=0,this.height=0,qe.profile&&(this.stats={size:0})}it.prototype.decRef=function(){--this.refCount<=0&&Ye(this)};function Ye(rt){var ot=rt.renderbuffer;re(ot,"must not double destroy renderbuffer"),E.bindRenderbuffer(qn,null),E.deleteRenderbuffer(ot),rt.renderbuffer=null,rt.refCount=0,delete At[rt.id],Se.renderbufferCount--}function lt(rt,ot){var e=new it(E.createRenderbuffer());At[e.id]=e,Se.renderbufferCount++;function t(r,n){var s=0,u=0,c=gi;if(typeof r=="object"&&r){var d=r;if("shape"in d){var B=d.shape;re(Array.isArray(B)&&B.length>=2,"invalid renderbuffer shape"),s=B[0]|0,u=B[1]|0}else"radius"in d&&(s=u=d.radius|0),"width"in d&&(s=d.width|0),"height"in d&&(u=d.height|0);"format"in d&&(re.parameter(d.format,Fe,"invalid renderbuffer format"),c=Fe[d.format])}else typeof r=="number"?(s=r|0,typeof n=="number"?u=n|0:u=s):r?re.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(re(s>0&&u>0&&s<=he.maxRenderbufferSize&&u<=he.maxRenderbufferSize,"invalid renderbuffer size"),!(s===e.width&&u===e.height&&c===e.format))return t.width=e.width=s,t.height=e.height=u,e.format=c,E.bindRenderbuffer(qn,e.renderbuffer),E.renderbufferStorage(qn,c,s,u),re(E.getError()===0,"invalid render buffer format"),qe.profile&&(e.stats.size=_s(e.format,e.width,e.height)),t.format=Me[e.format],t}function A(r,n){var s=r|0,u=n|0||s;return s===e.width&&u===e.height||(re(s>0&&u>0&&s<=he.maxRenderbufferSize&&u<=he.maxRenderbufferSize,"invalid renderbuffer size"),t.width=e.width=s,t.height=e.height=u,E.bindRenderbuffer(qn,e.renderbuffer),E.renderbufferStorage(qn,e.format,s,u),re(E.getError()===0,"invalid render buffer format"),qe.profile&&(e.stats.size=_s(e.format,e.width,e.height))),t}return t(rt,ot),t.resize=A,t._reglType="renderbuffer",t._renderbuffer=e,qe.profile&&(t.stats=e.stats),t.destroy=function(){e.decRef()},t}qe.profile&&(Se.getTotalRenderbufferSize=function(){var rt=0;return Object.keys(At).forEach(function(ot){rt+=At[ot].stats.size}),rt});function ft(){_r(At).forEach(function(rt){rt.renderbuffer=E.createRenderbuffer(),E.bindRenderbuffer(qn,rt.renderbuffer),E.renderbufferStorage(qn,rt.format,rt.width,rt.height)}),E.bindRenderbuffer(qn,null)}return{create:lt,clear:function(){_r(At).forEach(Ye)},restore:ft}},br=36160,En=36161,mi=3553,wo=34069,Cl=36064,wl=36096,_l=36128,Sl=33306,xr=36053,lr=36054,mr=36055,ur=36057,Fa=36061,wu=36193,_o=5121,_u=5126,Ql=6407,Tl=6408,Ss=6402,Dl=[Ql,Tl],Ra=[];Ra[Tl]=4,Ra[Ql]=3;var So=[];So[_o]=1,So[_u]=4,So[wu]=2;var Qs=32854,Ts=32855,Pl=36194,Il=33189,Ds=36168,Ps=34041,Ma=35907,Su=34836,Qo=34842,bn=34843,kl=[Qs,Ts,Pl,Ma,Qo,bn,Su],ji={};ji[xr]="complete",ji[lr]="incomplete attachment",ji[ur]="incomplete dimensions",ji[mr]="incomplete, missing attachment",ji[Fa]="unsupported";function Ll(E,Y,he,Se,qe,Fe){var Me={cur:null,next:null,dirty:!1,setFBO:null},tt=["rgba"],At=["rgba4","rgb565","rgb5 a1"];Y.ext_srgb&&At.push("srgba"),Y.ext_color_buffer_half_float&&At.push("rgba16f","rgb16f"),Y.webgl_color_buffer_float&&At.push("rgba32f");var it=["uint8"];Y.oes_texture_half_float&&it.push("half float","float16"),Y.oes_texture_float&&it.push("float","float32");function Ye(se,Ae,fe){this.target=se,this.texture=Ae,this.renderbuffer=fe;var ke=0,He=0;Ae?(ke=Ae.width,He=Ae.height):fe&&(ke=fe.width,He=fe.height),this.width=ke,this.height=He}function lt(se){se&&(se.texture&&se.texture._texture.decRef(),se.renderbuffer&&se.renderbuffer._renderbuffer.decRef())}function ft(se,Ae,fe){if(se)if(se.texture){var ke=se.texture._texture,He=Math.max(1,ke.width),Re=Math.max(1,ke.height);re(He===Ae&&Re===fe,"inconsistent width/height for supplied texture"),ke.refCount+=1}else{var Je=se.renderbuffer._renderbuffer;re(Je.width===Ae&&Je.height===fe,"inconsistent width/height for renderbuffer"),Je.refCount+=1}}function rt(se,Ae){Ae&&(Ae.texture?E.framebufferTexture2D(br,se,Ae.target,Ae.texture._texture.texture,0):E.framebufferRenderbuffer(br,se,En,Ae.renderbuffer._renderbuffer.renderbuffer))}function ot(se){var Ae=mi,fe=null,ke=null,He=se;typeof se=="object"&&(He=se.data,"target"in se&&(Ae=se.target|0)),re.type(He,"function","invalid attachment data");var Re=He._reglType;return Re==="texture2d"?(fe=He,re(Ae===mi)):Re==="textureCube"?(fe=He,re(Ae>=wo&&Ae<wo+6,"invalid cube map target")):Re==="renderbuffer"?(ke=He,Ae=En):re.raise("invalid regl object for attachment"),new Ye(Ae,fe,ke)}function e(se,Ae,fe,ke,He){if(fe){var Re=Se.create2D({width:se,height:Ae,format:ke,type:He});return Re._texture.refCount=0,new Ye(mi,Re,null)}else{var Je=qe.create({width:se,height:Ae,format:ke});return Je._renderbuffer.refCount=0,new Ye(En,null,Je)}}function t(se){return se&&(se.texture||se.renderbuffer)}function A(se,Ae,fe){se&&(se.texture?se.texture.resize(Ae,fe):se.renderbuffer&&se.renderbuffer.resize(Ae,fe),se.width=Ae,se.height=fe)}var r=0,n={};function s(){this.id=r++,n[this.id]=this,this.framebuffer=E.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function u(se){se.colorAttachments.forEach(lt),lt(se.depthAttachment),lt(se.stencilAttachment),lt(se.depthStencilAttachment)}function c(se){var Ae=se.framebuffer;re(Ae,"must not double destroy framebuffer"),E.deleteFramebuffer(Ae),se.framebuffer=null,Fe.framebufferCount--,delete n[se.id]}function d(se){var Ae;E.bindFramebuffer(br,se.framebuffer);var fe=se.colorAttachments;for(Ae=0;Ae<fe.length;++Ae)rt(Cl+Ae,fe[Ae]);for(Ae=fe.length;Ae<he.maxColorAttachments;++Ae)E.framebufferTexture2D(br,Cl+Ae,mi,null,0);E.framebufferTexture2D(br,Sl,mi,null,0),E.framebufferTexture2D(br,wl,mi,null,0),E.framebufferTexture2D(br,_l,mi,null,0),rt(wl,se.depthAttachment),rt(_l,se.stencilAttachment),rt(Sl,se.depthStencilAttachment);var ke=E.checkFramebufferStatus(br);!E.isContextLost()&&ke!==xr&&re.raise("framebuffer configuration not supported, status = "+ji[ke]),E.bindFramebuffer(br,Me.next?Me.next.framebuffer:null),Me.cur=Me.next,E.getError()}function B(se,Ae){var fe=new s;Fe.framebufferCount++;function ke(Re,Je){var $e;re(Me.next!==fe,"can not update framebuffer which is currently in use");var et=0,ht=0,mt=!0,Pt=!0,xt=null,Vt=!0,Ot="rgba",Zt="uint8",eA=1,$t=null,LA=null,tA=null,zt=!1;if(typeof Re=="number")et=Re|0,ht=Je|0||et;else if(!Re)et=ht=1;else{re.type(Re,"object","invalid arguments for framebuffer");var Bt=Re;if("shape"in Bt){var Yt=Bt.shape;re(Array.isArray(Yt)&&Yt.length>=2,"invalid shape for framebuffer"),et=Yt[0],ht=Yt[1]}else"radius"in Bt&&(et=ht=Bt.radius),"width"in Bt&&(et=Bt.width),"height"in Bt&&(ht=Bt.height);("color"in Bt||"colors"in Bt)&&(xt=Bt.color||Bt.colors,Array.isArray(xt)&&re(xt.length===1||Y.webgl_draw_buffers,"multiple render targets not supported")),xt||("colorCount"in Bt&&(eA=Bt.colorCount|0,re(eA>0,"invalid color buffer count")),"colorTexture"in Bt&&(Vt=!!Bt.colorTexture,Ot="rgba4"),"colorType"in Bt&&(Zt=Bt.colorType,Vt?(re(Y.oes_texture_float||!(Zt==="float"||Zt==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),re(Y.oes_texture_half_float||!(Zt==="half float"||Zt==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Zt==="half float"||Zt==="float16"?(re(Y.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ot="rgba16f"):(Zt==="float"||Zt==="float32")&&(re(Y.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ot="rgba32f"),re.oneOf(Zt,it,"invalid color type")),"colorFormat"in Bt&&(Ot=Bt.colorFormat,tt.indexOf(Ot)>=0?Vt=!0:At.indexOf(Ot)>=0?Vt=!1:Vt?re.oneOf(Bt.colorFormat,tt,"invalid color format for texture"):re.oneOf(Bt.colorFormat,At,"invalid color format for renderbuffer"))),("depthTexture"in Bt||"depthStencilTexture"in Bt)&&(zt=!!(Bt.depthTexture||Bt.depthStencilTexture),re(!zt||Y.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Bt&&(typeof Bt.depth=="boolean"?mt=Bt.depth:($t=Bt.depth,Pt=!1)),"stencil"in Bt&&(typeof Bt.stencil=="boolean"?Pt=Bt.stencil:(LA=Bt.stencil,mt=!1)),"depthStencil"in Bt&&(typeof Bt.depthStencil=="boolean"?mt=Pt=Bt.depthStencil:(tA=Bt.depthStencil,mt=!1,Pt=!1))}var Ut=null,_t=null,Rt=null,Ft=null;if(Array.isArray(xt))Ut=xt.map(ot);else if(xt)Ut=[ot(xt)];else for(Ut=new Array(eA),$e=0;$e<eA;++$e)Ut[$e]=e(et,ht,Vt,Ot,Zt);re(Y.webgl_draw_buffers||Ut.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),re(Ut.length<=he.maxColorAttachments,"too many color attachments, not supported"),et=et||Ut[0].width,ht=ht||Ut[0].height,$t?_t=ot($t):mt&&!Pt&&(_t=e(et,ht,zt,"depth","uint32")),LA?Rt=ot(LA):Pt&&!mt&&(Rt=e(et,ht,!1,"stencil","uint8")),tA?Ft=ot(tA):!$t&&!LA&&Pt&&mt&&(Ft=e(et,ht,zt,"depth stencil","depth stencil")),re(!!$t+!!LA+!!tA<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var zA=null;for($e=0;$e<Ut.length;++$e)if(ft(Ut[$e],et,ht),re(!Ut[$e]||Ut[$e].texture&&Dl.indexOf(Ut[$e].texture._texture.format)>=0||Ut[$e].renderbuffer&&kl.indexOf(Ut[$e].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+$e+" is invalid"),Ut[$e]&&Ut[$e].texture){var $A=Ra[Ut[$e].texture._texture.format]*So[Ut[$e].texture._texture.type];zA===null?zA=$A:re(zA===$A,"all color attachments much have the same number of bits per pixel.")}return ft(_t,et,ht),re(!_t||_t.texture&&_t.texture._texture.format===Ss||_t.renderbuffer&&_t.renderbuffer._renderbuffer.format===Il,"invalid depth attachment for framebuffer object"),ft(Rt,et,ht),re(!Rt||Rt.renderbuffer&&Rt.renderbuffer._renderbuffer.format===Ds,"invalid stencil attachment for framebuffer object"),ft(Ft,et,ht),re(!Ft||Ft.texture&&Ft.texture._texture.format===Ps||Ft.renderbuffer&&Ft.renderbuffer._renderbuffer.format===Ps,"invalid depth-stencil attachment for framebuffer object"),u(fe),fe.width=et,fe.height=ht,fe.colorAttachments=Ut,fe.depthAttachment=_t,fe.stencilAttachment=Rt,fe.depthStencilAttachment=Ft,ke.color=Ut.map(t),ke.depth=t(_t),ke.stencil=t(Rt),ke.depthStencil=t(Ft),ke.width=fe.width,ke.height=fe.height,d(fe),ke}function He(Re,Je){re(Me.next!==fe,"can not resize a framebuffer which is currently in use");var $e=Math.max(Re|0,1),et=Math.max(Je|0||$e,1);if($e===fe.width&&et===fe.height)return ke;for(var ht=fe.colorAttachments,mt=0;mt<ht.length;++mt)A(ht[mt],$e,et);return A(fe.depthAttachment,$e,et),A(fe.stencilAttachment,$e,et),A(fe.depthStencilAttachment,$e,et),fe.width=ke.width=$e,fe.height=ke.height=et,d(fe),ke}return ke(se,Ae),l(ke,{resize:He,_reglType:"framebuffer",_framebuffer:fe,destroy:function(){c(fe),u(fe)},use:function(Re){Me.setFBO({framebuffer:ke},Re)}})}function R(se){var Ae=Array(6);function fe(He){var Re;re(Ae.indexOf(Me.next)<0,"can not update framebuffer which is currently in use");var Je={color:null},$e=0,et=null,ht="rgba",mt="uint8",Pt=1;if(typeof He=="number")$e=He|0;else if(!He)$e=1;else{re.type(He,"object","invalid arguments for framebuffer");var xt=He;if("shape"in xt){var Vt=xt.shape;re(Array.isArray(Vt)&&Vt.length>=2,"invalid shape for framebuffer"),re(Vt[0]===Vt[1],"cube framebuffer must be square"),$e=Vt[0]}else"radius"in xt&&($e=xt.radius|0),"width"in xt?($e=xt.width|0,"height"in xt&&re(xt.height===$e,"must be square")):"height"in xt&&($e=xt.height|0);("color"in xt||"colors"in xt)&&(et=xt.color||xt.colors,Array.isArray(et)&&re(et.length===1||Y.webgl_draw_buffers,"multiple render targets not supported")),et||("colorCount"in xt&&(Pt=xt.colorCount|0,re(Pt>0,"invalid color buffer count")),"colorType"in xt&&(re.oneOf(xt.colorType,it,"invalid color type"),mt=xt.colorType),"colorFormat"in xt&&(ht=xt.colorFormat,re.oneOf(xt.colorFormat,tt,"invalid color format for texture"))),"depth"in xt&&(Je.depth=xt.depth),"stencil"in xt&&(Je.stencil=xt.stencil),"depthStencil"in xt&&(Je.depthStencil=xt.depthStencil)}var Ot;if(et)if(Array.isArray(et))for(Ot=[],Re=0;Re<et.length;++Re)Ot[Re]=et[Re];else Ot=[et];else{Ot=Array(Pt);var Zt={radius:$e,format:ht,type:mt};for(Re=0;Re<Pt;++Re)Ot[Re]=Se.createCube(Zt)}for(Je.color=Array(Ot.length),Re=0;Re<Ot.length;++Re){var eA=Ot[Re];re(typeof eA=="function"&&eA._reglType==="textureCube","invalid cube map"),$e=$e||eA.width,re(eA.width===$e&&eA.height===$e,"invalid cube map shape"),Je.color[Re]={target:wo,data:Ot[Re]}}for(Re=0;Re<6;++Re){for(var $t=0;$t<Ot.length;++$t)Je.color[$t].target=wo+Re;Re>0&&(Je.depth=Ae[0].depth,Je.stencil=Ae[0].stencil,Je.depthStencil=Ae[0].depthStencil),Ae[Re]?Ae[Re](Je):Ae[Re]=B(Je)}return l(fe,{width:$e,height:$e,color:Ot})}function ke(He){var Re,Je=He|0;if(re(Je>0&&Je<=he.maxCubeMapSize,"invalid radius for cube fbo"),Je===fe.width)return fe;var $e=fe.color;for(Re=0;Re<$e.length;++Re)$e[Re].resize(Je);for(Re=0;Re<6;++Re)Ae[Re].resize(Je);return fe.width=fe.height=Je,fe}return fe(se),l(fe,{faces:Ae,resize:ke,_reglType:"framebufferCube",destroy:function(){Ae.forEach(function(He){He.destroy()})}})}function te(){Me.cur=null,Me.next=null,Me.dirty=!0,_r(n).forEach(function(se){se.framebuffer=E.createFramebuffer(),d(se)})}return l(Me,{getFramebuffer:function(se){if(typeof se=="function"&&se._reglType==="framebuffer"){var Ae=se._framebuffer;if(Ae instanceof s)return Ae}return null},create:B,createCube:R,clear:function(){_r(n).forEach(c)},restore:te})}var Ir=5126,oA=34962;function kr(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ir,this.offset=0,this.stride=0,this.divisor=0}function Xn(E,Y,he,Se,qe){for(var Fe=he.maxAttributes,Me=new Array(Fe),tt=0;tt<Fe;++tt)Me[tt]=new kr;var At=0,it={},Ye={Record:kr,scope:{},state:Me,currentVAO:null,targetVAO:null,restore:ft()?n:function(){},createVAO:s,getVAO:ot,destroyBuffer:lt,setVAO:ft()?e:t,clear:ft()?A:function(){}};function lt(u){for(var c=0;c<Me.length;++c){var d=Me[c];d.buffer===u&&(E.disableVertexAttribArray(c),d.buffer=null)}}function ft(){return Y.oes_vertex_array_object}function rt(){return Y.angle_instanced_arrays}function ot(u){return typeof u=="function"&&u._vao?u._vao:null}function e(u){if(u!==Ye.currentVAO){var c=ft();u?c.bindVertexArrayOES(u.vao):c.bindVertexArrayOES(null),Ye.currentVAO=u}}function t(u){if(u!==Ye.currentVAO){if(u)u.bindAttrs();else for(var c=rt(),d=0;d<Me.length;++d){var B=Me[d];B.buffer?(E.enableVertexAttribArray(d),E.vertexAttribPointer(d,B.size,B.type,B.normalized,B.stride,B.offfset),c&&B.divisor&&c.vertexAttribDivisorANGLE(d,B.divisor)):(E.disableVertexAttribArray(d),E.vertexAttrib4f(d,B.x,B.y,B.z,B.w))}Ye.currentVAO=u}}function A(){_r(it).forEach(function(u){u.destroy()})}function r(){this.id=++At,this.attributes=[];var u=ft();u?this.vao=u.createVertexArrayOES():this.vao=null,it[this.id]=this,this.buffers=[]}r.prototype.bindAttrs=function(){for(var u=rt(),c=this.attributes,d=0;d<c.length;++d){var B=c[d];B.buffer?(E.enableVertexAttribArray(d),E.bindBuffer(oA,B.buffer.buffer),E.vertexAttribPointer(d,B.size,B.type,B.normalized,B.stride,B.offset),u&&B.divisor&&u.vertexAttribDivisorANGLE(d,B.divisor)):(E.disableVertexAttribArray(d),E.vertexAttrib4f(d,B.x,B.y,B.z,B.w))}for(var R=c.length;R<Fe;++R)E.disableVertexAttribArray(R)},r.prototype.refresh=function(){var u=ft();u&&(u.bindVertexArrayOES(this.vao),this.bindAttrs(),Ye.currentVAO=this)},r.prototype.destroy=function(){if(this.vao){var u=ft();this===Ye.currentVAO&&(Ye.currentVAO=null,u.bindVertexArrayOES(null)),u.deleteVertexArrayOES(this.vao),this.vao=null}it[this.id]&&(delete it[this.id],Se.vaoCount-=1)};function n(){var u=ft();u&&_r(it).forEach(function(c){c.refresh()})}function s(u){var c=new r;Se.vaoCount+=1;function d(B){re(Array.isArray(B),"arguments to vertex array constructor must be an array"),re(B.length<Fe,"too many attributes"),re(B.length>0,"must specify at least one attribute");var R={},te=c.attributes;te.length=B.length;for(var se=0;se<B.length;++se){var Ae=B[se],fe=te[se]=new kr,ke=Ae.data||Ae;if(Array.isArray(ke)||o(ke)||Dr(ke)){var He;c.buffers[se]&&(He=c.buffers[se],o(ke)&&He._buffer.byteLength>=ke.byteLength?He.subdata(ke):(He.destroy(),c.buffers[se]=null)),c.buffers[se]||(He=c.buffers[se]=qe.create(Ae,oA,!1,!0)),fe.buffer=qe.getBuffer(He),fe.size=fe.buffer.dimension|0,fe.normalized=!1,fe.type=fe.buffer.dtype,fe.offset=0,fe.stride=0,fe.divisor=0,fe.state=1,R[se]=1}else qe.getBuffer(Ae)?(fe.buffer=qe.getBuffer(Ae),fe.size=fe.buffer.dimension|0,fe.normalized=!1,fe.type=fe.buffer.dtype,fe.offset=0,fe.stride=0,fe.divisor=0,fe.state=1):qe.getBuffer(Ae.buffer)?(fe.buffer=qe.getBuffer(Ae.buffer),fe.size=(+Ae.size||fe.buffer.dimension)|0,fe.normalized=!!Ae.normalized||!1,"type"in Ae?(re.parameter(Ae.type,oi,"invalid buffer type"),fe.type=oi[Ae.type]):fe.type=fe.buffer.dtype,fe.offset=(Ae.offset||0)|0,fe.stride=(Ae.stride||0)|0,fe.divisor=(Ae.divisor||0)|0,fe.state=1,re(fe.size>=1&&fe.size<=4,"size must be between 1 and 4"),re(fe.offset>=0,"invalid offset"),re(fe.stride>=0&&fe.stride<=255,"stride must be between 0 and 255"),re(fe.divisor>=0,"divisor must be positive"),re(!fe.divisor||!!Y.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ae?(re(se>0,"first attribute must not be a constant"),fe.x=+Ae.x||0,fe.y=+Ae.y||0,fe.z=+Ae.z||0,fe.w=+Ae.w||0,fe.state=2):re(!1,"invalid attribute spec for location "+se)}for(var Re=0;Re<c.buffers.length;++Re)!R[Re]&&c.buffers[Re]&&(c.buffers[Re].destroy(),c.buffers[Re]=null);return c.refresh(),d}return d.destroy=function(){for(var B=0;B<c.buffers.length;++B)c.buffers[B]&&c.buffers[B].destroy();c.buffers.length=0,c.destroy()},d._vao=c,d._reglType="vao",d(u)}return Ye}var xn=35632,Fl=35633,Is=35718,Rl=35721;function Qu(E,Y,he,Se){var qe={},Fe={};function Me(e,t,A,r){this.name=e,this.id=t,this.location=A,this.info=r}function tt(e,t){for(var A=0;A<e.length;++A)if(e[A].id===t.id){e[A].location=t.location;return}e.push(t)}function At(e,t,A){var r=e===xn?qe:Fe,n=r[t];if(!n){var s=Y.str(t);n=E.createShader(e),E.shaderSource(n,s),E.compileShader(n),re.shaderError(E,n,s,e,A),r[t]=n}return n}var it={},Ye=[],lt=0;function ft(e,t){this.id=lt++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Se.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function rt(e,t,A){var r,n,s=At(xn,e.fragId),u=At(Fl,e.vertId),c=e.program=E.createProgram();if(E.attachShader(c,s),E.attachShader(c,u),A)for(r=0;r<A.length;++r){var d=A[r];E.bindAttribLocation(c,d[0],d[1])}E.linkProgram(c),re.linkError(E,c,Y.str(e.fragId),Y.str(e.vertId),t);var B=E.getProgramParameter(c,Is);Se.profile&&(e.stats.uniformsCount=B);var R=e.uniforms;for(r=0;r<B;++r)if(n=E.getActiveUniform(c,r),n)if(n.size>1)for(var te=0;te<n.size;++te){var se=n.name.replace("[0]","["+te+"]");tt(R,new Me(se,Y.id(se),E.getUniformLocation(c,se),n))}else tt(R,new Me(n.name,Y.id(n.name),E.getUniformLocation(c,n.name),n));var Ae=E.getProgramParameter(c,Rl);Se.profile&&(e.stats.attributesCount=Ae);var fe=e.attributes;for(r=0;r<Ae;++r)n=E.getActiveAttrib(c,r),n&&tt(fe,new Me(n.name,Y.id(n.name),E.getAttribLocation(c,n.name),n))}Se.profile&&(he.getMaxUniformsCount=function(){var e=0;return Ye.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},he.getMaxAttributesCount=function(){var e=0;return Ye.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e});function ot(){qe={},Fe={};for(var e=0;e<Ye.length;++e)rt(Ye[e],null,Ye[e].attributes.map(function(t){return[t.location,t.name]}))}return{clear:function(){var e=E.deleteShader.bind(E);_r(qe).forEach(e),qe={},_r(Fe).forEach(e),Fe={},Ye.forEach(function(t){E.deleteProgram(t.program)}),Ye.length=0,it={},he.shaderCount=0},program:function(e,t,A,r){re.command(e>=0,"missing vertex shader",A),re.command(t>=0,"missing fragment shader",A);var n=it[t];n||(n=it[t]={});var s=n[e];if(s&&(s.refCount++,!r))return s;var u=new ft(t,e);return he.shaderCount++,rt(u,A,r),s||(n[e]=u),Ye.push(u),l(u,{destroy:function(){if(u.refCount--,u.refCount<=0){E.deleteProgram(u.program);var c=Ye.indexOf(u);Ye.splice(c,1),he.shaderCount--}n[u.vertId].refCount<=0&&(E.deleteShader(Fe[u.vertId]),delete Fe[u.vertId],delete it[u.fragId][u.vertId]),Object.keys(it[u.fragId]).length||(E.deleteShader(qe[u.fragId]),delete qe[u.fragId],delete it[u.fragId])}})},restore:ot,shader:At,frag:-1,vert:-1}}var ks=6408,Bn=5121,Ml=3333,Ki=5126;function Vn(E,Y,he,Se,qe,Fe,Me){function tt(Ye){var lt;Y.next===null?(re(qe.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),lt=Bn):(re(Y.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),lt=Y.next.colorAttachments[0].texture._texture.type,Fe.oes_texture_float?(re(lt===Bn||lt===Ki,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),lt===Ki&&re(Me.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):re(lt===Bn,"Reading from a framebuffer is only allowed for the type 'uint8'"));var ft=0,rt=0,ot=Se.framebufferWidth,e=Se.framebufferHeight,t=null;o(Ye)?t=Ye:Ye&&(re.type(Ye,"object","invalid arguments to regl.read()"),ft=Ye.x|0,rt=Ye.y|0,re(ft>=0&&ft<Se.framebufferWidth,"invalid x offset for regl.read"),re(rt>=0&&rt<Se.framebufferHeight,"invalid y offset for regl.read"),ot=(Ye.width||Se.framebufferWidth-ft)|0,e=(Ye.height||Se.framebufferHeight-rt)|0,t=Ye.data||null),t&&(lt===Bn?re(t instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):lt===Ki&&re(t instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),re(ot>0&&ot+ft<=Se.framebufferWidth,"invalid width for read pixels"),re(e>0&&e+rt<=Se.framebufferHeight,"invalid height for read pixels"),he();var A=ot*e*4;return t||(lt===Bn?t=new Uint8Array(A):lt===Ki&&(t=t||new Float32Array(A))),re.isTypedArray(t,"data buffer for regl.read() must be a typedarray"),re(t.byteLength>=A,"data buffer for regl.read() too small"),E.pixelStorei(Ml,4),E.readPixels(ft,rt,ot,e,ks,lt,t),t}function At(Ye){var lt;return Y.setFBO({framebuffer:Ye.framebuffer},function(){lt=tt(Ye)}),lt}function it(Ye){return!Ye||!("framebuffer"in Ye)?tt(Ye):At(Ye)}return it}function yi(E){return Array.prototype.slice.call(E)}function Ei(E){return yi(E).join("")}function Tu(){var E=0,Y=[],he=[];function Se(lt){for(var ft=0;ft<he.length;++ft)if(he[ft]===lt)return Y[ft];var rt="g"+E++;return Y.push(rt),he.push(lt),rt}function qe(){var lt=[];function ft(){lt.push.apply(lt,yi(arguments))}var rt=[];function ot(){var e="v"+E++;return rt.push(e),arguments.length>0&&(lt.push(e,"="),lt.push.apply(lt,yi(arguments)),lt.push(";")),e}return l(ft,{def:ot,toString:function(){return Ei([rt.length>0?"var "+rt.join(",")+";":"",Ei(lt)])}})}function Fe(){var lt=qe(),ft=qe(),rt=lt.toString,ot=ft.toString;function e(t,A){ft(t,A,"=",lt.def(t,A),";")}return l(function(){lt.apply(lt,yi(arguments))},{def:lt.def,entry:lt,exit:ft,save:e,set:function(t,A,r){e(t,A),lt(t,A,"=",r,";")},toString:function(){return rt()+ot()}})}function Me(){var lt=Ei(arguments),ft=Fe(),rt=Fe(),ot=ft.toString,e=rt.toString;return l(ft,{then:function(){return ft.apply(ft,yi(arguments)),this},else:function(){return rt.apply(rt,yi(arguments)),this},toString:function(){var t=e();return t&&(t="else{"+t+"}"),Ei(["if(",lt,"){",ot(),"}",t])}})}var tt=qe(),At={};function it(lt,ft){var rt=[];function ot(){var n="a"+rt.length;return rt.push(n),n}ft=ft||0;for(var e=0;e<ft;++e)ot();var t=Fe(),A=t.toString,r=At[lt]=l(t,{arg:ot,toString:function(){return Ei(["function(",rt.join(),"){",A(),"}"])}});return r}function Ye(){var lt=['"use strict";',tt,"return {"];Object.keys(At).forEach(function(ot){lt.push('"',ot,'":',At[ot].toString(),",")}),lt.push("}");var ft=Ei(lt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),rt=Function.apply(null,Y.concat(ft));return rt.apply(null,he)}return{global:tt,link:Se,block:qe,proc:it,scope:Fe,cond:Me,compile:Ye}}var Cn="xyzw".split(""),To=5121,bi=1,Ls=2,Do=0,Fs=1,Rs=2,Ji=3,Oa=4,Ol=5,Nl=6,Ms="dither",xi="blend.enable",Po="blend.color",Zi="blend.equation",Io="blend.func",ko="depth.enable",Os="depth.func",Gl="depth.range",Ns="depth.mask",fr="colorMask",Na="cull.enable",Gs="cull.face",Lo="frontFace",Fo="lineWidth",Bi="polygonOffset.enable",ea="polygonOffset.offset",Us="sample.alpha",Hs="sample.enable",Ro="sample.coverage",Ci="stencil.enable",zs="stencil.mask",ta="stencil.func",Mo="stencil.opFront",wn="stencil.opBack",Ul="scissor.enable",_n="scissor.box",rn="viewport",Aa="profile",jn="framebuffer",Sn="vert",Qn="frag",Yr="elements",Xr="primitive",Kn="count",Oo="offset",Ga="instances",Or="vao",Jn="Width",wi="Height",ra=jn+Jn,_i=jn+wi,Du=rn+Jn,Pu=rn+wi,Hl="drawingBuffer",yr=Hl+Jn,Ws=Hl+wi,Iu=[Io,Zi,ta,Mo,wn,Ro,rn,_n,ea],na=34962,ku=34963,zl=35632,Wl=35633,qs=3553,Lu=34067,Fu=2884,Ru=3042,Zn=3024,Ua=2960,No=2929,Ha=3089,Tn=32823,Mu=32926,Ou=32928,ei=5126,za=35664,Wa=35665,qa=35666,ia=5124,Dn=35667,aa=35668,oa=35669,$a=35670,Go=35671,ti=35672,Ya=35673,Xa=35674,sa=35675,Ai=35676,Va=35678,ja=35680,la=4,ua=1028,ri=1029,ql=2304,Ka=2305,$l=32775,Nu=32776,Yl=519,Pn=7680,Xl=0,Uo=1,fa=32774,Ja=513,Vl=36160,jl=36064,nn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Kl=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],ca={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ni={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},$s={frag:zl,vert:Wl},Ys={cw:ql,ccw:Ka};function Ho(E){return Array.isArray(E)||o(E)||Dr(E)}function Xs(E){return E.sort(function(Y,he){return Y===rn?-1:he===rn?1:Y<he?-1:1})}function pr(E,Y,he,Se){this.thisDep=E,this.contextDep=Y,this.propDep=he,this.append=Se}function In(E){return E&&!(E.thisDep||E.contextDep||E.propDep)}function nr(E){return new pr(!1,!1,!1,E)}function Br(E,Y){var he=E.type;if(he===Do){var Se=E.data.length;return new pr(!0,Se>=1,Se>=2,Y)}else if(he===Oa){var qe=E.data;return new pr(qe.thisDep,qe.contextDep,qe.propDep,Y)}else{if(he===Ol)return new pr(!1,!1,!1,Y);if(he===Nl){for(var Fe=!1,Me=!1,tt=!1,At=0;At<E.data.length;++At){var it=E.data[At];if(it.type===Fs)tt=!0;else if(it.type===Rs)Me=!0;else if(it.type===Ji)Fe=!0;else if(it.type===Do){Fe=!0;var Ye=it.data;Ye>=1&&(Me=!0),Ye>=2&&(tt=!0)}else it.type===Oa&&(Fe=Fe||it.data.thisDep,Me=Me||it.data.contextDep,tt=tt||it.data.propDep)}return new pr(Fe,Me,tt,Y)}else return new pr(he===Ji,he===Rs,he===Fs,Y)}}var Si=new pr(!1,!1,!1,function(){});function Jl(E,Y,he,Se,qe,Fe,Me,tt,At,it,Ye,lt,ft,rt,ot){var e=it.Record,t={add:32774,subtract:32778,"reverse subtract":32779};he.ext_blend_minmax&&(t.min=$l,t.max=Nu);var A=he.angle_instanced_arrays,r=he.webgl_draw_buffers,n={dirty:!0,profile:ot.profile},s={},u=[],c={},d={};function B(ne){return ne.replace(".","_")}function R(ne,M,me){var Qe=B(ne);u.push(ne),s[Qe]=n[Qe]=!!me,c[Qe]=M}function te(ne,M,me){var Qe=B(ne);u.push(ne),Array.isArray(me)?(n[Qe]=me.slice(),s[Qe]=me.slice()):n[Qe]=s[Qe]=me,d[Qe]=M}R(Ms,Zn),R(xi,Ru),te(Po,"blendColor",[0,0,0,0]),te(Zi,"blendEquationSeparate",[fa,fa]),te(Io,"blendFuncSeparate",[Uo,Xl,Uo,Xl]),R(ko,No,!0),te(Os,"depthFunc",Ja),te(Gl,"depthRange",[0,1]),te(Ns,"depthMask",!0),te(fr,fr,[!0,!0,!0,!0]),R(Na,Fu),te(Gs,"cullFace",ri),te(Lo,Lo,Ka),te(Fo,Fo,1),R(Bi,Tn),te(ea,"polygonOffset",[0,0]),R(Us,Mu),R(Hs,Ou),te(Ro,"sampleCoverage",[1,!1]),R(Ci,Ua),te(zs,"stencilMask",-1),te(ta,"stencilFunc",[Yl,0,-1]),te(Mo,"stencilOpSeparate",[ua,Pn,Pn,Pn]),te(wn,"stencilOpSeparate",[ri,Pn,Pn,Pn]),R(Ul,Ha),te(_n,"scissor",[0,0,E.drawingBufferWidth,E.drawingBufferHeight]),te(rn,rn,[0,0,E.drawingBufferWidth,E.drawingBufferHeight]);var se={gl:E,context:ft,strings:Y,next:s,current:n,draw:lt,elements:Fe,buffer:qe,shader:Ye,attributes:it.state,vao:it,uniforms:At,framebuffer:tt,extensions:he,timer:rt,isBufferArgs:Ho},Ae={primTypes:Sr,compareFuncs:ca,blendFuncs:nn,blendEquations:t,stencilOps:ni,glTypes:oi,orientationType:Ys};re.optional(function(){se.isArrayLike=qA}),r&&(Ae.backBuffer=[ri],Ae.drawBuffer=WA(Se.maxDrawbuffers,function(ne){return ne===0?[0]:WA(ne,function(M){return jl+M})}));var fe=0;function ke(){var ne=Tu(),M=ne.link,me=ne.global;ne.id=fe++,ne.batchId="0";var Qe=M(se),De=ne.shared={props:"a0"};Object.keys(se).forEach(function(ve){De[ve]=me.def(Qe,".",ve)}),re.optional(function(){ne.CHECK=M(re),ne.commandStr=re.guessCommand(),ne.command=M(ne.commandStr),ne.assert=function(ve,ee,_e){ve("if(!(",ee,"))",this.CHECK,".commandRaise(",M(_e),",",this.command,");")},Ae.invalidBlendCombinations=Kl});var be=ne.next={},ye=ne.current={};Object.keys(d).forEach(function(ve){Array.isArray(n[ve])&&(be[ve]=me.def(De.next,".",ve),ye[ve]=me.def(De.current,".",ve))});var Ce=ne.constants={};Object.keys(Ae).forEach(function(ve){Ce[ve]=me.def(JSON.stringify(Ae[ve]))}),ne.invoke=function(ve,ee){switch(ee.type){case Do:var _e=["this",De.context,De.props,ne.batchId];return ve.def(M(ee.data),".call(",_e.slice(0,Math.max(ee.data.length+1,4)),")");case Fs:return ve.def(De.props,ee.data);case Rs:return ve.def(De.context,ee.data);case Ji:return ve.def("this",ee.data);case Oa:return ee.data.append(ne,ve),ee.data.ref;case Ol:return ee.data.toString();case Nl:return ee.data.map(function(Ie){return ne.invoke(ve,Ie)})}},ne.attribCache={};var ie={};return ne.scopeAttrib=function(ve){var ee=Y.id(ve);if(ee in ie)return ie[ee];var _e=it.scope[ee];_e||(_e=it.scope[ee]=new e);var Ie=ie[ee]=M(_e);return Ie},ne}function He(ne){var M=ne.static,me=ne.dynamic,Qe;if(Aa in M){var De=!!M[Aa];Qe=nr(function(ye,Ce){return De}),Qe.enable=De}else if(Aa in me){var be=me[Aa];Qe=Br(be,function(ye,Ce){return ye.invoke(Ce,be)})}return Qe}function Re(ne,M){var me=ne.static,Qe=ne.dynamic;if(jn in me){var De=me[jn];return De?(De=tt.getFramebuffer(De),re.command(De,"invalid framebuffer object"),nr(function(ye,Ce){var ie=ye.link(De),ve=ye.shared;Ce.set(ve.framebuffer,".next",ie);var ee=ve.context;return Ce.set(ee,"."+ra,ie+".width"),Ce.set(ee,"."+_i,ie+".height"),ie})):nr(function(ye,Ce){var ie=ye.shared;Ce.set(ie.framebuffer,".next","null");var ve=ie.context;return Ce.set(ve,"."+ra,ve+"."+yr),Ce.set(ve,"."+_i,ve+"."+Ws),"null"})}else if(jn in Qe){var be=Qe[jn];return Br(be,function(ye,Ce){var ie=ye.invoke(Ce,be),ve=ye.shared,ee=ve.framebuffer,_e=Ce.def(ee,".getFramebuffer(",ie,")");re.optional(function(){ye.assert(Ce,"!"+ie+"||"+_e,"invalid framebuffer object")}),Ce.set(ee,".next",_e);var Ie=ve.context;return Ce.set(Ie,"."+ra,_e+"?"+_e+".width:"+Ie+"."+yr),Ce.set(Ie,"."+_i,_e+"?"+_e+".height:"+Ie+"."+Ws),_e})}else return null}function Je(ne,M,me){var Qe=ne.static,De=ne.dynamic;function be(ie){if(ie in Qe){var ve=Qe[ie];re.commandType(ve,"object","invalid "+ie,me.commandStr);var ee=!0,_e=ve.x|0,Ie=ve.y|0,We,Xe;return"width"in ve?(We=ve.width|0,re.command(We>=0,"invalid "+ie,me.commandStr)):ee=!1,"height"in ve?(Xe=ve.height|0,re.command(Xe>=0,"invalid "+ie,me.commandStr)):ee=!1,new pr(!ee&&M&&M.thisDep,!ee&&M&&M.contextDep,!ee&&M&&M.propDep,function(Ct,Ht){var Et=Ct.shared.context,It=We;"width"in ve||(It=Ht.def(Et,".",ra,"-",_e));var Gt=Xe;return"height"in ve||(Gt=Ht.def(Et,".",_i,"-",Ie)),[_e,Ie,It,Gt]})}else if(ie in De){var Ue=De[ie],at=Br(Ue,function(Ct,Ht){var Et=Ct.invoke(Ht,Ue);re.optional(function(){Ct.assert(Ht,Et+"&&typeof "+Et+'==="object"',"invalid "+ie)});var It=Ct.shared.context,Gt=Ht.def(Et,".x|0"),Kt=Ht.def(Et,".y|0"),ir=Ht.def('"width" in ',Et,"?",Et,".width|0:","(",It,".",ra,"-",Gt,")"),Lr=Ht.def('"height" in ',Et,"?",Et,".height|0:","(",It,".",_i,"-",Kt,")");return re.optional(function(){Ct.assert(Ht,ir+">=0&&"+Lr+">=0","invalid "+ie)}),[Gt,Kt,ir,Lr]});return M&&(at.thisDep=at.thisDep||M.thisDep,at.contextDep=at.contextDep||M.contextDep,at.propDep=at.propDep||M.propDep),at}else return M?new pr(M.thisDep,M.contextDep,M.propDep,function(Ct,Ht){var Et=Ct.shared.context;return[0,0,Ht.def(Et,".",ra),Ht.def(Et,".",_i)]}):null}var ye=be(rn);if(ye){var Ce=ye;ye=new pr(ye.thisDep,ye.contextDep,ye.propDep,function(ie,ve){var ee=Ce.append(ie,ve),_e=ie.shared.context;return ve.set(_e,"."+Du,ee[2]),ve.set(_e,"."+Pu,ee[3]),ee})}return{viewport:ye,scissor_box:be(_n)}}function $e(ne,M){var me=ne.static,Qe=typeof me[Qn]=="string"&&typeof me[Sn]=="string";if(Qe){if(Object.keys(M.dynamic).length>0)return null;var De=M.static,be=Object.keys(De);if(be.length>0&&typeof De[be[0]]=="number"){for(var ye=[],Ce=0;Ce<be.length;++Ce)re(typeof De[be[Ce]]=="number","must specify all vertex attribute locations when using vaos"),ye.push([De[be[Ce]]|0,be[Ce]]);return ye}}return null}function et(ne,M,me){var Qe=ne.static,De=ne.dynamic;function be(ee){if(ee in Qe){var _e=Y.id(Qe[ee]);re.optional(function(){Ye.shader($s[ee],_e,re.guessCommand())});var Ie=nr(function(){return _e});return Ie.id=_e,Ie}else if(ee in De){var We=De[ee];return Br(We,function(Xe,Ue){var at=Xe.invoke(Ue,We),Ct=Ue.def(Xe.shared.strings,".id(",at,")");return re.optional(function(){Ue(Xe.shared.shader,".shader(",$s[ee],",",Ct,",",Xe.command,");")}),Ct})}return null}var ye=be(Qn),Ce=be(Sn),ie=null,ve;return In(ye)&&In(Ce)?(ie=Ye.program(Ce.id,ye.id,null,me),ve=nr(function(ee,_e){return ee.link(ie)})):ve=new pr(ye&&ye.thisDep||Ce&&Ce.thisDep,ye&&ye.contextDep||Ce&&Ce.contextDep,ye&&ye.propDep||Ce&&Ce.propDep,function(ee,_e){var Ie=ee.shared.shader,We;ye?We=ye.append(ee,_e):We=_e.def(Ie,".",Qn);var Xe;Ce?Xe=Ce.append(ee,_e):Xe=_e.def(Ie,".",Sn);var Ue=Ie+".program("+Xe+","+We;return re.optional(function(){Ue+=","+ee.command}),_e.def(Ue+")")}),{frag:ye,vert:Ce,progVar:ve,program:ie}}function ht(ne,M){var me=ne.static,Qe=ne.dynamic;function De(){if(Yr in me){var ee=me[Yr];Ho(ee)?ee=Fe.getElements(Fe.create(ee,!0)):ee&&(ee=Fe.getElements(ee),re.command(ee,"invalid elements",M.commandStr));var _e=nr(function(We,Xe){if(ee){var Ue=We.link(ee);return We.ELEMENTS=Ue,Ue}return We.ELEMENTS=null,null});return _e.value=ee,_e}else if(Yr in Qe){var Ie=Qe[Yr];return Br(Ie,function(We,Xe){var Ue=We.shared,at=Ue.isBufferArgs,Ct=Ue.elements,Ht=We.invoke(Xe,Ie),Et=Xe.def("null"),It=Xe.def(at,"(",Ht,")"),Gt=We.cond(It).then(Et,"=",Ct,".createStream(",Ht,");").else(Et,"=",Ct,".getElements(",Ht,");");return re.optional(function(){We.assert(Gt.else,"!"+Ht+"||"+Et,"invalid elements")}),Xe.entry(Gt),Xe.exit(We.cond(It).then(Ct,".destroyStream(",Et,");")),We.ELEMENTS=Et,Et})}return null}var be=De();function ye(){if(Xr in me){var ee=me[Xr];return re.commandParameter(ee,Sr,"invalid primitve",M.commandStr),nr(function(Ie,We){return Sr[ee]})}else if(Xr in Qe){var _e=Qe[Xr];return Br(_e,function(Ie,We){var Xe=Ie.constants.primTypes,Ue=Ie.invoke(We,_e);return re.optional(function(){Ie.assert(We,Ue+" in "+Xe,"invalid primitive, must be one of "+Object.keys(Sr))}),We.def(Xe,"[",Ue,"]")})}else if(be)return In(be)?be.value?nr(function(Ie,We){return We.def(Ie.ELEMENTS,".primType")}):nr(function(){return la}):new pr(be.thisDep,be.contextDep,be.propDep,function(Ie,We){var Xe=Ie.ELEMENTS;return We.def(Xe,"?",Xe,".primType:",la)});return null}function Ce(ee,_e){if(ee in me){var Ie=me[ee]|0;return re.command(!_e||Ie>=0,"invalid "+ee,M.commandStr),nr(function(Xe,Ue){return _e&&(Xe.OFFSET=Ie),Ie})}else if(ee in Qe){var We=Qe[ee];return Br(We,function(Xe,Ue){var at=Xe.invoke(Ue,We);return _e&&(Xe.OFFSET=at,re.optional(function(){Xe.assert(Ue,at+">=0","invalid "+ee)})),at})}else if(_e&&be)return nr(function(Xe,Ue){return Xe.OFFSET="0",0});return null}var ie=Ce(Oo,!0);function ve(){if(Kn in me){var ee=me[Kn]|0;return re.command(typeof ee=="number"&&ee>=0,"invalid vertex count",M.commandStr),nr(function(){return ee})}else if(Kn in Qe){var _e=Qe[Kn];return Br(_e,function(Xe,Ue){var at=Xe.invoke(Ue,_e);return re.optional(function(){Xe.assert(Ue,"typeof "+at+'==="number"&&'+at+">=0&&"+at+"===("+at+"|0)","invalid vertex count")}),at})}else if(be)if(In(be)){if(be)return ie?new pr(ie.thisDep,ie.contextDep,ie.propDep,function(Xe,Ue){var at=Ue.def(Xe.ELEMENTS,".vertCount-",Xe.OFFSET);return re.optional(function(){Xe.assert(Ue,at+">=0","invalid vertex offset/element buffer too small")}),at}):nr(function(Xe,Ue){return Ue.def(Xe.ELEMENTS,".vertCount")});var Ie=nr(function(){return-1});return re.optional(function(){Ie.MISSING=!0}),Ie}else{var We=new pr(be.thisDep||ie.thisDep,be.contextDep||ie.contextDep,be.propDep||ie.propDep,function(Xe,Ue){var at=Xe.ELEMENTS;return Xe.OFFSET?Ue.def(at,"?",at,".vertCount-",Xe.OFFSET,":-1"):Ue.def(at,"?",at,".vertCount:-1")});return re.optional(function(){We.DYNAMIC=!0}),We}return null}return{elements:be,primitive:ye(),count:ve(),instances:Ce(Ga,!1),offset:ie}}function mt(ne,M){var me=ne.static,Qe=ne.dynamic,De={};return u.forEach(function(be){var ye=B(be);function Ce(ie,ve){if(be in me){var ee=ie(me[be]);De[ye]=nr(function(){return ee})}else if(be in Qe){var _e=Qe[be];De[ye]=Br(_e,function(Ie,We){return ve(Ie,We,Ie.invoke(We,_e))})}}switch(be){case Na:case xi:case Ms:case Ci:case ko:case Ul:case Bi:case Us:case Hs:case Ns:return Ce(function(ie){return re.commandType(ie,"boolean",be,M.commandStr),ie},function(ie,ve,ee){return re.optional(function(){ie.assert(ve,"typeof "+ee+'==="boolean"',"invalid flag "+be,ie.commandStr)}),ee});case Os:return Ce(function(ie){return re.commandParameter(ie,ca,"invalid "+be,M.commandStr),ca[ie]},function(ie,ve,ee){var _e=ie.constants.compareFuncs;return re.optional(function(){ie.assert(ve,ee+" in "+_e,"invalid "+be+", must be one of "+Object.keys(ca))}),ve.def(_e,"[",ee,"]")});case Gl:return Ce(function(ie){return re.command(qA(ie)&&ie.length===2&&typeof ie[0]=="number"&&typeof ie[1]=="number"&&ie[0]<=ie[1],"depth range is 2d array",M.commandStr),ie},function(ie,ve,ee){re.optional(function(){ie.assert(ve,ie.shared.isArrayLike+"("+ee+")&&"+ee+".length===2&&typeof "+ee+'[0]==="number"&&typeof '+ee+'[1]==="number"&&'+ee+"[0]<="+ee+"[1]","depth range must be a 2d array")});var _e=ve.def("+",ee,"[0]"),Ie=ve.def("+",ee,"[1]");return[_e,Ie]});case Io:return Ce(function(ie){re.commandType(ie,"object","blend.func",M.commandStr);var ve="srcRGB"in ie?ie.srcRGB:ie.src,ee="srcAlpha"in ie?ie.srcAlpha:ie.src,_e="dstRGB"in ie?ie.dstRGB:ie.dst,Ie="dstAlpha"in ie?ie.dstAlpha:ie.dst;return re.commandParameter(ve,nn,ye+".srcRGB",M.commandStr),re.commandParameter(ee,nn,ye+".srcAlpha",M.commandStr),re.commandParameter(_e,nn,ye+".dstRGB",M.commandStr),re.commandParameter(Ie,nn,ye+".dstAlpha",M.commandStr),re.command(Kl.indexOf(ve+", "+_e)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+ve+", "+_e+")",M.commandStr),[nn[ve],nn[_e],nn[ee],nn[Ie]]},function(ie,ve,ee){var _e=ie.constants.blendFuncs;re.optional(function(){ie.assert(ve,ee+"&&typeof "+ee+'==="object"',"invalid blend func, must be an object")});function Ie(Et,It){var Gt=ve.def('"',Et,It,'" in ',ee,"?",ee,".",Et,It,":",ee,".",Et);return re.optional(function(){ie.assert(ve,Gt+" in "+_e,"invalid "+be+"."+Et+It+", must be one of "+Object.keys(nn))}),Gt}var We=Ie("src","RGB"),Xe=Ie("dst","RGB");re.optional(function(){var Et=ie.constants.invalidBlendCombinations;ie.assert(ve,Et+".indexOf("+We+'+", "+'+Xe+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Ue=ve.def(_e,"[",We,"]"),at=ve.def(_e,"[",Ie("src","Alpha"),"]"),Ct=ve.def(_e,"[",Xe,"]"),Ht=ve.def(_e,"[",Ie("dst","Alpha"),"]");return[Ue,Ct,at,Ht]});case Zi:return Ce(function(ie){if(typeof ie=="string")return re.commandParameter(ie,t,"invalid "+be,M.commandStr),[t[ie],t[ie]];if(typeof ie=="object")return re.commandParameter(ie.rgb,t,be+".rgb",M.commandStr),re.commandParameter(ie.alpha,t,be+".alpha",M.commandStr),[t[ie.rgb],t[ie.alpha]];re.commandRaise("invalid blend.equation",M.commandStr)},function(ie,ve,ee){var _e=ie.constants.blendEquations,Ie=ve.def(),We=ve.def(),Xe=ie.cond("typeof ",ee,'==="string"');return re.optional(function(){function Ue(at,Ct,Ht){ie.assert(at,Ht+" in "+_e,"invalid "+Ct+", must be one of "+Object.keys(t))}Ue(Xe.then,be,ee),ie.assert(Xe.else,ee+"&&typeof "+ee+'==="object"',"invalid "+be),Ue(Xe.else,be+".rgb",ee+".rgb"),Ue(Xe.else,be+".alpha",ee+".alpha")}),Xe.then(Ie,"=",We,"=",_e,"[",ee,"];"),Xe.else(Ie,"=",_e,"[",ee,".rgb];",We,"=",_e,"[",ee,".alpha];"),ve(Xe),[Ie,We]});case Po:return Ce(function(ie){return re.command(qA(ie)&&ie.length===4,"blend.color must be a 4d array",M.commandStr),WA(4,function(ve){return+ie[ve]})},function(ie,ve,ee){return re.optional(function(){ie.assert(ve,ie.shared.isArrayLike+"("+ee+")&&"+ee+".length===4","blend.color must be a 4d array")}),WA(4,function(_e){return ve.def("+",ee,"[",_e,"]")})});case zs:return Ce(function(ie){return re.commandType(ie,"number",ye,M.commandStr),ie|0},function(ie,ve,ee){return re.optional(function(){ie.assert(ve,"typeof "+ee+'==="number"',"invalid stencil.mask")}),ve.def(ee,"|0")});case ta:return Ce(function(ie){re.commandType(ie,"object",ye,M.commandStr);var ve=ie.cmp||"keep",ee=ie.ref||0,_e="mask"in ie?ie.mask:-1;return re.commandParameter(ve,ca,be+".cmp",M.commandStr),re.commandType(ee,"number",be+".ref",M.commandStr),re.commandType(_e,"number",be+".mask",M.commandStr),[ca[ve],ee,_e]},function(ie,ve,ee){var _e=ie.constants.compareFuncs;re.optional(function(){function Ue(){ie.assert(ve,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Ue(ee+"&&typeof ",ee,'==="object"'),Ue('!("cmp" in ',ee,")||(",ee,".cmp in ",_e,")")});var Ie=ve.def('"cmp" in ',ee,"?",_e,"[",ee,".cmp]",":",Pn),We=ve.def(ee,".ref|0"),Xe=ve.def('"mask" in ',ee,"?",ee,".mask|0:-1");return[Ie,We,Xe]});case Mo:case wn:return Ce(function(ie){re.commandType(ie,"object",ye,M.commandStr);var ve=ie.fail||"keep",ee=ie.zfail||"keep",_e=ie.zpass||"keep";return re.commandParameter(ve,ni,be+".fail",M.commandStr),re.commandParameter(ee,ni,be+".zfail",M.commandStr),re.commandParameter(_e,ni,be+".zpass",M.commandStr),[be===wn?ri:ua,ni[ve],ni[ee],ni[_e]]},function(ie,ve,ee){var _e=ie.constants.stencilOps;re.optional(function(){ie.assert(ve,ee+"&&typeof "+ee+'==="object"',"invalid "+be)});function Ie(We){return re.optional(function(){ie.assert(ve,'!("'+We+'" in '+ee+")||("+ee+"."+We+" in "+_e+")","invalid "+be+"."+We+", must be one of "+Object.keys(ni))}),ve.def('"',We,'" in ',ee,"?",_e,"[",ee,".",We,"]:",Pn)}return[be===wn?ri:ua,Ie("fail"),Ie("zfail"),Ie("zpass")]});case ea:return Ce(function(ie){re.commandType(ie,"object",ye,M.commandStr);var ve=ie.factor|0,ee=ie.units|0;return re.commandType(ve,"number",ye+".factor",M.commandStr),re.commandType(ee,"number",ye+".units",M.commandStr),[ve,ee]},function(ie,ve,ee){re.optional(function(){ie.assert(ve,ee+"&&typeof "+ee+'==="object"',"invalid "+be)});var _e=ve.def(ee,".factor|0"),Ie=ve.def(ee,".units|0");return[_e,Ie]});case Gs:return Ce(function(ie){var ve=0;return ie==="front"?ve=ua:ie==="back"&&(ve=ri),re.command(!!ve,ye,M.commandStr),ve},function(ie,ve,ee){return re.optional(function(){ie.assert(ve,ee+'==="front"||'+ee+'==="back"',"invalid cull.face")}),ve.def(ee,'==="front"?',ua,":",ri)});case Fo:return Ce(function(ie){return re.command(typeof ie=="number"&&ie>=Se.lineWidthDims[0]&&ie<=Se.lineWidthDims[1],"invalid line width, must be a positive number between "+Se.lineWidthDims[0]+" and "+Se.lineWidthDims[1],M.commandStr),ie},function(ie,ve,ee){return re.optional(function(){ie.assert(ve,"typeof "+ee+'==="number"&&'+ee+">="+Se.lineWidthDims[0]+"&&"+ee+"<="+Se.lineWidthDims[1],"invalid line width")}),ee});case Lo:return Ce(function(ie){return re.commandParameter(ie,Ys,ye,M.commandStr),Ys[ie]},function(ie,ve,ee){return re.optional(function(){ie.assert(ve,ee+'==="cw"||'+ee+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ve.def(ee+'==="cw"?'+ql+":"+Ka)});case fr:return Ce(function(ie){return re.command(qA(ie)&&ie.length===4,"color.mask must be length 4 array",M.commandStr),ie.map(function(ve){return!!ve})},function(ie,ve,ee){return re.optional(function(){ie.assert(ve,ie.shared.isArrayLike+"("+ee+")&&"+ee+".length===4","invalid color.mask")}),WA(4,function(_e){return"!!"+ee+"["+_e+"]"})});case Ro:return Ce(function(ie){re.command(typeof ie=="object"&&ie,ye,M.commandStr);var ve="value"in ie?ie.value:1,ee=!!ie.invert;return re.command(typeof ve=="number"&&ve>=0&&ve<=1,"sample.coverage.value must be a number between 0 and 1",M.commandStr),[ve,ee]},function(ie,ve,ee){re.optional(function(){ie.assert(ve,ee+"&&typeof "+ee+'==="object"',"invalid sample.coverage")});var _e=ve.def('"value" in ',ee,"?+",ee,".value:1"),Ie=ve.def("!!",ee,".invert");return[_e,Ie]})}}),De}function Pt(ne,M){var me=ne.static,Qe=ne.dynamic,De={};return Object.keys(me).forEach(function(be){var ye=me[be],Ce;if(typeof ye=="number"||typeof ye=="boolean")Ce=nr(function(){return ye});else if(typeof ye=="function"){var ie=ye._reglType;ie==="texture2d"||ie==="textureCube"?Ce=nr(function(ve){return ve.link(ye)}):ie==="framebuffer"||ie==="framebufferCube"?(re.command(ye.color.length>0,'missing color attachment for framebuffer sent to uniform "'+be+'"',M.commandStr),Ce=nr(function(ve){return ve.link(ye.color[0])})):re.commandRaise('invalid data for uniform "'+be+'"',M.commandStr)}else qA(ye)?Ce=nr(function(ve){var ee=ve.global.def("[",WA(ye.length,function(_e){return re.command(typeof ye[_e]=="number"||typeof ye[_e]=="boolean","invalid uniform "+be,ve.commandStr),ye[_e]}),"]");return ee}):re.commandRaise('invalid or missing data for uniform "'+be+'"',M.commandStr);Ce.value=ye,De[be]=Ce}),Object.keys(Qe).forEach(function(be){var ye=Qe[be];De[be]=Br(ye,function(Ce,ie){return Ce.invoke(ie,ye)})}),De}function xt(ne,M){var me=ne.static,Qe=ne.dynamic,De={};return Object.keys(me).forEach(function(be){var ye=me[be],Ce=Y.id(be),ie=new e;if(Ho(ye))ie.state=bi,ie.buffer=qe.getBuffer(qe.create(ye,na,!1,!0)),ie.type=0;else{var ve=qe.getBuffer(ye);if(ve)ie.state=bi,ie.buffer=ve,ie.type=0;else if(re.command(typeof ye=="object"&&ye,"invalid data for attribute "+be,M.commandStr),"constant"in ye){var ee=ye.constant;ie.buffer="null",ie.state=Ls,typeof ee=="number"?ie.x=ee:(re.command(qA(ee)&&ee.length>0&&ee.length<=4,"invalid constant for attribute "+be,M.commandStr),Cn.forEach(function(Ct,Ht){Ht<ee.length&&(ie[Ct]=ee[Ht])}))}else{Ho(ye.buffer)?ve=qe.getBuffer(qe.create(ye.buffer,na,!1,!0)):ve=qe.getBuffer(ye.buffer),re.command(!!ve,'missing buffer for attribute "'+be+'"',M.commandStr);var _e=ye.offset|0;re.command(_e>=0,'invalid offset for attribute "'+be+'"',M.commandStr);var Ie=ye.stride|0;re.command(Ie>=0&&Ie<256,'invalid stride for attribute "'+be+'", must be integer betweeen [0, 255]',M.commandStr);var We=ye.size|0;re.command(!("size"in ye)||We>0&&We<=4,'invalid size for attribute "'+be+'", must be 1,2,3,4',M.commandStr);var Xe=!!ye.normalized,Ue=0;"type"in ye&&(re.commandParameter(ye.type,oi,"invalid type for attribute "+be,M.commandStr),Ue=oi[ye.type]);var at=ye.divisor|0;"divisor"in ye&&(re.command(at===0||A,'cannot specify divisor for attribute "'+be+'", instancing not supported',M.commandStr),re.command(at>=0,'invalid divisor for attribute "'+be+'"',M.commandStr)),re.optional(function(){var Ct=M.commandStr,Ht=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ye).forEach(function(Et){re.command(Ht.indexOf(Et)>=0,'unknown parameter "'+Et+'" for attribute pointer "'+be+'" (valid parameters are '+Ht+")",Ct)})}),ie.buffer=ve,ie.state=bi,ie.size=We,ie.normalized=Xe,ie.type=Ue||ve.dtype,ie.offset=_e,ie.stride=Ie,ie.divisor=at}}De[be]=nr(function(Ct,Ht){var Et=Ct.attribCache;if(Ce in Et)return Et[Ce];var It={isStream:!1};return Object.keys(ie).forEach(function(Gt){It[Gt]=ie[Gt]}),ie.buffer&&(It.buffer=Ct.link(ie.buffer),It.type=It.type||It.buffer+".dtype"),Et[Ce]=It,It})}),Object.keys(Qe).forEach(function(be){var ye=Qe[be];function Ce(ie,ve){var ee=ie.invoke(ve,ye),_e=ie.shared,Ie=ie.constants,We=_e.isBufferArgs,Xe=_e.buffer;re.optional(function(){ie.assert(ve,ee+"&&(typeof "+ee+'==="object"||typeof '+ee+'==="function")&&('+We+"("+ee+")||"+Xe+".getBuffer("+ee+")||"+Xe+".getBuffer("+ee+".buffer)||"+We+"("+ee+'.buffer)||("constant" in '+ee+"&&(typeof "+ee+'.constant==="number"||'+_e.isArrayLike+"("+ee+".constant))))",'invalid dynamic attribute "'+be+'"')});var Ue={isStream:ve.def(!1)},at=new e;at.state=bi,Object.keys(at).forEach(function(It){Ue[It]=ve.def(""+at[It])});var Ct=Ue.buffer,Ht=Ue.type;ve("if(",We,"(",ee,")){",Ue.isStream,"=true;",Ct,"=",Xe,".createStream(",na,",",ee,");",Ht,"=",Ct,".dtype;","}else{",Ct,"=",Xe,".getBuffer(",ee,");","if(",Ct,"){",Ht,"=",Ct,".dtype;",'}else if("constant" in ',ee,"){",Ue.state,"=",Ls,";","if(typeof "+ee+'.constant === "number"){',Ue[Cn[0]],"=",ee,".constant;",Cn.slice(1).map(function(It){return Ue[It]}).join("="),"=0;","}else{",Cn.map(function(It,Gt){return Ue[It]+"="+ee+".constant.length>"+Gt+"?"+ee+".constant["+Gt+"]:0;"}).join(""),"}}else{","if(",We,"(",ee,".buffer)){",Ct,"=",Xe,".createStream(",na,",",ee,".buffer);","}else{",Ct,"=",Xe,".getBuffer(",ee,".buffer);","}",Ht,'="type" in ',ee,"?",Ie.glTypes,"[",ee,".type]:",Ct,".dtype;",Ue.normalized,"=!!",ee,".normalized;");function Et(It){ve(Ue[It],"=",ee,".",It,"|0;")}return Et("size"),Et("offset"),Et("stride"),Et("divisor"),ve("}}"),ve.exit("if(",Ue.isStream,"){",Xe,".destroyStream(",Ct,");","}"),Ue}De[be]=Br(ye,Ce)}),De}function Vt(ne,M){var me=ne.static,Qe=ne.dynamic;if(Or in me){var De=me[Or];return De!==null&&it.getVAO(De)===null&&(De=it.createVAO(De)),nr(function(ye){return ye.link(it.getVAO(De))})}else if(Or in Qe){var be=Qe[Or];return Br(be,function(ye,Ce){var ie=ye.invoke(Ce,be);return Ce.def(ye.shared.vao+".getVAO("+ie+")")})}return null}function Ot(ne){var M=ne.static,me=ne.dynamic,Qe={};return Object.keys(M).forEach(function(De){var be=M[De];Qe[De]=nr(function(ye,Ce){return typeof be=="number"||typeof be=="boolean"?""+be:ye.link(be)})}),Object.keys(me).forEach(function(De){var be=me[De];Qe[De]=Br(be,function(ye,Ce){return ye.invoke(Ce,be)})}),Qe}function Zt(ne,M,me,Qe,De){var be=ne.static,ye=ne.dynamic;re.optional(function(){var Et=[jn,Sn,Qn,Yr,Xr,Oo,Kn,Ga,Aa,Or].concat(u);function It(Gt){Object.keys(Gt).forEach(function(Kt){re.command(Et.indexOf(Kt)>=0,'unknown parameter "'+Kt+'"',De.commandStr)})}It(be),It(ye)});var Ce=$e(ne,M),ie=Re(ne),ve=Je(ne,ie,De),ee=ht(ne,De),_e=mt(ne,De),Ie=et(ne,De,Ce);function We(Et){var It=ve[Et];It&&(_e[Et]=It)}We(rn),We(B(_n));var Xe=Object.keys(_e).length>0,Ue={framebuffer:ie,draw:ee,shader:Ie,state:_e,dirty:Xe,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Ue.profile=He(ne),Ue.uniforms=Pt(me,De),Ue.drawVAO=Ue.scopeVAO=Vt(ne),!Ue.drawVAO&&Ie.program&&!Ce&&he.angle_instanced_arrays){var at=!0,Ct=Ie.program.attributes.map(function(Et){var It=M.static[Et];return at=at&&!!It,It});if(at&&Ct.length>0){var Ht=it.getVAO(it.createVAO(Ct));Ue.drawVAO=new pr(null,null,null,function(Et,It){return Et.link(Ht)}),Ue.useVAO=!0}}return Ce?Ue.useVAO=!0:Ue.attributes=xt(M,De),Ue.context=Ot(Qe),Ue}function eA(ne,M,me){var Qe=ne.shared,De=Qe.context,be=ne.scope();Object.keys(me).forEach(function(ye){M.save(De,"."+ye);var Ce=me[ye],ie=Ce.append(ne,M);Array.isArray(ie)?be(De,".",ye,"=[",ie.join(),"];"):be(De,".",ye,"=",ie,";")}),M(be)}function $t(ne,M,me,Qe){var De=ne.shared,be=De.gl,ye=De.framebuffer,Ce;r&&(Ce=M.def(De.extensions,".webgl_draw_buffers"));var ie=ne.constants,ve=ie.drawBuffer,ee=ie.backBuffer,_e;me?_e=me.append(ne,M):_e=M.def(ye,".next"),Qe||M("if(",_e,"!==",ye,".cur){"),M("if(",_e,"){",be,".bindFramebuffer(",Vl,",",_e,".framebuffer);"),r&&M(Ce,".drawBuffersWEBGL(",ve,"[",_e,".colorAttachments.length]);"),M("}else{",be,".bindFramebuffer(",Vl,",null);"),r&&M(Ce,".drawBuffersWEBGL(",ee,");"),M("}",ye,".cur=",_e,";"),Qe||M("}")}function LA(ne,M,me){var Qe=ne.shared,De=Qe.gl,be=ne.current,ye=ne.next,Ce=Qe.current,ie=Qe.next,ve=ne.cond(Ce,".dirty");u.forEach(function(ee){var _e=B(ee);if(!(_e in me.state)){var Ie,We;if(_e in ye){Ie=ye[_e],We=be[_e];var Xe=WA(n[_e].length,function(at){return ve.def(Ie,"[",at,"]")});ve(ne.cond(Xe.map(function(at,Ct){return at+"!=="+We+"["+Ct+"]"}).join("||")).then(De,".",d[_e],"(",Xe,");",Xe.map(function(at,Ct){return We+"["+Ct+"]="+at}).join(";"),";"))}else{Ie=ve.def(ie,".",_e);var Ue=ne.cond(Ie,"!==",Ce,".",_e);ve(Ue),_e in c?Ue(ne.cond(Ie).then(De,".enable(",c[_e],");").else(De,".disable(",c[_e],");"),Ce,".",_e,"=",Ie,";"):Ue(De,".",d[_e],"(",Ie,");",Ce,".",_e,"=",Ie,";")}}}),Object.keys(me.state).length===0&&ve(Ce,".dirty=false;"),M(ve)}function tA(ne,M,me,Qe){var De=ne.shared,be=ne.current,ye=De.current,Ce=De.gl;Xs(Object.keys(me)).forEach(function(ie){var ve=me[ie];if(!(Qe&&!Qe(ve))){var ee=ve.append(ne,M);if(c[ie]){var _e=c[ie];In(ve)?ee?M(Ce,".enable(",_e,");"):M(Ce,".disable(",_e,");"):M(ne.cond(ee).then(Ce,".enable(",_e,");").else(Ce,".disable(",_e,");")),M(ye,".",ie,"=",ee,";")}else if(qA(ee)){var Ie=be[ie];M(Ce,".",d[ie],"(",ee,");",ee.map(function(We,Xe){return Ie+"["+Xe+"]="+We}).join(";"),";")}else M(Ce,".",d[ie],"(",ee,");",ye,".",ie,"=",ee,";")}})}function zt(ne,M){A&&(ne.instancing=M.def(ne.shared.extensions,".angle_instanced_arrays"))}function Bt(ne,M,me,Qe,De){var be=ne.shared,ye=ne.stats,Ce=be.current,ie=be.timer,ve=me.profile;function ee(){return typeof performance>"u"?"Date.now()":"performance.now()"}var _e,Ie;function We(Et){_e=M.def(),Et(_e,"=",ee(),";"),typeof De=="string"?Et(ye,".count+=",De,";"):Et(ye,".count++;"),rt&&(Qe?(Ie=M.def(),Et(Ie,"=",ie,".getNumPendingQueries();")):Et(ie,".beginQuery(",ye,");"))}function Xe(Et){Et(ye,".cpuTime+=",ee(),"-",_e,";"),rt&&(Qe?Et(ie,".pushScopeStats(",Ie,",",ie,".getNumPendingQueries(),",ye,");"):Et(ie,".endQuery();"))}function Ue(Et){var It=M.def(Ce,".profile");M(Ce,".profile=",Et,";"),M.exit(Ce,".profile=",It,";")}var at;if(ve){if(In(ve)){ve.enable?(We(M),Xe(M.exit),Ue("true")):Ue("false");return}at=ve.append(ne,M),Ue(at)}else at=M.def(Ce,".profile");var Ct=ne.block();We(Ct),M("if(",at,"){",Ct,"}");var Ht=ne.block();Xe(Ht),M.exit("if(",at,"){",Ht,"}")}function Yt(ne,M,me,Qe,De){var be=ne.shared;function ye(ie){switch(ie){case za:case Dn:case Go:return 2;case Wa:case aa:case ti:return 3;case qa:case oa:case Ya:return 4;default:return 1}}function Ce(ie,ve,ee){var _e=be.gl,Ie=M.def(ie,".location"),We=M.def(be.attributes,"[",Ie,"]"),Xe=ee.state,Ue=ee.buffer,at=[ee.x,ee.y,ee.z,ee.w],Ct=["buffer","normalized","offset","stride"];function Ht(){M("if(!",We,".buffer){",_e,".enableVertexAttribArray(",Ie,");}");var It=ee.type,Gt;if(ee.size?Gt=M.def(ee.size,"||",ve):Gt=ve,M("if(",We,".type!==",It,"||",We,".size!==",Gt,"||",Ct.map(function(ir){return We+"."+ir+"!=="+ee[ir]}).join("||"),"){",_e,".bindBuffer(",na,",",Ue,".buffer);",_e,".vertexAttribPointer(",[Ie,Gt,It,ee.normalized,ee.stride,ee.offset],");",We,".type=",It,";",We,".size=",Gt,";",Ct.map(function(ir){return We+"."+ir+"="+ee[ir]+";"}).join(""),"}"),A){var Kt=ee.divisor;M("if(",We,".divisor!==",Kt,"){",ne.instancing,".vertexAttribDivisorANGLE(",[Ie,Kt],");",We,".divisor=",Kt,";}")}}function Et(){M("if(",We,".buffer){",_e,".disableVertexAttribArray(",Ie,");",We,".buffer=null;","}if(",Cn.map(function(It,Gt){return We+"."+It+"!=="+at[Gt]}).join("||"),"){",_e,".vertexAttrib4f(",Ie,",",at,");",Cn.map(function(It,Gt){return We+"."+It+"="+at[Gt]+";"}).join(""),"}")}Xe===bi?Ht():Xe===Ls?Et():(M("if(",Xe,"===",bi,"){"),Ht(),M("}else{"),Et(),M("}"))}Qe.forEach(function(ie){var ve=ie.name,ee=me.attributes[ve],_e;if(ee){if(!De(ee))return;_e=ee.append(ne,M)}else{if(!De(Si))return;var Ie=ne.scopeAttrib(ve);re.optional(function(){ne.assert(M,Ie+".state","missing attribute "+ve)}),_e={},Object.keys(new e).forEach(function(We){_e[We]=M.def(Ie,".",We)})}Ce(ne.link(ie),ye(ie.info.type),_e)})}function Ut(ne,M,me,Qe,De){for(var be=ne.shared,ye=be.gl,Ce,ie=0;ie<Qe.length;++ie){var ve=Qe[ie],ee=ve.name,_e=ve.info.type,Ie=me.uniforms[ee],We=ne.link(ve),Xe=We+".location",Ue;if(Ie){if(!De(Ie))continue;if(In(Ie)){var at=Ie.value;if(re.command(at!==null&&typeof at<"u",'missing uniform "'+ee+'"',ne.commandStr),_e===Va||_e===ja){re.command(typeof at=="function"&&(_e===Va&&(at._reglType==="texture2d"||at._reglType==="framebuffer")||_e===ja&&(at._reglType==="textureCube"||at._reglType==="framebufferCube")),"invalid texture for uniform "+ee,ne.commandStr);var Ct=ne.link(at._texture||at.color[0]._texture);M(ye,".uniform1i(",Xe,",",Ct+".bind());"),M.exit(Ct,".unbind();")}else if(_e===Xa||_e===sa||_e===Ai){re.optional(function(){re.command(qA(at),"invalid matrix for uniform "+ee,ne.commandStr),re.command(_e===Xa&&at.length===4||_e===sa&&at.length===9||_e===Ai&&at.length===16,"invalid length for matrix uniform "+ee,ne.commandStr)});var Ht=ne.global.def("new Float32Array(["+Array.prototype.slice.call(at)+"])"),Et=2;_e===sa?Et=3:_e===Ai&&(Et=4),M(ye,".uniformMatrix",Et,"fv(",Xe,",false,",Ht,");")}else{switch(_e){case ei:re.commandType(at,"number","uniform "+ee,ne.commandStr),Ce="1f";break;case za:re.command(qA(at)&&at.length===2,"uniform "+ee,ne.commandStr),Ce="2f";break;case Wa:re.command(qA(at)&&at.length===3,"uniform "+ee,ne.commandStr),Ce="3f";break;case qa:re.command(qA(at)&&at.length===4,"uniform "+ee,ne.commandStr),Ce="4f";break;case $a:re.commandType(at,"boolean","uniform "+ee,ne.commandStr),Ce="1i";break;case ia:re.commandType(at,"number","uniform "+ee,ne.commandStr),Ce="1i";break;case Go:re.command(qA(at)&&at.length===2,"uniform "+ee,ne.commandStr),Ce="2i";break;case Dn:re.command(qA(at)&&at.length===2,"uniform "+ee,ne.commandStr),Ce="2i";break;case ti:re.command(qA(at)&&at.length===3,"uniform "+ee,ne.commandStr),Ce="3i";break;case aa:re.command(qA(at)&&at.length===3,"uniform "+ee,ne.commandStr),Ce="3i";break;case Ya:re.command(qA(at)&&at.length===4,"uniform "+ee,ne.commandStr),Ce="4i";break;case oa:re.command(qA(at)&&at.length===4,"uniform "+ee,ne.commandStr),Ce="4i";break}M(ye,".uniform",Ce,"(",Xe,",",qA(at)?Array.prototype.slice.call(at):at,");")}continue}else Ue=Ie.append(ne,M)}else{if(!De(Si))continue;Ue=M.def(be.uniforms,"[",Y.id(ee),"]")}_e===Va?(re(!Array.isArray(Ue),"must specify a scalar prop for textures"),M("if(",Ue,"&&",Ue,'._reglType==="framebuffer"){',Ue,"=",Ue,".color[0];","}")):_e===ja&&(re(!Array.isArray(Ue),"must specify a scalar prop for cube maps"),M("if(",Ue,"&&",Ue,'._reglType==="framebufferCube"){',Ue,"=",Ue,".color[0];","}")),re.optional(function(){function Lr(Ln,qu){ne.assert(M,Ln,'bad data or missing for uniform "'+ee+'".  '+qu)}function zu(Ln){re(!Array.isArray(Ue),"must not specify an array type for uniform"),Lr("typeof "+Ue+'==="'+Ln+'"',"invalid type, expected "+Ln)}function an(Ln,qu){Array.isArray(Ue)?re(Ue.length===Ln,"must have length "+Ln):Lr(be.isArrayLike+"("+Ue+")&&"+Ue+".length==="+Ln,"invalid vector, should have length "+Ln,ne.commandStr)}function Wu(Ln){re(!Array.isArray(Ue),"must not specify a value type"),Lr("typeof "+Ue+'==="function"&&'+Ue+'._reglType==="texture'+(Ln===qs?"2d":"Cube")+'"',"invalid texture type",ne.commandStr)}switch(_e){case ia:zu("number");break;case Dn:an(2);break;case aa:an(3);break;case oa:an(4);break;case ei:zu("number");break;case za:an(2);break;case Wa:an(3);break;case qa:an(4);break;case $a:zu("boolean");break;case Go:an(2);break;case ti:an(3);break;case Ya:an(4);break;case Xa:an(4);break;case sa:an(9);break;case Ai:an(16);break;case Va:Wu(qs);break;case ja:Wu(Lu);break}});var It=1;switch(_e){case Va:case ja:var Gt=M.def(Ue,"._texture");M(ye,".uniform1i(",Xe,",",Gt,".bind());"),M.exit(Gt,".unbind();");continue;case ia:case $a:Ce="1i";break;case Dn:case Go:Ce="2i",It=2;break;case aa:case ti:Ce="3i",It=3;break;case oa:case Ya:Ce="4i",It=4;break;case ei:Ce="1f";break;case za:Ce="2f",It=2;break;case Wa:Ce="3f",It=3;break;case qa:Ce="4f",It=4;break;case Xa:Ce="Matrix2fv";break;case sa:Ce="Matrix3fv";break;case Ai:Ce="Matrix4fv";break}if(M(ye,".uniform",Ce,"(",Xe,","),Ce.charAt(0)==="M"){var Kt=Math.pow(_e-Xa+2,2),ir=ne.global.def("new Float32Array(",Kt,")");Array.isArray(Ue)?M("false,(",WA(Kt,function(Lr){return ir+"["+Lr+"]="+Ue[Lr]}),",",ir,")"):M("false,(Array.isArray(",Ue,")||",Ue," instanceof Float32Array)?",Ue,":(",WA(Kt,function(Lr){return ir+"["+Lr+"]="+Ue+"["+Lr+"]"}),",",ir,")")}else It>1?M(WA(It,function(Lr){return Array.isArray(Ue)?Ue[Lr]:Ue+"["+Lr+"]"})):(re(!Array.isArray(Ue),"uniform value must not be an array"),M(Ue));M(");")}}function _t(ne,M,me,Qe){var De=ne.shared,be=De.gl,ye=De.draw,Ce=Qe.draw;function ie(){var Gt=Ce.elements,Kt,ir=M;return Gt?((Gt.contextDep&&Qe.contextDynamic||Gt.propDep)&&(ir=me),Kt=Gt.append(ne,ir)):Kt=ir.def(ye,".",Yr),Kt&&ir("if("+Kt+")"+be+".bindBuffer("+ku+","+Kt+".buffer.buffer);"),Kt}function ve(){var Gt=Ce.count,Kt,ir=M;return Gt?((Gt.contextDep&&Qe.contextDynamic||Gt.propDep)&&(ir=me),Kt=Gt.append(ne,ir),re.optional(function(){Gt.MISSING&&ne.assert(M,"false","missing vertex count"),Gt.DYNAMIC&&ne.assert(ir,Kt+">=0","missing vertex count")})):(Kt=ir.def(ye,".",Kn),re.optional(function(){ne.assert(ir,Kt+">=0","missing vertex count")})),Kt}var ee=ie();function _e(Gt){var Kt=Ce[Gt];return Kt?Kt.contextDep&&Qe.contextDynamic||Kt.propDep?Kt.append(ne,me):Kt.append(ne,M):M.def(ye,".",Gt)}var Ie=_e(Xr),We=_e(Oo),Xe=ve();if(typeof Xe=="number"){if(Xe===0)return}else me("if(",Xe,"){"),me.exit("}");var Ue,at;A&&(Ue=_e(Ga),at=ne.instancing);var Ct=ee+".type",Ht=Ce.elements&&In(Ce.elements);function Et(){function Gt(){me(at,".drawElementsInstancedANGLE(",[Ie,Xe,Ct,We+"<<(("+Ct+"-"+To+")>>1)",Ue],");")}function Kt(){me(at,".drawArraysInstancedANGLE(",[Ie,We,Xe,Ue],");")}ee?Ht?Gt():(me("if(",ee,"){"),Gt(),me("}else{"),Kt(),me("}")):Kt()}function It(){function Gt(){me(be+".drawElements("+[Ie,Xe,Ct,We+"<<(("+Ct+"-"+To+")>>1)"]+");")}function Kt(){me(be+".drawArrays("+[Ie,We,Xe]+");")}ee?Ht?Gt():(me("if(",ee,"){"),Gt(),me("}else{"),Kt(),me("}")):Kt()}A&&(typeof Ue!="number"||Ue>=0)?typeof Ue=="string"?(me("if(",Ue,">0){"),Et(),me("}else if(",Ue,"<0){"),It(),me("}")):Et():It()}function Rt(ne,M,me,Qe,De){var be=ke(),ye=be.proc("body",De);return re.optional(function(){be.commandStr=M.commandStr,be.command=be.link(M.commandStr)}),A&&(be.instancing=ye.def(be.shared.extensions,".angle_instanced_arrays")),ne(be,ye,me,Qe),be.compile().body}function Ft(ne,M,me,Qe){zt(ne,M),me.useVAO?me.drawVAO?M(ne.shared.vao,".setVAO(",me.drawVAO.append(ne,M),");"):M(ne.shared.vao,".setVAO(",ne.shared.vao,".targetVAO);"):(M(ne.shared.vao,".setVAO(null);"),Yt(ne,M,me,Qe.attributes,function(){return!0})),Ut(ne,M,me,Qe.uniforms,function(){return!0}),_t(ne,M,M,me)}function zA(ne,M){var me=ne.proc("draw",1);zt(ne,me),eA(ne,me,M.context),$t(ne,me,M.framebuffer),LA(ne,me,M),tA(ne,me,M.state),Bt(ne,me,M,!1,!0);var Qe=M.shader.progVar.append(ne,me);if(me(ne.shared.gl,".useProgram(",Qe,".program);"),M.shader.program)Ft(ne,me,M,M.shader.program);else{me(ne.shared.vao,".setVAO(null);");var De=ne.global.def("{}"),be=me.def(Qe,".id"),ye=me.def(De,"[",be,"]");me(ne.cond(ye).then(ye,".call(this,a0);").else(ye,"=",De,"[",be,"]=",ne.link(function(Ce){return Rt(Ft,ne,M,Ce,1)}),"(",Qe,");",ye,".call(this,a0);"))}Object.keys(M.state).length>0&&me(ne.shared.current,".dirty=true;")}function $A(ne,M,me,Qe){ne.batchId="a1",zt(ne,M);function De(){return!0}Yt(ne,M,me,Qe.attributes,De),Ut(ne,M,me,Qe.uniforms,De),_t(ne,M,M,me)}function kn(ne,M,me,Qe){zt(ne,M);var De=me.contextDep,be=M.def(),ye="a0",Ce="a1",ie=M.def();ne.shared.props=ie,ne.batchId=be;var ve=ne.scope(),ee=ne.scope();M(ve.entry,"for(",be,"=0;",be,"<",Ce,";++",be,"){",ie,"=",ye,"[",be,"];",ee,"}",ve.exit);function _e(Ct){return Ct.contextDep&&De||Ct.propDep}function Ie(Ct){return!_e(Ct)}if(me.needsContext&&eA(ne,ee,me.context),me.needsFramebuffer&&$t(ne,ee,me.framebuffer),tA(ne,ee,me.state,_e),me.profile&&_e(me.profile)&&Bt(ne,ee,me,!1,!0),Qe)me.useVAO?me.drawVAO?_e(me.drawVAO)?ee(ne.shared.vao,".setVAO(",me.drawVAO.append(ne,ee),");"):ve(ne.shared.vao,".setVAO(",me.drawVAO.append(ne,ve),");"):ve(ne.shared.vao,".setVAO(",ne.shared.vao,".targetVAO);"):(ve(ne.shared.vao,".setVAO(null);"),Yt(ne,ve,me,Qe.attributes,Ie),Yt(ne,ee,me,Qe.attributes,_e)),Ut(ne,ve,me,Qe.uniforms,Ie),Ut(ne,ee,me,Qe.uniforms,_e),_t(ne,ve,ee,me);else{var We=ne.global.def("{}"),Xe=me.shader.progVar.append(ne,ee),Ue=ee.def(Xe,".id"),at=ee.def(We,"[",Ue,"]");ee(ne.shared.gl,".useProgram(",Xe,".program);","if(!",at,"){",at,"=",We,"[",Ue,"]=",ne.link(function(Ct){return Rt($A,ne,me,Ct,2)}),"(",Xe,");}",at,".call(this,a0[",be,"],",be,");")}}function ae(ne,M){var me=ne.proc("batch",2);ne.batchId="0",zt(ne,me);var Qe=!1,De=!0;Object.keys(M.context).forEach(function(We){Qe=Qe||M.context[We].propDep}),Qe||(eA(ne,me,M.context),De=!1);var be=M.framebuffer,ye=!1;be?(be.propDep?Qe=ye=!0:be.contextDep&&Qe&&(ye=!0),ye||$t(ne,me,be)):$t(ne,me,null),M.state.viewport&&M.state.viewport.propDep&&(Qe=!0);function Ce(We){return We.contextDep&&Qe||We.propDep}LA(ne,me,M),tA(ne,me,M.state,function(We){return!Ce(We)}),(!M.profile||!Ce(M.profile))&&Bt(ne,me,M,!1,"a1"),M.contextDep=Qe,M.needsContext=De,M.needsFramebuffer=ye;var ie=M.shader.progVar;if(ie.contextDep&&Qe||ie.propDep)kn(ne,me,M,null);else{var ve=ie.append(ne,me);if(me(ne.shared.gl,".useProgram(",ve,".program);"),M.shader.program)kn(ne,me,M,M.shader.program);else{me(ne.shared.vao,".setVAO(null);");var ee=ne.global.def("{}"),_e=me.def(ve,".id"),Ie=me.def(ee,"[",_e,"]");me(ne.cond(Ie).then(Ie,".call(this,a0,a1);").else(Ie,"=",ee,"[",_e,"]=",ne.link(function(We){return Rt(kn,ne,M,We,2)}),"(",ve,");",Ie,".call(this,a0,a1);"))}}Object.keys(M.state).length>0&&me(ne.shared.current,".dirty=true;")}function Le(ne,M){var me=ne.proc("scope",3);ne.batchId="a2";var Qe=ne.shared,De=Qe.current;eA(ne,me,M.context),M.framebuffer&&M.framebuffer.append(ne,me),Xs(Object.keys(M.state)).forEach(function(ye){var Ce=M.state[ye],ie=Ce.append(ne,me);qA(ie)?ie.forEach(function(ve,ee){me.set(ne.next[ye],"["+ee+"]",ve)}):me.set(Qe.next,"."+ye,ie)}),Bt(ne,me,M,!0,!0),[Yr,Oo,Kn,Ga,Xr].forEach(function(ye){var Ce=M.draw[ye];Ce&&me.set(Qe.draw,"."+ye,""+Ce.append(ne,me))}),Object.keys(M.uniforms).forEach(function(ye){var Ce=M.uniforms[ye].append(ne,me);Array.isArray(Ce)&&(Ce="["+Ce.join()+"]"),me.set(Qe.uniforms,"["+Y.id(ye)+"]",Ce)}),Object.keys(M.attributes).forEach(function(ye){var Ce=M.attributes[ye].append(ne,me),ie=ne.scopeAttrib(ye);Object.keys(new e).forEach(function(ve){me.set(ie,"."+ve,Ce[ve])})}),M.scopeVAO&&me.set(Qe.vao,".targetVAO",M.scopeVAO.append(ne,me));function be(ye){var Ce=M.shader[ye];Ce&&me.set(Qe.shader,"."+ye,Ce.append(ne,me))}be(Sn),be(Qn),Object.keys(M.state).length>0&&(me(De,".dirty=true;"),me.exit(De,".dirty=true;")),me("a1(",ne.shared.context,",a0,",ne.batchId,");")}function Pe(ne){if(!(typeof ne!="object"||qA(ne))){for(var M=Object.keys(ne),me=0;me<M.length;++me)if(ar.isDynamic(ne[M[me]]))return!0;return!1}}function ct(ne,M,me){var Qe=M.static[me];if(!Qe||!Pe(Qe))return;var De=ne.global,be=Object.keys(Qe),ye=!1,Ce=!1,ie=!1,ve=ne.global.def("{}");be.forEach(function(_e){var Ie=Qe[_e];if(ar.isDynamic(Ie)){typeof Ie=="function"&&(Ie=Qe[_e]=ar.unbox(Ie));var We=Br(Ie,null);ye=ye||We.thisDep,ie=ie||We.propDep,Ce=Ce||We.contextDep}else{switch(De(ve,".",_e,"="),typeof Ie){case"number":De(Ie);break;case"string":De('"',Ie,'"');break;case"object":Array.isArray(Ie)&&De("[",Ie.join(),"]");break;default:De(ne.link(Ie));break}De(";")}});function ee(_e,Ie){be.forEach(function(We){var Xe=Qe[We];if(ar.isDynamic(Xe)){var Ue=_e.invoke(Ie,Xe);Ie(ve,".",We,"=",Ue,";")}})}M.dynamic[me]=new ar.DynamicVariable(Oa,{thisDep:ye,contextDep:Ce,propDep:ie,ref:ve,append:ee}),delete M.static[me]}function Nt(ne,M,me,Qe,De){var be=ke();be.stats=be.link(De),Object.keys(M.static).forEach(function(Ce){ct(be,M,Ce)}),Iu.forEach(function(Ce){ct(be,ne,Ce)});var ye=Zt(ne,M,me,Qe,be);return zA(be,ye),Le(be,ye),ae(be,ye),l(be.compile(),{destroy:function(){ye.shader.program.destroy()}})}return{next:s,current:n,procs:function(){var ne=ke(),M=ne.proc("poll"),me=ne.proc("refresh"),Qe=ne.block();M(Qe),me(Qe);var De=ne.shared,be=De.gl,ye=De.next,Ce=De.current;Qe(Ce,".dirty=false;"),$t(ne,M),$t(ne,me,null,!0);var ie;A&&(ie=ne.link(A)),he.oes_vertex_array_object&&me(ne.link(he.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ve=0;ve<Se.maxAttributes;++ve){var ee=me.def(De.attributes,"[",ve,"]"),_e=ne.cond(ee,".buffer");_e.then(be,".enableVertexAttribArray(",ve,");",be,".bindBuffer(",na,",",ee,".buffer.buffer);",be,".vertexAttribPointer(",ve,",",ee,".size,",ee,".type,",ee,".normalized,",ee,".stride,",ee,".offset);").else(be,".disableVertexAttribArray(",ve,");",be,".vertexAttrib4f(",ve,",",ee,".x,",ee,".y,",ee,".z,",ee,".w);",ee,".buffer=null;"),me(_e),A&&me(ie,".vertexAttribDivisorANGLE(",ve,",",ee,".divisor);")}return me(ne.shared.vao,".currentVAO=null;",ne.shared.vao,".setVAO(",ne.shared.vao,".targetVAO);"),Object.keys(c).forEach(function(Ie){var We=c[Ie],Xe=Qe.def(ye,".",Ie),Ue=ne.block();Ue("if(",Xe,"){",be,".enable(",We,")}else{",be,".disable(",We,")}",Ce,".",Ie,"=",Xe,";"),me(Ue),M("if(",Xe,"!==",Ce,".",Ie,"){",Ue,"}")}),Object.keys(d).forEach(function(Ie){var We=d[Ie],Xe=n[Ie],Ue,at,Ct=ne.block();if(Ct(be,".",We,"("),qA(Xe)){var Ht=Xe.length;Ue=ne.global.def(ye,".",Ie),at=ne.global.def(Ce,".",Ie),Ct(WA(Ht,function(Et){return Ue+"["+Et+"]"}),");",WA(Ht,function(Et){return at+"["+Et+"]="+Ue+"["+Et+"];"}).join("")),M("if(",WA(Ht,function(Et){return Ue+"["+Et+"]!=="+at+"["+Et+"]"}).join("||"),"){",Ct,"}")}else Ue=Qe.def(ye,".",Ie),at=Qe.def(Ce,".",Ie),Ct(Ue,");",Ce,".",Ie,"=",Ue,";"),M("if(",Ue,"!==",at,"){",Ct,"}");me(Ct)}),ne.compile()}(),compile:Nt}}function zo(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Gu=34918,Uu=34919,Zl=35007,jA=function(E,Y){if(!Y.ext_disjoint_timer_query)return null;var he=[];function Se(){return he.pop()||Y.ext_disjoint_timer_query.createQueryEXT()}function qe(A){he.push(A)}var Fe=[];function Me(A){var r=Se();Y.ext_disjoint_timer_query.beginQueryEXT(Zl,r),Fe.push(r),rt(Fe.length-1,Fe.length,A)}function tt(){Y.ext_disjoint_timer_query.endQueryEXT(Zl)}function At(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var it=[];function Ye(){return it.pop()||new At}function lt(A){it.push(A)}var ft=[];function rt(A,r,n){var s=Ye();s.startQueryIndex=A,s.endQueryIndex=r,s.sum=0,s.stats=n,ft.push(s)}var ot=[],e=[];function t(){var A,r,n=Fe.length;if(n!==0){e.length=Math.max(e.length,n+1),ot.length=Math.max(ot.length,n+1),ot[0]=0,e[0]=0;var s=0;for(A=0,r=0;r<Fe.length;++r){var u=Fe[r];Y.ext_disjoint_timer_query.getQueryObjectEXT(u,Uu)?(s+=Y.ext_disjoint_timer_query.getQueryObjectEXT(u,Gu),qe(u)):Fe[A++]=u,ot[r+1]=s,e[r+1]=A}for(Fe.length=A,A=0,r=0;r<ft.length;++r){var c=ft[r],d=c.startQueryIndex,B=c.endQueryIndex;c.sum+=ot[B]-ot[d];var R=e[d],te=e[B];te===R?(c.stats.gpuTime+=c.sum/1e6,lt(c)):(c.startQueryIndex=R,c.endQueryIndex=te,ft[A++]=c)}ft.length=A}}return{beginQuery:Me,endQuery:tt,pushScopeStats:rt,update:t,getNumPendingQueries:function(){return Fe.length},clear:function(){he.push.apply(he,Fe);for(var A=0;A<he.length;A++)Y.ext_disjoint_timer_query.deleteQueryEXT(he[A]);Fe.length=0,he.length=0},restore:function(){Fe.length=0,he.length=0}}},Hu=16384,Vs=256,Za=1024,Vr=34962,eo="webglcontextlost",Wo="webglcontextrestored",js=1,eu=2,tu=3;function qo(E,Y){for(var he=0;he<E.length;++he)if(E[he]===Y)return he;return-1}function Au(E){var Y=wr(E);if(!Y)return null;var he=Y.gl,Se=he.getContextAttributes(),qe=he.isContextLost(),Fe=Nr(he,Y);if(!Fe)return null;var Me=Ao(),tt=zo(),At=Fe.extensions,it=jA(he,At),Ye=Xt(),lt=he.drawingBufferWidth,ft=he.drawingBufferHeight,rt={tick:0,time:0,viewportWidth:lt,viewportHeight:ft,framebufferWidth:lt,framebufferHeight:ft,drawingBufferWidth:lt,drawingBufferHeight:ft,pixelRatio:Y.pixelRatio},ot={},e={elements:null,primitive:4,count:-1,offset:0,instances:-1},t=ma(he,At),A=Wr(he,tt,Y,n),r=Xn(he,At,t,tt,A);function n(_t){return r.destroyBuffer(_t)}var s=pu(he,At,A,tt),u=Qu(he,Me,tt,Y),c=La(he,At,t,function(){R.procs.poll()},rt,tt,Y),d=Cu(he,At,t,tt,Y),B=Ll(he,At,t,c,d,tt),R=Jl(he,Me,At,t,A,s,c,B,ot,r,u,e,rt,it,Y),te=Vn(he,B,R.procs.poll,rt,Se,At,t),se=R.next,Ae=he.canvas,fe=[],ke=[],He=[],Re=[Y.onDestroy],Je=null;function $e(){if(fe.length===0){it&&it.update(),Je=null;return}Je=da.next($e),tA();for(var _t=fe.length-1;_t>=0;--_t){var Rt=fe[_t];Rt&&Rt(rt,null,0)}he.flush(),it&&it.update()}function et(){!Je&&fe.length>0&&(Je=da.next($e))}function ht(){Je&&(da.cancel($e),Je=null)}function mt(_t){_t.preventDefault(),qe=!0,ht(),ke.forEach(function(Rt){Rt()})}function Pt(_t){he.getError(),qe=!1,Fe.restore(),u.restore(),A.restore(),c.restore(),d.restore(),B.restore(),r.restore(),it&&it.restore(),R.procs.refresh(),et(),He.forEach(function(Rt){Rt()})}Ae&&(Ae.addEventListener(eo,mt,!1),Ae.addEventListener(Wo,Pt,!1));function xt(){fe.length=0,ht(),Ae&&(Ae.removeEventListener(eo,mt),Ae.removeEventListener(Wo,Pt)),u.clear(),B.clear(),d.clear(),c.clear(),s.clear(),A.clear(),r.clear(),it&&it.clear(),Re.forEach(function(_t){_t()})}function Vt(_t){re(!!_t,"invalid args to regl({...})"),re.type(_t,"object","invalid args to regl({...})");function Rt(De){var be=l({},De);delete be.uniforms,delete be.attributes,delete be.context,delete be.vao,"stencil"in be&&be.stencil.op&&(be.stencil.opBack=be.stencil.opFront=be.stencil.op,delete be.stencil.op);function ye(Ce){if(Ce in be){var ie=be[Ce];delete be[Ce],Object.keys(ie).forEach(function(ve){be[Ce+"."+ve]=ie[ve]})}}return ye("blend"),ye("depth"),ye("cull"),ye("stencil"),ye("polygonOffset"),ye("scissor"),ye("sample"),"vao"in De&&(be.vao=De.vao),be}function Ft(De,be){var ye={},Ce={};return Object.keys(De).forEach(function(ie){var ve=De[ie];if(ar.isDynamic(ve)){Ce[ie]=ar.unbox(ve,ie);return}else if(be&&Array.isArray(ve)){for(var ee=0;ee<ve.length;++ee)if(ar.isDynamic(ve[ee])){Ce[ie]=ar.unbox(ve,ie);return}}ye[ie]=ve}),{dynamic:Ce,static:ye}}var zA=Ft(_t.context||{},!0),$A=Ft(_t.uniforms||{},!0),kn=Ft(_t.attributes||{},!1),ae=Ft(Rt(_t),!1),Le={gpuTime:0,cpuTime:0,count:0},Pe=R.compile(ae,kn,$A,zA,Le),ct=Pe.draw,Nt=Pe.batch,ne=Pe.scope,M=[];function me(De){for(;M.length<De;)M.push(null);return M}function Qe(De,be){var ye;if(qe&&re.raise("context lost"),typeof De=="function")return ne.call(this,null,De,0);if(typeof be=="function")if(typeof De=="number")for(ye=0;ye<De;++ye)ne.call(this,null,be,ye);else if(Array.isArray(De))for(ye=0;ye<De.length;++ye)ne.call(this,De[ye],be,ye);else return ne.call(this,De,be,0);else if(typeof De=="number"){if(De>0)return Nt.call(this,me(De|0),De|0)}else if(Array.isArray(De)){if(De.length)return Nt.call(this,De,De.length)}else return ct.call(this,De)}return l(Qe,{stats:Le,destroy:function(){Pe.destroy()}})}var Ot=B.setFBO=Vt({framebuffer:ar.define.call(null,js,"framebuffer")});function Zt(_t,Rt){var Ft=0;R.procs.poll();var zA=Rt.color;zA&&(he.clearColor(+zA[0]||0,+zA[1]||0,+zA[2]||0,+zA[3]||0),Ft|=Hu),"depth"in Rt&&(he.clearDepth(+Rt.depth),Ft|=Vs),"stencil"in Rt&&(he.clearStencil(Rt.stencil|0),Ft|=Za),re(!!Ft,"called regl.clear with no buffer specified"),he.clear(Ft)}function eA(_t){if(re(typeof _t=="object"&&_t,"regl.clear() takes an object as input"),"framebuffer"in _t)if(_t.framebuffer&&_t.framebuffer_reglType==="framebufferCube")for(var Rt=0;Rt<6;++Rt)Ot(l({framebuffer:_t.framebuffer.faces[Rt]},_t),Zt);else Ot(_t,Zt);else Zt(null,_t)}function $t(_t){re.type(_t,"function","regl.frame() callback must be a function"),fe.push(_t);function Rt(){var Ft=qo(fe,_t);re(Ft>=0,"cannot cancel a frame twice");function zA(){var $A=qo(fe,zA);fe[$A]=fe[fe.length-1],fe.length-=1,fe.length<=0&&ht()}fe[Ft]=zA}return et(),{cancel:Rt}}function LA(){var _t=se.viewport,Rt=se.scissor_box;_t[0]=_t[1]=Rt[0]=Rt[1]=0,rt.viewportWidth=rt.framebufferWidth=rt.drawingBufferWidth=_t[2]=Rt[2]=he.drawingBufferWidth,rt.viewportHeight=rt.framebufferHeight=rt.drawingBufferHeight=_t[3]=Rt[3]=he.drawingBufferHeight}function tA(){rt.tick+=1,rt.time=Bt(),LA(),R.procs.poll()}function zt(){c.refresh(),LA(),R.procs.refresh(),it&&it.update()}function Bt(){return(Xt()-Ye)/1e3}zt();function Yt(_t,Rt){re.type(Rt,"function","listener callback must be a function");var Ft;switch(_t){case"frame":return $t(Rt);case"lost":Ft=ke;break;case"restore":Ft=He;break;case"destroy":Ft=Re;break;default:re.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ft.push(Rt),{cancel:function(){for(var zA=0;zA<Ft.length;++zA)if(Ft[zA]===Rt){Ft[zA]=Ft[Ft.length-1],Ft.pop();return}}}}var Ut=l(Vt,{clear:eA,prop:ar.define.bind(null,js),context:ar.define.bind(null,eu),this:ar.define.bind(null,tu),draw:Vt({}),buffer:function(_t){return A.create(_t,Vr,!1,!1)},elements:function(_t){return s.create(_t,!1)},texture:c.create2D,cube:c.createCube,renderbuffer:d.create,framebuffer:B.create,framebufferCube:B.createCube,vao:r.createVAO,attributes:Se,frame:$t,on:Yt,limits:t,hasExtension:function(_t){return t.extensions.indexOf(_t.toLowerCase())>=0},read:te,destroy:xt,_gl:he,_refresh:zt,poll:function(){tA(),it&&it.update()},now:Bt,stats:tt});return Y.onDone(null,Ut),Ut}return Au})}(regl$2)),regl$2.exports}var reglExports=requireRegl();const regl=getDefaultExportFromCjs(reglExports),Mouse=mouseListen();class HydraRenderer{constructor({pb:i=null,width:o=1280,height:l=720,numSources:f=4,numOutputs:m=4,makeGlobal:D=!0,autoLoop:F=!0,detectAudio:pe=!0,enableStreamCapture:ue=!0,canvas:j,precision:xe,extendTransforms:Z={}}={}){if(ArrayUtils.init(),this.pb=i,this.width=o,this.height=l,this.renderAll=!1,this.detectAudio=pe,this._initCanvas(j),this.synth={time:0,bpm:30,width:this.width,height:this.height,fps:void 0,stats:{fps:0},speed:1,mouse:Mouse,render:this._render.bind(this),setResolution:this.setResolution.bind(this),update:we=>{},hush:this.hush.bind(this),tick:this.tick.bind(this)},D&&(window.loadScript=this.loadScript),this.timeSinceLastUpdate=0,this._time=0,xe&&["lowp","mediump","highp"].includes(xe.toLowerCase()))this.precision=xe.toLowerCase();else{let we=(/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream;this.precision=we?"highp":"mediump"}if(this.extendTransforms=Z,this.saveFrame=!1,this.captureStream=null,this.generator=void 0,this._initRegl(),this._initOutputs(m),this._initSources(f),this._generateGlslTransforms(),this.synth.screencap=()=>{this.saveFrame=!0},ue)try{this.captureStream=this.canvas.captureStream(25),this.synth.vidRecorder=new VideoRecorder(this.captureStream)}catch(we){console.warn(`[hydra-synth warning]
new MediaSource() is not currently supported on iOS.`),console.error(we)}pe&&this._initAudio(),F&&loop(this.tick.bind(this)).start(),this.sandbox=new EvalSandbox(this.synth,D,["speed","update","bpm","fps"])}eval(i){this.sandbox.eval(i)}getScreenImage(i){this.imageCallback=i,this.saveFrame=!0}hush(){this.s.forEach(i=>{i.clear()}),this.o.forEach(i=>{this.synth.solid(0,0,0,0).out(i)}),this.synth.render(this.o[0]),this.sandbox.set("update",i=>{})}loadScript(i=""){return new Promise((l,f)=>{var m=document.createElement("script");m.onload=function(){console.log(`loaded script ${i}`),l()},m.onerror=D=>{console.log(`error loading script ${i}`,"log-error"),l()},m.src=i,document.head.appendChild(m)})}setResolution(i,o){this.canvas.width=i,this.canvas.height=o,this.width=i,this.height=o,this.sandbox.set("width",i),this.sandbox.set("height",o),console.log(this.width),this.o.forEach(l=>{l.resize(i,o)}),this.s.forEach(l=>{l.resize(i,o)}),this.regl._refresh(),console.log(this.canvas.width)}canvasToImage(i){const o=document.createElement("a");o.style.display="none";let l=new Date;o.download=`hydra-${l.getFullYear()}-${l.getMonth()+1}-${l.getDate()}-${l.getHours()}.${l.getMinutes()}.${l.getSeconds()}.png`,document.body.appendChild(o);var f=this;this.canvas.toBlob(m=>{f.imageCallback?(f.imageCallback(m),delete f.imageCallback):(o.href=URL.createObjectURL(m),console.log(o.href),o.click())},"image/png"),setTimeout(()=>{document.body.removeChild(o),window.URL.revokeObjectURL(o.href)},300)}_initAudio(){this.synth.a=new Audio({numBins:4,parentEl:this.canvas.parentNode})}_initCanvas(i){i?(this.canvas=i,this.width=i.width,this.height=i.height):(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.imageRendering="pixelated",document.body.appendChild(this.canvas))}_initRegl(){this.regl=regl({canvas:this.canvas,pixelRatio:1}),this.regl.clear({color:[0,0,0,1]}),this.renderAll=this.regl({frag:`
      precision ${this.precision} float;
      varying vec2 uv;
      uniform sampler2D tex0;
      uniform sampler2D tex1;
      uniform sampler2D tex2;
      uniform sampler2D tex3;

      void main () {
        vec2 st = vec2(1.0 - uv.x, uv.y);
        st*= vec2(2);
        vec2 q = floor(st).xy*(vec2(2.0, 1.0));
        int quad = int(q.x) + int(q.y);
        st.x += step(1., mod(st.y,2.0));
        st.y += step(1., mod(st.x,2.0));
        st = fract(st);
        if(quad==0){
          gl_FragColor = texture2D(tex0, st);
        } else if(quad==1){
          gl_FragColor = texture2D(tex1, st);
        } else if (quad==2){
          gl_FragColor = texture2D(tex2, st);
        } else {
          gl_FragColor = texture2D(tex3, st);
        }

      }
      `,vert:`
      precision ${this.precision} float;
      attribute vec2 position;
      varying vec2 uv;

      void main () {
        uv = position;
        gl_Position = vec4(1.0 - 2.0 * position, 0, 1);
      }`,attributes:{position:[[-2,0],[0,-2],[2,2]]},uniforms:{tex0:this.regl.prop("tex0"),tex1:this.regl.prop("tex1"),tex2:this.regl.prop("tex2"),tex3:this.regl.prop("tex3")},count:3,depth:{enable:!1}}),this.renderFbo=this.regl({frag:`
      precision ${this.precision} float;
      varying vec2 uv;
      uniform vec2 resolution;
      uniform sampler2D tex0;

      void main () {
        gl_FragColor = texture2D(tex0, vec2(1.0 - uv.x, uv.y));
      }
      `,vert:`
      precision ${this.precision} float;
      attribute vec2 position;
      varying vec2 uv;

      void main () {
        uv = position;
        gl_Position = vec4(1.0 - 2.0 * position, 0, 1);
      }`,attributes:{position:[[-2,0],[0,-2],[2,2]]},uniforms:{tex0:this.regl.prop("tex0"),resolution:this.regl.prop("resolution")},count:3,depth:{enable:!1}})}_initOutputs(i){const o=this;this.o=Array(i).fill().map((l,f)=>{var m=new Output({regl:this.regl,width:this.width,height:this.height,precision:this.precision,label:`o${f}`});return m.id=f,o.synth["o"+f]=m,m}),this.output=this.o[0]}_initSources(i){this.s=[];for(var o=0;o<i;o++)this.createSource(o)}createSource(i){let o=new HydraSource({regl:this.regl,pb:this.pb,width:this.width,height:this.height,label:`s${i}`});return this.synth["s"+this.s.length]=o,this.s.push(o),o}_generateGlslTransforms(){var i=this;this.generator=new GeneratorFactory({defaultOutput:this.o[0],defaultUniforms:this.o[0].uniforms,extendTransforms:this.extendTransforms,changeListener:({type:o,method:l,synth:f})=>{o==="add"&&(i.synth[l]=f.generators[l],i.sandbox&&i.sandbox.add(l))}}),this.synth.setFunction=this.generator.setFunction.bind(this.generator)}_render(i){i?(this.output=i,this.isRenderingAll=!1):this.isRenderingAll=!0}tick(i,o){if(this.sandbox.tick(),this.detectAudio===!0&&this.synth.a.tick(),this.sandbox.set("time",this.synth.time+=i*.001*this.synth.speed),this.timeSinceLastUpdate+=i,!this.synth.fps||this.timeSinceLastUpdate>=1e3/this.synth.fps){if(this.synth.stats.fps=Math.ceil(1e3/this.timeSinceLastUpdate),this.synth.update)try{this.synth.update(this.timeSinceLastUpdate)}catch(l){console.log(l)}for(let l=0;l<this.s.length;l++)this.s[l].tick(this.synth.time);for(let l=0;l<this.o.length;l++)this.o[l].tick({time:this.synth.time,mouse:this.synth.mouse,bpm:this.synth.bpm,resolution:[this.canvas.width,this.canvas.height]});this.isRenderingAll?this.renderAll({tex0:this.o[0].getCurrent(),tex1:this.o[1].getCurrent(),tex2:this.o[2].getCurrent(),tex3:this.o[3].getCurrent(),resolution:[this.canvas.width,this.canvas.height]}):this.renderFbo({tex0:this.output.getCurrent(),resolution:[this.canvas.width,this.canvas.height]}),this.timeSinceLastUpdate=0}this.saveFrame===!0&&(this.canvasToImage(),this.saveFrame=!1)}}const hydraUtils={hydra:null,isInitialized:!1,extensionsLoaded:!1,init:function(){if(!this.isInitialized)if(typeof HydraRenderer<"u"){this.setupHydra(),this.isInitialized=!0;return}else console.error("Hydra is not defined. Please ensure Hydra is loaded before using hydraUtils.")},setupHydra:function(){const canvas=document.getElementById("canvas");this.hydra=new HydraRenderer({canvas,detectAudio:!0,enableStreamCapture:!0,width:canvas.clientWidth,height:canvas.clientHeight}),eval("setResolution(canvas.clientWidth, canvas.clientHeight)"),eval("a.show()"),window.hydraSynth=this.hydra,this.loadHydraExtensions()},async loadHydraExtensions(){if(!this.extensionsLoaded)try{console.log("🔄 Loading Hydra extensions..."),await __vitePreload(()=>import("./hydra_extra_shader-X2H_kiQe.js"),[]),console.log("✅ Hydra Extra Shaders loaded"),await __vitePreload(()=>import("./hydraFractal-Dxhf6r4P.js"),[]),console.log("✅ Hydra Fractals loaded"),await __vitePreload(()=>import("./antlia-math-C4FlbSWj.js"),[]),console.log("✅ Hydra Antlia Math loaded"),await __vitePreload(()=>import("./antlia-shape-C8XBDYkF.js"),[]),console.log("✅ Hydra Antlia Shapes loaded"),await __vitePreload(()=>import("./hydraFCS-C7pUOJt8.js"),[]),console.log("✅ Hydra FCS loaded"),await __vitePreload(()=>import("./databending-_mY77tKK.js"),[]),console.log("✅ Hydra Databending loaded"),this.extensionsLoaded=!0,console.log("🎉 All Hydra extensions loaded successfully!")}catch(w){console.error("❌ Error loading Hydra extensions:",w)}},getBlock:function(w,i){const o=w.lineCount();let l=i,f=i;for(;l>0&&w.getLine(l-1).trim()!=="";)l--;for(;f<o-1&&w.getLine(f+1).trim()!=="";)f++;return{startLine:l,endLine:f}},evaluateCode:function(code){try{eval(code)}catch(w){this.showErrorFlash(w.message),console.error("Error evaluating code:",w)}},showErrorFlash:function(w){const i=document.querySelector(".error-flash");i&&i.remove();const o=document.createElement("div");o.className="error-flash",o.textContent=`Erreur: ${w}`,document.body.appendChild(o),setTimeout(()=>{o.parentNode&&o.remove()},3e3)},stopHydra:function(){eval("hush()")},incrementValue(w,i){const o=w.getCursor(),l=w.getLine(o.line);let f=o.ch,m=o.ch;for(;f>0&&/[\d\.\-]/.test(l.charAt(f-1));)f--;for(;m<l.length&&/[\d\.]/.test(l.charAt(m));)m++;let D=l.substring(f,m);if(/^\.\d+$/.test(D)&&(D="0"+D),/^-?\d+(\.\d+)?$/.test(D)){let pe;if(D.includes(".")){const ue=parseFloat(D),j=D.split(".")[1]||"",xe=j.length>0?j.length:1,Z=xe>1?.01:.1;pe=(ue+i*Z).toFixed(xe)}else{const ue=parseInt(D,10);Math.abs(ue)>300?pe=(ue+i*100).toString():pe=(ue+i).toString()}w.replaceRange(pe,{line:o.line,ch:f},{line:o.line,ch:m}),w.setCursor({line:o.line,ch:f+pe.length})}},saveEditorContent(w){let i=w.getValue(),o="";o||(o=`hydraCode_${new Date().toISOString().replace(/[:.-]/g,"")}.js`);const l=new Blob([i],{type:"text/plain"}),f=URL.createObjectURL(l),m=document.createElement("a");m.href=f,m.download=o,m.click()},switchOutput(w=null){if(w===null)this.evaluateCode("render()"),document.getElementById("output-src").textContent="all";else{document.getElementById("output-src").textContent=`o${w}`;const i=`render(o${w})`;this.evaluateCode(i)}}},hydraAutocomplete={sources:[{text:"noise(10,0.1)",displayText:"noise"},{text:"voronoi(5,0.3,0.3)",displayText:"voronoi"},{text:"osc(60,0.1,0)",displayText:"osc"},{text:"shape(3,0.3,0.01)",displayText:"shape"},{text:"gradient(0)",displayText:"gradient"},{text:"solid(1,1,1,1)",displayText:"solid"},{text:"src(o0)",displayText:"src"}],implicitCurves:[{text:"iCardioid(1.0,1.0)",displayText:"iCardioid"},{text:"iBicorn(1.0,1.0,1.0)",displayText:"iBicorn"},{text:"iAstroid(1.0,1.0,1.0)",displayText:"iAstroid"},{text:"iCircle(1.0)",displayText:"iCircle"},{text:"iCassOval(1.0,1.0,1.0,1.0)",displayText:"iCassOval"},{text:"iSextic(1.0,1.0,1.0)",displayText:"iSextic"},{text:"iCochleoid(1.0,1.0,1.0)",displayText:"iCochleoid"},{text:"iCissoid(1.0,1.0,10.0)",displayText:"iCissoid"},{text:"iSluzeConchoid(1.0,3.0,1.0)",displayText:"iSluzeConchoid"},{text:"iDevil(1.0,4.0,1.0,3.0)",displayText:"iDevil"},{text:"iDFolium(1.0,3.0)",displayText:"iDFolium"},{text:"iSpiral(1.0,3.0,1.0)",displayText:"iSpiral"},{text:"iFermatSpiral(1.0,1.0,1.0)",displayText:"iFermatSpiral"},{text:"iFreethNephroid(1.0,1.0,2.0)",displayText:"iFreethNephroid"},{text:"iInvoluteCircle(1.0,10.0)",displayText:"iInvoluteCircle"}],parametricCurves:[{text:"pAstroid(src(o0),1.0)",displayText:"pAstroid"},{text:"pSpiral(src(o0),)",displayText:"pSpiral"},{text:"pCardioid(src(o0),1.0,2.0)",displayText:"pCardioid"},{text:"pConchoid(src(o0),1.0)",displayText:"pConchoid"},{text:"pEpicycloid(src(o0),1.0,1.0)",displayText:"pEpicycloid"},{text:"pDescartesFolium(src(o0),1.0,1.0)",displayText:"pDescartesFolium"},{text:"pHypocycloid(src(o0),1.0,2.0)",displayText:"pHypocycloid"},{text:"pHypotrochoid(src(o0),1.0,2.0,1.0)",displayText:"pHypotrochoid"},{text:"pInvoluteCircle(src(o0),1.0)",displayText:"pInvoluteCircle"},{text:"pCircle(src(o0),1.0)",displayText:"pCircle"},{text:"pLissajous(src(o0),5.0,1.0,1.0,0.0)",displayText:"pLissajous"},{text:"pNephroid(src(o0),1.0)",displayText:"pNephroid"},{text:"pPlateau(src(o0),2.0,1.0)",displayText:"pPlateau"},{text:"pTalbot(src(o0),1.0)",displayText:"pTalbot"}],parametricSurfaces:[{text:"pSphere(1.0,1.0)",displayText:"pSphere"},{text:"pMobiusStrip(1.0,1.0)",displayText:"pMobiusStrip"},{text:"pCylinder(1.0,1.0)",displayText:"pCylinder"},{text:"pKleinBottle(1.0,1.0)",displayText:"pKleinBottle"},{text:"pCrossCap(1.0,1.0)",displayText:"pCrossCap"},{text:"pSteiner(1.0,1.0)",displayText:"pSteiner"},{text:"pTorus(1.0,1.0,0.5)",displayText:"pTorus"}],implicitSurfaces:[{text:"iSphere()",displayText:"iSphere"},{text:"iCube()",displayText:"iCube"},{text:"iTorus(0.5,1.0)",displayText:"iTorus"},{text:"iPlane(1.0,1.0,1.0)",displayText:"iPlane"},{text:"iSteiner(1.0)",displayText:"iSteiner"},{text:"iWineGlass(3.2)",displayText:"iWineGlass"},{text:"iGenus2()",displayText:"iGenus2"}],inverseParametricSurfaces:[{text:"ipSphere(src(o0), 1.0)",displayText:"ipSphere"},{text:"ipTorus(src(o0),1.0)",displayText:"ipTorus"},{text:"ipMobiusStrip(src(o0))",displayText:"ipMobiusStrip"},{text:"ipCylinder(src(o0))",displayText:"ipCylinder"},{text:"ipKleinBottle(src(o0))",displayText:"ipKleinBottle"},{text:"ipCrossCap(src(o0)1.0)",displayText:"ipCrossCap"}],parametricHypersurfaces:[{text:"hpSphere(src(o0),1.0)",displayText:"hpSphere"},{text:"hpTorus(src(o0),1.0,0.5)",displayText:"hpTorus"},{text:"hpCone(src(o0),1.0)",displayText:"hpCone"},{text:"hpConeOblique(src(o0),1.0,1.0,1.0,1.0)",displayText:"hpConeOblique"}],explicitCurves:[{text:"eCircle(1.0,1.0)",displayText:"eCircle"},{text:"eBicorn(1.0)",displayText:"eBicorn"},{text:"eCatenary(1.0)",displayText:"eCatenary"},{text:"eCissoid(1.0,2.0)",displayText:"eCissoid"},{text:"eLame(2.0,2.5,3.0,2.0)",displayText:"eLame"},{text:"eNewton(2.0,0.4,1.0,0.8)",displayText:"eNewton"},{text:"ePearl(2.0,1.0,1.0,1.0,1.0,1.0)",displayText:"ePearl"},{text:"ePear(2.0,2.0,9.0)",displayText:"ePear"},{text:"eStrophoid(2.0,5.0)",displayText:"eStrophoid"},{text:"eTrisectrix(2.0,1.0)",displayText:"eTrisectrix"}],noise:[{text:"whitenoise(10.0,0.0)",displayText:"whitenoise"},{text:"colornoise(10.0,0.0)",displayText:"colornoise"},{text:"unoise(10.0,0.1)",displayText:"unoise"},{text:"turb(10.0,0.1,3.0)",displayText:"turb"},{text:"uturb(10.0,0.1,3.0)",displayText:"uturb"},{text:"warp(10.0,0.1,2.0,3.0,1.0)",displayText:"warp"},{text:"cwarp(10.0,0.1,2.0,3.0,1.0,0.5)",displayText:"cwarp"},{text:"ncontour(0.5,0.1,3,5.0,0.5,2.0)",displayText:"ncontour"}],art:[{text:"brick(0.25,0.08,0.01)",displayText:"brick"},{text:"checker(10.0)",displayText:"checker"},{text:"concentric(100.0,0.5,0.5)",displayText:"concentric"},{text:"hextile(10.0)",displayText:"hextile"},{text:"lissa(0.0,10.0,3.0,0.025)",displayText:"lissa"},{text:"pulse(0.5,0.05,0.001)",displayText:"pulse"},{text:"pulsetrain(3.0,0.5,0.05,0.001)",displayText:"pulsetrain"},{text:"spiral(1.0,5.0,0.1)",displayText:"spiral"},{text:"wave(0.0,10.0,3.0,0.025)",displayText:"wave"}],pattern:[{text:"blinking(5.0,5.0,0.5,0.03)",displayText:"blinking"},{text:"blobs(0.1,0.2,0.05)",displayText:"blobs"},{text:"concentric2(5.0,2.0,0.5,1.0)",displayText:"concentric2"},{text:"phasenoise(0,0.1,5.0,0.5,0.03)",displayText:"phasenoise"},{text:"sdfmove(0.73,1.0,-0.5)",displayText:"sdfmove"},{text:"smoothsun(0.3,0.2,1.0,0.5)",displayText:"smoothsun"}],antliaShapes:[{text:"circle(0.3,0.007)",displayText:"circle"},{text:"square(0.25,0)",displayText:"square"},{text:"rectangle(0.3,[1,1],0)",displayText:"rectangle"},{text:"triangle(0.3,0.007)",displayText:"triangle"},{text:"horiz(0.3,0.0007)",displayText:"horiz"},{text:"vert(0.3,0.0007)",displayText:"vert"},{text:"leftdiag(0.3,0.0007)",displayText:"leftdiag"},{text:"rightdiag(0.3,0.0007)",displayText:"rightdiag"},{text:"firstquad(1,1,1,1)",displayText:"firstquad"},{text:"secondquad(1,1,1,1)",displayText:"secondquad"},{text:"thirdquad(1,1,1,1)",displayText:"thirdquad"},{text:"fourthquad(1,1,1,1)",displayText:"fourthquad"},{text:"quad(0,1,1,1,1)",displayText:"quad"},{text:"star(0.3,5,0.007)",displayText:"star"},{text:"grid(8,4,0.05,0.001)",displayText:"grid"}],initSources:[{text:"s0.initCam()",displayText:"SrcWebCam"},{text:'s0.initImage("")',displayText:"SrcImage"},{text:'s0.initVideo("")',displayText:"SrcVideo"},{text:"s0.initScreen()",displayText:"SrcScreen"}],transformations:[{text:"add()",displayText:"add"},{text:"sub()",displayText:"sub"},{text:"mult()",displayText:"mult"},{text:"blend()",displayText:"blend"},{text:"diff()",displayText:"diff"},{text:"layer()",displayText:"layer"},{text:"mask()",displayText:"mask"},{text:"modulate()",displayText:"modulate"},{text:"modulateRepeat(src(o0),3,3,0.5,0.5)",displayText:"modulateRepeat"},{text:"modulateRepeatX(src(o0),3,0.5)",displayText:"modulateRepeatX"},{text:"modulateRepeatY(src(o0),3,0.5)",displayText:"modulateRepeatY"},{text:"modulateRotate(src(o0),1,0)",displayText:"modulateRotate"},{text:"modulateScale(src(o0),1,1)",displayText:"modulateScale"},{text:"modulatePixelate(src(o0),10,3)",displayText:"modulatePixelate"},{text:"modulateHue(src(o0),1)",displayText:"modulateHue"},{text:"modulateKaleid(src(o0),4)",displayText:"modulateKaleid"},{text:"modulateScrollX(src(o0),0.5,0)",displayText:"modulateScrollX"},{text:"modulateScrollY(src(o0),0.5,0)",displayText:"modulateScrollY"},{text:"out(o0)",displayText:"out"}],effects:[{text:"brightness(0.4)",displayText:"brightness"},{text:"contrast(1.6)",displayText:"contrast"},{text:"color(1,1,1)",displayText:"color"},{text:"colorama(0.005)",displayText:"colorama"},{text:"sum(1)",displayText:"sum"},{text:"r(1,0)",displayText:"r"},{text:"g(1,0)",displayText:"g"},{text:"b(1,0)",displayText:"b"},{text:"a(1,0)",displayText:"a"},{text:"invert(1)",displayText:"invert"},{text:"luma(0.5,0.1)",displayText:"luma"},{text:"posterize(3,0.6)",displayText:"posterize"},{text:"saturate(2)",displayText:"saturate"},{text:"hue(0.4)",displayText:"hue"},{text:"shift(0.1,0.1,0.1,0.1)",displayText:"shift"},{text:"thresh(0.5,0.04)",displayText:"thresh"},{text:"kaleid(4)",displayText:"kaleid"},{text:"pixelate(20,20)",displayText:"pixelate"},{text:"repeat(3,3,0,0)",displayText:"repeat"},{text:"repeatX(3,0)",displayText:"repeatX"},{text:"repeatY(3,0)",displayText:"repeatY"},{text:"rotate(10,0)",displayText:"rotate"},{text:"scale(1, screenRatio)",displayText:"scale"},{text:"scroll(0.5,0.5,0,0)",displayText:"scroll"},{text:"scrollX(0.5,0)",displayText:"scrollX"},{text:"scrollY(0.5,0)",displayText:"scrollY"}],colorEffects:[{text:"sepia(1.0)",displayText:"sepia"},{text:"levels(3.0,1.0)",displayText:"levels"},{text:"monotone(3.0,0.6,1.0)",displayText:"monotone"},{text:"hsvshift(0.0,1.0,1.0)",displayText:"hsvshift"},{text:"grarose(1.0)",displayText:"grarose"},{text:"grawave(1.0)",displayText:"grawave"},{text:"colcross(1.0)",displayText:"colcross"},{text:"coldot(1.0)",displayText:"coldot"},{text:"colboost(1.0)",displayText:"colboost"},{text:"colreflect(1.0)",displayText:"colreflect"}],databending:[{text:"databend(0.5,0.1,0.3)",displayText:"databend"},{text:"rgbshift(1.0,0.05,0.2)",displayText:"rgbshift"},{text:"pixelcorrupt(1.0,16.0,0.4)",displayText:"pixelcorrupt"},{text:"compress(1.0,8.0,0.3)",displayText:"compress"},{text:"glitchcoord(0.1,10.0,0.5)",displayText:"glitchcoord"},{text:"pixelsort(0.2,0.5,0.0)",displayText:"pixelsort"},{text:"memcorrupt(0.15,32.0,0.3)",displayText:"memcorrupt"},{text:"interlace(0.1,200.0,0.05)",displayText:"interlace"}],screenSpaceShaders:[{text:"dither()",displayText:"dither"},{text:"dither2()",displayText:"dither2"},{text:"dither4()",displayText:"dither4"},{text:"ditherrnd()",displayText:"ditherrnd"},{text:"ditherrndcolor()",displayText:"ditherrndcolor"},{text:"erode()",displayText:"erode"},{text:"dilate()",displayText:"dilate"},{text:"blur()",displayText:"blur"},{text:"blurmore()",displayText:"blurmore"},{text:"sharpen()",displayText:"sharpen"},{text:"emboss()",displayText:"emboss"},{text:"edge()",displayText:"edge"},{text:"sobelx()",displayText:"sobelx"},{text:"sobely()",displayText:"sobely"},{text:"pxsort(0.2, 0, 0, 1)",displayText:"pxsort"},{text:"pysort(0.2, 0, 0, 1)",displayText:"pysort"}],fractalEffects:[{text:"mirrorX(0,1)",displayText:"mirrorX"},{text:"mirrorY(0,1)",displayText:"mirrorY"},{text:"mirrorX2(0,1)",displayText:"mirrorX2"},{text:"mirrorY2(0,1)",displayText:"mirrorY2"},{text:"mirrorWrap()",displayText:"mirrorWrap"},{text:"polar(1.0, 1.0, 0.5, 0.5)",displayText:"polar"},{text:"inversion()",displayText:"inversion"}],utilities:[{text:"render(o0)",displayText:"render"},{text:"update = () => {}",displayText:"update"},{text:"setResolution(1920,1080)",displayText:"setResolution"},{text:"setFunction({})",displayText:"setFunction"},{text:"setBins(4)",displayText:"setBins"},{text:"setCutoff(4)",displayText:"setCutoff"},{text:"setSmooth(0.8)",displayText:"setSmooth"},{text:"setScale(2)",displayText:"setScale"},{text:"hide()",displayText:"hide"},{text:"show()",displayText:"show"}],mathFunctions:[{text:"()=>Math.sin(time)",displayText:"time"},{text:"()=>sinrange(time, 0,1,1,1)",displayText:"sinrange"},{text:"()=>cosrange(time, 0,1,1)",displayText:"cosrange"},{text:"()=>sinrange(time, 0,1,1)",displayText:"tanrange"},{text:"()=>sawrange(time, 0,1,1)",displayText:"sawrange"},{text:"()=>mouse.x",displayText:"mouse.x"},{text:"()=>mouse.y",displayText:"mouse.y"},{text:"()=>a.fft[0]",displayText:"a0"},{text:"()=>a.fft[1]",displayText:"a1"},{text:"()=>a.fft[2]",displayText:"a2"},{text:"()=>a.fft[3]",displayText:"a3"},{text:"Math.sin()",displayText:"sin"},{text:"Math.cos()",displayText:"cos"},{text:"Math.tan()",displayText:"tan"},{text:"saw()",displayText:"saw"},{text:"()=>sawt()",displayText:"sawt"},{text:"()=>bouncet(time, 3, 1, 8)",displayText:"bouncet"},{text:"Math.random()",displayText:"random"},{text:"rand(0,1)",displayText:"rand"},{text:"Math.PI",displayText:"Math.PI"},{text:"Math.abs()",displayText:"abs"},{text:"Math.floor()",displayText:"floor"},{text:"Math.ceil()",displayText:"ceil"},{text:"Math.round()",displayText:"round"},{text:"Math.min()",displayText:"min"},{text:"Math.max()",displayText:"max"},{text:"screenRatio",displayText:"sr"}],space:[{text:"invtile(0.5)",displayText:"invtile"},{text:"invsqrt(0.5)",displayText:"invsqrt"},{text:"abslog(1.0)",displayText:"abslog"},{text:"swave(1.0)",displayText:"swave"},{text:"centermag(0.4,0.2,0,0)",displayText:"centermag"}],arrayMethods:[{text:"smooth()",displayText:"smooth"},{text:"fast(1)",displayText:"fast"},{text:'ease("linear")',displayText:"ease"},{text:"offset(0)",displayText:"offset"},{text:"fit(0,1)",displayText:"fit"}],_currentView:"categories",_currentCategory:null,_completionWidget:null,categories:{"🔥 Sources":{items:"sources",blankOnly:!0},"🌊 Noise Functions":{items:"noise",blankOnly:!0},"🎨 Art Patterns":{items:"art",blankOnly:!0},"✨ Soft Patterns":{items:"pattern",blankOnly:!0},"🔷 Antlia Shapes":{items:"antliaShapes",blankOnly:!0},"📐 Implicit Curves FCS":{items:"implicitCurves",blankOnly:!0},"🌐 Parametric Surfaces FCS":{items:"parametricSurfaces",blankOnly:!0},"🔵 Implicit Surfaces FCS":{items:"implicitSurfaces",blankOnly:!1},"🔴 Inverse Parametric Surfaces FCS":{items:"inverseParametricSurfaces",blankOnly:!1},"🟢 Parametric Curves FCS":{items:"parametricCurves",blankOnly:!1},"🟣 Explicit Curves FCS":{items:"explicitCurves",blankOnly:!1},"🔶 Parametric Hypersurfaces FCS":{items:"parametricHypersurfaces",blankOnly:!1},"📺 Init Sources":{items:"initSources",blankOnly:!0},"🔄 Transformations":{items:"transformations",blankOnly:!1},"⚡ Effects":{items:"effects",blankOnly:!1},"🌌 Space Effects":{items:"space",blankOnly:!1},"🌈 Color Effects":{items:"colorEffects",blankOnly:!1},"💾 DataBending":{items:"databending",blankOnly:!1},"🌁 Screen Space Shaders":{items:"screenSpaceShaders",blankOnly:!1},"🪞 Fractal Effects":{items:"fractalEffects",blankOnly:!1},"🧮 Math & Audio":{items:"mathFunctions",blankOnly:!1},"🛠️ Utilities":{items:"utilities",blankOnly:!0}},createCategorySeparator:function(w,i){return{text:"",displayText:w+" →",className:"autocomplete-category-separator",categoryKey:i,render:function(o,l,f){o.className+=" autocomplete-category-separator",o.innerHTML=`<span class="category-text">${f.displayText}</span>`,o.style.cursor="pointer",o.setAttribute("data-category",f.categoryKey)},hint:function(o,l,f){return!1}}},createBackButton:function(){return{text:"",displayText:"← Retour aux catégories",className:"autocomplete-back-button",render:function(w,i,o){w.className+=" autocomplete-back-button",w.innerHTML=`<span class="back-text">${o.displayText}</span>`,w.style.cursor="pointer"},hint:function(w,i,o){return!1}}},hint:function(w,i){const o=w.getCursor(),l=w.getLine(o.line),f=l.slice(0,o.ch);w.getTokenAt(o),o.ch,this._currentView="categories",this._currentCategory=null;const m=(f.match(/\(/g)||[]).length,D=(f.match(/\)/g)||[]).length,F=m>D;if(/\]\s*\.\s*[\w*]*$/.test(f)){const Ee=f.split(".").pop()||"",we=f.lastIndexOf(".");return{list:this.filterWithWildcards(this.arrayMethods,Ee),from:i.Pos(o.line,we+1),to:i.Pos(o.line,o.ch)}}if(F){const Ee=[];Object.keys(this.categories).forEach(q=>{const ce=this.categories[q],Q=this[ce.items];Q&&Q.length>0&&(Ee.push(this.createCategorySeparator(q,q)),Ee.push(...Q))});const we=f.match(/([\w*]*)$/),Oe=we?we[1]:"",Ke=o.ch-Oe.length;return{list:this.filterWithWildcards(Ee,Oe),from:i.Pos(o.line,Ke),to:i.Pos(o.line,o.ch)}}if(/\.\s*[\w*]*$/.test(f)){const Ee=f.split(".").pop()||"",we=f.lastIndexOf(".");if(Ee===""){const le=[];return Object.keys(this.categories).forEach(q=>{if(!this.categories[q].blankOnly){const Q=this.createCategorySeparator(q,q);le.push(Q)}}),{list:le,from:i.Pos(o.line,we+1),to:i.Pos(o.line,o.ch)}}const Oe=[...this.transformations,...this.effects,...this.colorEffects,...this.fractalEffects,...this.screenSpaceShaders,...this.space,...this.parametricCurves,...this.implicitSurfaces,...this.inverseParametricSurfaces,...this.parametricHypersurfaces,...this.explicitCurves,...this.databending];return{list:this.filterWithWildcards(Oe,Ee),from:i.Pos(o.line,we+1),to:i.Pos(o.line,o.ch)}}if(f.trim()===""){const Ee=[];return Object.keys(this.categories).forEach(we=>{if(this.categories[we].blankOnly){const Ke=this.createCategorySeparator(we,we);Ee.push(Ke)}}),{list:Ee,from:i.Pos(o.line,o.ch),to:i.Pos(o.line,o.ch)}}let pe="";o.ch;const ue=l.lastIndexOf(" ",o.ch-1)+1,j=o.ch;pe=l.slice(ue,j);const xe=[];return Object.keys(this.categories).forEach(Ee=>{const we=this.categories[Ee],Oe=this[we.items];Oe&&Oe.length>0&&(xe.push(this.createCategorySeparator(Ee,Ee)),xe.push(...Oe))}),{list:this.filterWithWildcards(xe,pe),from:i.Pos(o.line,ue),to:i.Pos(o.line,o.ch)}},filterWithWildcards:function(w,i){if(!i||i==="")return w;if(!i.includes("*"))return w.filter(l=>l.displayText.toLowerCase().includes(i.toLowerCase()));const o=this.createWildcardRegex(i);return w.filter(l=>o.test(l.displayText.toLowerCase()))},createWildcardRegex:function(w){if(!w)return/^$/;const i=w.toLowerCase().trim();if(!i)return/^$/;const o=i.replace(/[.+?^${}()|[\]\\]/g,"\\$&");let l;i.startsWith("*")&&i.endsWith("*")&&i.length>2?l=`.*${o.slice(1,-1)}.*`:i.startsWith("*")&&i.length>1?l=`.*${o.slice(1)}$`:i.endsWith("*")&&i.length>1?l=`^${o.slice(0,-1)}.*`:i.includes("*")?l=o.replace(/\*/g,".*"):l=`.*${o}.*`;try{return new RegExp(l,"i")}catch{return/.*/}},showCategoryItems:function(w,i){const o=this.categories[i];if(!o||!this[o.items])return null;const l=[this.createBackButton(),...this[o.items]];return this._currentView="items",this._currentCategory=i,{list:l,from:w.getCursor(),to:w.getCursor()}}};class HydraColorPicker{constructor(){this.hiddenInput=null,this.createHiddenInput()}createHiddenInput(){this.hiddenInput=document.createElement("input"),this.hiddenInput.type="color",this.hiddenInput.style.position="absolute",this.hiddenInput.style.left="-9999px",this.hiddenInput.style.opacity="0",this.hiddenInput.style.pointerEvents="none",this.hiddenInput.tabIndex=-1,document.body.appendChild(this.hiddenInput)}detectColorFunction(i){const o=i.getCursor(),l=i.getLine(o.line),f=/\.color\s*\(/g;let m;for(;(m=f.exec(l))!==null;){const D=m.index,F=m.index+m[0].length-1;let pe=1,ue=F,j=!1;for(let xe=F+1;xe<l.length&&pe>0;xe++)if(l[xe]==="(")pe++;else if(l[xe]===")"&&(pe--,pe===0)){ue=xe,j=!0;break}if(o.ch>F&&o.ch<=(j?ue:l.length)){const xe=l.substring(F+1,j?ue:l.length),Z=this.parseColorValues(xe);return{found:!0,start:{line:o.line,ch:D},end:{line:o.line,ch:j?ue+1:l.length},openParenPos:F+1,closeParenPos:j?ue:l.length,currentValues:Z,isEmpty:xe.trim()===""}}}return{found:!1}}parseColorValues(i){const o=i.trim();if(o==="")return{r:1,g:0,b:0};const l=o.split(",").map(f=>{const m=parseFloat(f.trim());return isNaN(m)?0:Math.max(0,Math.min(1,m))});return{r:l[0]!==void 0?l[0]:1,g:l[1]!==void 0?l[1]:0,b:l[2]!==void 0?l[2]:0}}openNativeColorPicker(i,o,l){if(!o||!o.found){console.log("Place your cursor in a .color() function to use the color picker");return}const f=this.rgbToHex(o.currentValues.r,o.currentValues.g,o.currentValues.b);this.hiddenInput.value=f,this.handleColorChange&&(this.hiddenInput.removeEventListener("change",this.handleColorChange),this.hiddenInput.removeEventListener("input",this.handleColorChange)),this.handleColorChange=m=>{const D=m.target.value,F=this.hexToRgb(D);l&&l(F.r,F.g,F.b,o),this.hiddenInput.removeEventListener("change",this.handleColorChange),this.hiddenInput.removeEventListener("input",this.handleColorChange)},this.hiddenInput.addEventListener("change",this.handleColorChange),this.hiddenInput.addEventListener("input",this.handleColorChange);try{this.hiddenInput.showPicker?this.hiddenInput.showPicker():(console.log("showPicker() not supported, using fallback..."),this.openColorPickerFallback(i,o,l))}catch(m){console.log("Could not open color picker:",m),this.openColorPickerFallback(i,o,l)}}openColorPickerFallback(i,o,l){const f=document.createElement("div");f.style.cssText=`
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #0f1419, #1a1b26);
            border: 2px solid #4A90C2;
            border-radius: 8px;
            padding: 15px;
            z-index: 9999;
            font-family: 'Fira Code', monospace;
            color: #E8F4FD;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        `;const m=document.createElement("div");m.textContent="🎨 Color Picker",m.style.cssText="margin-bottom: 10px; text-align: center; font-weight: bold;";const D=document.createElement("input");D.type="color",D.value=this.rgbToHex(o.currentValues.r,o.currentValues.g,o.currentValues.b),D.style.cssText=`
            width: 80px; 
            height: 40px; 
            border: 2px solid #6BBFDF; 
            border-radius: 6px;
            cursor: pointer;
            display: block;
            margin: 0 auto 10px auto;
        `;const F=document.createElement("div");F.textContent="Press Escape to cancel",F.style.cssText="font-size: 11px; text-align: center; opacity: 0.7;",f.appendChild(m),f.appendChild(D),f.appendChild(F),document.body.appendChild(f),D.addEventListener("change",j=>{const xe=this.hexToRgb(j.target.value);l(xe.r,xe.g,xe.b,o),document.body.removeChild(f)}),D.focus();const pe=j=>{j.key==="Escape"&&(document.body.contains(f)&&document.body.removeChild(f),document.removeEventListener("keydown",pe),document.removeEventListener("click",ue))},ue=j=>{f.contains(j.target)||(document.body.contains(f)&&document.body.removeChild(f),document.removeEventListener("keydown",pe),document.removeEventListener("click",ue))};document.addEventListener("keydown",pe),setTimeout(()=>{document.addEventListener("click",ue)},100)}rgbToHex(i,o,l){const f=m=>{const D=Math.round(Math.max(0,Math.min(255,m*255))).toString(16);return D.length===1?"0"+D:D};return`#${f(i)}${f(o)}${f(l)}`}hexToRgb(i){const o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);return o?{r:parseInt(o[1],16)/255,g:parseInt(o[2],16)/255,b:parseInt(o[3],16)/255}:{r:0,g,b:0}}}const hydraColorPicker=new HydraColorPicker,sources={noise:`noise(scale, offset)
Generates Perlin noise. 
scale: noise scale (default: 10)
offset: noise offset (default: 0.1)`,voronoi:`voronoi(scale, speed, blending)
Generates a Voronoi pattern. 
scale: pattern scale (default: 5)
speed: animation speed (default: 0.3)
blending: edge smoothing (default: 0.3)`,osc:`osc(frequency, sync, offset)
Sinusoidal oscillator. 
frequency: oscillation frequency (default: 60)
sync: synchronization (default: 0.1)
offset: phase offset (default: 0)`,shape:`shape(sides, radius, smoothing)
Creates a geometric shape. 
sides: number of sides (default: 3)
radius: shape radius (default: 0.3)
smoothing: edge smoothing (default: 0.01)`,gradient:`gradient(speed)
Generates an animated gradient. 
speed: animation speed (default: 0)`,solid:`solid(r, g, b, a)
Creates a solid color. 
r,g,b: color components (0-1)
a: alpha channel (default: 1)`,src:`src(input)
Retrieves a video source. 
input: source name (o0-o3, s0-s3)`,whitenoise:`whitenoise(size, dynamic)
Black and white high frequency noise.
size: float (default: 10.0)
dynamic: float (default: 0.0)`,colornoise:`colornoise(size, dynamic)
Colored high frequency noise.
size: float (default: 10.0)
dynamic: float (default: 0.0)`,unoise:`unoise(scale, offset)
Unsigned Perlin noise scaled to 0..1.
scale: float (default: 10.0)
offset: float (default: 0.1)`,turb:`turb(scale, offset, octaves)
Turbulent noise (signed value).
scale: float (default: 10.0)
offset: float (default: 0.1)
octaves: float (default: 3.0)`,uturb:`uturb(scale, offset, octaves)
Unsigned turbulent noise scaled to 0..1.
scale: float (default: 10.0)
offset: float (default: 0.1)
octaves: float (default: 3.0)`,warp:`warp(scalei, offset, octaves, octavesinner, scale)
Domain warping noise.
scalei: float (default: 10.0)
offset: float (default: 0.1)
octaves: float (default: 2.0)
octavesinner: float (default: 3.0)
scale: float (default: 1.0)`,cwarp:`cwarp(scalei, offset, octaves, octavesinner, scale, focus)
Centered domain warping noise.
scalei: float (default: 10.0)
offset: float (default: 0.1)
octaves: float (default: 2.0)
octavesinner: float (default: 3.0)
scale: float (default: 1.0)
focus: float (default: 0.5)`,ncontour:`ncontour(thresh, smooth, octaves, scale, speed, step)
Contour from noise.
thresh: float (default: 0.5)
smooth: float (default: 0.1)
octaves: int (default: 3)
scale: float (default: 5.0)
speed: float (default: 0.5)
step: float (default: 2.0)`,brick:`brick(width, height, gap)
Brick pattern.

see: Ebert, Musgrave, Peachey, Perlin Worley
"Texturing and Modeling – A Procedural Approach"
Darwyn Peachey, Building Procedural Textures, page 37

width: float (default: 0.25)
height: float (default: 0.08)
gap: float (default: 0.01)`,checker:`checker()
Checkerboard pattern.

repeats: float (default: 10.0)`,concentric:`concentric(scale, centerX, centerY)
Concentric circles pattern.

scale: float (default: 100.0)
centerX: float (default: 0.5)
centerY: float (default: 0.5)`,hextile:`hextile(tiles)
Hex tiles pattern.

tiles: float (default: 10.0)`,lissa:`lissa(time, frequ, loops, thick)
Lissajous curve pattern.

time: float (default: 0.0)
frequ: float (default: 10.0)
loops: float (default: 3.0)
thick: float (default: 0.025)`,pulse:`pulse(edge, width, epsilon)
Pulse pattern.

edge: float (default: 0.5)
width: float (default: 0.05)
epsilon: float (default: 0.001)`,pulsetrain:`pulsetrain(train, edge, width, epsilon)
Pulse train pattern.

train: float (default: 3.0)
edge: float (default: 0.5)
width: float (default: 0.05)
epsilon: float (default: 0.001)`,spiral:`spiral(a, b, thickness)
Spiral pattern.

a: float (default: 1.0)
b: float (default: 5.0)
thickness: float (default: 0.1)`,wave:`wave(time, frequ, loops, thick)
Wave pattern.

time: float (default: 0.0)
frequ: float (default: 10.0)
loops: float (default: 3.0)
thick: float (default: 0.025)`,blinking:`blinking(tiles, scale, speed, phase)
Blinking grid: Looks like a grid of colorful square lamps.
tiles: float (default: 5.0)
scale: float (default: 5.0)
speed: float (default: 0.5)
phase: float (default: 0.03)`,blobs:`blobs(speed, tresh, soft)
Three blobs are dancing around.
speed: float (default: 0.1)
tresh: float (default: 0.2)
soft: float (default: 0.05)`,concentric2:`concentric2(base, octaves, ampscale, speed)
Harmonic concentric rings pattern.
base: float (default: 5.0)
octaves: float (default: 2.0)
ampscale: float (default: 0.5)
speed: float (default: 1.0)`,phasenoise:`phasenoise(base, range, scale, speed, phase)
Noise in HSV with phase shifting.
base: float (default: 0.0)
range: float (default: 0.1)
scale: float (default: 5.0)
speed: float (default: 0.5)
phase: float (default: 0.03)`,sdfmove:`sdfmove(speed1, speed2, speed3)
Moving ramp pattern.
speed1: float (default: 0.73)
speed2: float (default: 1.0)
speed3: float (default: -0.5)`,smoothsun:`smoothsun(threshold, border, speed, ampscale)
Smooth sun pattern.
threshold: float (default: 0.3)
border: float (default: 0.2)
speed: float (default: 1.0)
ampscale: float (default: 0.5)`,iCardioid:`iCardioid(freq, a)
Cardioid implicit curve.
freq: animation frequency (default: 1.0)
a: shape parameter (default: 1.0)`,iBicorn:`iBicorn(freq, a_exp, a)
Bicorn implicit curve.
freq: animation frequency (default: 1.0)
a_exp: exponent parameter (default: 1.0)
a: shape parameter (default: 1.0)`,iAstroid:`iAstroid(freq, wrap, amp)
Astroid implicit curve.
freq: animation frequency (default: 1.0)
wrap: wrap parameter (default: 1.0)
amp: amplitude (default: 1.0)`,iCircle:`iCircle(freq)
Circle implicit curve.
freq: animation frequency (default: 1.0)`,iCassOval:`iCassOval(freq, mult, a, c)
Cassini oval implicit curve.
freq: animation frequency (default: 1.0)
mult: multiplier (default: 1.0)
a: shape parameter (default: 1.0)
c: constant (default: 1.0)`,iSextic:`iSextic(freq1, freq2, a)
Sextic curve.
freq1: first frequency (default: 1.0)
freq2: second frequency (default: 1.0)
a: shape parameter (default: 1.0)`,iCochleoid:`iCochleoid(freq1, freq2, a)
Cochleoid curve.
freq1: first frequency (default: 1.0)
freq2: second frequency (default: 1.0)
a: shape parameter (default: 1.0)`,iCissoid:`iCissoid(freq, a, wrap)
Cissoid curve.
freq: animation frequency (default: 1.0)
a: shape parameter (default: 1.0)
wrap: wrap parameter (default: 10.0)`,iSluzeConchoid:`iSluzeConchoid(freq, a, k)
Conchoid of de Sluze.
freq: animation frequency (default: 1.0)
a: shape parameter (default: 3.0)
k: constant (default: 1.0)`,iDevil:`iDevil(freq, wrap, k, a)
Devil curve.
freq: animation frequency (default: 1.0)
wrap: wrap parameter (default: 4.0)
k: shape parameter (default: 1.0)
a: scale parameter (default: 3.0)`,iDFolium:`iDFolium(freq, a)
Descartes folium.
freq: animation frequency (default: 1.0)
a: shape parameter (default: 3.0)`,iSpiral:`iSpiral(freq, a, b)
Spiral curve.
freq: animation frequency (default: 1.0)
a: spiral parameter (default: 3.0)
b: decay parameter (default: 1.0)`,iFermatSpiral:`iFermatSpiral(freq, a, b)
Fermat spiral.
freq: animation frequency (default: 1.0)
a: scale parameter (default: 1.0)
b: spiral parameter (default: 1.0)`,iFreethNephroid:`iFreethNephroid(freq1, freq2, a)
Freeth nephroid.
freq1: first frequency (default: 1.0)
freq2: second frequency (default: 1.0)
a: scale parameter (default: 2.0)`,iInvoluteCircle:`iInvoluteCircle(freq, wrap)
Involute of circle.
freq: animation frequency (default: 1.0)
wrap: wrap parameter (default: 10.0)`,pSphere:`pSphere(freq, a)
Parametric sphere.
freq: animation frequency (default: 1.0)
a: radius (default: 1.0)`,pMobiusStrip:`pMobiusStrip(freq, a)
Mobius strip.
freq: animation frequency (default: 1.0)
a: width parameter (default: 1.0)`,pCylinder:`pCylinder(freq, a)
Parametric cylinder.
freq: animation frequency (default: 1.0)
a: radius (default: 1.0)`,pKleinBottle:`pKleinBottle(freq, aa)
Klein bottle.
freq: animation frequency (default: 1.0)
aa: shape parameter (default: 1.0)`,pCrossCap:`pCrossCap(freq, aa)
Cross cap surface.
freq: animation frequency (default: 1.0)
aa: scale parameter (default: 1.0)`,pSteiner:`pSteiner(freq, aa)
Steiner surface.
freq: animation frequency (default: 1.0)
aa: scale parameter (default: 1.0)`,pTorus:`pTorus(freq, a, c)
Parametric torus.
freq: animation frequency (default: 1.0)
a: tube radius (default: 1.0)
c: torus radius (default: 0.5)`},initSources={initCam:`s0.initCam()
Initializes webcam as video source`,initImage:`s0.initImage(url)
Initializes an image as video source`,initVideo:`s0.initVideo(url)
Initializes a video as video source`,initScreen:`s0.initScreen()
Initializes screen capture as video source`},transformations={add:`add(texture, amount)
Adds a texture with another. 
texture: texture to add 
amount: addition strength (default: 1)`,sub:`sub(texture, amount)
Subtracts a texture from another. 
texture: texture to subtract 
amount: subtraction strength (default: 1)`,mult:`mult(texture, amount)
Multiplies a texture with another. 
texture: multiplicative texture 
amount: multiplication strength (default: 1)`,blend:`blend(texture, amount)
Blends a texture with another. 
texture: texture to blend 
amount: blend strength (default: 0.5)`,diff:`diff(texture)
Creates absolute difference between two textures. 
texture: texture to compare`,layer:`layer(texture)
Layers a texture on top of another. 
texture: texture to layer`,mask:`mask(texture)
Masks a texture with another. 
texture: masking texture (black = transparent, white = opaque)`,modulate:`modulate(texture, amount)
Modulates UV coordinates with a texture. 
texture: modulation texture 
amount: modulation intensity (default: 0.1)`,modulateRepeat:`modulateRepeat(texture, repeatX, repeatY, offsetX, offsetY)
Repeats texture using brightness of another. 
texture: modulation texture 
repeatX/Y: number of repetitions (default: 3) 
offsetX/Y: offset (default: 0.5)`,modulateRotate:`modulateRotate(texture, multiple, offset)
Rotates texture based on brightness of another. 
texture: modulation texture 
multiple: rotation multiplier (default: 1) 
offset: rotation offset (default: 0)`,modulateScale:`modulateScale(texture, multiple, offset)
Scales texture based on brightness of another. 
texture: modulation texture 
multiple: scale multiplier (default: 1) 
offset: scale offset (default: 1)`,modulatePixelate:`modulatePixelate(texture, multiple, offset)
Pixelates texture based on brightness of another. 
texture: modulation texture 
multiple: pixelation multiplier (default: 10) 
offset: pixelation offset (default: 3)`,modulateKaleid:`modulateKaleid(texture, nSides)
Applies modulated kaleidoscope effect. 
texture: modulation texture 
nSides: number of sides (default: 4)`,modulateScrollX:`modulateScrollX(texture, scrollX, speed)
Modulated horizontal scrolling. 
texture: modulation texture 
scrollX: scroll amount (default: 0.5) 
speed: scroll speed (default: 0)`,modulateScrollY:`modulateScrollY(texture, scrollY, speed)
Modulated vertical scrolling. 
texture: modulation texture 
scrollY: scroll amount (default: 0.5) 
speed: scroll speed (default: 0)`,out:`out(buffer)
Sends result to an output buffer. 
buffer: destination buffer (o0-o3, default: o0)`},effects={brightness:`brightness(amount)
Adjusts brightness. 
amount: brightness level (default: 0.4)`,contrast:`contrast(amount)
Adjusts contrast. 
amount: contrast level (default: 1.6)`,color:`color(r, g, b)
Adjusts RGB colors. 
r, g, b: channel multipliers (default: 1)`,colorama:`colorama(amount)
Shifts HSV colors. 
amount: shift intensity (default: 0.005)`,invert:`invert(amount)
Inverts colors. 
amount: inversion intensity (default: 1)`,luma:`luma(threshold, tolerance)
Filters by brightness. 
threshold: threshold (default: 0.5) 
tolerance: tolerance (default: 0.1)`,posterize:`posterize(bins, gamma)
Reduces number of colors. 
bins: number of levels (default: 3) 
gamma: gamma adjustment (default: 0.6)`,saturate:`saturate(amount)
Adjusts saturation. 
amount: saturation level (default: 2)`,hue:`hue(amount)
Shifts hue. 
amount: shift amount (default: 0.4)`,thresh:`thresh(threshold, tolerance)
Thresholds pixels. 
threshold: threshold (default: 0.5) 
tolerance: tolerance (default: 0.04)`,kaleid:`kaleid(nSides)
Kaleidoscope effect. 
nSides: number of sides (default: 4)`,pixelate:`pixelate(pixelX, pixelY)
Pixelates the image. 
pixelX, pixelY: pixel size (default: 20, 20)`,repeat:`repeat(repeatX, repeatY, offsetX, offsetY)
Repeats the image. 
repeatX, repeatY: number of repetitions (default: 3, 3) 
offsetX, offsetY: offset (default: 0, 0)`,repeatX:`repeatX(reps, offset)
Repeats image horizontally. 
reps: number of repetitions (default: 3) 
offset: offset (default: 0)`,repeatY:`repeatY(reps, offset)
Repeats image vertically. 
reps: number of repetitions (default: 3) 
offset: offset (default: 0)`,rotate:`rotate(angle, speed)
Rotates the image. 
angle: angle in radians (default: 10) 
speed: rotation speed (default: 0)`,scale:`scale(amount, xMult, yMult, offsetX, offsetY)
Scales the image. 
amount: size (default: 1.5) 
xMult, yMult: x/y multipliers (default: 1, 1) 
offsetX, offsetY: center offset (default: 0.5, 0.5)`,scrollX:`scrollX(scrollX, speed)
Horizontal scrolling. 
scrollX: scroll amount (default: 0.5) 
speed: speed (default: 0)`,scrollY:`scrollY(scrollY, speed)
Vertical scrolling. 
scrollY: scroll amount (default: 0.5) 
speed: speed (default: 0)`},utilities={render:`render(buffer)
Displays a buffer on screen. 
buffer: buffer to render (default: o0)`,update:`update = callback => {...}
Adds a function to execute each frame`,setResolution:`setResolution(width, height)
Adjusts canvas resolution`,setFunction:`setFunction(objects)
Defines custom functions`,setBins:`setBins(numBins)
Sets number of bins for audio analysis`,setCutoff:`setCutoff(cutoff)
Sets threshold value for audio analysis`,setSmooth:`setSmooth(smooth)
Sets smoothing for audio analysis`,setScale:`setScale(scale)
Sets scale for audio analysis`,hide:`hide()
Hides the canvas`,show:`show()
Shows the canvas`},arrayMethods={smooth:`array.smooth()
Smoothes transitions between values in an array`,fast:`array.fast(speed)
Controls value change speed. 
speed: speed (default: 1)`,ease:`array.ease(easing)
Applies easing function. 
easing: easing type (default: "linear")`,offset:`array.offset(amount)
Shifts values by a constant. 
amount: offset value`,fit:`array.fit(low, high)
Rescales values to a range. 
low, high: destination range`},mathFunctions={time:`time
Variable that increments automatically`,sinrange:`sinrange(x, min, max, freq)
Sine wave in a range. 
x: time or value 
min: minimum value (default: 0)
max: maximum value (default: 1)
freq: frequency (default: 1)`,cosrange:`cosrange(x, min, max, freq)
Cosine wave in a range. 
x: time or value 
min: minimum value (default: 0)
max: maximum value (default: 1)
freq: frequency (default: 1)`,tanrange:`tanrange(x, min, max, freq)
Tangent wave in a range. 
x: time or value 
min: minimum value (default: 0)
max: maximum value (default: 1)
freq: frequency (default: 1)`,mouse:`mouse
Mouse position (x and y between 0 and 1)`,"a.fft":`a.fft[index]
Accesses audio frequency analysis`,sin:`Math.sin(x)
Calculates sine of x`,cos:`Math.cos(x)
Calculates cosine of x`,tan:`Math.tan(x, amp=3, freq=1)
Calculates tangent of x`,saw:`Math.saw(x)
Generates sawtooth wave. 
x: time or value`,sawt:`Math.sawt(amp=3, freq=1)
Generates sawtooth wave with time. 
x: time or value`,random:`Math.random()
Generates random number between 0 and 1`,"Math.PI":`Math.PI
Constant π (3.14159...)`,rand:`rand(min, max)
Generates random number between min and max. 
min: minimum value (default: 0) 
max: maximum value (default: 1)`,bouncet:`bouncet(t, amp=3, freq=1, bouncing=8)
Generates bouncing effect. 
t: time or value 
amp: amplitude (default: 3) 
freq: frequency (default: 1) 
bouncing: number of bounces (default: 8)`,screenRatio:`screenRatio
Aspect ratio of the screen (height/width)`},colorEffects={sepia:`sepia(amount)
Applies sepia tone effect. 
amount: sepia intensity (default: 1.0)`,levels:`levels(levels, amount)
Reduces color levels while preserving light-dark dynamics. 
levels: number of color levels (default: 3.0) 
amount: effect intensity (default: 1.0)`,monotone:`monotone(levels, hue, amount)
Creates monotone effect with specified hue. 
levels: number of levels (default: 3.0) 
hue: color hue 0-1 (default: 0.6) 
amount: effect intensity (default: 1.0)`,hsvshift:`hsvshift(hue, saturation, value)
Shifts HSV color values. 
hue: hue shift 0-1 (default: 0.0) 
saturation: saturation multiplier (default: 1.0) 
value: brightness multiplier (default: 1.0)`,grarose:`grarose(amount)
Applies rose gradient to grayscale conversion. 
amount: gradient intensity (default: 1.0)`,grawave:`grawave(amount)
Applies wave gradient creating color bands. 
amount: gradient intensity (default: 1.0)`,colcross:`colcross(amount)
Applies RGB cross product for strong color effects. 
amount: effect intensity (default: 1.0)`,coldot:`coldot(amount)
Applies RGB dot product of rotated channels. 
amount: effect intensity (default: 1.0)`,colboost:`colboost(amount)
Boosts colors using vector operations. 
amount: boost intensity (default: 1.0)`,colreflect:`colreflect(amount)
Creates color reflection effect. 
amount: reflection intensity (default: 1.0)`,databend:`databend(amount, shift, corruption)
Simulates digital data corruption with bit shifting. 
amount: corruption intensity (default: 0.5) 
shift: channel shift amount (default: 0.1) 
corruption: digital noise level (default: 0.3)`,rgbshift:`rgbshift(amount, offset, chaos)
Separates and corrupts RGB channels. 
amount: effect intensity (default: 1.0) 
offset: channel separation (default: 0.05) 
chaos: corruption chaos level (default: 0.2)`,pixelcorrupt:`pixelcorrupt(amount, blocksize, corruption)
Corrupts pixels in blocks with various digital artifacts. 
amount: effect intensity (default: 1.0) 
blocksize: corruption block size (default: 16.0) 
corruption: corruption probability (default: 0.4)`,compress:`compress(amount, quality, blockiness)
Simulates JPEG-like compression artifacts. 
amount: effect intensity (default: 1.0) 
quality: compression quality levels (default: 8.0) 
blockiness: blocking artifact intensity (default: 0.3)`},screenSpaceShaders={dither:`dither()
Applies black and white ordered dithering.`,dither2:`dither2()
Applies ordered dithering with a 2x2 Bayer matrix for color reduction.`,dither4:`dither4()
Applies ordered dithering with a 4x4 Bayer matrix to preserve more colors.`,ditherrnd:`ditherrnd()
Applies black and white random dithering.`,ditherrndcolor:`ditherrndcolor()
Applies random dithering preserving some colors.`,erode:`erode()
Morphological erode operator.`,dilate:`dilate()
Morphological dilate operator.`,blur:`blur()
Applies a 3x3 Gaussian blur.`,blurmore:`blurmore()
Applies a 5x5 Gaussian blur.`,sharpen:`sharpen()
Applies a sharpening filter.`,emboss:`emboss()
Applies an embossing filter.`,edge:`edge()
Applies an edge detection filter.`,sobelx:`sobelx()
Applies a Sobel filter in the X direction.`,sobely:`sobely()
Applies a Sobel filter in the Y direction.`,pxsort:`pxsort(threshold, frame, dirX, dirY)
Sorts pixels horizontally by brightness.
threshold: (default 0.2)
frame: (default 0)
dirX: (default 0)
dirY: (default 1)`,pysort:`pysort(threshold, frame, dirX, dirY)
Sorts pixels vertically by brightness.
threshold: (default 0.2)
frame: (default 0)
dirX: (default 0)
dirY: (default 1)`},fractalEffects={mirrorX:`mirrorX(pos, coverage)
Mirrors image horizontally from position. 
pos: mirror position (default: 0) 
coverage: effect coverage (default: 1) 
Result: [1234|4321]`,mirrorY:`mirrorY(pos, coverage)
Mirrors image vertically from position. 
pos: mirror position (default: 0) 
coverage: effect coverage (default: 1) 
Same as mirrorX but on Y axis`,mirrorX2:`mirrorX2(pos, coverage)
Mirrors image horizontally from other side. 
pos: mirror position (default: 0) 
coverage: effect coverage (default: 1) 
Result: [8765|5678]`,mirrorY2:`mirrorY2(pos, coverage)
Mirrors image vertically from other side. 
pos: mirror position (default: 0) 
coverage: effect coverage (default: 1) 
Same as mirrorX2 but on Y axis`,mirrorWrap:`mirrorWrap()
Mirrors any out of bounds coordinates. 
Input: [-8,-7,-6,-5,-4,-3,-2,-1] [1,2,3,4,5,6,7,8] [9,10,11,12,13,14,15,16] 
Result: [87654321] [12345678] [87654321]`,polar:`polar(radius, angle, centerX, centerY)
Applies polar transformation. 
radius: radius multiplier (default: 1.0) 
angle: angle multiplier (default: 1.0) 
centerX: horizontal center (default: 0.5) 
centerY: vertical center (default: 0.5)`,inversion:`inversion()
Applies circular inversion transformation. 
Useful for creating fractal-like patterns.`,glitchcoord:`glitchcoord(amount, frequency, chaos)
Applies digital glitch distortions to coordinates. 
amount: distortion strength (default: 0.1) 
frequency: scanline frequency (default: 10.0) 
chaos: chaos factor (default: 0.5)`,pixelsort:`pixelsort(amount, threshold, direction)
Applies pixel sorting effect to coordinates. 
amount: sorting displacement (default: 0.2) 
threshold: sorting trigger threshold (default: 0.5) 
direction: sort direction 0=horizontal, 1=vertical (default: 0.0)`,memcorrupt:`memcorrupt(amount, blocksize, corruption)
Simulates memory corruption on coordinate space. 
amount: corruption strength (default: 0.15) 
blocksize: memory block size (default: 32.0) 
corruption: corruption probability (default: 0.3)`,interlace:`interlace(amount, lines, drift)
Applies interlace corruption effect. 
amount: effect strength (default: 0.1) 
lines: number of scanlines (default: 200.0) 
drift: horizontal drift amount (default: 0.05)`},antliaShapes={circle:`circle(s, smooth)
Creates a circular shape mask.
s: size (default: 0.3)
smooth: edge smoothing (default: 0.007)`,square:`square(s, smooth)
Creates a square shape mask.
s: size (default: 0.25)
smooth: edge smoothing (default: 0)`,rectangle:`rectangle(s, ratio, smooth)
Creates a rectangular shape mask.
s: size (default: 0.3)
ratio: aspect ratio array [width, height] (default: [1,1])
smooth: edge smoothing (default: 0)`,triangle:`triangle(s, smooth)
Creates a triangular shape mask.
s: size (default: 0.3)
smooth: edge smoothing (default: 0.007)`,horiz:`horiz(s, smooth)
Creates a horizontal strip.
s: size (default: 0.3)
smooth: edge smoothing (default: 0.0007)`,vert:`vert(s, smooth)
Creates a vertical strip.
s: size (default: 0.3)
smooth: edge smoothing (default: 0.0007)`,leftdiag:`leftdiag(s, smooth)
Creates a left diagonal strip.
s: size (default: 0.3)
smooth: edge smoothing (default: 0.0007)`,rightdiag:`rightdiag(s, smooth)
Creates a right diagonal strip.
s: size (default: 0.3)
smooth: edge smoothing (default: 0.0007)`,firstquad:`firstquad(r, g, b, a)
Creates a solid color in the first quadrant (top-right).
r,g,b,a: color components (default: 1,1,1,1)`,secondquad:`secondquad(r, g, b, a)
Creates a solid color in the second quadrant (top-left).
r,g,b,a: color components (default: 1,1,1,1)`,thirdquad:`thirdquad(r, g, b, a)
Creates a solid color in the third quadrant (bottom-left).
r,g,b,a: color components (default: 1,1,1,1)`,fourthquad:`fourthquad(r, g, b, a)
Creates a solid color in the fourth quadrant (bottom-right).
r,g,b,a: color components (default: 1,1,1,1)`,quad:`quad(i, r, g, b, a)
Creates a solid color in the specified quadrant.
i: quadrant index (0-3)
r,g,b,a: color components (default: 1,1,1,1)`,star:`star(s, v, smooth)
Creates a star shape.
s: size (default: 0.3)
v: number of points (default: 5)
smooth: edge smoothing (default: 0.007)`,grid:`grid(x, y, b, smooth)
Creates a grid pattern.
x: horizontal divisions (default: 8)
y: vertical divisions (default: 4)
b: border thickness (default: 0.05)
smooth: edge smoothing (default: 0.001)`},parametricCurves={pAstroid:`pAstroid(texture,a)
Parametric astroid curve.
a: scale parameter (default: 1.0)`,pSpiral:`pSpiral(texture,)
Parametric spiral curve.`,pCardioid:`pCardioid(texture,a, p)
Parametric cardioid curve.
a: scale parameter (default: 1.0)
p: parameter (default: 2.0)`,pConchoid:`pConchoid(texture,a)
Parametric conchoid curve.
a: shape parameter (default: 1.0)`,pEpicycloid:`pEpicycloid(texture,a, b)
Parametric epicycloid curve.
a: radius parameter (default: 1.0)
b: radius parameter (default: 1.0)`,pDescartesFolium:`pDescartesFolium(texture,a, b)
Parametric Descartes folium.
a: scale parameter (default: 1.0)
b: shape parameter (default: 1.0)`,pHypocycloid:`pHypocycloid(texture,a, b)
Parametric hypocycloid curve.
a: radius parameter (default: 1.0)
b: frequency parameter (default: 2.0)`,pHypotrochoid:`pHypotrochoid(texture,a, b, d)
Parametric hypotrochoid curve.
a: radius parameter (default: 1.0)
b: frequency parameter (default: 2.0)
d: distance parameter (default: 1.0)`,pInvoluteCircle:`pInvoluteCircle(texture,a)
Parametric involute of circle.
a: radius parameter (default: 1.0)`,pCircle:`pCircle(texture,a)
Parametric circle.
a: radius (default: 1.0)`,pLissajous:`pLissajous(texture,a, n, b, phase)
Parametric Lissajous curve.
a: amplitude parameter (default: 5.0)
n: frequency parameter (default: 1.0)
b: amplitude parameter (default: 1.0)
phase: phase shift (default: 0.0)`,pNephroid:`pNephroid(texture,a)
Parametric nephroid curve.
a: radius parameter (default: 1.0)`,pPlateau:`pPlateau(texture,m, n)
Parametric Plateau curve.
m: parameter (default: 2.0)
n: parameter (default: 1.0)`,pTalbot:`pTalbot(texture,a)
Parametric Talbot curve.
a: scale parameter (default: 1.0)`},implicitSurfaces={iSphere:`iSphere()
Implicit sphere surface.`,iCube:`iCube()
Implicit cube surface.`,iTorus:`iTorus(c, a)
Implicit torus surface.
c: minor radius (default: 0.5)
a: major radius (default: 1.0)`,iPlane:`iPlane(nx, ny, nz)
Implicit plane surface.
nx: normal x component (default: 1.0)
ny: normal y component (default: 1.0)
nz: normal z component (default: 1.0)`,iSteiner:`iSteiner(a)
Implicit Steiner surface.
a: shape parameter (default: 1.0)`,iWineGlass:`iWineGlass(k)
Implicit wine glass surface.
k: shape parameter (default: 3.2)`,iGenus2:`iGenus2()
Implicit genus-2 surface.`},inverseParametricSurfaces={ipSphere:`ipSphere(texture, a)
Inverse parametric sphere.
a: radius parameter (default: 1.0)`,ipTorus:`ipTorus(texture,a)
Inverse parametric torus.
a: shape parameter (default: 1.0)`,ipMobiusStrip:`ipMobiusStrip(texture)
Inverse parametric Mobius strip.`,ipCylinder:`ipCylinder(texture)
Inverse parametric cylinder.`,ipKleinBottle:`ipKleinBottle(texture)
Inverse parametric Klein bottle.`,ipCrossCap:`ipCrossCap(texture,a)
Inverse parametric cross cap.
a: scale parameter (default: 1.0)`},parametricHypersurfaces={hpSphere:`hpSphere(texture,a)
Parametric hypersphere.
a: radius parameter (default: 1.0)`,hpTorus:`hpTorus(texture,c, a)
Parametric hypertorus.
c: major radius (default: 1.0)
a: minor radius (default: 0.5)`,hpCone:`hpCone(texture,c)
Parametric hypercone.
c: shape parameter (default: 1.0)`,hpConeOblique:`hpConeOblique(texture,c, vx, vy, vz)
Parametric oblique hypercone.
c: shape parameter (default: 1.0)
vx: direction x (default: 1.0)
vy: direction y (default: 1.0)
vz: direction z (default: 1.0)`},explicitCurves={eCircle:`eCircle(freq, a)
Explicit circle curve.
freq: animation frequency (default: 1.0)
a: radius (default: 1.0)`,eBicorn:`eBicorn(freq)
Explicit bicorn curve.
freq: animation frequency (default: 1.0)`,eCatenary:`eCatenary(freq)
Explicit catenary curve.
freq: animation frequency (default: 1.0)`,eCissoid:`eCissoid(freq, a)
Explicit cissoid curve.
freq: animation frequency (default: 1.0)
a: shape parameter (default: 2.0)`,eLame:`eLame(freq, n, a, b)
Explicit Lamé curve.
freq: animation frequency (default: 2.0)
n: exponent (default: 2.5)
a: scale parameter (default: 3.0)
b: shape parameter (default: 2.0)`,eNewton:`eNewton(freq, g, a, b)
Explicit Newton diverging parabola.
freq: animation frequency (default: 2.0)
g: parameter (default: 0.4)
a: scale parameter (default: 1.0)
b: shape parameter (default: 0.8)`,ePearl:`ePearl(freq, k, a, n, m, p)
Explicit pearls of Sluze.
freq: animation frequency (default: 2.0)
k: scale parameter (default: 1.0)
a: shape parameter (default: 1.0)
n: exponent (default: 1.0)
m: power (default: 1.0)
p: parameter (default: 1.0)`,ePear:`ePear(freq, b, a)
Explicit pear-shaped quartic.
freq: animation frequency (default: 2.0)
b: scale parameter (default: 2.0)
a: shape parameter (default: 9.0)`,eStrophoid:`eStrophoid(freq, a)
Explicit strophoid curve.
freq: animation frequency (default: 2.0)
a: shape parameter (default: 5.0)`,eTrisectrix:`eTrisectrix(freq, a)
Explicit trisectrix of Maclaurin.
freq: animation frequency (default: 2.0)
a: scale parameter (default: 1.0)`},definitions={...sources,...initSources,...transformations,...effects,...colorEffects,...screenSpaceShaders,...fractalEffects,...antliaShapes,...utilities,...arrayMethods,...mathFunctions,...parametricCurves,...implicitSurfaces,...inverseParametricSurfaces,...parametricHypersurfaces,...explicitCurves};function showHydraDefinition(w){const i=w.getCursor(),o=w.getLine(i.line),f=w.getTokenAt(i).string,m=i.ch;document.querySelectorAll(".CodeMirror-tooltip").forEach(ue=>removeTooltip(ue));function F(ue,j){const xe=/([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/g,Z=[];let Ee;for(;(Ee=xe.exec(ue))!==null;){const Ke=Ee[1],le=Ee.index,q=Ee.index+Ee[0].length-1;let ce=1,Q=q;for(let N=q+1;N<ue.length&&ce>0;N++)ue[N]==="("?ce++:ue[N]===")"&&ce--,Q=N;Z.push({name:Ke,start:le,openParen:q,closeParen:Q})}let we=null,Oe=-1;for(const Ke of Z)if(j>=Ke.openParen&&j<=Ke.closeParen){const le=Ke.openParen;le>Oe&&(Oe=le,we=Ke.name)}return we}let pe=f;if(f.includes(".")){const ue=f.split(".");pe=ue[ue.length-1]}if(!definitions[pe]||!pe.match(/^[a-zA-Z_]/)){const ue=F(o,m);ue&&(pe=ue)}if(definitions[pe]){const ue=definitions[pe],j=makeTooltip(w,i,ue);setTimeout(()=>removeTooltip(j),7e3)}}function makeTooltip(w,i,o){const l=document.createElement("div");l.className="CodeMirror-tooltip hydra-tooltip",l.textContent=o,document.body.appendChild(l);const f=w.cursorCoords(i,"page").left,m=f+l.offsetWidth,D=document.documentElement.clientWidth;return m>D?l.style.left=`${D-l.offsetWidth-16}px`:l.style.left=`${f}px`,l.style.top=`${w.cursorCoords(i,"page").bottom}px`,l}function removeTooltip(w){w&&w.parentNode&&w.parentNode.removeChild(w)}function removeAllTooltips(){document.querySelectorAll(".CodeMirror-tooltip").forEach(i=>removeTooltip(i))}document.addEventListener("DOMContentLoaded",()=>{const w=localStorage.getItem("hydra-editor-content"),o=CodeMirror(document.getElementById("editor"),{value:w||"osc(20, 0.1, 0).out()",mode:"javascript",theme:"cobalt",keyMap:"sublime",lineNumbers:!1,autofocus:!0,autoCloseBrackets:!0,styleActiveLine:!0,styleSelectedText:!0,indentUnit:2,tabSize:2,matchBrackets:!0,autoCloseBrackets:!0,lineWrapping:!0});function l(){const j=o.getValue();localStorage.setItem("hydra-editor-content",j)}configPanel.init(o);const f=["initCam","initImage","initVideo","initScreen","render","setResolution","setBin","setCutoff","setSmooth","setScale","hide","show","p5","P5","hush"];function m(j){var{startLine:xe,endLine:Z}=hydraUtils.getBlock(j,j.getCursor().line);let Ee=j.getRange({line:xe,ch:0},{line:Z,ch:j.getLine(Z).length});const we=f.some(Ke=>Ee.includes(Ke));!/\.out\s*\(.*\)\s*;?$/m.test(Ee)&&!we&&(Ee=Ee.trim(),Ee+=".out()",j.replaceRange(Ee,{line:xe,ch:0},{line:Z,ch:j.getLine(Z).length})),hydraUtils.evaluateCode(Ee),F(xe,Z),l()}function D(j){var{startLine:xe,endLine:Z}=hydraUtils.getBlock(j,j.getCursor().line);let Ee=j.getRange({line:xe,ch:0},{line:Z,ch:j.getLine(Z).length});hydraUtils.evaluateCode(Ee),F(xe,Z),l()}function F(j,xe){for(let Z=j;Z<=xe;Z++){const Ee=o.markText({line:Z,ch:0},{line:Z,ch:o.getLine(Z).length},{className:"flash-highlight"});setTimeout(()=>Ee.clear(),200)}}function pe(){console.log("Toggling editor visibility"),document.getElementById("editor").classList.toggle("hideEditor")}function ue(j){const xe=hydraColorPicker.detectColorFunction(j);xe.found?hydraColorPicker.openNativeColorPicker(j,xe,(Z,Ee,we,Oe)=>{const Ke=`${Z.toFixed(2)}, ${Ee.toFixed(2)}, ${we.toFixed(2)}`,le={line:Oe.start.line,ch:Oe.openParenPos},q={line:Oe.start.line,ch:Oe.closeParenPos};j.replaceRange(Ke,le,q),m(j)}):console.log("Place your cursor in a .color() function to use the color picker")}o.addKeyMap({"Ctrl-Enter":function(j){m(j)},"Ctrl-Alt-Enter":function(j){D(j)},"Cmd-Enter":function(j){m(j)},"Cmd-Alt-Enter":function(j){D(j)},"Ctrl-Space":"autocomplete","Cmd-Space":"autocomplete","Ctrl-;":()=>{hydraUtils.stopHydra()},"Cmd-;":()=>{hydraUtils.stopHydra()},"Alt-X":j=>{j.toggleComment()},"Alt-Up":j=>{hydraUtils.incrementValue(j,1),m(j)},"Alt-Down":j=>{hydraUtils.incrementValue(j,-1),m(j)},"Alt-I":j=>{showHydraDefinition(j)},Esc:()=>{removeAllTooltips()},"Alt-H":j=>{pe()},"Ctrl-S":j=>{hydraUtils.saveEditorContent(j)},"Cmd-S":j=>{hydraUtils.saveEditorContent(j)},"Ctrl-K":j=>{ue(j)},"Cmd-K":j=>{ue(j)},"Alt-1":()=>{hydraUtils.switchOutput(0)},"Alt-2":()=>{hydraUtils.switchOutput(1)},"Alt-3":()=>{hydraUtils.switchOutput(2)},"Alt-4":()=>{hydraUtils.switchOutput(3)},"Alt-5":()=>{hydraUtils.switchOutput()},"Alt-P":()=>{configPanel.togglePanel()}}),o.setOption("hintOptions",{hint:j=>hydraAutocomplete.hint(j,CodeMirror),completeSingle:!1,extraKeys:{Right:function(j,xe){const Z=document.querySelector(".CodeMirror-hint-active");if(Z){const Ee=Z.getAttribute("data-category");if(Ee){const we=hydraAutocomplete.showCategoryItems(j,Ee);we&&(xe.close(),setTimeout(()=>{j.showHint({hint:()=>we,completeSingle:!1,extraKeys:{Left:function(Oe,Ke){Ke.close(),setTimeout(()=>{Oe.showHint()},50)}}})},50))}}},Left:function(j,xe){const Z=xe.data[xe.selectedHint];Z&&Z.displayText&&Z.displayText.includes("Retour aux catégories")&&(xe.close(),setTimeout(()=>{j.showHint()},50))}}}),window.addEventListener("beforeunload",()=>{l()});try{hydraUtils.init(),console.log("Hydra initialized successfully.")}catch(j){console.error("Error initializing Hydra:",j)}})});export default Yu();
